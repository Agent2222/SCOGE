var p=Object.defineProperty;var y=(r,t,e)=>t in r?p(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var m=(r,t,e)=>y(r,typeof t!="symbol"?t+"":t,e);import{bd as o}from"./main-eIJD23Y3.js";import"./wScoge-BthgsBuw.js";class v{constructor(t,e,a,i){m(this,"autoMovePlayer",({dir1:t,steps1:e,dir2:a,steps2:i})=>{var s=0,h=!1,l=0,n=!1;a===null&&(n=!0),this.autorun===null&&(window.movementBlock=!0,this.autorun=setInterval(()=>{if(s<e&&(this.shiftOrMove(t),window.soundtrack.movement(!0),s++),s>=e&&(h=!0,a!==null&&l<i&&(this.shiftOrMove(a),l++),l>=i&&(n=!0,window.soundtrack.movement(!1))),h===!0&&n===!0)return clearInterval(this.autorun),this.autorun=null,window.movementBlock=!1,!0},100))});m(this,"domainZoomReturn",t=>{});this.mapping=t,this.player=e,this.mapEvents=a,this.multiplayer=i,this.viewportWidth=window.innerWidth,this.viewportHeight=window.innerHeight,this.canvas=document.getElementById("universe"),this.canvas2=document.getElementById("uniPlayers"),this.playerWidth=e.playerBox.offsetWidth,this.playerHeight=e.playerBox.offsetHeight,this.playerX=e.playerBox.offsetLeft,this.playerY=e.playerBox.offsetTop,this.playerCenterX=this.playerX+this.playerWidth/2,this.playerCenterY=this.playerY+this.playerHeight/2,this.playerLeft=this.playerX,this.playerRight=this.playerX+this.playerWidth,this.playerTop=this.playerY,this.playerBottom=this.playerY+this.playerHeight,this.canvasWidth=this.mapEvents.canvas.offsetWidth,this.canvasHeight=this.mapEvents.canvas.offsetHeight,this.cameraX1=0,this.cameraX2=0,this.cameraY=0,this.tileSize=18,this.step=18,this.minX1=0,this.maxX1=0,this.minX2=0,this.maxX2=0,this.minY=0,this.maxY=0,this.tempStartX=990,this.tempStartY=0,this.remainingPixels=null,this.remainingPixelsLeft=null,this.tolerance=5,this.pass=null,this.autorun=null}async moveCamera(t){switch(this.pass=await o(null,null,this.player.domain,this.mapping),t){case"right":this.pass.right!==!0&&this.shiftOrMove("right");break;case"left":this.pass.left!==!0&&this.shiftOrMove("left");break;case"up":this.pass.up!==!0&&this.shiftOrMove("up");break;case"down":this.pass.down!==!0&&this.shiftOrMove("down");break}this.pass=await o(null,null,this.player.domain,this.mapping)}shiftOrMove(t){var h;this.maxX1=this.canvasWidth-this.tempStartX-this.viewportWidth,this.minX1=-this.tempStartX,this.maxY=this.canvasHeight-this.tempStartY-this.viewportHeight,this.minY=-this.tempStartY;var e=this.viewportWidth/2,a=this.viewportHeight/2,i=this.player.playerBox.getBoundingClientRect().left,s=this.player.playerBox.getBoundingClientRect().top;switch(t){case"right":this.cameraX1<this.maxX1&&i>=e?(this.cameraX1=Math.min(this.cameraX1+this.step,this.maxX1),this.canvas.style.transform=`translate(${-this.cameraX1}px, ${-this.cameraY}px)`,this.canvas2.style.transform=`translate(${-this.cameraX1}px, ${-this.cameraY}px)`):(this.cameraX1>=this.maxX1||i<e)&&this.player.movePlayer("right");break;case"left":this.cameraX1>this.minX1&&i<=e?(this.cameraX1=Math.max(this.cameraX1-this.step,this.minX1),this.canvas.style.transform=`translate(${-this.cameraX1}px, ${-this.cameraY}px)`,this.canvas2.style.transform=`translate(${-this.cameraX1}px, ${-this.cameraY}px)`):(this.cameraX1<=this.minX1||i>e)&&this.player.movePlayer("left");break;case"up":this.cameraY>this.minY&&s<=a?(this.cameraY=Math.max(this.cameraY-this.step,this.minY),this.canvas.style.transform=`translate(${-this.cameraX1}px, ${-this.cameraY}px)`,this.canvas2.style.transform=`translate(${-this.cameraX1}px, ${-this.cameraY}px)`):(this.cameraY<=this.minY||s>a)&&this.player.movePlayer("up");break;case"down":this.cameraY<this.maxY&&s>=a?(this.cameraY=Math.min(this.cameraY+this.step,this.maxY),this.canvas.style.transform=`translate(${-this.cameraX1}px, ${-this.cameraY}px)`,this.canvas2.style.transform=`translate(${-this.cameraX1}px, ${-this.cameraY}px)`):(this.cameraY>=this.maxY||s<a)&&this.player.movePlayer("down");break}if(this.player.playerPosition(),this.multiplayer.direction=t,(h=this.multiplayer.channels[1])==null||h.presence.update({data:this.player.uniPlayer}),this.multiplayer.rooms[0].players.length>1){this.multiplayer.getPlayersInRoom(1),this.multiplayer.updatePlayerInRoom(this.player.uniPlayer,1),this.mapEvents.clearPlayerShadow(t,Number(this.player.uniPlayer.previousX),Number(this.player.uniPlayer.previousY));return}else this.multiplayer.getPlayersInRoom(1),this.multiplayer.updatePlayerInRoom(this.player.uniPlayer,1),this.mapEvents.clearPlayerShadow(t,Number(this.player.uniPlayer.previousX),Number(this.player.uniPlayer.previousY)),this.multiplayer.createShadowPlayer(this.player.uniPlayer)}domainZoom(){let t=document.getElementById("universe"),e=document.getElementById("selection"),a=e.offsetLeft,i=e.offsetTop;t.style.transition="transform .8s ease-in-out",t.style.transformOrigin=`${a}px ${i}px`,t.style.transform="scale(10)",e.style.opacity="0",window.movementBlock=!0,window.soundtrack.movement(!1)}}export{v as Camera};
