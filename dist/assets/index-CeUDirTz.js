const __vite__fileDeps=["assets/main-r2m38eK3.js","assets/wScoge-GKPzpLMX.js","assets/wScoge-ClXpu_7t.css","assets/main-DW0PhOmK.css","assets/eth_estimateGas-I6gGQD6B.js","assets/eth_getTransactionCount-Db3PtAv7.js","assets/hashMessage-CMwUctZV.js","assets/checkContractWalletSignature-YMgReBeb.js","assets/isValidSignature-Cslmlb9k.js","assets/checkContractWalletSignedTypedData-CauJ9Ybi.js","assets/send-transaction-Bbu4IvxK.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{J as v,K as qe,L as et,M as tt,N as nt,B as Ge,O as Ee,P as rt,Q as Ie,R as k,S as at,T as le,U as q,V as E,W as st,X as ee,Y as fe,Z as it,$ as ot,a0 as te,a1 as Fe,a2 as I,a3 as pe,a4 as ct,a5 as Be,a6 as De,a7 as ut,a8 as dt,a9 as W,aa as lt,j as ft,v as pt,ab as ne,ac as Oe,ad as yt,ae as mt,e as re,af as z,ag as gt,ah as U,ai as Se,aj as Ue,_ as w,F as R,ak as Ce,al as Le,am as ht,H as $,u as bt,an as T,ao as N,ap as Me,aq as xt,ar as wt,s as Re,as as Pt,at as At,au as _t,av as Tt,aw as B,ax as vt,p as $e,d as Gt,ay as ye}from"./main-r2m38eK3.js";async function Et(e){const t=await e({method:"eth_gasPrice"});return v(t)}function It(e){const t=[],n=e.length;for(let r=0;r<n;r++){const a=e[r],s=qe(a);t.push(s)}return t}function Ft(e){const t=et(e),n=[],r=e.length;for(let a=0;a<r;a++){const s=e[a];tt(s)||n.push(nt(s,t))}return n}class Bt extends Ge{constructor(t){super(`Filter type "${t}" is not supported.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"FilterTypeNotSupportedError"})}}const ae=Ee;function Dt(e){const{abi:t,args:n=[],name:r}=e,a=rt(r,{strict:!1}),s=t.filter(o=>a?o.type==="function"?Ie(o)===r:o.type==="event"?ae(o)===r:!1:"name"in o&&o.name===r);if(s.length===0)return;if(s.length===1)return s[0];let i;for(const o of s){if(!("inputs"in o))continue;if(!n||n.length===0){if(!o.inputs||o.inputs.length===0)return o;continue}if(!o.inputs||o.inputs.length===0||o.inputs.length!==n.length)continue;if(n.every((u,d)=>{const p="inputs"in o&&o.inputs[d];return p?J(u,p):!1})){if(i&&"inputs"in i&&i.inputs){const u=Ne(o.inputs,i.inputs,n);if(u)throw new at({abiItem:o,type:u[0]},{abiItem:i,type:u[1]})}i=o}}return i||s[0]}function J(e,t){const n=typeof e,r=t.type;switch(r){case"address":return k(e,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return r==="tuple"&&"components"in t?Object.values(t.components).every((a,s)=>J(Object.values(e)[s],a)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?n==="string"||e instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)?Array.isArray(e)&&e.every(a=>J(a,{...t,type:r.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function Ne(e,t,n){for(const r in e){const a=e[r],s=t[r];if(a.type==="tuple"&&s.type==="tuple"&&"components"in a&&"components"in s)return Ne(a.components,s.components,n[r]);const i=[a.type,s.type];if(i.includes("address")&&i.includes("bytes20")?!0:i.includes("address")&&i.includes("string")?k(n[r],{strict:!1}):i.includes("address")&&i.includes("bytes")?k(n[r],{strict:!1}):!1)return i}}const me="/docs/contract/encodeEventTopics";function Ot(e){var c;const{abi:t,eventName:n,args:r}=e;let a=t[0];if(n){const u=Dt({abi:t,name:n});if(!u)throw new le(n,{docsPath:me});a=u}if(a.type!=="event")throw new le(void 0,{docsPath:me});const s=q(a),i=ae(s);let o=[];if(r&&"inputs"in a){const u=(c=a.inputs)==null?void 0:c.filter(p=>"indexed"in p&&p.indexed),d=Array.isArray(r)?r:Object.values(r).length>0?(u==null?void 0:u.map(p=>r[p.name]))??[]:[];d.length>0&&(o=(u==null?void 0:u.map((p,l)=>Array.isArray(d[l])?d[l].map((h,m)=>ge({param:p,value:d[l][m]})):d[l]?ge({param:p,value:d[l]}):null))??[])}return[i,...o]}function ge({param:e,value:t}){if(e.type==="string"||e.type==="bytes")return E(st(t));if(e.type==="tuple"||e.type.match(/^(.*)\[(\d+)?\]$/))throw new Bt(e.type);return ee([e],[t])}const St={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},Ut={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"};function Ve(e){const{abi:t,data:n}=e,r=fe(n,0,4);if(r==="0x")throw new it;const s=[...t||[],St,Ut].find(i=>i.type==="error"&&r===Ie(q(i)));if(!s)throw new ot(r,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:s,args:"inputs"in s&&s.inputs&&s.inputs.length>0?te(s.inputs,fe(n,4)):void 0,errorName:s.name}}const Ct={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3"};function Lt(e){const t={};return typeof e.accessList<"u"&&(t.accessList=e.accessList),typeof e.blobVersionedHashes<"u"&&(t.blobVersionedHashes=e.blobVersionedHashes),typeof e.blobs<"u"&&(typeof e.blobs[0]!="string"?t.blobs=e.blobs.map(n=>Fe(n)):t.blobs=e.blobs),typeof e.data<"u"&&(t.data=e.data),typeof e.from<"u"&&(t.from=e.from),typeof e.gas<"u"&&(t.gas=I(e.gas)),typeof e.gasPrice<"u"&&(t.gasPrice=I(e.gasPrice)),typeof e.maxFeePerBlobGas<"u"&&(t.maxFeePerBlobGas=I(e.maxFeePerBlobGas)),typeof e.maxFeePerGas<"u"&&(t.maxFeePerGas=I(e.maxFeePerGas)),typeof e.maxPriorityFeePerGas<"u"&&(t.maxPriorityFeePerGas=I(e.maxPriorityFeePerGas)),typeof e.nonce<"u"&&(t.nonce=I(e.nonce)),typeof e.to<"u"&&(t.to=e.to),typeof e.type<"u"&&(t.type=Ct[e.type]),typeof e.value<"u"&&(t.value=I(e.value)),t}const Mt={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844"};function Rt(e){const t={...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,chainId:e.chainId?pe(e.chainId):void 0,gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,maxFeePerBlobGas:e.maxFeePerBlobGas?BigInt(e.maxFeePerBlobGas):void 0,maxFeePerGas:e.maxFeePerGas?BigInt(e.maxFeePerGas):void 0,maxPriorityFeePerGas:e.maxPriorityFeePerGas?BigInt(e.maxPriorityFeePerGas):void 0,nonce:e.nonce?pe(e.nonce):void 0,to:e.to?e.to:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,type:e.type?Mt[e.type]:void 0,typeHex:e.type?e.type:void 0,value:e.value?BigInt(e.value):void 0,v:e.v?BigInt(e.v):void 0};return t.yParity=(()=>{if(e.yParity)return Number(e.yParity);if(typeof t.v=="bigint"){if(t.v===0n||t.v===27n)return 0;if(t.v===1n||t.v===28n)return 1;if(t.v>=35n)return t.v%2n===0n?1:0}})(),t.type==="legacy"&&(delete t.accessList,delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,delete t.yParity),t.type==="eip2930"&&(delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas),t.type==="eip1559"&&delete t.maxFeePerBlobGas,t}function $t(e){var n;const t=(n=e.transactions)==null?void 0:n.map(r=>typeof r=="string"?r:Rt(r));return{...e,baseFeePerGas:e.baseFeePerGas?BigInt(e.baseFeePerGas):null,blobGasUsed:e.blobGasUsed?BigInt(e.blobGasUsed):void 0,difficulty:e.difficulty?BigInt(e.difficulty):void 0,excessBlobGas:e.excessBlobGas?BigInt(e.excessBlobGas):void 0,gasLimit:e.gasLimit?BigInt(e.gasLimit):void 0,gasUsed:e.gasUsed?BigInt(e.gasUsed):void 0,hash:e.hash?e.hash:null,logsBloom:e.logsBloom?e.logsBloom:null,nonce:e.nonce?e.nonce:null,number:e.number?BigInt(e.number):null,size:e.size?BigInt(e.size):void 0,timestamp:e.timestamp?BigInt(e.timestamp):void 0,transactions:t,totalDifficulty:e.totalDifficulty?BigInt(e.totalDifficulty):null}}const he="/docs/contract/decodeEventLog";function Nt(e){const{abi:t,data:n,strict:r,topics:a}=e,s=r??!0,[i,...o]=a;if(!i)throw new ct({docsPath:he});const c=t.find(g=>g.type==="event"&&i===ae(q(g)));if(!(c&&"name"in c)||c.type!=="event")throw new Be(i,{docsPath:he});const{name:u,inputs:d}=c,p=d==null?void 0:d.some(g=>!("name"in g&&g.name));let l=p?[]:{};const h=d.filter(g=>"indexed"in g&&g.indexed);for(let g=0;g<h.length;g++){const y=h[g],P=o[g];if(!P)throw new De({abiItem:c,param:y});l[p?g:y.name||g]=Vt({param:y,value:P})}const m=d.filter(g=>!("indexed"in g&&g.indexed));if(m.length>0){if(n&&n!=="0x")try{const g=te(m,n);if(g)if(p)l=[...l,...g];else for(let y=0;y<m.length;y++)l[m[y].name]=g[y]}catch(g){if(s)throw g instanceof ut||g instanceof dt?new W({abiItem:c,data:n,params:m,size:lt(n)}):g}else if(s)throw new W({abiItem:c,data:"0x",params:m,size:0})}return{eventName:u,args:Object.values(l).length>0?l:void 0}}function Vt({param:e,value:t}){return e.type==="string"||e.type==="bytes"||e.type==="tuple"||e.type.match(/^(.*)\[(\d+)?\]$/)?t:(te([e],t)||[])[0]}function Ht({abi:e,eventName:t,logs:n,strict:r=!0}){return n.map(a=>{var s;try{const i=Nt({...a,abi:e,strict:r});return t&&!t.includes(i.eventName)?null:{...i,...a}}catch(i){let o,c;if(i instanceof Be)return null;if(i instanceof W||i instanceof De){if(r)return null;o=i.abiItem.name,c=(s=i.abiItem.inputs)==null?void 0:s.some(u=>!("name"in u&&u.name))}return{...a,args:c?[]:{},eventName:o}}}).filter(Boolean)}function jt(e){const{domain:t={},message:n,primaryType:r}=e,a={EIP712Domain:ft({domain:t}),...e.types};pt({domain:t,message:n,primaryType:r,types:a});const s=["0x1901"];return t&&s.push(kt({domain:t,types:a})),r!=="EIP712Domain"&&s.push(He({data:n,primaryType:r,types:a})),E(ne(s))}function kt({domain:e,types:t}){return He({data:e,primaryType:"EIP712Domain",types:t})}function He({data:e,primaryType:t,types:n}){const r=je({data:e,primaryType:t,types:n});return E(r)}function je({data:e,primaryType:t,types:n}){const r=[{type:"bytes32"}],a=[Wt({primaryType:t,types:n})];for(const s of n[t]){const[i,o]=We({types:n,name:s.name,type:s.type,value:e[s.name]});r.push(i),a.push(o)}return ee(r,a)}function Wt({primaryType:e,types:t}){const n=Oe(zt({primaryType:e,types:t}));return E(n)}function zt({primaryType:e,types:t}){let n="";const r=ke({primaryType:e,types:t});r.delete(e);const a=[e,...Array.from(r).sort()];for(const s of a)n+=`${s}(${t[s].map(({name:i,type:o})=>`${o} ${i}`).join(",")})`;return n}function ke({primaryType:e,types:t},n=new Set){const r=e.match(/^\w*/u),a=r==null?void 0:r[0];if(n.has(a)||t[a]===void 0)return n;n.add(a);for(const s of t[a])ke({primaryType:s.type,types:t},n);return n}function We({types:e,name:t,type:n,value:r}){if(e[n]!==void 0)return[{type:"bytes32"},E(je({data:r,primaryType:n,types:e}))];if(n==="bytes")return r=`0x${(r.length%2?"0":"")+r.slice(2)}`,[{type:"bytes32"},E(r)];if(n==="string")return[{type:"bytes32"},E(Oe(r))];if(n.lastIndexOf("]")===n.length-1){const a=n.slice(0,n.lastIndexOf("[")),s=r.map(i=>We({name:t,type:a,types:e,value:i}));return[{type:"bytes32"},E(ee(s.map(([i])=>i),s.map(([,i])=>i)))]}return[{type:n},r]}function Jt(e,t="hex"){const n=ze(e),r=yt(new Uint8Array(n.length));return n.encode(r),t==="hex"?Fe(r.bytes):r.bytes}function ze(e){return Array.isArray(e)?Zt(e.map(t=>ze(t))):Kt(e)}function Zt(e){const t=e.reduce((a,s)=>a+s.length,0),n=Je(t);return{length:t<=55?1+t:1+n+t,encode(a){t<=55?a.pushByte(192+t):(a.pushByte(247+n),n===1?a.pushUint8(t):n===2?a.pushUint16(t):n===3?a.pushUint24(t):a.pushUint32(t));for(const{encode:s}of e)s(a)}}}function Kt(e){const t=typeof e=="string"?mt(e):e,n=Je(t.length);return{length:t.length===1&&t[0]<128?1:t.length<=55?1+t.length:1+n+t.length,encode(a){t.length===1&&t[0]<128?a.pushBytes(t):t.length<=55?(a.pushByte(128+t.length),a.pushBytes(t)):(a.pushByte(183+n),n===1?a.pushUint8(t.length):n===2?a.pushUint16(t.length):n===3?a.pushUint24(t.length):a.pushUint32(t.length),a.pushBytes(t))}}}function Je(e){if(e<2**8)return 1;if(e<2**16)return 2;if(e<2**24)return 3;if(e<2**32)return 4;throw new Ge("Length is too large.")}async function Yt(e,t){const n=t.blockTag??"latest",r=t.includeTransactions??!1,a=t.blockNumber!==void 0?re(t.blockNumber):void 0,s=await e({method:"eth_getBlockByNumber",params:[a||n,r]});if(!s)throw new Error("Block not found");return $t(s)}async function Qt(e){const t=await e({method:"eth_maxPriorityFeePerGas"});return v(t)}function Ze(e,t){return t&&(e.__preparedMethod=t.preparedMethod,e.__contract=t.contract),e}const Xt=Object.freeze(Object.defineProperty({__proto__:null,prepareTransaction:Ze},Symbol.toStringTag,{value:"Module"}));async function x(e){return typeof e=="function"?await e():e}function se(e){const{contract:t,method:n,params:r,...a}=e,s=()=>(async()=>{var i,o;if(Array.isArray(n))return n;if(gt(n))return U(n);if(typeof n=="function")return U(await n(t));if(typeof n=="string"&&n.startsWith("function ")){const c=Se(n);if(c.type==="function")return U(c);throw new Error('"method" passed is not of type "function"')}if(t.abi&&((i=t.abi)==null?void 0:i.length)>0){const c=(o=t.abi)==null?void 0:o.find(u=>u.type==="function"&&u.name===n);if(c)return U(c)}throw new Error(`Could not resolve method "${n}".`)})();return Ze({...a,to:t.address,chain:t.chain,client:t.client,data:async()=>{let i;return Array.isArray(n)?i=n:i=await s(),i[1].length===0?i[0]:i[0]+z(i[1],await x(r??[])).slice(2)}},{preparedMethod:s,contract:t})}const qt="0x5357aa5e",en=[],tn=[{name:"_installedExtensions",type:"tuple[]",internalType:"struct IModularCore.InstalledExtension[]",components:[{name:"implementation",type:"address",internalType:"address"},{name:"config",type:"tuple",internalType:"struct IExtensionConfig.ExtensionConfig",components:[{name:"registerInstallationCallback",type:"bool",internalType:"bool"},{name:"requiredInterfaces",type:"bytes4[]",internalType:"bytes4[]"},{name:"supportedInterfaces",type:"bytes4[]",internalType:"bytes4[]"},{name:"callbackFunctions",type:"tuple[]",internalType:"struct IExtensionConfig.CallbackFunction[]",components:[{name:"selector",type:"bytes4",internalType:"bytes4"}]},{name:"fallbackFunctions",type:"tuple[]",internalType:"struct IExtensionConfig.FallbackFunction[]",components:[{name:"selector",type:"bytes4",internalType:"bytes4"},{name:"permissionBits",type:"uint256",internalType:"uint256"}]}]}]}];async function nn(e){return Ue({contract:e.contract,method:[qt,en,tn],params:[]})}const rn="https://{clientId}.ipfscdn.io/ipfs/{cid}";function an(e){var t,n;if(e.uri.startsWith("ipfs://")){const r=((n=(t=e.client.config)==null?void 0:t.storage)==null?void 0:n.gatewayUrl)??rn,a=e.client.clientId,s=sn(e.uri);let i;return typeof globalThis<"u"&&"Application"in globalThis&&(i=globalThis.Application.applicationId),`${r.replace("{clientId}",a).split("/ipfs")[0]}/ipfs/${s}${i?`?bundleId=${i}`:""}`}if(e.uri.startsWith("http"))return e.uri;throw new Error('Invalid URI scheme, expected "ipfs://" or "http(s)://"')}function sn(e){if(!e.startsWith("ipfs://"))return e;const t=e.search(/\/(Qm|baf)/i);return e.slice(t+1)}async function on(e){var r,a,s,i,o,c,u,d,p,l;let t;if(e.uri.startsWith("ar://")){const{resolveArweaveScheme:h}=await w(async()=>{const{resolveArweaveScheme:m}=await import("./arweave-CAGvOb64.js");return{resolveArweaveScheme:m}},[]);t=h(e)}else t=an(e);const n=await R(e.client)(t,{keepalive:(s=(a=(r=e.client.config)==null?void 0:r.storage)==null?void 0:a.fetch)==null?void 0:s.keepalive,headers:(c=(o=(i=e.client.config)==null?void 0:i.storage)==null?void 0:o.fetch)==null?void 0:c.headers,requestTimeoutMs:(p=(d=(u=e.client.config)==null?void 0:u.storage)==null?void 0:d.fetch)==null?void 0:p.requestTimeoutMs});if(!n.ok)throw(l=n.body)==null||l.cancel(),new Error(`Failed to download file: ${n.statusText}`);return n}const ie="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",Z=ie.length,cn=ie.charAt(0),un=Math.log(256)/Math.log(Z);function dn(e){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length===0)return"";let t=0,n=0,r=0;const a=e.length;for(;r!==a&&e[r]===0;)r++,t++;const s=(a-r)*un+1>>>0,i=new Uint8Array(s);for(;r!==a;){let u=e[r]||0,d=0;for(let p=s-1;(u!==0||d<n)&&p!==-1;p--,d++)u+=256*(i[p]||0)>>>0,i[p]=u%Z>>>0,u=u/Z>>>0;if(u!==0)throw new Error("Non-zero carry");n=d,r++}let o=s-n;for(;o!==s&&i[o]===0;)o++;let c=cn.repeat(t);for(;o<s;++o)c+=ie.charAt(i[o]||0);return c}let b,M,f=0,K={},G,Ke;const be=0;let Y=0,D,Q,ln;const xe={useRecords:!1,mapsAsObjects:!0};class oe{constructor(){Object.assign(this,xe)}decodeKey(t){return t}decode(t,n=-1){M=n>-1?n:t.length,f=0,Y=0,Ke=null,D=null,b=t;try{ln=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(r){throw b=null,t instanceof Uint8Array?r:new Error(`Source must be a Uint8Array or Buffer but was a ${t&&typeof t=="object"?t.constructor.name:typeof t}`)}return this instanceof oe?(K=this,this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),(!G||G.length>0)&&(G=[])):(K=xe,(!G||G.length>0)&&(G=[])),fn()}}function fn(){try{const e=L();if(D){if(f>=D.postBundlePosition){const t=new Error("Unexpected bundle position");throw t.incomplete=!0,t}f=D.postBundlePosition,D=null}if(f===M)G=null,b=null,Q&&(Q=null);else if(f>M){const t=new Error("Unexpected end of CBOR data");throw t.incomplete=!0,t}else throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw hn(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function L(){let e=b[f++];const t=e>>5;if(e=e&31,e>23)switch(e){case 24:e=b[f++];break;default:throw new Error(`Unknown token ${e}`)}switch(t){case 0:return e;case 1:return~e;case 2:return gn(e);case 3:if(Y>=f)return Ke.slice(f-be,(f+=e)-be);if(Y===0&&M<140&&e<32){const n=e<16?mn(e):yn(e);if(n!==null)return n}return readFixedString(e);case 4:{const n=new Array(e);for(let r=0;r<e;r++)n[r]=L();return n}case 5:{const n={};for(let r=0;r<e;r++)n[pn(L())]=L();return n}default:if(Number.isNaN(e)){const n=new Error("Unexpected end of CBOR data");throw n.incomplete=!0,n}throw new Error(`Unknown CBOR token ${e}`)}}function pn(e){if(typeof e=="string")return e==="__proto__"?"__proto_":e;if(typeof e!="object")return e.toString();throw new Error(`Invalid property name type ${typeof e}`)}const _=String.fromCharCode;function yn(e){const t=f,n=new Array(e);for(let r=0;r<e;r++){const a=b[f++];if((a&128)>0){f=t;return}n[r]=a}return _.apply(String,n)}function mn(e){if(e<4){if(e<2){if(e===0)return"";const de=b[f++];if((de&128)>1){f-=1;return}return _(de)}const y=b[f++],P=b[f++];if((y&128)>0||(P&128)>0){f-=2;return}if(e<3)return _(y,P);const A=b[f++];if((A&128)>0){f-=3;return}return _(y,P,A)}const t=b[f++],n=b[f++],r=b[f++],a=b[f++];if((t&128)>0||(n&128)>0||(r&128)>0||(a&128)>0){f-=4;return}if(e<6){if(e===4)return _(t,n,r,a);const y=b[f++];if((y&128)>0){f-=5;return}return _(t,n,r,a,y)}if(e<8){const y=b[f++],P=b[f++];if((y&128)>0||(P&128)>0){f-=6;return}if(e<7)return _(t,n,r,a,y,P);const A=b[f++];if((A&128)>0){f-=7;return}return _(t,n,r,a,y,P,A)}const s=b[f++],i=b[f++],o=b[f++],c=b[f++];if((s&128)>0||(i&128)>0||(o&128)>0||(c&128)>0){f-=8;return}if(e<10){if(e===8)return _(t,n,r,a,s,i,o,c);const y=b[f++];if((y&128)>0){f-=9;return}return _(t,n,r,a,s,i,o,c,y)}if(e<12){const y=b[f++],P=b[f++];if((y&128)>0||(P&128)>0){f-=10;return}if(e<11)return _(t,n,r,a,s,i,o,c,y,P);const A=b[f++];if((A&128)>0){f-=11;return}return _(t,n,r,a,s,i,o,c,y,P,A)}const u=b[f++],d=b[f++],p=b[f++],l=b[f++];if((u&128)>0||(d&128)>0||(p&128)>0||(l&128)>0){f-=12;return}if(e<14){if(e===12)return _(t,n,r,a,s,i,o,c,u,d,p,l);const y=b[f++];if((y&128)>0){f-=13;return}return _(t,n,r,a,s,i,o,c,u,d,p,l,y)}const h=b[f++],m=b[f++];if((h&128)>0||(m&128)>0){f-=14;return}if(e<15)return _(t,n,r,a,s,i,o,c,u,d,p,l,h,m);const g=b[f++];if((g&128)>0){f-=15;return}return _(t,n,r,a,s,i,o,c,u,d,p,l,h,m,g)}function gn(e){return K.copyBuffers?Uint8Array.prototype.slice.call(b,f,f+=e):b.subarray(f,f+=e)}function hn(){b=null,Q=null,G=null}const bn=new Array(147);for(let e=0;e<256;e++)bn[e]=+`1e${Math.floor(45.15-e*.30103)}`;const xn=new oe,wn=xn.decode;function Pn(e){return Ce(e,{strict:!1})?e:`0x${e}`}function An(e){const t=Le(Pn(e)),n=t[t.length-2]*256+t[t.length-1],r=t.length-2-n;if(r<0||r>t.length)return;const a=t.slice(r,-2),s=wn(a);if("ipfs"in s)return`ipfs://${dn(s.ipfs)}`}const V=new WeakMap;function _n(e,t="https://contract.thirdweb.com/abi"){if(V.has(e))return V.get(e);const n=(async()=>{if(e.abi)return e.abi;try{return await Tn(e,t)}catch{return await In(e)}})();return V.set(e,n),n}async function Tn(e,t="https://contract.thirdweb.com/abi"){const r=await(await R(e.client)(`${t}/${e.chain.id}/${e.address}`)).json();if(!r||r.error)throw new Error(`Failed to resolve ABI from contract API. ${r.error||""}`);return r}async function Ye(e){const t=await ht(e);if(t==="0x"){const{id:r,name:a}=e.chain;throw new Error(`Failed to load contract bytecode. Make sure the contract [${e.address}] exists on the chain [${a||"Unknown Chain"} (chain id: ${r})]`)}const n=An(t);if(!n)return[];try{return(await(await on({uri:n,client:e.client})).json()).output.abi}catch{return[]}}const vn={inputs:[],name:"getAllPlugins",outputs:[{components:[{internalType:"bytes4",name:"functionSelector",type:"bytes4"},{internalType:"string",name:"functionSignature",type:"string"},{internalType:"address",name:"pluginAddress",type:"address"}],internalType:"struct IPluginMap.Plugin[]",name:"registered",type:"tuple[]"}],stateMutability:"view",type:"function"},Gn={inputs:[],name:"getAllExtensions",outputs:[{components:[{components:[{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"metadataURI",type:"string"},{internalType:"address",name:"implementation",type:"address"}],internalType:"struct IExtension.ExtensionMetadata",name:"metadata",type:"tuple"},{components:[{internalType:"bytes4",name:"functionSelector",type:"bytes4"},{internalType:"string",name:"functionSignature",type:"string"}],internalType:"struct IExtension.ExtensionFunction[]",name:"functions",type:"tuple[]"}],internalType:"struct IExtension.Extension[]",name:"allExtensions",type:"tuple[]"}],stateMutability:"view",type:"function"},En={inputs:[],name:"facets",outputs:[{components:[{internalType:"address",name:"facetAddress",type:"address"},{internalType:"bytes4[]",name:"functionSelectors",type:"bytes4[]"}],type:"tuple[]"}],stateMutability:"view",type:"function"};async function In(e,t,n){const[r,a,s,i,o]=await Promise.all([Ye(e),Fn(e),Bn(e),Dn(e),On(e)]),c=[...new Set([...a,...s,...i,...o])];if(!c.length)return r;const u=await Sn({contract:e,plugins:c,resolveSubAbi:n});return Un({rootAbi:r,pluginAbis:u})}async function Fn(e){try{const{readContract:t}=await w(async()=>{const{readContract:r}=await import("./main-r2m38eK3.js").then(a=>a.aJ);return{readContract:r}},__vite__mapDeps([0,1,2,3])),n=await t({contract:e,method:vn});return n.length?[...new Set(n.map(r=>r.pluginAddress))]:[]}catch{}return[]}async function Bn(e){try{const{readContract:t}=await w(async()=>{const{readContract:r}=await import("./main-r2m38eK3.js").then(a=>a.aJ);return{readContract:r}},__vite__mapDeps([0,1,2,3])),n=await t({contract:e,method:Gn});return n.length?[...new Set(n.map(r=>r.metadata.implementation))]:[]}catch{}return[]}async function Dn(e){try{const t=await nn({contract:e});return t.length?[...new Set(t.map(n=>n.implementation))]:[]}catch{}return[]}async function On(e){try{const{readContract:t}=await w(async()=>{const{readContract:r}=await import("./main-r2m38eK3.js").then(a=>a.aJ);return{readContract:r}},__vite__mapDeps([0,1,2,3])),n=await t({contract:e,method:En});return n.length?n.map(r=>r.facetAddress):[]}catch{}return[]}async function Sn(e){return Promise.all(e.plugins.map(t=>{const n={...e.contract,address:t};return e.resolveSubAbi?e.resolveSubAbi(n):Ye(n)}))}function Un(e){let t=e.pluginAbis.flat().filter(r=>r.type!=="constructor");e.rootAbi&&(t=[...e.rootAbi||[],...t].filter(Boolean));const n=[...new Set(It(t))];return Ft(n)}const H=new WeakMap;async function S(e){if(H.has(e))return H.get(e);const t=(async()=>{if(e.data===void 0)return"0x";if(typeof e.data=="function"){const n=await e.data();return n||"0x"}return e.data})();return H.set(e,t),t}const Cn=Object.freeze(Object.defineProperty({__proto__:null,encode:S},Symbol.toStringTag,{value:"Module"}));function O(e){if(e===0n||(e&e-1n)===0n)return e;let t=1n;for(;e>0n;)e>>=1n,t<<=1n;return t}async function we(e){const{error:t,contract:n}=e;if(typeof t=="object"){const r=t;if(r.data){if(r.data!=="0x"){let a=n==null?void 0:n.abi;n&&!a&&(a=await _n(n).catch(()=>{}));const s=Ve({data:r.data,abi:a});return new Pe(`${s.errorName}${s.args?` - ${s.args}`:""}`,n)}return new Pe("Execution Reverted",n)}}return t}class Pe extends Error{constructor(t,n){var r;super(),Object.defineProperty(this,"contractAddress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chainId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="TransactionError",this.contractAddress=n==null?void 0:n.address,this.chainId=(r=n==null?void 0:n.chain)==null?void 0:r.id,this.message=t}}const j=new WeakMap;async function Ln(e){var s;const t=e.from??((s=e.account)==null?void 0:s.address)??void 0,n={...e.transaction,from:t};if(j.has(n))return j.get(n);const{account:r}=e,a=(async()=>{var m,g;const i=await x(e.transaction.gas);if(i)return i;if(r!=null&&r.estimateGas)try{let y=await r.estimateGas(e.transaction);return(m=e.transaction.chain.experimental)!=null&&m.increaseZeroByteCount&&(y=O(y)),y}catch(y){throw await we({error:y,contract:e.transaction.__contract})}const{encode:o}=await w(async()=>{const{encode:y}=await Promise.resolve().then(()=>Cn);return{encode:y}},void 0),[c,u,d]=await Promise.all([o(e.transaction),x(e.transaction.to),x(e.transaction.value)]),[{getRpcClient:p},{eth_estimateGas:l}]=await Promise.all([w(()=>import("./main-r2m38eK3.js").then(y=>y.aH),__vite__mapDeps([0,1,2,3])),w(()=>import("./eth_estimateGas-I6gGQD6B.js"),__vite__mapDeps([4,0,1,2,3]))]),h=p(e.transaction);try{let y=await l(h,Lt({to:u,data:c,from:t,value:d}));return(g=e.transaction.chain.experimental)!=null&&g.increaseZeroByteCount&&(y=O(y)),y}catch(y){throw await we({error:y,contract:e.transaction.__contract})}})();return j.set(n,a),a}async function Mn(e){const{client:t,chain:n,percentMultiplier:r}=e,a=$({client:t,chain:n}),s=await Et(a),i=r?s/BigInt(100)*BigInt(r):0n;return s+i}function Rn(e,t){let[n,r=""]=e.split(".");const a=n.startsWith("-")?"-":"";if(a&&(n=n.slice(1)),r=r.padEnd(t,"0"),r.length>t){const s=r[t];s&&Number.parseInt(s,10)>=5?(r=(BigInt(r.substring(0,t))+1n).toString().padStart(t,"0"),r.length>t&&(n=(BigInt(n)+1n).toString(),r=r.substring(r.length-t))):r=r.substring(0,t)}return BigInt(`${a}${n}${r}`)}async function $n(e){var s;const[t,n,r]=await Promise.all([x(e.maxFeePerGas),x(e.maxPriorityFeePerGas),x(e.gasPrice)]);if(t!==void 0&&n!==void 0)return{maxFeePerGas:t,maxPriorityFeePerGas:n};if(r)return{gasPrice:r};const a=await Qe(e.client,e.chain);return(s=e.chain.experimental)!=null&&s.increaseZeroByteCount?a.gasPrice?{gasPrice:O(a.gasPrice)}:{maxFeePerGas:t??O(a.maxFeePerGas??0n),maxPriorityFeePerGas:n??O(a.maxPriorityFeePerGas??0n)}:a.gasPrice?a:{maxFeePerGas:t??a.maxFeePerGas,maxPriorityFeePerGas:n??a.maxPriorityFeePerGas}}async function Qe(e,t){const n=await Nn(e,t);return n.maxFeePerGas&&n.maxPriorityFeePerGas?{maxFeePerGas:n.maxFeePerGas,maxPriorityFeePerGas:n.maxPriorityFeePerGas}:{gasPrice:await Mn({client:e,chain:t,percentMultiplier:10})}}async function Nn(e,t){let n=null,r=null;const a=$({client:e,chain:t}),[s,i]=await Promise.all([Yt(a,{blockTag:"latest"}),Qt(a).catch(()=>null)]),o=s!=null&&s.baseFeePerGas?s.baseFeePerGas:100n,c=t.id;return c===220||c===1220?{maxFeePerGas:null,maxPriorityFeePerGas:null}:(c===80001||c===137?r=await zn(c):i&&(r=i),r?(r=Vn(r),n=o*2n+r,(c===42220||c===44787||c===62320)&&(r=n),{maxFeePerGas:n,maxPriorityFeePerGas:r}):{maxFeePerGas:null,maxPriorityFeePerGas:null})}function Vn(e,t=10){const n=e/BigInt(100)*BigInt(t);return e+n}function Hn(e){switch(e){case 137:return"https://gasstation.polygon.technology/v2";case 80001:return"https://gasstation-testnet.polygon.technology/v2"}}const jn=31n,kn=1n;function Wn(e){switch(e){case 137:return jn;case 80001:return kn}}async function zn(e){const t=Hn(e);try{const r=(await(await fetch(t)).json()).fast.maxPriorityFee;if(r>0){const a=Number.parseFloat(r).toFixed(9);return Rn(a,9)}}catch(n){console.error("failed to fetch gas",n)}return Wn(e)}async function Jn(e){const t=$(e.transaction),n=e.transaction.chain.id,r=e.from;let[a,s,i,o,c,u,d]=await Promise.all([S(e.transaction),(async()=>{const l=await x(e.transaction.nonce);return l!==void 0?l:r?await w(async()=>{const{eth_getTransactionCount:h}=await import("./eth_getTransactionCount-Db3PtAv7.js");return{eth_getTransactionCount:h}},__vite__mapDeps([5,0,1,2,3])).then(({eth_getTransactionCount:h})=>h(t,{address:r,blockTag:"pending"})):void 0})(),Ln(e),$n(e.transaction),x(e.transaction.to),x(e.transaction.accessList),x(e.transaction.value)]);const p=await x(e.transaction.extraGas);return p&&(i+=p),{to:c,chainId:n,data:a,gas:i,nonce:s,accessList:u,value:d,...o}}function Zn(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="event")}function Kn(e){const{signature:t}=e;let n;return Zn(t)?n=t:n=Se(t),{abiEvent:n,hash:Ee(n),topics:Ot({abi:[n],args:e.filters})}}function Yn(e){const{logs:t,events:n,strict:r}=e;return Ht({logs:t,abi:n.map(a=>a.abiEvent),strict:r})}function Qn(e){return`0x${e.reduce((t,n)=>t+n.replace("0x",""),"")}`}function C(e){if(["string","number"].includes(typeof e)&&!Number.isInteger(Number(e)))throw new Error(`Expected value to be an integer to convert to a bigint, got ${e} of type ${typeof e}`);return e instanceof Uint8Array?BigInt(bt(e)):BigInt(e)}const Xe=50000n,Xn=e=>{const t=qn(e);return{domain:{name:"zkSync",version:"2",chainId:e.chainId},types:{Transaction:[{name:"txType",type:"uint256"},{name:"from",type:"uint256"},{name:"to",type:"uint256"},{name:"gasLimit",type:"uint256"},{name:"gasPerPubdataByteLimit",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymaster",type:"uint256"},{name:"nonce",type:"uint256"},{name:"value",type:"uint256"},{name:"data",type:"bytes"},{name:"factoryDeps",type:"bytes32[]"},{name:"paymasterInput",type:"bytes"}]},primaryType:"Transaction",message:t}};function qn(e){const{gas:t,nonce:n,to:r,from:a,value:s,maxFeePerGas:i,maxPriorityFeePerGas:o,paymaster:c,paymasterInput:u,gasPerPubdata:d,data:p}=e;return{txType:113n,from:BigInt(a),to:r?BigInt(r):0n,gasLimit:t??0n,gasPerPubdataByteLimit:d??Xe,maxFeePerGas:i??0n,maxPriorityFeePerGas:o??0n,paymaster:c?BigInt(c):0n,nonce:n?BigInt(n):0n,value:s??0n,data:p||"0x0",factoryDeps:[],paymasterInput:u||"0x"}}async function er(e){const{account:t,eip712Transaction:n,chainId:r}=e,a=Xn(n),s=await t.signTypedData({...a});return nr({...n,chainId:r,customSignature:s})}async function tr(e){const{account:t,transaction:n}=e;let[r,a,s,i,o,c,u]=await Promise.all([S(n),x(n.to),x(n.value),x(n.gas),x(n.maxFeePerGas),x(n.maxPriorityFeePerGas),x(n.eip712).then(p=>p==null?void 0:p.gasPerPubdata)]);if(!i||!o||!c){const l=await $(n)({method:"zks_estimateFee",params:[{from:t.address,to:a,data:r,value:s?re(s):void 0}]});i=C(l.gas_limit),o=C(l.max_fee_per_gas)*2n,c=C(l.max_priority_fee_per_gas)||1n,u=C(l.gas_per_pubdata_limit)}return{...await Jn({transaction:{...n,gas:i,maxFeePerGas:o,maxPriorityFeePerGas:c},from:t.address}),...n.eip712,gasPerPubdata:u,from:t.address}}function nr(e){const{chainId:t,gas:n,nonce:r,to:a,from:s,value:i,maxFeePerGas:o,maxPriorityFeePerGas:c,customSignature:u,factoryDeps:d,paymaster:p,paymasterInput:l,gasPerPubdata:h,data:m}=e,g=[r?T(r):"0x",c?T(c):"0x",o?T(o):"0x",n?T(n):"0x",a??"0x",i?T(i):"0x",m??"0x0",T(t),T(""),T(""),T(t),s??"0x",h?T(h):T(Xe),d??[],u??"0x",p&&l?[p,l]:[]];return Qn(["0x71",Jt(g)])}function rr(e={}){return Kn({signature:"event UserOperationRevertReason(bytes32 indexed userOpHash, address indexed sender, uint256 nonce, bytes revertReason)",filters:e})}const ar=()=>{const e=BigInt(Math.floor(Math.random()*4294967296)),t=BigInt(Math.floor(Math.random()*4294967296)),n=BigInt(Math.floor(Math.random()*4294967296)),r=BigInt(Math.floor(Math.random()*4294967296)),a=BigInt(Math.floor(Math.random()*4294967296)),s=BigInt(Math.floor(Math.random()*4294967296));return e<<BigInt(160)|t<<BigInt(128)|n<<BigInt(96)|r<<BigInt(64)|a<<BigInt(32)|s},sr=()=>BigInt(ne([re(ar()),"0x0000000000000000"]));function ce(e){return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,Ce(n)?n:T(n)]))}function ir(e){return e.id===324||e.id===300||e.id===302}async function or(e){var t;return F({...e,operation:"eth_sendUserOperation",params:[ce(e.userOp),((t=e.options.overrides)==null?void 0:t.entrypointAddress)??N]})}async function Ae(e){var n;const t=await F({...e,operation:"eth_estimateUserOperationGas",params:[ce(e.userOp),((n=e.options.overrides)==null?void 0:n.entrypointAddress)??N]});return{preVerificationGas:v(t.preVerificationGas),verificationGas:v(t.verificationGas),verificationGasLimit:v(t.verificationGasLimit),callGasLimit:v(t.callGasLimit)+wt}}async function cr(e){const t=await F({...e,operation:"thirdweb_getUserOperationGasPrice",params:[]});return{maxPriorityFeePerGas:v(t.maxPriorityFeePerGas),maxFeePerGas:v(t.maxFeePerGas)}}async function ur(e){var n,r;const t=await F({options:e,operation:"eth_getUserOperationReceipt",params:[e.userOpHash]});if(t){if(t.success===!1){const s=(r=(n=Yn({events:[rr()],logs:t.logs})[0])==null?void 0:n.args)==null?void 0:r.revertReason;if(!s)throw new Error(`UserOp failed at txHash: ${t.transactionHash}`);const i=Ve({data:s});throw new Error(`UserOp failed with reason: '${i.args.join(",")}' at txHash: ${t.transactionHash}`)}return t.receipt}}async function dr(e){const t=await F({options:e.options,operation:"zk_paymasterData",params:[e.transaction]});return{paymaster:t.paymaster,paymasterInput:t.paymasterInput}}async function lr(e){return{transactionHash:(await F({options:e.options,operation:"zk_broadcastTransaction",params:[{...e.transaction,signedTransaction:e.signedTransaction}]})).transactionHash}}async function F(e){var c;const{options:t,operation:n,params:r}=e,a=((c=t.overrides)==null?void 0:c.bundlerUrl)??Me(t.chain),i=await R(t.client)(a,{method:"POST",headers:{"Content-Type":"application/json"},body:xt({jsonrpc:"2.0",id:1,method:n,params:r})}),o=await i.json();if(!i.ok||o.error){let u=o.error||i.statusText;typeof u=="object"&&(u=JSON.stringify(u));const d=o.code||"UNKNOWN";throw new Error(`${n} error: ${u}
Status: ${i.status}
Code: ${d}`)}return o.result}async function fr(e,t){var a,s,i;if((a=t.overrides)!=null&&a.predictAddress)return t.overrides.predictAddress(e);if((s=t.overrides)!=null&&s.accountAddress)return t.overrides.accountAddress;const n=t.personalAccountAddress;if(!n)throw new Error("Account address is required to predict the smart wallet address.");const r=Re(((i=t.overrides)==null?void 0:i.accountSalt)??"");return Ue({contract:e,method:"function getAddress(address, bytes) returns (address)",params:[n,r]})}function pr(e){var r,a;const{factoryContract:t,options:n}=e;return(r=n.overrides)!=null&&r.createAccount?n.overrides.createAccount(t):se({contract:t,method:"function createAccount(address, bytes) returns (address)",params:[n.personalAccount.address,Re(((a=n.overrides)==null?void 0:a.accountSalt)??"")]})}function yr(e){var a;const{accountContract:t,options:n,transaction:r}=e;return(a=n.overrides)!=null&&a.execute?n.overrides.execute(t,r):se({contract:t,method:"function execute(address, uint256, bytes)",params:[r.to||"",r.value||0n,r.data||"0x"]})}function mr(e){var a;const{accountContract:t,options:n,transactions:r}=e;return(a=n.overrides)!=null&&a.executeBatch?n.overrides.executeBatch(t,r):se({contract:t,method:"function executeBatch(address[], uint256[], bytes[])",params:[r.map(s=>s.to||""),r.map(s=>s.value||0n),r.map(s=>s.data||"0x")]})}async function _e(e){var p,l,h,m;const{userOp:t,options:n}=e;if((p=n.overrides)!=null&&p.paymaster)return(l=n.overrides)==null?void 0:l.paymaster(t);const r={"Content-Type":"application/json"},a=n.client,s=Pt(n.chain),i=((h=n.overrides)==null?void 0:h.entrypointAddress)??N,c=await R(a)(s,{method:"POST",headers:r,body:JSON.stringify({jsonrpc:"2.0",id:1,method:"pm_sponsorUserOperation",params:[ce(t),i]})}),u=await c.json();if(!c.ok){const g=u.error||c.statusText,y=u.code||"UNKNOWN";throw new Error(`Paymaster error: ${g}
Status: ${c.status}
Code: ${y}`)}if(u.result)return typeof u.result=="string"?{paymasterAndData:u.result}:{paymasterAndData:u.result.paymasterAndData,verificationGasLimit:u.result.verificationGasLimit?v(u.result.verificationGasLimit):void 0,preVerificationGas:u.result.preVerificationGas?v(u.result.preVerificationGas):void 0,callGasLimit:u.result.callGasLimit?v(u.result.callGasLimit):void 0};const d=((m=u.error)==null?void 0:m.message)||u.error||c.statusText||"unknown error";throw new Error(`Paymaster error from ${s}: ${d}`)}async function gr(e){const t=e.timeoutMs||12e4,n=e.intervalMs||1e3,r=Date.now()+t;for(;Date.now()<r;){const a=await ur(e);if(a)return a;await new Promise(s=>setTimeout(s,n))}throw new Error("Timeout waiting for userOp to be mined")}async function hr(e){var p;const{transaction:t,options:n}=e,a=await At(n.accountContract)?"0x":await xr(n),s=await S(t);let{maxFeePerGas:i,maxPriorityFeePerGas:o}=t;const c=((p=n.overrides)==null?void 0:p.bundlerUrl)??Me(n.chain);if(_t(c)){const l=await cr({options:n});i=l.maxFeePerGas,o=l.maxPriorityFeePerGas}else{const[l,h]=await Promise.all([x(i),x(o)]);if(l&&h)i=l,o=h;else{const m=await Qe(n.client,n.chain);o=h??m.maxPriorityFeePerGas??0n,i=l??m.maxFeePerGas??0n}}const u=sr(),d={sender:n.accountContract.address,nonce:u,initCode:a,callData:s,maxFeePerGas:i,maxPriorityFeePerGas:o,callGasLimit:0n,verificationGasLimit:0n,preVerificationGas:0n,paymasterAndData:"0x",signature:Tt};if(n.sponsorGas){const l=await _e({userOp:d,options:n}),h=l.paymasterAndData;if(h&&h!=="0x"&&(d.paymasterAndData=h),l.callGasLimit&&l.verificationGasLimit&&l.preVerificationGas)d.callGasLimit=l.callGasLimit,d.verificationGasLimit=l.verificationGasLimit,d.preVerificationGas=l.preVerificationGas;else{const m=await Ae({userOp:d,options:n});if(d.callGasLimit=m.callGasLimit,d.verificationGasLimit=m.verificationGasLimit,d.preVerificationGas=m.preVerificationGas,h&&h!=="0x"){const g=await _e({userOp:d,options:n});g.paymasterAndData&&g.paymasterAndData!=="0x"&&(d.paymasterAndData=g.paymasterAndData)}}}else{const l=await Ae({userOp:d,options:n});d.callGasLimit=l.callGasLimit,d.verificationGasLimit=l.verificationGasLimit,d.preVerificationGas=l.preVerificationGas}return{...d,signature:"0x"}}async function br(e){var a;const{userOp:t,options:n}=e,r=wr({userOp:t,entryPoint:((a=n.overrides)==null?void 0:a.entrypointAddress)||N,chainId:n.chain.id});if(n.personalAccount.signMessage){const s=await n.personalAccount.signMessage({message:{raw:Le(r)}});return{...t,signature:s}}throw new Error("signMessage not implemented in signingAccount")}async function xr(e){const{factoryContract:t}=e,n=pr({factoryContract:t,options:e});return ne([t.address,await S(n)])}function wr(e){const{userOp:t,entryPoint:n,chainId:r}=e,a=B(t.initCode),s=B(t.callData),i=B(t.paymasterAndData),o=z([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"bytes32"}],[t.sender,t.nonce,a,s,t.callGasLimit,t.verificationGasLimit,t.preVerificationGas,t.maxFeePerGas,t.maxPriorityFeePerGas,i]),c=z([{type:"bytes32"},{type:"address"},{type:"uint256"}],[B(o),n,BigInt(r)]);return B(c)}function Pr(e){return e.id==="smart"}const ue=new WeakMap,X=new WeakMap;async function Ar(e,t,n){const{personalAccount:r,client:a,chain:s}=t;if(!r)throw new Error("Personal wallet does not have an account");const i=n,o=i.factoryAddress??vt,c=s??i.chain,u="gasless"in i?i.gasless:i.sponsorGas;if(ir(c))return[vr({creationOptions:n,connectionOptions:t,chain:c,sponsorGas:u}),c];const d=ye({client:a,address:o,chain:c}),p=await fr(d,{personalAccountAddress:r.address,...i}).then(m=>m).catch(m=>{throw new Error(`Failed to get account address with factory contract ${d.address} on chain ID ${c.id}. Are you on the right chain?`,{cause:m})}),l=ye({client:a,address:p,chain:c}),h=await Tr({...i,chain:c,sponsorGas:u,personalAccount:r,accountContract:l,factoryContract:d,client:a});return ue.set(r,e),X.set(e,r),[h,c]}async function _r(e){const t=X.get(e);t&&(ue.delete(t),X.delete(e))}async function Tr(e){const{accountContract:t}=e,n={address:t.address,async sendTransaction(r){const a=yr({accountContract:t,options:e,transaction:r});return ve({executeTx:a,options:e})},async sendBatchTransaction(r){const a=mr({accountContract:t,options:e,transactions:r});return ve({executeTx:a,options:e})},async signMessage({message:r}){const[{isContractDeployed:a},{readContract:s},{encodeAbiParameters:i},{hashMessage:o},{checkContractWalletSignature:c}]=await Promise.all([w(()=>import("./main-r2m38eK3.js").then(m=>m.aK),__vite__mapDeps([0,1,2,3])),w(()=>import("./main-r2m38eK3.js").then(m=>m.aJ),__vite__mapDeps([0,1,2,3])),w(()=>import("./main-r2m38eK3.js").then(m=>m.aI),__vite__mapDeps([0,1,2,3])),w(()=>import("./hashMessage-CMwUctZV.js"),__vite__mapDeps([6,0,1,2,3])),w(()=>import("./checkContractWalletSignature-YMgReBeb.js"),__vite__mapDeps([7,8,0,1,2,3]))]);await a(t)||(console.log("Account contract not deployed yet. Deploying account before signing message"),await Te({options:e,account:n,accountContract:t}));const d=o(r);let p=!1;try{await s({contract:t,method:"function getMessageHash(bytes32 _hash) public view returns (bytes32)",params:[d]}),p=!0}catch{}let l;if(p){const m=i([{type:"bytes32"}],[d]);l=await e.personalAccount.signTypedData({domain:{name:"Account",version:"1",chainId:e.chain.id,verifyingContract:t.address},primaryType:"AccountMessage",types:{AccountMessage:[{name:"message",type:"bytes"}]},message:{message:m}})}else l=await e.personalAccount.signMessage({message:r});if(await c({contract:t,message:r,signature:l}))return l;throw new Error("Unable to verify signature on smart account, please make sure the smart account is deployed and the signature is valid.")},async signTypedData(r){var g,y,P;const a=$e(r),[{isContractDeployed:s},{readContract:i},{encodeAbiParameters:o},{checkContractWalletSignedTypedData:c}]=await Promise.all([w(()=>import("./main-r2m38eK3.js").then(A=>A.aK),__vite__mapDeps([0,1,2,3])),w(()=>import("./main-r2m38eK3.js").then(A=>A.aJ),__vite__mapDeps([0,1,2,3])),w(()=>import("./main-r2m38eK3.js").then(A=>A.aI),__vite__mapDeps([0,1,2,3])),w(()=>import("./checkContractWalletSignedTypedData-CauJ9Ybi.js"),__vite__mapDeps([9,8,0,1,2,3]))]);if(((y=(g=a.domain)==null?void 0:g.verifyingContract)==null?void 0:y.toLowerCase())===((P=t.address)==null?void 0:P.toLowerCase()))return e.personalAccount.signTypedData(a);await s(t)||(console.log("Account contract not deployed yet. Deploying account before signing message"),await Te({options:e,account:n,accountContract:t}));const p=jt(a);let l=!1;try{await i({contract:t,method:"function getMessageHash(bytes32 _hash) public view returns (bytes32)",params:[p]}),l=!0}catch{}let h;if(l){const A=o([{type:"bytes32"}],[p]);h=await e.personalAccount.signTypedData({domain:{name:"Account",version:"1",chainId:e.chain.id,verifyingContract:t.address},primaryType:"AccountMessage",types:{AccountMessage:[{name:"message",type:"bytes"}]},message:{message:A}})}else h=await e.personalAccount.signTypedData(a);if(await c({contract:t,data:a,signature:h}))return h;throw new Error("Unable to verify signature on smart account, please make sure the smart account is deployed and the signature is valid.")},async onTransactionRequested(r){var a,s;return(s=(a=e.personalAccount).onTransactionRequested)==null?void 0:s.call(a,r)}};return n}function vr(e){const{creationOptions:t,connectionOptions:n,chain:r}=e,a={address:n.personalAccount.address,async sendTransaction(s){const i={data:s.data,to:s.to??void 0,value:s.value??0n,chain:Gt(s.chainId),client:n.client};let o=await tr({account:a,transaction:i});if(e.sponsorGas){const d=await dr({options:{client:n.client,overrides:t.overrides,chain:r},transaction:o});o={...o,...d}}const c=await er({account:a,chainId:r.id,eip712Transaction:o});return{transactionHash:(await lr({options:{client:n.client,overrides:t.overrides,chain:r},transaction:o,signedTransaction:c})).transactionHash,client:n.client,chain:r}},async signMessage({message:s}){return n.personalAccount.signMessage({message:s})},async signTypedData(s){const i=$e(s);return n.personalAccount.signTypedData(i)},async onTransactionRequested(s){var i,o;return(o=(i=n.personalAccount).onTransactionRequested)==null?void 0:o.call(i,s)}};return a}async function Te(e){const{options:t,account:n,accountContract:r}=e,[{sendTransaction:a},{prepareTransaction:s}]=await Promise.all([w(()=>import("./send-transaction-Bbu4IvxK.js").then(c=>c.s),__vite__mapDeps([10,0,1,2,3])),w(()=>Promise.resolve().then(()=>Xt),void 0)]),i=s({client:t.client,chain:t.chain,to:r.address,value:0n,gas:50000n});return await a({transaction:i,account:n})}async function ve(e){const{executeTx:t,options:n}=e,r=await hr({transaction:t,options:n}),a=await br({options:n,userOp:r}),s=await or({options:n,userOp:a}),i=await gr({...n,userOpHash:s});return{client:n.client,chain:n.chain,transactionHash:i.transactionHash}}const Er=Object.freeze(Object.defineProperty({__proto__:null,connectSmartWallet:Ar,disconnectSmartWallet:_r,isSmartWallet:Pr,personalAccountToSmartAccountMap:ue},Symbol.toStringTag,{value:"Module"}));export{Mt as a,jt as h,Er as i,Jn as t};
