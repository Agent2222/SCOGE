import{A as ut,H as wr,r as Yn,P as Xn,c as Zn,d as Qn,e as ei,f as ti,h as ri,i as ni,j as ii,k as si,l as oi,m as ai,o as li,C as ci,p as ui,D as fi,E as hi,q as di,s as gi,I as yi,t as wi,L as vi,M as bi,N as Bi,O as mi,u as pi,v as xi,w as ki,x as Ei,Q as Ai,R as Si,y as Ni,S as Ci,z as Ii,B as _i,U as Ui,F as Ti,G as Vi,J as Li,K as Ri,T as Hi,V as Oi,W as Pi,X as Mi,Y as Fi,Z as Di,_ as $i,$ as Ki,a0 as ji,a1 as Ji,a2 as Wi,a3 as Gi,a4 as qi,a5 as zi,a6 as Yi,a7 as Xi,a8 as Zi,a9 as Qi,aa as es,ab as ts,ac as rs,ad as ns,ae as is,af as ss,ag as os,ah as as,ai as ls,aj as cs,ak as us,al as fs,am as hs,an as ds,ao as gs,ap as ys,aq as ws,ar as vs,as as ke,at as Ve,au as bs,av as vr,aw as Bs,ax as Qt,ay as F,az as ms,aA as ft,aB as he,aC as ie,aD as br,aE as Br,aF as ps,aG as Y,aH as er,aI as xs,aJ as de,aK as tr,aL as ks,aM as Es,aN as As,aO as U,aP as me,aQ as Le,aR as Ss,aS as Ns,aT as Cs,aU as Is,aV as _s,aW as Ie,aX as rr,aY as j,aZ as se,a_ as mr,a$ as Us,b0 as Ts,b1 as Vs,b2 as je,b3 as pr,b4 as q,b5 as xr,b6 as Ls,b7 as k,b8 as Rs,b9 as Q,ba as Hs,bb as Os,bc as nr}from"./main-hS3tnEYq.js";import"./wScoge-BthgsBuw.js";const Ps=({IDL:i})=>i.Service({retrieve:i.Func([i.Text],[i.Vec(i.Nat8)],["query"]),store:i.Func([i.Text,i.Vec(i.Nat8)],[],[])});function Ms(i){return ut.createActor(Ps,i)}async function Fs(i,e){e||(e=await wr.create());const r=(await Yn({agent:e,canisterId:Xn.fromText(i),paths:["candid"]})).get("candid");if(r)return r;const n=({IDL:o})=>o.Service({__get_candid_interface_tmp_hack:o.Func([],[o.Text],["query"])});return await ut.createActor(n,{agent:e,canisterId:i}).__get_candid_interface_tmp_hack()}const Ds=Object.freeze(Object.defineProperty({__proto__:null,ACTOR_METHOD_WITH_CERTIFICATE:Zn,ACTOR_METHOD_WITH_HTTP_DETAILS:Qn,Actor:ut,ActorCallError:ei,AdvancedActor:ti,AgentCallError:ri,AgentHTTPResponseError:ni,AgentQueryError:ii,AgentReadStateError:si,AnonymousIdentity:oi,CanisterStatus:ai,Cbor:li,Certificate:ci,CertificateVerificationError:ui,DER_COSE_OID:fi,ED25519_OID:hi,Ed25519PublicKey:di,Expiry:gi,HttpAgent:wr,IC_ROOT_KEY:yi,IdentityInvalidError:wi,get LookupStatus(){return vi},MANAGEMENT_CANISTER_ID:bi,get NodeType(){return Bi},Observable:mi,ObservableLog:pi,ProxyAgent:xi,get ProxyMessageKind(){return ki},ProxyStubAgent:Ei,QueryCallRejectedError:Ai,get ReplicaRejectCode(){return Si},get RequestStatusResponseStatus(){return Ni},SECP256K1_OID:Ci,SignIdentity:Ii,get SubmitRequestType(){return _i},UpdateCallRejectedError:Ui,blsVerify:Ti,bufEquals:Vi,bufFromBufLike:Li,check_canister_ranges:Ri,compare:Hi,concat:Oi,createAssetCanisterActor:Ms,createIdentityDescriptor:Pi,decodeLen:Mi,decodeLenBytes:Fi,defaultStrategy:Di,encodeLen:$i,encodeLenBytes:Ki,fetchCandid:Fs,find_label:ji,flatten_forks:Ji,fromHex:Wi,getDefaultAgent:Gi,getManagementCanister:qi,hash:zi,hashOfMap:Yi,hashTreeToString:Xi,hashValue:Zi,httpHeadersTransform:Qi,lookupResultToBuffer:es,lookup_path:ts,makeExpiryTransform:rs,makeNonce:ns,makeNonceTransform:is,pollForResponse:ss,polling:os,randomNumber:as,reconstruct:ls,requestIdOf:cs,strategy:us,toHex:fs,uint8ToBuf:hs,unwrapDER:ds,verify:gs,wrapDER:ys},Symbol.toStringTag,{value:"Module"})),$s=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),kr=Uint8Array.from(new Array(16).fill(0).map((i,e)=>e)),Ks=kr.map(i=>(9*i+5)%16),Er=(()=>{const t=[[kr],[Ks]];for(let r=0;r<4;r++)for(let n of t)n.push(n[r].map(s=>$s[s]));return t})(),Ar=Er[0],Sr=Er[1],Nr=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(i=>Uint8Array.from(i)),js=Ar.map((i,e)=>i.map(t=>Nr[e][t])),Js=Sr.map((i,e)=>i.map(t=>Nr[e][t])),Ws=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Gs=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function ir(i,e,t,r){return i===0?e^t^r:i===1?e&t|~e&r:i===2?(e|~t)^r:i===3?e&r|t&~r:e^(t|~r)}const Ee=new Uint32Array(16);class qs extends vs{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:r,h3:n,h4:s}=this;return[e,t,r,n,s]}set(e,t,r,n,s){this.h0=e|0,this.h1=t|0,this.h2=r|0,this.h3=n|0,this.h4=s|0}process(e,t){for(let g=0;g<16;g++,t+=4)Ee[g]=e.getUint32(t,!0);let r=this.h0|0,n=r,s=this.h1|0,o=s,a=this.h2|0,l=a,c=this.h3|0,u=c,f=this.h4|0,h=f;for(let g=0;g<5;g++){const B=4-g,w=Ws[g],v=Gs[g],y=Ar[g],P=Sr[g],W=js[g],L=Js[g];for(let p=0;p<16;p++){const M=ke(r+ir(g,s,a,c)+Ee[y[p]]+w,W[p])+f|0;r=f,f=c,c=ke(a,10)|0,a=s,s=M}for(let p=0;p<16;p++){const M=ke(n+ir(B,o,l,u)+Ee[P[p]]+v,L[p])+h|0;n=h,h=u,u=ke(l,10)|0,l=o,o=M}}this.set(this.h1+a+u|0,this.h2+c+h|0,this.h3+f+n|0,this.h4+r+o|0,this.h0+s+l|0)}roundClean(){Ve(Ee)}destroy(){this.destroyed=!0,Ve(this.buffer),this.set(0,0,0,0,0)}}const zs=ws(()=>new qs);class Cr extends bs{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,vr(e);const r=Bs(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(r.length>n?e.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),Ve(s)}update(e){return Qt(this),this.iHash.update(e),this}digestInto(e){Qt(this),F(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=n,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ye=(i,e,t)=>new Cr(i,e).update(t).digest();ye.create=(i,e)=>new Cr(i,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ys(i){return{hash:i,hmac:(e,...t)=>ye(i,e,he(...t)),randomBytes:ft}}function Xs(i,e){const t=r=>ms({...i,...Ys(r)});return{...t(e),create:t}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const pe=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Re=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),ht=BigInt(0),we=BigInt(1),He=BigInt(2),sr=(i,e)=>(i+e/He)/e;function Ir(i){const e=pe,t=BigInt(3),r=BigInt(6),n=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),l=BigInt(88),c=i*i*i%e,u=c*c*i%e,f=U(u,t,e)*u%e,h=U(f,t,e)*u%e,g=U(h,He,e)*c%e,B=U(g,n,e)*g%e,w=U(B,s,e)*B%e,v=U(w,a,e)*w%e,y=U(v,l,e)*v%e,P=U(y,a,e)*w%e,W=U(P,t,e)*u%e,L=U(W,o,e)*B%e,p=U(L,r,e)*c%e,M=U(p,He,e);if(!K.eql(K.sqr(M),i))throw new Error("Cannot find square root");return M}const K=ks(pe,void 0,void 0,{sqrt:Ir}),N=Xs({a:ht,b:BigInt(7),Fp:K,n:Re,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:i=>{const e=Re,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-we*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=t,o=BigInt("0x100000000000000000000000000000000"),a=sr(s*i,e),l=sr(-r*i,e);let c=ie(i-a*t-l*n,e),u=ie(-a*r-l*s,e);const f=c>o,h=u>o;if(f&&(c=e-c),h&&(u=e-u),c>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+i);return{k1neg:f,k1:c,k2neg:h,k2:u}}}},Y),or={};function Oe(i,...e){let t=or[i];if(t===void 0){const r=Y(Uint8Array.from(i,n=>n.charCodeAt(0)));t=er(r,r),or[i]=t}return Y(er(t,...e))}const dt=i=>i.toRawBytes(!0).slice(1),rt=i=>Br(i,32),Ye=i=>ie(i,pe),ve=i=>ie(i,Re),gt=N.ProjectivePoint,Zs=(i,e,t)=>gt.BASE.multiplyAndAddUnsafe(i,e,t);function nt(i){let e=N.utils.normPrivateKeyToScalar(i),t=gt.fromPrivateKey(e);return{scalar:t.hasEvenY()?e:ve(-e),bytes:dt(t)}}function _r(i){xs("x",i,we,pe);const e=Ye(i*i),t=Ye(e*i+BigInt(7));let r=Ir(t);r%He!==ht&&(r=Ye(-r));const n=new gt(i,r,we);return n.assertValidity(),n}const ne=br;function Ur(...i){return ve(ne(Oe("BIP0340/challenge",...i)))}function Qs(i){return nt(i).bytes}function eo(i,e,t=ft(32)){const r=de("message",i),{bytes:n,scalar:s}=nt(e),o=de("auxRand",t,32),a=rt(s^ne(Oe("BIP0340/aux",o))),l=Oe("BIP0340/nonce",a,n,r),c=ve(ne(l));if(c===ht)throw new Error("sign failed: k is zero");const{bytes:u,scalar:f}=nt(c),h=Ur(u,n,r),g=new Uint8Array(64);if(g.set(u,0),g.set(rt(ve(f+h*s)),32),!Tr(g,r,n))throw new Error("sign: Invalid signature produced");return g}function Tr(i,e,t){const r=de("signature",i,64),n=de("message",e),s=de("publicKey",t,32);try{const o=_r(ne(s)),a=ne(r.subarray(0,32));if(!tr(a,we,pe))return!1;const l=ne(r.subarray(32,64));if(!tr(l,we,Re))return!1;const c=Ur(rt(a),dt(o),n),u=Zs(o,l,ve(-c));return!(!u||!u.hasEvenY()||u.toAffine().x!==a)}catch{return!1}}const to={getPublicKey:Qs,sign:eo,verify:Tr,utils:{randomPrivateKey:N.utils.randomPrivateKey,lift_x:_r,pointToBytes:dt,numberToBytesBE:Br,bytesToNumberBE:br,taggedHash:Oe,mod:ie}},ro=As(K,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(i=>i.map(e=>BigInt(e)))),no=Es(K,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:K.create(BigInt("-11"))}),yt=ps(N.ProjectivePoint,i=>{const{x:e,y:t}=no(K.create(i[0]));return ro(e,t)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:K.ORDER,m:1,k:128,expand:"xmd",hash:Y}),io=yt.hashToCurve,so=yt.encodeToCurve,oo=Object.freeze(Object.defineProperty({__proto__:null,encodeToCurve:so,hashToCurve:io,schnorr:to,secp256k1:N,secp256k1_hasher:yt},Symbol.toStringTag,{value:"Module"}));/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Pe(i){return i instanceof Uint8Array||ArrayBuffer.isView(i)&&i.constructor.name==="Uint8Array"}function Vr(i,e){return Array.isArray(e)?e.length===0?!0:i?e.every(t=>typeof t=="string"):e.every(t=>Number.isSafeInteger(t)):!1}function ao(i){if(typeof i!="function")throw new Error("function expected");return!0}function Me(i,e){if(typeof e!="string")throw new Error(`${i}: string expected`);return!0}function ae(i){if(!Number.isSafeInteger(i))throw new Error(`invalid integer: ${i}`)}function Fe(i){if(!Array.isArray(i))throw new Error("array expected")}function De(i,e){if(!Vr(!0,e))throw new Error(`${i}: array of strings expected`)}function Lr(i,e){if(!Vr(!1,e))throw new Error(`${i}: array of numbers expected`)}function wt(...i){const e=s=>s,t=(s,o)=>a=>s(o(a)),r=i.map(s=>s.encode).reduceRight(t,e),n=i.map(s=>s.decode).reduce(t,e);return{encode:r,decode:n}}function Rr(i){const e=typeof i=="string"?i.split(""):i,t=e.length;De("alphabet",e);const r=new Map(e.map((n,s)=>[n,s]));return{encode:n=>(Fe(n),n.map(s=>{if(!Number.isSafeInteger(s)||s<0||s>=t)throw new Error(`alphabet.encode: digit index outside alphabet "${s}". Allowed: ${i}`);return e[s]})),decode:n=>(Fe(n),n.map(s=>{Me("alphabet.decode",s);const o=r.get(s);if(o===void 0)throw new Error(`Unknown letter: "${s}". Allowed: ${i}`);return o}))}}function Hr(i=""){return Me("join",i),{encode:e=>(De("join.decode",e),e.join(i)),decode:e=>(Me("join.decode",e),e.split(i))}}function lo(i,e="="){return ae(i),Me("padding",e),{encode(t){for(De("padding.encode",t);t.length*i%8;)t.push(e);return t},decode(t){De("padding.decode",t);let r=t.length;if(r*i%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&t[r-1]===e;r--)if((r-1)*i%8===0)throw new Error("padding: invalid, string has too much padding");return t.slice(0,r)}}}function it(i,e,t){if(e<2)throw new Error(`convertRadix: invalid from=${e}, base cannot be less than 2`);if(t<2)throw new Error(`convertRadix: invalid to=${t}, base cannot be less than 2`);if(Fe(i),!i.length)return[];let r=0;const n=[],s=Array.from(i,a=>{if(ae(a),a<0||a>=e)throw new Error(`invalid integer: ${a}`);return a}),o=s.length;for(;;){let a=0,l=!0;for(let c=r;c<o;c++){const u=s[c],f=e*a,h=f+u;if(!Number.isSafeInteger(h)||f/e!==a||h-u!==f)throw new Error("convertRadix: carry overflow");const g=h/t;a=h%t;const B=Math.floor(g);if(s[c]=B,!Number.isSafeInteger(B)||B*t+a!==h)throw new Error("convertRadix: carry overflow");if(l)B?l=!1:r=c;else continue}if(n.push(a),l)break}for(let a=0;a<i.length-1&&i[a]===0;a++)n.push(0);return n.reverse()}const Or=(i,e)=>e===0?i:Or(e,i%e),$e=(i,e)=>i+(e-Or(i,e)),Xe=(()=>{let i=[];for(let e=0;e<40;e++)i.push(2**e);return i})();function st(i,e,t,r){if(Fe(i),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(t<=0||t>32)throw new Error(`convertRadix2: wrong to=${t}`);if($e(e,t)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${t} carryBits=${$e(e,t)}`);let n=0,s=0;const o=Xe[e],a=Xe[t]-1,l=[];for(const c of i){if(ae(c),c>=o)throw new Error(`convertRadix2: invalid data word=${c} from=${e}`);if(n=n<<e|c,s+e>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${e}`);for(s+=e;s>=t;s-=t)l.push((n>>s-t&a)>>>0);const u=Xe[s];if(u===void 0)throw new Error("invalid carry");n&=u-1}if(n=n<<t-s&a,!r&&s>=e)throw new Error("Excess padding");if(!r&&n>0)throw new Error(`Non-zero padding: ${n}`);return r&&s>0&&l.push(n>>>0),l}function Pr(i){ae(i);const e=2**8;return{encode:t=>{if(!Pe(t))throw new Error("radix.encode input should be Uint8Array");return it(Array.from(t),e,i)},decode:t=>(Lr("radix.decode",t),Uint8Array.from(it(t,i,e)))}}function co(i,e=!1){if(ae(i),i<=0||i>32)throw new Error("radix2: bits should be in (0..32]");if($e(8,i)>32||$e(i,8)>32)throw new Error("radix2: carry overflow");return{encode:t=>{if(!Pe(t))throw new Error("radix2.encode input should be Uint8Array");return st(Array.from(t),8,i,!e)},decode:t=>(Lr("radix2.decode",t),Uint8Array.from(st(t,i,8,e)))}}function Mr(i,e){return ae(i),ao(e),{encode(t){if(!Pe(t))throw new Error("checksum.encode: input should be Uint8Array");const r=e(t).slice(0,i),n=new Uint8Array(t.length+i);return n.set(t),n.set(r,t.length),n},decode(t){if(!Pe(t))throw new Error("checksum.decode: input should be Uint8Array");const r=t.slice(0,-i),n=t.slice(-i),s=e(r).slice(0,i);for(let o=0;o<i;o++)if(s[o]!==n[o])throw new Error("Invalid checksum");return r}}}const Ae={alphabet:Rr,chain:wt,checksum:Mr,convertRadix:it,convertRadix2:st,radix:Pr,radix2:co,join:Hr,padding:lo},uo=i=>wt(Pr(58),Rr(i),Hr("")),fo=uo("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),ho=i=>wt(Mr(4,e=>i(i(e))),fo);/*! scure-bip32 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const Se=N.ProjectivePoint,Ze=ho(Y);function ar(i){F(i);const e=i.length===0?"0":Ns(i);return BigInt("0x"+e)}function go(i){if(typeof i!="bigint")throw new Error("bigint expected");return Cs(i.toString(16).padStart(64,"0"))}const yo=Ss("Bitcoin seed"),Qe={private:76066276,public:76067358},_e=2147483648,wo=i=>zs(Y(i)),vo=i=>me(i).getUint32(0,!1),Ne=i=>{if(!Number.isSafeInteger(i)||i<0||i>2**32-1)throw new Error("invalid number, should be from 0 to 2**32-1, got "+i);const e=new Uint8Array(4);return me(e).setUint32(0,i,!1),e};class G{get fingerprint(){if(!this.pubHash)throw new Error("No publicKey set!");return vo(this.pubHash)}get identifier(){return this.pubHash}get pubKeyHash(){return this.pubHash}get privateKey(){return this.privKeyBytes||null}get publicKey(){return this.pubKey||null}get privateExtendedKey(){const e=this.privateKey;if(!e)throw new Error("No private key");return Ze.encode(this.serialize(this.versions.private,he(new Uint8Array([0]),e)))}get publicExtendedKey(){if(!this.pubKey)throw new Error("No public key");return Ze.encode(this.serialize(this.versions.public,this.pubKey))}static fromMasterSeed(e,t=Qe){if(F(e),8*e.length<128||8*e.length>512)throw new Error("HDKey: seed length must be between 128 and 512 bits; 256 bits is advised, got "+e.length);const r=ye(Le,yo,e);return new G({versions:t,chainCode:r.slice(32),privateKey:r.slice(0,32)})}static fromExtendedKey(e,t=Qe){const r=Ze.decode(e),n=me(r),s=n.getUint32(0,!1),o={versions:t,depth:r[4],parentFingerprint:n.getUint32(5,!1),index:n.getUint32(9,!1),chainCode:r.slice(13,45)},a=r.slice(45),l=a[0]===0;if(s!==t[l?"private":"public"])throw new Error("Version mismatch");return l?new G({...o,privateKey:a.slice(1)}):new G({...o,publicKey:a})}static fromJSON(e){return G.fromExtendedKey(e.xpriv)}constructor(e){if(this.depth=0,this.index=0,this.chainCode=null,this.parentFingerprint=0,!e||typeof e!="object")throw new Error("HDKey.constructor must not be called directly");if(this.versions=e.versions||Qe,this.depth=e.depth||0,this.chainCode=e.chainCode||null,this.index=e.index||0,this.parentFingerprint=e.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");if(e.publicKey&&e.privateKey)throw new Error("HDKey: publicKey and privateKey at same time.");if(e.privateKey){if(!N.utils.isValidPrivateKey(e.privateKey))throw new Error("Invalid private key");this.privKey=typeof e.privateKey=="bigint"?e.privateKey:ar(e.privateKey),this.privKeyBytes=go(this.privKey),this.pubKey=N.getPublicKey(e.privateKey,!0)}else if(e.publicKey)this.pubKey=Se.fromHex(e.publicKey).toRawBytes(!0);else throw new Error("HDKey: no public or private key provided");this.pubHash=wo(this.pubKey)}derive(e){if(!/^[mM]'?/.test(e))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(e))return this;const t=e.replace(/^[mM]'?\//,"").split("/");let r=this;for(const n of t){const s=/^(\d+)('?)$/.exec(n),o=s&&s[1];if(!s||s.length!==3||typeof o!="string")throw new Error("invalid child index: "+n);let a=+o;if(!Number.isSafeInteger(a)||a>=_e)throw new Error("Invalid index");s[2]==="'"&&(a+=_e),r=r.deriveChild(a)}return r}deriveChild(e){if(!this.pubKey||!this.chainCode)throw new Error("No publicKey or chainCode set");let t=Ne(e);if(e>=_e){const a=this.privateKey;if(!a)throw new Error("Could not derive hardened child key");t=he(new Uint8Array([0]),a,t)}else t=he(this.pubKey,t);const r=ye(Le,this.chainCode,t),n=ar(r.slice(0,32)),s=r.slice(32);if(!N.utils.isValidPrivateKey(n))throw new Error("Tweak bigger than curve order");const o={versions:this.versions,chainCode:s,depth:this.depth+1,parentFingerprint:this.fingerprint,index:e};try{if(this.privateKey){const a=ie(this.privKey+n,N.CURVE.n);if(!N.utils.isValidPrivateKey(a))throw new Error("The tweak was out of range or the resulted private key is invalid");o.privateKey=a}else{const a=Se.fromHex(this.pubKey).add(Se.fromPrivateKey(n));if(a.equals(Se.ZERO))throw new Error("The tweak was equal to negative P, which made the result key invalid");o.publicKey=a.toRawBytes(!0)}return new G(o)}catch{return this.deriveChild(e+1)}}sign(e){if(!this.privateKey)throw new Error("No privateKey set!");return F(e,32),N.sign(e,this.privKey).toCompactRawBytes()}verify(e,t){if(F(e,32),F(t,64),!this.publicKey)throw new Error("No publicKey set!");let r;try{r=N.Signature.fromCompact(t)}catch{return!1}return N.verify(r,e,this.publicKey)}wipePrivateData(){return this.privKey=void 0,this.privKeyBytes&&(this.privKeyBytes.fill(0),this.privKeyBytes=void 0),this}toJSON(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}}serialize(e,t){if(!this.chainCode)throw new Error("No chainCode set");return F(t,33),he(Ne(e),new Uint8Array([this.depth]),Ne(this.parentFingerprint),Ne(this.index),this.chainCode,t)}}const bo=Object.freeze(Object.defineProperty({__proto__:null,HARDENED_OFFSET:_e,HDKey:G},Symbol.toStringTag,{value:"Module"}));function Fr(i,e,t,r){vr(i);const n=_s({dkLen:32,asyncTick:10},r),{c:s,dkLen:o,asyncTick:a}=n;if(Ie(s),Ie(o),Ie(a),s<1)throw new Error("iterations (c) should be >= 1");const l=rr(e),c=rr(t),u=new Uint8Array(o),f=ye.create(i,l),h=f._cloneInto().update(c);return{c:s,dkLen:o,asyncTick:a,DK:u,PRF:f,PRFSalt:h}}function Dr(i,e,t,r,n){return i.destroy(),e.destroy(),r&&r.destroy(),Ve(n),t}function Bo(i,e,t,r){const{c:n,dkLen:s,DK:o,PRF:a,PRFSalt:l}=Fr(i,e,t,r);let c;const u=new Uint8Array(4),f=me(u),h=new Uint8Array(a.outputLen);for(let g=1,B=0;B<s;g++,B+=a.outputLen){const w=o.subarray(B,B+a.outputLen);f.setInt32(0,g,!1),(c=l._cloneInto(c)).update(u).digestInto(h),w.set(h.subarray(0,w.length));for(let v=1;v<n;v++){a._cloneInto(c).update(h).digestInto(h);for(let y=0;y<w.length;y++)w[y]^=h[y]}}return Dr(a,l,o,c,h)}async function mo(i,e,t,r){const{c:n,dkLen:s,asyncTick:o,DK:a,PRF:l,PRFSalt:c}=Fr(i,e,t,r);let u;const f=new Uint8Array(4),h=me(f),g=new Uint8Array(l.outputLen);for(let B=1,w=0;w<s;B++,w+=l.outputLen){const v=a.subarray(w,w+l.outputLen);h.setInt32(0,B,!1),(u=c._cloneInto(u)).update(f).digestInto(g),v.set(g.subarray(0,v.length)),await Is(n-1,o,()=>{l._cloneInto(u).update(g).digestInto(g);for(let y=0;y<v.length;y++)v[y]^=g[y]})}return Dr(l,c,a,u,g)}/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const po=i=>i[0]==="あいこくしん";function $r(i){if(typeof i!="string")throw new TypeError("invalid mnemonic type: "+typeof i);return i.normalize("NFKD")}function vt(i){const e=$r(i),t=e.split(" ");if(![12,15,18,21,24].includes(t.length))throw new Error("Invalid mnemonic");return{nfkd:e,words:t}}function Kr(i){F(i,16,20,24,28,32)}function xo(i,e=128){if(Ie(e),e%32!==0||e>256)throw new TypeError("Invalid entropy");return Wr(ft(e/8),i)}const ko=i=>{const e=8-i.length/4;return new Uint8Array([Y(i)[0]>>e<<e])};function jr(i){if(!Array.isArray(i)||i.length!==2048||typeof i[0]!="string")throw new Error("Wordlist: expected array of 2048 strings");return i.forEach(e=>{if(typeof e!="string")throw new Error("wordlist: non-string element: "+e)}),Ae.chain(Ae.checksum(1,ko),Ae.radix2(11,!0),Ae.alphabet(i))}function Jr(i,e){const{words:t}=vt(i),r=jr(e).decode(t);return Kr(r),r}function Wr(i,e){return Kr(i),jr(e).encode(i).join(po(e)?"　":" ")}function Eo(i,e){try{Jr(i,e)}catch{return!1}return!0}const Gr=i=>$r("mnemonic"+i);function Ao(i,e=""){return mo(Le,vt(i).nfkd,Gr(e),{c:2048,dkLen:64})}function So(i,e=""){return Bo(Le,vt(i).nfkd,Gr(e),{c:2048,dkLen:64})}const No=Object.freeze(Object.defineProperty({__proto__:null,entropyToMnemonic:Wr,generateMnemonic:xo,mnemonicToEntropy:Jr,mnemonicToSeed:Ao,mnemonicToSeedSync:So,validateMnemonic:Eo},Symbol.toStringTag,{value:"Module"})),Co=mr,Io=mr,qr=j({client_principal:Co,client_nonce:se}),_o=j({sequence_num:se,content:Ts(Vs),client_key:qr,timestamp:se,is_service_message:Us}),Uo=j({msg:_o}),To=je({Ok:q,Err:pr}),Vo=j({client_nonce:se,gateway_principal:Io}),Lo=je({Ok:q,Err:pr});xr([Vo],[Lo],[]);xr([Uo,Ls(q)],[To],[]);const Ro=j({client_key:qr}),Ho=j({last_incoming_sequence_num:se}),Oo=j({last_incoming_sequence_num:se}),Po=je({WrongSequenceNumber:q,InvalidServiceMessage:q,KeepAliveTimeout:q,ClosedByApplication:q}),Mo=j({reason:Po});je({OpenMessage:Ro,AckMessage:Ho,KeepAliveMessage:Oo,CloseMessage:Mo});var zr={exports:{}};(function(i){(function(e,t){i.exports?i.exports=t():e.log=t()})(k,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"],s={},o=null;function a(w,v){var y=w[v];if(typeof y.bind=="function")return y.bind(w);try{return Function.prototype.bind.call(y,w)}catch{return function(){return Function.prototype.apply.apply(y,[w,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(w){return w==="debug"&&(w="log"),typeof console===t?!1:w==="trace"&&r?l:console[w]!==void 0?a(console,w):console.log!==void 0?a(console,"log"):e}function u(){for(var w=this.getLevel(),v=0;v<n.length;v++){var y=n[v];this[y]=v<w?e:this.methodFactory(y,w,this.name)}if(this.log=this.debug,typeof console===t&&w<this.levels.SILENT)return"No console available for logging"}function f(w){return function(){typeof console!==t&&(u.call(this),this[w].apply(this,arguments))}}function h(w,v,y){return c(w)||f.apply(this,arguments)}function g(w,v){var y=this,P,W,L,p="loglevel";typeof w=="string"?p+=":"+w:typeof w=="symbol"&&(p=void 0);function M(m){var E=(n[m]||"silent").toUpperCase();if(!(typeof window===t||!p)){try{window.localStorage[p]=E;return}catch{}try{window.document.cookie=encodeURIComponent(p)+"="+E+";"}catch{}}}function Yt(){var m;if(!(typeof window===t||!p)){try{m=window.localStorage[p]}catch{}if(typeof m===t)try{var E=window.document.cookie,xe=encodeURIComponent(p),Zt=E.indexOf(xe+"=");Zt!==-1&&(m=/^([^;]+)/.exec(E.slice(Zt+xe.length+1))[1])}catch{}return y.levels[m]===void 0&&(m=void 0),m}}function qn(){if(!(typeof window===t||!p)){try{window.localStorage.removeItem(p)}catch{}try{window.document.cookie=encodeURIComponent(p)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function ce(m){var E=m;if(typeof E=="string"&&y.levels[E.toUpperCase()]!==void 0&&(E=y.levels[E.toUpperCase()]),typeof E=="number"&&E>=0&&E<=y.levels.SILENT)return E;throw new TypeError("log.setLevel() called with invalid level: "+m)}y.name=w,y.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},y.methodFactory=v||h,y.getLevel=function(){return L??W??P},y.setLevel=function(m,E){return L=ce(m),E!==!1&&M(L),u.call(y)},y.setDefaultLevel=function(m){W=ce(m),Yt()||y.setLevel(m,!1)},y.resetLevel=function(){L=null,qn(),u.call(y)},y.enableAll=function(m){y.setLevel(y.levels.TRACE,m)},y.disableAll=function(m){y.setLevel(y.levels.SILENT,m)},y.rebuild=function(){if(o!==y&&(P=ce(o.getLevel())),u.call(y),o===y)for(var m in s)s[m].rebuild()},P=ce(o?o.getLevel():"WARN");var Xt=Yt();Xt!=null&&(L=ce(Xt)),u.call(y)}o=new g,o.getLogger=function(v){if(typeof v!="symbol"&&typeof v!="string"||v==="")throw new TypeError("You must supply a name when creating a logger.");var y=s[v];return y||(y=s[v]=new g(v,o.methodFactory)),y};var B=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=B),o},o.getLoggers=function(){return s},o.default=o,o})})(zr);var Fo=zr.exports;const Do=Rs(Fo);var $o={};const Ko=$o.LOG_LEVEL||"info",jo=Do.getLogger("ic-websocket-js");jo.setDefaultLevel(Ko);var Jo={},X={};const Wo=Q(Ds),Go=Q(oo),qo=Q(Hs),zo=Q(Os),Yo=Q(No),Xo=Q(bo);var Yr={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.unwrapDER=i.SECP256K1_OID=i.ED25519_OID=i.DER_COSE_OID=i.decodeLen=i.decodeLenBytes=i.encodeLen=i.encodeLenBytes=i.bufEquals=void 0,i.wrapDER=o;const e=(l,c)=>{if(l.byteLength!==c.byteLength)return!1;const u=new Uint8Array(l),f=new Uint8Array(c);for(let h=0;h<u.length;h++)if(u[h]!==f[h])return!1;return!0};i.bufEquals=e;const t=l=>{if(l<=127)return 1;if(l<=255)return 2;if(l<=65535)return 3;if(l<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")};i.encodeLenBytes=t;const r=(l,c,u)=>{if(u<=127)return l[c]=u,1;if(u<=255)return l[c]=129,l[c+1]=u,2;if(u<=65535)return l[c]=130,l[c+1]=u>>8,l[c+2]=u,3;if(u<=16777215)return l[c]=131,l[c+1]=u>>16,l[c+2]=u>>8,l[c+3]=u,4;throw new Error("Length too long (> 4 bytes)")};i.encodeLen=r;const n=(l,c)=>{if(l[c]<128)return 1;if(l[c]===128)throw new Error("Invalid length 0");if(l[c]===129)return 2;if(l[c]===130)return 3;if(l[c]===131)return 4;throw new Error("Length too long (> 4 bytes)")};i.decodeLenBytes=n;const s=(l,c)=>{const u=(0,i.decodeLenBytes)(l,c);if(u===1)return l[c];if(u===2)return l[c+1];if(u===3)return(l[c+1]<<8)+l[c+2];if(u===4)return(l[c+1]<<16)+(l[c+2]<<8)+l[c+3];throw new Error("Length too long (> 4 bytes)")};i.decodeLen=s,i.DER_COSE_OID=Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]),i.ED25519_OID=Uint8Array.from([48,5,6,3,43,101,112]),i.SECP256K1_OID=Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);function o(l,c){const u=2+(0,i.encodeLenBytes)(l.byteLength+1),f=c.byteLength+u+l.byteLength;let h=0;const g=new Uint8Array(1+(0,i.encodeLenBytes)(f)+f);return g[h++]=48,h+=(0,i.encodeLen)(g,h,f),g.set(c,h),h+=c.byteLength,g[h++]=3,h+=(0,i.encodeLen)(g,h,l.byteLength+1),g[h++]=0,g.set(new Uint8Array(l),h),g}const a=(l,c)=>{let u=0;const f=(w,v)=>{if(h[u++]!==w)throw new Error("Expected: "+v)},h=new Uint8Array(l);if(f(48,"sequence"),u+=(0,i.decodeLenBytes)(h,u),!(0,i.bufEquals)(h.slice(u,u+c.byteLength),c))throw new Error("Not the expected OID.");u+=c.byteLength,f(3,"bit string");const g=(0,i.decodeLen)(h,u)-1;u+=(0,i.decodeLenBytes)(h,u),f(0,"0 padding");const B=h.slice(u);if(g!==B.length)throw new Error(`DER payload mismatch: Expected length ${g} actual length ${B.length}`);return B};i.unwrapDER=a})(Yr);var bt={};/*!
 * MIT License
 * 
 * Copyright (c) 2017-2024 Peculiar Ventures, LLC
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const Zo="[object ArrayBuffer]";class b{static isArrayBuffer(e){return Object.prototype.toString.call(e)===Zo}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const r=b.toUint8Array(e),n=b.toUint8Array(t);if(r.length!==n.byteLength)return!1;for(let s=0;s<r.length;s++)if(r[s]!==n[s])return!1;return!0}static concat(...e){let t;Array.isArray(e[0])&&!(e[1]instanceof Function)||Array.isArray(e[0])&&e[1]instanceof Function?t=e[0]:e[e.length-1]instanceof Function?t=e.slice(0,e.length-1):t=e;let r=0;for(const o of t)r+=o.byteLength;const n=new Uint8Array(r);let s=0;for(const o of t){const a=this.toUint8Array(o);n.set(a,s),s+=a.length}return e[e.length-1]instanceof Function?this.toView(n,e[e.length-1]):n.buffer}}const et="string",Qo=/^[0-9a-f\s]+$/i,ea=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,ta=/^[a-zA-Z0-9-_]+$/;class lr{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r.buffer}static toString(e){const t=b.toUint8Array(e);let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return decodeURIComponent(escape(r))}}class R{static toString(e,t=!1){const r=b.toArrayBuffer(e),n=new DataView(r);let s="";for(let o=0;o<r.byteLength;o+=2){const a=n.getUint16(o,t);s+=String.fromCharCode(a)}return s}static fromString(e,t=!1){const r=new ArrayBuffer(e.length*2),n=new DataView(r);for(let s=0;s<e.length;s++)n.setUint16(s*2,e.charCodeAt(s),t);return r}}class x{static isHex(e){return typeof e===et&&Qo.test(e)}static isBase64(e){return typeof e===et&&ea.test(e)}static isBase64Url(e){return typeof e===et&&ta.test(e)}static ToString(e,t="utf8"){const r=b.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return R.toString(r,!0);case"utf16":case"utf16be":return R.toString(r);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return R.fromString(e,!0);case"utf16":case"utf16be":return R.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=b.toUint8Array(e);if(typeof btoa<"u"){const r=this.ToString(t,"binary");return btoa(r)}else return nr.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!x.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(t)):new Uint8Array(nr.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!x.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=x.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return lr.fromString(e);case"utf16":case"utf16be":return R.fromString(e);case"utf16le":case"usc2":return R.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=x.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return lr.toString(e);case"utf16":case"utf16be":return R.toString(e);case"utf16le":case"usc2":return R.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r.buffer}static ToBinary(e){const t=b.toUint8Array(e);let r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return r}static ToHex(e){const t=b.toUint8Array(e);let r="";const n=t.length;for(let s=0;s<n;s++){const o=t[s];o<16&&(r+="0"),r+=o.toString(16)}return r}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!x.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let n=0;n<t.length;n=n+2){const s=t.slice(n,n+2);r[n/2]=parseInt(s,16)}return r.buffer}static ToUtf16String(e,t=!1){return R.toString(e,t)}static FromUtf16String(e,t=!1){return R.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(e==null?void 0:e.replace(/[\n\r\t ]/g,""))||""}}x.DEFAULT_UTF8_ENCODING="utf8";/*!
 Copyright (c) Peculiar Ventures, LLC
*/function oe(i,e){let t=0;if(i.length===1)return i[0];for(let r=i.length-1;r>=0;r--)t+=i[i.length-1-r]*Math.pow(2,e*r);return t}function Z(i,e,t=-1){const r=t;let n=i,s=0,o=Math.pow(2,e);for(let a=1;a<8;a++){if(i<o){let l;if(r<0)l=new ArrayBuffer(a),s=a;else{if(r<a)return new ArrayBuffer(0);l=new ArrayBuffer(r),s=r}const c=new Uint8Array(l);for(let u=a-1;u>=0;u--){const f=Math.pow(2,u*e);c[s-u-1]=Math.floor(n/f),n-=c[s-u-1]*f}return l}o*=Math.pow(2,e)}return new ArrayBuffer(0)}function ot(...i){let e=0,t=0;for(const s of i)e+=s.length;const r=new ArrayBuffer(e),n=new Uint8Array(r);for(const s of i)n.set(s,t),t+=s.length;return n}function Xr(){const i=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const a=i[0]===255&&i[1]&128,l=i[0]===0&&(i[1]&128)===0;(a||l)&&this.warnings.push("Needlessly long format")}const e=new ArrayBuffer(this.valueHex.byteLength),t=new Uint8Array(e);for(let a=0;a<this.valueHex.byteLength;a++)t[a]=0;t[0]=i[0]&128;const r=oe(t,8),n=new ArrayBuffer(this.valueHex.byteLength),s=new Uint8Array(n);for(let a=0;a<this.valueHex.byteLength;a++)s[a]=i[a];return s[0]&=127,oe(s,8)-r}function ra(i){const e=i<0?i*-1:i;let t=128;for(let r=1;r<8;r++){if(e<=t){if(i<0){const o=t-e,a=Z(o,8,r),l=new Uint8Array(a);return l[0]|=128,a}let n=Z(e,8,r),s=new Uint8Array(n);if(s[0]&128){const o=n.slice(0),a=new Uint8Array(o);n=new ArrayBuffer(n.byteLength+1),s=new Uint8Array(n);for(let l=0;l<o.byteLength;l++)s[l+1]=a[l];s[0]=0}return n}t*=Math.pow(2,8)}return new ArrayBuffer(0)}function na(i,e){if(i.byteLength!==e.byteLength)return!1;const t=new Uint8Array(i),r=new Uint8Array(e);for(let n=0;n<t.length;n++)if(t[n]!==r[n])return!1;return!0}function I(i,e){const t=i.toString(10);if(e<t.length)return"";const r=e-t.length,n=new Array(r);for(let o=0;o<r;o++)n[o]="0";return n.join("").concat(t)}/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function Ke(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function Bt(i){let e=0,t=0;for(let n=0;n<i.length;n++){const s=i[n];e+=s.byteLength}const r=new Uint8Array(e);for(let n=0;n<i.length;n++){const s=i[n];r.set(new Uint8Array(s),t),t+=s.byteLength}return r.buffer}function O(i,e,t,r){return e instanceof Uint8Array?e.byteLength?t<0?(i.error="Wrong parameter: inputOffset less than zero",!1):r<0?(i.error="Wrong parameter: inputLength less than zero",!1):e.byteLength-t-r<0?(i.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(i.error="Wrong parameter: inputBuffer has zero length",!1):(i.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class Je{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return Bt(this.items)}}const ue=[new Uint8Array([1])],cr="0123456789",tt="name",ur="valueHexView",ia="isHexOnly",sa="idBlock",oa="tagClass",aa="tagNumber",la="isConstructed",ca="fromBER",ua="toBER",fa="local",C="",V=new ArrayBuffer(0),We=new Uint8Array(0),be="EndOfContent",Zr="OCTET STRING",Qr="BIT STRING";function H(i){var e;return e=class extends i{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(r){this.valueHexView=new Uint8Array(r)}constructor(...r){var n;super(...r);const s=r[0]||{};this.isHexOnly=(n=s.isHexOnly)!==null&&n!==void 0?n:!1,this.valueHexView=s.valueHex?b.toUint8Array(s.valueHex):We}fromBER(r,n,s){const o=r instanceof ArrayBuffer?new Uint8Array(r):r;if(!O(this,o,n,s))return-1;const a=n+s;return this.valueHexView=o.subarray(n,a),this.valueHexView.length?(this.blockLength=s,a):(this.warnings.push("Zero buffer length"),n)}toBER(r=!1){return this.isHexOnly?r?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",V)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:x.ToHex(this.valueHexView)}}},e.NAME="hexBlock",e}class ee{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}constructor({blockLength:e=0,error:t=C,warnings:r=[],valueBeforeDecode:n=We}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=b.toUint8Array(n)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:x.ToHex(this.valueBeforeDecodeView)}}}ee.NAME="baseBlock";class S extends ee{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}S.NAME="valueBlock";class en extends H(ee){constructor({idBlock:e={}}={}){var t,r,n,s;super(),e?(this.isHexOnly=(t=e.isHexOnly)!==null&&t!==void 0?t:!1,this.valueHexView=e.valueHex?b.toUint8Array(e.valueHex):We,this.tagClass=(r=e.tagClass)!==null&&r!==void 0?r:-1,this.tagNumber=(n=e.tagNumber)!==null&&n!==void 0?n:-1,this.isConstructed=(s=e.isConstructed)!==null&&s!==void 0?s:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",V}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const n=new Uint8Array(1);if(!e){let s=this.tagNumber;s&=31,t|=s,n[0]=t}return n.buffer}if(!this.isHexOnly){const n=Z(this.tagNumber,7),s=new Uint8Array(n),o=n.byteLength,a=new Uint8Array(o+1);if(a[0]=t|31,!e){for(let l=0;l<o-1;l++)a[l+1]=s[l]|128;a[o]=s[o-1]}return a.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=t|31,!e){const n=this.valueHexView;for(let s=0;s<n.length-1;s++)r[s+1]=n[s]|128;r[this.valueHexView.byteLength]=n[n.length-1]}return r.buffer}fromBER(e,t,r){const n=b.toUint8Array(e);if(!O(this,n,t,r))return-1;const s=n.subarray(t,t+r);if(s.length===0)return this.error="Zero buffer length",-1;switch(s[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(s[0]&32)===32,this.isHexOnly=!1;const a=s[0]&31;if(a!==31)this.tagNumber=a,this.blockLength=1;else{let l=1,c=this.valueHexView=new Uint8Array(255),u=255;for(;s[l]&128;){if(c[l-1]=s[l]&127,l++,l>=s.length)return this.error="End of input reached before message was fully decoded",-1;if(l===u){u+=255;const h=new Uint8Array(u);for(let g=0;g<c.length;g++)h[g]=c[g];c=this.valueHexView=new Uint8Array(u)}}this.blockLength=l+1,c[l-1]=s[l]&127;const f=new Uint8Array(l);for(let h=0;h<l;h++)f[h]=c[h];c=this.valueHexView=new Uint8Array(l),c.set(f),this.blockLength<=9?this.tagNumber=oe(c,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}en.NAME="identificationBlock";class tn extends ee{constructor({lenBlock:e={}}={}){var t,r,n;super(),this.isIndefiniteForm=(t=e.isIndefiniteForm)!==null&&t!==void 0?t:!1,this.longFormUsed=(r=e.longFormUsed)!==null&&r!==void 0?r:!1,this.length=(n=e.length)!==null&&n!==void 0?n:0}fromBER(e,t,r){const n=b.toUint8Array(e);if(!O(this,n,t,r))return-1;const s=n.subarray(t,t+r);if(s.length===0)return this.error="Zero buffer length",-1;if(s[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=s[0]===128,this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(s[0]&128),this.longFormUsed===!1)return this.length=s[0],this.blockLength=1,t+this.blockLength;const o=s[0]&127;if(o>8)return this.error="Too big integer",-1;if(o+1>s.length)return this.error="End of input reached before message was fully decoded",-1;const a=t+1,l=n.subarray(a,a+o);return l[o-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=oe(l,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),e===!1&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const n=Z(this.length,8);if(n.byteLength>127)return this.error="Too big length",V;if(t=new ArrayBuffer(n.byteLength+1),e)return t;const s=new Uint8Array(n);r=new Uint8Array(t),r[0]=n.byteLength|128;for(let o=0;o<n.byteLength;o++)r[o+1]=s[o];return t}return t=new ArrayBuffer(1),e===!1&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}tn.NAME="lengthBlock";const d={};class A extends ee{constructor({name:e=C,optional:t=!1,primitiveSchema:r,...n}={},s){super(n),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new en(n),this.lenBlock=new tn(n),this.valueBlock=s?new s(n):new S(n)}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e,t){const r=t||new Je;t||rn(this);const n=this.idBlock.toBER(e);if(r.write(n),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const s=this.valueBlock.toBER(e);this.lenBlock.length=s.byteLength;const o=this.lenBlock.toBER(e);r.write(o),r.write(s)}return t?V:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return e==="ascii"?this.onAsciiEncoding():x.ToHex(this.toBER())}onAsciiEncoding(){const e=this.constructor.NAME,t=x.ToHex(this.valueBlock.valueBeforeDecodeView);return`${e} : ${t}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;const t=this.toBER(),r=e.toBER();return na(t,r)}}A.NAME="BaseBlock";function rn(i){var e;if(i instanceof d.Constructed)for(const t of i.valueBlock.value)rn(t)&&(i.lenBlock.isIndefiniteForm=!0);return!!(!((e=i.lenBlock)===null||e===void 0)&&e.isIndefiniteForm)}class mt extends A{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor({value:e=C,...t}={},r){super(t,r),e&&this.fromString(e)}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}mt.NAME="BaseStringBlock";class nn extends H(S){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}nn.NAME="PrimitiveValueBlock";var sn;class pt extends A{constructor(e={}){super(e,nn),this.idBlock.isConstructed=!1}}sn=pt;d.Primitive=sn;pt.NAME="PRIMITIVE";function ha(i,e){if(i instanceof e)return i;const t=new e;return t.idBlock=i.idBlock,t.lenBlock=i.lenBlock,t.warnings=i.warnings,t.valueBeforeDecodeView=i.valueBeforeDecodeView,t}function le(i,e=0,t=i.length){const r=e;let n=new A({},S);const s=new ee;if(!O(s,i,e,t))return n.error=s.error,{offset:-1,result:n};if(!i.subarray(e,e+t).length)return n.error="Zero buffer length",{offset:-1,result:n};let a=n.idBlock.fromBER(i,e,t);if(n.idBlock.warnings.length&&n.warnings.concat(n.idBlock.warnings),a===-1)return n.error=n.idBlock.error,{offset:-1,result:n};if(e=a,t-=n.idBlock.blockLength,a=n.lenBlock.fromBER(i,e,t),n.lenBlock.warnings.length&&n.warnings.concat(n.lenBlock.warnings),a===-1)return n.error=n.lenBlock.error,{offset:-1,result:n};if(e=a,t-=n.lenBlock.blockLength,!n.idBlock.isConstructed&&n.lenBlock.isIndefiniteForm)return n.error="Indefinite length form used for primitive encoding form",{offset:-1,result:n};let l=A;switch(n.idBlock.tagClass){case 1:if(n.idBlock.tagNumber>=37&&n.idBlock.isHexOnly===!1)return n.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:n};switch(n.idBlock.tagNumber){case 0:if(n.idBlock.isConstructed&&n.lenBlock.length>0)return n.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:n};l=d.EndOfContent;break;case 1:l=d.Boolean;break;case 2:l=d.Integer;break;case 3:l=d.BitString;break;case 4:l=d.OctetString;break;case 5:l=d.Null;break;case 6:l=d.ObjectIdentifier;break;case 10:l=d.Enumerated;break;case 12:l=d.Utf8String;break;case 13:l=d.RelativeObjectIdentifier;break;case 14:l=d.TIME;break;case 15:return n.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:n};case 16:l=d.Sequence;break;case 17:l=d.Set;break;case 18:l=d.NumericString;break;case 19:l=d.PrintableString;break;case 20:l=d.TeletexString;break;case 21:l=d.VideotexString;break;case 22:l=d.IA5String;break;case 23:l=d.UTCTime;break;case 24:l=d.GeneralizedTime;break;case 25:l=d.GraphicString;break;case 26:l=d.VisibleString;break;case 27:l=d.GeneralString;break;case 28:l=d.UniversalString;break;case 29:l=d.CharacterString;break;case 30:l=d.BmpString;break;case 31:l=d.DATE;break;case 32:l=d.TimeOfDay;break;case 33:l=d.DateTime;break;case 34:l=d.Duration;break;default:{const c=n.idBlock.isConstructed?new d.Constructed:new d.Primitive;c.idBlock=n.idBlock,c.lenBlock=n.lenBlock,c.warnings=n.warnings,n=c}}break;case 2:case 3:case 4:default:l=n.idBlock.isConstructed?d.Constructed:d.Primitive}return n=ha(n,l),a=n.fromBER(i,e,n.lenBlock.isIndefiniteForm?t:n.lenBlock.length),n.valueBeforeDecodeView=i.subarray(r,r+n.blockLength),{offset:a,result:n}}function da(i){if(!i.byteLength){const e=new A({},S);return e.error="Input buffer has zero length",{offset:-1,result:e}}return le(b.toUint8Array(i).slice(),0,i.byteLength)}function ga(i,e){return i?1:e}class D extends S{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const n=b.toUint8Array(e);if(!O(this,n,t,r))return-1;if(this.valueBeforeDecodeView=n.subarray(t,t+r),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),t;let s=t;for(;ga(this.isIndefiniteForm,r)>0;){const o=le(n,s,r);if(o.offset===-1)return this.error=o.result.error,this.warnings.concat(o.result.warnings),-1;if(s=o.offset,this.blockLength+=o.result.blockLength,r-=o.result.blockLength,this.value.push(o.result),this.isIndefiniteForm&&o.result.constructor.NAME===be)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===be?this.value.pop():this.warnings.push("No EndOfContent block encoded")),s}toBER(e,t){const r=t||new Je;for(let n=0;n<this.value.length;n++)this.value[n].toBER(e,r);return t?V:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}D.NAME="ConstructedValueBlock";var on;class te extends A{constructor(e={}){super(e,D),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){const e=[];for(const r of this.valueBlock.value)e.push(r.toString("ascii").split(`
`).map(n=>`  ${n}`).join(`
`));const t=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join(`
`)}`:`${t} :`}}on=te;d.Constructed=on;te.NAME="CONSTRUCTED";class an extends S{fromBER(e,t,r){return t}toBER(e){return V}}an.override="EndOfContentValueBlock";var ln;class xt extends A{constructor(e={}){super(e,an),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}ln=xt;d.EndOfContent=ln;xt.NAME=be;var cn;class kt extends A{constructor(e={}){super(e,S),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){const r=new ArrayBuffer(2);if(!e){const n=new Uint8Array(r);n[0]=5,n[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}cn=kt;d.Null=cn;kt.NAME="NULL";class un extends H(S){get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=b.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}fromBER(e,t,r){const n=b.toUint8Array(e);return O(this,n,t,r)?(this.valueHexView=n.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Xr.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}un.NAME="BooleanValueBlock";var fn;class Et extends A{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor(e={}){super(e,un),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}fn=Et;d.Boolean=fn;Et.NAME="BOOLEAN";class hn extends H(D){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,n=D.prototype.fromBER.call(this,e,t,r),n===-1)return n;for(let s=0;s<this.value.length;s++){const o=this.value[s].constructor.NAME;if(o===be){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(o!==Zr)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e,t){return this.isConstructed?D.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}hn.NAME="OctetStringValueBlock";var At;class St extends A{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,s;(n=r.isConstructed)!==null&&n!==void 0||(r.isConstructed=!!(!((s=r.value)===null||s===void 0)&&s.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},hn),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,r===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const s=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(s.byteLength){const o=le(s,0,s.byteLength);o.offset!==-1&&o.offset===r&&(this.valueBlock.value=[o.result])}}catch{}}return super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return te.prototype.onAsciiEncoding.call(this);const e=this.constructor.NAME,t=x.ToHex(this.valueBlock.valueHexView);return`${e} : ${t}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof At&&e.push(t.valueBlock.valueHexView);return b.concat(e)}}At=St;d.OctetString=At;St.NAME=Zr;class dn extends H(D){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let n=-1;if(this.isConstructed){if(n=D.prototype.fromBER.call(this,e,t,r),n===-1)return n;for(const a of this.value){const l=a.constructor.NAME;if(l===be){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(l!==Qr)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const c=a.valueBlock;if(this.unusedBits>0&&c.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=c.unusedBits}return n}const s=b.toUint8Array(e);if(!O(this,s,t,r))return-1;const o=s.subarray(t,t+r);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const a=o.subarray(1);try{if(a.byteLength){const l=le(a,0,a.byteLength);l.offset!==-1&&l.offset===r-1&&(this.value=[l.result])}}catch{}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,t+r}toBER(e,t){if(this.isConstructed)return D.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return V;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}dn.NAME="BitStringValueBlock";var gn;class Nt extends A{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,s;(n=r.isConstructed)!==null&&n!==void 0||(r.isConstructed=!!(!((s=r.value)===null||s===void 0)&&s.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},dn),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return te.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const o of t)e.push(o.toString(2).padStart(8,"0"));const r=e.join(""),n=this.constructor.NAME,s=r.substring(0,r.length-this.valueBlock.unusedBits);return`${n} : ${s}`}}}gn=Nt;d.BitString=gn;Nt.NAME=Qr;var yn;function ya(i,e){const t=new Uint8Array([0]),r=new Uint8Array(i),n=new Uint8Array(e);let s=r.slice(0);const o=s.length-1,a=n.slice(0),l=a.length-1;let c=0;const u=l<o?o:l;let f=0;for(let h=u;h>=0;h--,f++){switch(!0){case f<a.length:c=s[o-f]+a[l-f]+t[0];break;default:c=s[o-f]+t[0]}switch(t[0]=c/10,!0){case f>=s.length:s=ot(new Uint8Array([c%10]),s);break;default:s[o-f]=c%10}}return t[0]>0&&(s=ot(t,s)),s}function fr(i){if(i>=ue.length)for(let e=ue.length;e<=i;e++){const t=new Uint8Array([0]);let r=ue[e-1].slice(0);for(let n=r.length-1;n>=0;n--){const s=new Uint8Array([(r[n]<<1)+t[0]]);t[0]=s[0]/10,r[n]=s[0]%10}t[0]>0&&(r=ot(t,r)),ue.push(r)}return ue[i]}function wa(i,e){let t=0;const r=new Uint8Array(i),n=new Uint8Array(e),s=r.slice(0),o=s.length-1,a=n.slice(0),l=a.length-1;let c,u=0;for(let f=l;f>=0;f--,u++)switch(c=s[o-u]-a[l-u]-t,!0){case c<0:t=1,s[o-u]=c+10;break;default:t=0,s[o-u]=c}if(t>0)for(let f=o-l+1;f>=0;f--,u++)if(c=s[o-u]-t,c<0)t=1,s[o-u]=c+10;else{t=0,s[o-u]=c;break}return s.slice()}class Ct extends H(S){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Xr.call(this)))}constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),e!==void 0&&(this.valueDec=e)}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(ra(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const s=this.fromBER(e,t,r);if(s===-1)return s;const o=this.valueHexView;return o[0]===0&&o[1]&128?this.valueHexView=o.subarray(1):n!==0&&o.length<n&&(n-o.length>1&&(n=o.length+1),this.valueHexView=o.subarray(n-o.length)),s}toDER(e=!1){const t=this.valueHexView;switch(!0){case(t[0]&128)!==0:{const r=new Uint8Array(this.valueHexView.length+1);r[0]=0,r.set(t,1),this.valueHexView=r}break;case(t[0]===0&&(t[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return n===-1||this.setValueHex(),n}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=this.valueHexView.length*8-1;let t=new Uint8Array(this.valueHexView.length*8/3),r=0,n;const s=this.valueHexView;let o="",a=!1;for(let l=s.byteLength-1;l>=0;l--){n=s[l];for(let c=0;c<8;c++){if((n&1)===1)switch(r){case e:t=wa(fr(r),t),o="-";break;default:t=ya(t,fr(r))}r++,n>>=1}}for(let l=0;l<t.length;l++)t[l]&&(a=!0),a&&(o+=cr.charAt(t[l]));return a===!1&&(o+=cr.charAt(0)),o}}yn=Ct;Ct.NAME="IntegerValueBlock";Object.defineProperty(yn.prototype,"valueHex",{set:function(i){this.valueHexView=new Uint8Array(i),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var ge;class Ge extends A{constructor(e={}){super(e,Ct),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return Ke(),BigInt(this.valueBlock.toString())}static fromBigInt(e){Ke();const t=BigInt(e),r=new Je,n=t.toString(16).replace(/^-/,""),s=new Uint8Array(x.FromHex(n));if(t<0){const a=new Uint8Array(s.length+(s[0]&128?1:0));a[0]|=128;const c=BigInt(`0x${x.ToHex(a)}`)+t,u=b.toUint8Array(x.FromHex(c.toString(16)));u[0]|=128,r.write(u)}else s[0]&128&&r.write(new Uint8Array([0])),r.write(s);return new ge({valueHex:r.final()})}convertToDER(){const e=new ge({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new ge({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}ge=Ge;d.Integer=ge;Ge.NAME="INTEGER";var wn;class It extends Ge{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}wn=It;d.Enumerated=wn;It.NAME="ENUMERATED";class at extends H(S){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const n=b.toUint8Array(e);if(!O(this,n,t,r))return-1;const s=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let a=0;a<r&&(this.valueHexView[a]=s[a]&127,this.blockLength++,!!(s[a]&128));a++);const o=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength;a++)o[a]=this.valueHexView[a];return this.valueHexView=o,s[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=oe(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){Ke();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let n=0;n<r.length;n++)r[n]=parseInt(t.slice(n*7,n*7+7),2)+(n+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const n=this.valueHexView,s=new Uint8Array(this.blockLength);for(let o=0;o<this.blockLength-1;o++)s[o]=n[o]|128;return s[this.blockLength-1]=n[this.blockLength-1],s.buffer}const t=Z(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",V;const r=new Uint8Array(t.byteLength);if(!e){const n=new Uint8Array(t),s=t.byteLength-1;for(let o=0;o<s;o++)r[o]=n[o]|128;r[s]=n[s]}return r}toString(){let e="";if(this.isHexOnly)e=x.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}at.NAME="sidBlock";class vn extends S{constructor({value:e=C,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const s=new at;if(n=s.fromBER(e,n,r),n===-1)return this.blockLength=0,this.error=s.error,n;this.value.length===0&&(s.isFirstSid=!0),this.blockLength+=s.blockLength,r-=s.blockLength,this.value.push(s)}return n}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(n.byteLength===0)return this.error=this.value[r].error,V;t.push(n)}return Bt(t)}fromString(e){this.value=[];let t=0,r=0,n="",s=!1;do if(r=e.indexOf(".",t),r===-1?n=e.substring(t):n=e.substring(t,r),t=r+1,s){const o=this.value[0];let a=0;switch(o.valueDec){case 0:break;case 1:a=40;break;case 2:a=80;break;default:this.value=[];return}const l=parseInt(n,10);if(isNaN(l))return;o.valueDec=l+a,s=!1}else{const o=new at;if(n>Number.MAX_SAFE_INTEGER){Ke();const a=BigInt(n);o.valueBigInt=a}else if(o.valueDec=parseInt(n,10),isNaN(o.valueDec))return;this.value.length||(o.isFirstSid=!0,s=!0),this.value.push(o)}while(r!==-1)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();r!==0&&(e=`${e}.`),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}vn.NAME="ObjectIdentifierValueBlock";var bn;class _t extends A{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,vn),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}bn=_t;d.ObjectIdentifier=bn;_t.NAME="OBJECT IDENTIFIER";class lt extends H(ee){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(r===0)return t;const n=b.toUint8Array(e);if(!O(this,n,t,r))return-1;const s=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let a=0;a<r&&(this.valueHexView[a]=s[a]&127,this.blockLength++,!!(s[a]&128));a++);const o=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength;a++)o[a]=this.valueHexView[a];return this.valueHexView=o,s[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=oe(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const n=this.valueHexView,s=new Uint8Array(this.blockLength);for(let o=0;o<this.blockLength-1;o++)s[o]=n[o]|128;return s[this.blockLength-1]=n[this.blockLength-1],s.buffer}const t=Z(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",V;const r=new Uint8Array(t.byteLength);if(!e){const n=new Uint8Array(t),s=t.byteLength-1;for(let o=0;o<s;o++)r[o]=n[o]|128;r[s]=n[s]}return r.buffer}toString(){let e="";return this.isHexOnly?e=x.ToHex(this.valueHexView):e=this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}lt.NAME="relativeSidBlock";class Bn extends S{constructor({value:e=C,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const s=new lt;if(n=s.fromBER(e,n,r),n===-1)return this.blockLength=0,this.error=s.error,n;this.blockLength+=s.blockLength,r-=s.blockLength,this.value.push(s)}return n}toBER(e,t){const r=[];for(let n=0;n<this.value.length;n++){const s=this.value[n].toBER(e);if(s.byteLength===0)return this.error=this.value[n].error,V;r.push(s)}return Bt(r)}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),r===-1?n=e.substring(t):n=e.substring(t,r),t=r+1;const s=new lt;if(s.valueDec=parseInt(n,10),isNaN(s.valueDec))return!0;this.value.push(s)}while(r!==-1);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();r!==0&&(e=`${e}.`),t&&(n=`{${n}}`),e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Bn.NAME="RelativeObjectIdentifierValueBlock";var mn;class Ut extends A{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,Bn),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}mn=Ut;d.RelativeObjectIdentifier=mn;Ut.NAME="RelativeObjectIdentifier";var pn;class Tt extends te{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}pn=Tt;d.Sequence=pn;Tt.NAME="SEQUENCE";var xn;class Vt extends te{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}xn=Vt;d.Set=xn;Vt.NAME="SET";class kn extends H(S){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=C}toJSON(){return{...super.toJSON(),value:this.value}}}kn.NAME="StringValueBlock";class En extends kn{}En.NAME="SimpleStringValueBlock";class _ extends mt{constructor({...e}={}){super(e,En)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,b.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}_.NAME="SIMPLE STRING";class An extends _{fromBuffer(e){this.valueBlock.valueHexView=b.toUint8Array(e);try{this.valueBlock.value=x.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=x.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(x.FromUtf8String(e)),this.valueBlock.value=e}}An.NAME="Utf8StringValueBlock";var Sn;class J extends An{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Sn=J;d.Utf8String=Sn;J.NAME="UTF8String";class Nn extends _{fromBuffer(e){this.valueBlock.value=x.ToUtf16String(e),this.valueBlock.valueHexView=b.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(x.FromUtf16String(e))}}Nn.NAME="BmpStringValueBlock";var Cn;class Lt extends Nn{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Cn=Lt;d.BmpString=Cn;Lt.NAME="BMPString";class In extends _{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let n=0;n<r.length;n+=4)r[n]=r[n+3],r[n+1]=r[n+2],r[n+2]=0,r[n+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t*4);for(let n=0;n<t;n++){const s=Z(e.charCodeAt(n),8),o=new Uint8Array(s);if(o.length>4)continue;const a=4-o.length;for(let l=o.length-1;l>=0;l--)r[n*4+l+a]=o[l]}this.valueBlock.value=e}}In.NAME="UniversalStringValueBlock";var _n;class Rt extends In{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}_n=Rt;d.UniversalString=_n;Rt.NAME="UniversalString";var Un;class Ht extends _{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}Un=Ht;d.NumericString=Un;Ht.NAME="NumericString";var Tn;class Ot extends _{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}Tn=Ot;d.PrintableString=Tn;Ot.NAME="PrintableString";var Vn;class Pt extends _{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Vn=Pt;d.TeletexString=Vn;Pt.NAME="TeletexString";var Ln;class Mt extends _{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Ln=Mt;d.VideotexString=Ln;Mt.NAME="VideotexString";var Rn;class Ft extends _{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}Rn=Ft;d.IA5String=Rn;Ft.NAME="IA5String";var Hn;class Dt extends _{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}Hn=Dt;d.GraphicString=Hn;Dt.NAME="GraphicString";var On;class qe extends _{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}On=qe;d.VisibleString=On;qe.NAME="VisibleString";var Pn;class $t extends _{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}Pn=$t;d.GeneralString=Pn;$t.NAME="GeneralString";var Mn;class Kt extends _{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}Mn=Kt;d.CharacterString=Mn;Kt.NAME="CharacterString";var Fn;class ze extends qe{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let n=0;n<e.length;n++)this.valueBlock.valueHexView[n]=e.charCodeAt(n)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,b.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const r=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(r===null){this.error="Wrong input string for conversion";return}const n=parseInt(r[1],10);n>=50?this.year=1900+n:this.year=2e3+n,this.month=parseInt(r[2],10),this.day=parseInt(r[3],10),this.hour=parseInt(r[4],10),this.minute=parseInt(r[5],10),this.second=parseInt(r[6],10)}toString(e="iso"){if(e==="iso"){const t=new Array(7);return t[0]=I(this.year<2e3?this.year-1900:this.year-2e3,2),t[1]=I(this.month,2),t[2]=I(this.day,2),t[3]=I(this.hour,2),t[4]=I(this.minute,2),t[5]=I(this.second,2),t[6]="Z",t.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}Fn=ze;d.UTCTime=Fn;ze.NAME="UTCTime";var Dn;class jt extends ze{constructor(e={}){var t;super(e),(t=this.millisecond)!==null&&t!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){const e=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond);return new Date(e)}fromString(e){let t=!1,r="",n="",s=0,o,a=0,l=0;if(e[e.length-1]==="Z")r=e.substring(0,e.length-1),t=!0;else{const f=new Number(e[e.length-1]);if(isNaN(f.valueOf()))throw new Error("Wrong input string for conversion");r=e}if(t){if(r.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(r.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let f=1,h=r.indexOf("+"),g="";if(h===-1&&(h=r.indexOf("-"),f=-1),h!==-1){if(g=r.substring(h+1),r=r.substring(0,h),g.length!==2&&g.length!==4)throw new Error("Wrong input string for conversion");let B=parseInt(g.substring(0,2),10);if(isNaN(B.valueOf()))throw new Error("Wrong input string for conversion");if(a=f*B,g.length===4){if(B=parseInt(g.substring(2,4),10),isNaN(B.valueOf()))throw new Error("Wrong input string for conversion");l=f*B}}}let c=r.indexOf(".");if(c===-1&&(c=r.indexOf(",")),c!==-1){const f=new Number(`0${r.substring(c)}`);if(isNaN(f.valueOf()))throw new Error("Wrong input string for conversion");s=f.valueOf(),n=r.substring(0,c)}else n=r;switch(!0){case n.length===8:if(o=/(\d{4})(\d{2})(\d{2})/ig,c!==-1)throw new Error("Wrong input string for conversion");break;case n.length===10:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,c!==-1){let f=60*s;this.minute=Math.floor(f),f=60*(f-this.minute),this.second=Math.floor(f),f=1e3*(f-this.second),this.millisecond=Math.floor(f)}break;case n.length===12:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,c!==-1){let f=60*s;this.second=Math.floor(f),f=1e3*(f-this.second),this.millisecond=Math.floor(f)}break;case n.length===14:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,c!==-1){const f=1e3*s;this.millisecond=Math.floor(f)}break;default:throw new Error("Wrong input string for conversion")}const u=o.exec(n);if(u===null)throw new Error("Wrong input string for conversion");for(let f=1;f<u.length;f++)switch(f){case 1:this.year=parseInt(u[f],10);break;case 2:this.month=parseInt(u[f],10);break;case 3:this.day=parseInt(u[f],10);break;case 4:this.hour=parseInt(u[f],10)+a;break;case 5:this.minute=parseInt(u[f],10)+l;break;case 6:this.second=parseInt(u[f],10);break;default:throw new Error("Wrong input string for conversion")}if(t===!1){const f=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=f.getUTCFullYear(),this.month=f.getUTCMonth(),this.day=f.getUTCDay(),this.hour=f.getUTCHours(),this.minute=f.getUTCMinutes(),this.second=f.getUTCSeconds(),this.millisecond=f.getUTCMilliseconds()}}toString(e="iso"){if(e==="iso"){const t=[];return t.push(I(this.year,4)),t.push(I(this.month,2)),t.push(I(this.day,2)),t.push(I(this.hour,2)),t.push(I(this.minute,2)),t.push(I(this.second,2)),this.millisecond!==0&&(t.push("."),t.push(I(this.millisecond,3))),t.push("Z"),t.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}Dn=jt;d.GeneralizedTime=Dn;jt.NAME="GeneralizedTime";var $n;class Jt extends J{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}$n=Jt;d.DATE=$n;Jt.NAME="DATE";var Kn;class Wt extends J{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}Kn=Wt;d.TimeOfDay=Kn;Wt.NAME="TimeOfDay";var jn;class Gt extends J{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}jn=Gt;d.DateTime=jn;Gt.NAME="DateTime";var Jn;class qt extends J{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}Jn=qt;d.Duration=Jn;qt.NAME="Duration";var Wn;class zt extends J{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}Wn=zt;d.TIME=Wn;zt.NAME="TIME";class Be{constructor({name:e=C,optional:t=!1}={}){this.name=e,this.optional=t}}class Gn extends Be{constructor({value:e=[],...t}={}){super(t),this.value=e}}class ct extends Be{constructor({value:e=new Be,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class va{get data(){return this.dataView.slice().buffer}set data(e){this.dataView=b.toUint8Array(e)}constructor({data:e=We}={}){this.dataView=b.toUint8Array(e)}fromBER(e,t,r){const n=t+r;return this.dataView=b.toUint8Array(e).subarray(t,n),n}toBER(e){return this.dataView.slice().buffer}}function re(i,e,t){if(t instanceof Gn){for(const s of t.value)if(re(i,e,s).verified)return{verified:!0,result:i};{const s={verified:!1,result:{error:"Wrong values for Choice type"}};return t.hasOwnProperty(tt)&&(s.name=t.name),s}}if(t instanceof Be)return t.hasOwnProperty(tt)&&(i[t.name]=e),{verified:!0,result:i};if(!(i instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(sa in t))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(ca in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(ua in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const r=t.idBlock.toBER(!1);if(r.byteLength===0)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(t.idBlock.fromBER(r,0,r.byteLength)===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(t.idBlock.hasOwnProperty(oa)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagClass!==e.idBlock.tagClass)return{verified:!1,result:i};if(t.idBlock.hasOwnProperty(aa)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagNumber!==e.idBlock.tagNumber)return{verified:!1,result:i};if(t.idBlock.hasOwnProperty(la)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isConstructed!==e.idBlock.isConstructed)return{verified:!1,result:i};if(!(ia in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isHexOnly!==e.idBlock.isHexOnly)return{verified:!1,result:i};if(t.idBlock.isHexOnly){if(!(ur in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const s=t.idBlock.valueHexView,o=e.idBlock.valueHexView;if(s.length!==o.length)return{verified:!1,result:i};for(let a=0;a<s.length;a++)if(s[a]!==o[1])return{verified:!1,result:i}}if(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,C),t.name&&(i[t.name]=e)),t instanceof d.Constructed){let s=0,o={verified:!1,result:{error:"Unknown error"}},a=t.valueBlock.value.length;if(a>0&&t.valueBlock.value[0]instanceof ct&&(a=e.valueBlock.value.length),a===0)return{verified:!0,result:i};if(e.valueBlock.value.length===0&&t.valueBlock.value.length!==0){let l=!0;for(let c=0;c<t.valueBlock.value.length;c++)l=l&&(t.valueBlock.value[c].optional||!1);return l?{verified:!0,result:i}:(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,C),t.name&&delete i[t.name]),i.error="Inconsistent object length",{verified:!1,result:i})}for(let l=0;l<a;l++)if(l-s>=e.valueBlock.value.length){if(t.valueBlock.value[l].optional===!1){const c={verified:!1,result:i};return i.error="Inconsistent length between ASN.1 data and schema",t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,C),t.name&&(delete i[t.name],c.name=t.name)),c}}else if(t.valueBlock.value[0]instanceof ct){if(o=re(i,e.valueBlock.value[l],t.valueBlock.value[0].value),o.verified===!1)if(t.valueBlock.value[0].optional)s++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,C),t.name&&delete i[t.name]),o;if(tt in t.valueBlock.value[0]&&t.valueBlock.value[0].name.length>0){let c={};fa in t.valueBlock.value[0]&&t.valueBlock.value[0].local?c=e:c=i,typeof c[t.valueBlock.value[0].name]>"u"&&(c[t.valueBlock.value[0].name]=[]),c[t.valueBlock.value[0].name].push(e.valueBlock.value[l])}}else if(o=re(i,e.valueBlock.value[l-s],t.valueBlock.value[l]),o.verified===!1)if(t.valueBlock.value[l].optional)s++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,C),t.name&&delete i[t.name]),o;if(o.verified===!1){const l={verified:!1,result:i};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,C),t.name&&(delete i[t.name],l.name=t.name)),l}return{verified:!0,result:i}}if(t.primitiveSchema&&ur in e.valueBlock){const s=le(e.valueBlock.valueHexView);if(s.offset===-1){const o={verified:!1,result:s.result};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,C),t.name&&(delete i[t.name],o.name=t.name)),o}return re(i,s.result,t.primitiveSchema)}return{verified:!0,result:i}}function ba(i,e){if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const t=le(b.toUint8Array(i));return t.offset===-1?{verified:!1,result:t.result}:re(t.result,t.result,e)}const Ba=Object.freeze(Object.defineProperty({__proto__:null,Any:Be,BaseBlock:A,BaseStringBlock:mt,BitString:Nt,BmpString:Lt,Boolean:Et,CharacterString:Kt,Choice:Gn,Constructed:te,DATE:Jt,DateTime:Gt,Duration:qt,EndOfContent:xt,Enumerated:It,GeneralString:$t,GeneralizedTime:jt,GraphicString:Dt,HexBlock:H,IA5String:Ft,Integer:Ge,Null:kt,NumericString:Ht,ObjectIdentifier:_t,OctetString:St,Primitive:pt,PrintableString:Ot,RawData:va,RelativeObjectIdentifier:Ut,Repeated:ct,Sequence:Tt,Set:Vt,TIME:zt,TeletexString:Pt,TimeOfDay:Wt,UTCTime:ze,UniversalString:Rt,Utf8String:J,ValueBlock:S,VideotexString:Mt,ViewWriter:Je,VisibleString:qe,compareSchema:re,fromBER:da,verifySchema:ba},Symbol.toStringTag,{value:"Module"})),ma=Q(Ba);var pa=k&&k.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(i,r,n)}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),xa=k&&k.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),ka=k&&k.__importStar||function(){var i=function(e){return i=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},i(e)};return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=i(e),n=0;n<r.length;n++)r[n]!=="default"&&pa(t,e,r[n]);return xa(t,e),t}}();Object.defineProperty(bt,"__esModule",{value:!0});bt.pemToSecretKey=Na;const Ea=ka(ma),Aa="-----BEGIN EC PRIVATE KEY-----",Sa="-----END EC PRIVATE KEY-----";function Na(i){const e=i.trim().split(`
`),t=e[0].trim(),r=e[e.length-1].trim();if(e.length<3)throw new Error("Invalid PEM format");if(!t.startsWith(Aa))throw new Error("Invalid PEM header");if(!r.startsWith(Sa))throw new Error("Invalid PEM footer");const n=e.slice(1,-1).join("").replace(/\r?\n/g,""),s=Uint8Array.from(atob(n),o=>o.charCodeAt(0));try{if(!Ea.fromBER(s).result.toString().includes("OBJECT IDENTIFIER : 1.3.132.0.10"))throw new Error("Invalid curve, must be secp256k1");return s.slice(7,39)}catch(o){throw console.error(o),new Error("Encountered error while parsing PEM key")}}var Ca=k&&k.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(i,r,n)}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),Ia=k&&k.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),_a=k&&k.__importStar||function(){var i=function(e){return i=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},i(e)};return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=i(e),n=0;n<r.length;n++)r[n]!=="default"&&Ca(t,e,r[n]);return Ia(t,e),t}}(),hr=k&&k.__classPrivateFieldGet||function(i,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?i!==e||!r:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(i):r?r.value:e.get(i)},dr=k&&k.__classPrivateFieldSet||function(i,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?i!==e||!n:!e.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(i,t):n?n.value=t:e.set(i,t),t},Ue,Te;Object.defineProperty(X,"__esModule",{value:!0});X.Secp256k1KeyIdentity=X.Secp256k1PublicKey=void 0;const T=Wo,fe=Go,Ua=qo,gr=zo,Ta=_a(Yo),Va=Xo,Ce=Yr,La=bt;function yr(i){return i!==null&&typeof i=="object"}class ${static fromRaw(e){return new $((0,T.bufFromBufLike)(e))}static fromDer(e){return new $(this.derDecode(e))}static from(e){if(typeof e=="string"){const t=(0,T.fromHex)(e);return this.fromRaw(t)}else if(yr(e)){const t=e;if(yr(t)&&Object.hasOwnProperty.call(t,"__derEncodedPublicKey__"))return this.fromDer(t);if(ArrayBuffer.isView(t)){const r=t;return this.fromRaw((0,T.bufFromBufLike)(r.buffer))}else{if(t instanceof ArrayBuffer)return this.fromRaw(t);if("rawKey"in t)return this.fromRaw(t.rawKey);if("derKey"in t)return this.fromDer(t.derKey);if("toDer"in t)return this.fromDer(t.toDer())}}throw new Error("Cannot construct Secp256k1PublicKey from the provided key.")}static derEncode(e){const t=(0,T.bufFromBufLike)((0,Ce.wrapDER)(e,Ce.SECP256K1_OID).buffer);return t.__derEncodedPublicKey__=void 0,t}static derDecode(e){return(0,Ce.unwrapDER)(e,Ce.SECP256K1_OID)}get rawKey(){return hr(this,Ue,"f")}get derKey(){return hr(this,Te,"f")}constructor(e){Ue.set(this,void 0),Te.set(this,void 0),dr(this,Ue,(0,T.bufFromBufLike)(e),"f"),dr(this,Te,$.derEncode(e),"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}X.Secp256k1PublicKey=$;Ue=new WeakMap,Te=new WeakMap;class z extends T.SignIdentity{static generate(e){if(e&&e.byteLength!==32)throw new Error("Secp256k1 Seed needs to be 32 bytes long.");let t;if(e){if(t=e,!fe.secp256k1.utils.isValidPrivateKey(t))throw new Error("The seed is invalid.")}else for(t=new Uint8Array((0,gr.randomBytes)(32));!fe.secp256k1.utils.isValidPrivateKey(t);)t=new Uint8Array((0,gr.randomBytes)(32));const r=fe.secp256k1.getPublicKey(t,!1),n=$.fromRaw(r);return new this(n,t)}static fromParsedJson(e){const[t,r]=e;return new z($.fromRaw((0,T.fromHex)(t)),(0,T.fromHex)(r))}static fromJSON(e){const t=JSON.parse(e);if(Array.isArray(t)){if(typeof t[0]=="string"&&typeof t[1]=="string")return this.fromParsedJson([t[0],t[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(e)}`)}static fromKeyPair(e,t){return new z($.fromRaw(e),t)}static fromSecretKey(e){const t=fe.secp256k1.getPublicKey(new Uint8Array(e),!1);return z.fromKeyPair(t,new Uint8Array(e))}static fromSeedPhrase(e,t){const r=Array.isArray(e)?e.join(" "):e;(r.split(" ").length<12||r.split(" ").length>24)&&console.warn("Warning - an unusually formatted seed phrase has been provided. Decoding may not work as expected");const n=Ta.mnemonicToSeedSync(r,t);if(n.byteLength!==64)throw new Error("Derived seed must be 64 bytes long.");const o=Va.HDKey.fromMasterSeed(n).derive("m/44'/223'/0'/0/0");if(!o.privateKey)throw new Error("Failed to derive private key from seed phrase");return z.fromSecretKey((0,T.bufFromBufLike)(o.privateKey))}static fromPem(e){const t=(0,La.pemToSecretKey)(e);return this.fromSecretKey(t)}constructor(e,t){super(),this._privateKey=t,this._publicKey=e}toJSON(){return[(0,T.toHex)(this._publicKey.toRaw()),(0,T.toHex)(this._privateKey)]}getKeyPair(){return{secretKey:this._privateKey,publicKey:this._publicKey}}getPublicKey(){return this._publicKey}async sign(e){const t=Ua.sha256.create();return t.update(new Uint8Array(e)),(0,T.uint8ToBuf)(fe.secp256k1.sign(new Uint8Array(t.digest()),new Uint8Array(this._privateKey)).toCompactRawBytes())}}X.Secp256k1KeyIdentity=z;X.default=z;(function(i){var e=k&&k.__createBinding||(Object.create?function(r,n,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(n,s);(!a||("get"in a?!n.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return n[s]}}),Object.defineProperty(r,o,a)}:function(r,n,s,o){o===void 0&&(o=s),r[o]=n[s]}),t=k&&k.__exportStar||function(r,n){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(n,s)&&e(n,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),t(X,i)})(Jo);class Pa{constructor(e,t){this.mapping2=e,this.mapEvents=t,this.domain=null,this.playerBox=document.getElementById("selection"),this.playerPos={x:0,y:0},this.selectionPos={x:0,y:0},this.selectionBoxPosition={x:0,y:0},this.cityPosition={x:0,y:0},this.sconvertedSelPos=null,this.convertedCursorPos=null,this.tileSize=18,this.playerNum=0,this.msL=50,this.msR=50,this.msU=50,this.msD=50,this.movementPaused=!1,this.playerX=this.playerBox.offsetLeft,this.playerY=this.playerBox.offsetTop,this.playerCenterX=this.playerX+this.playerWidth/2,this.playerCenterY=this.playerY+this.playerHeight/2,this.playerId=Math.floor(Math.random()*100),this.playerCoor={x:0,y:0},this.uniPlayer={playerId:this.playerId,playerName:"Damion"+this.playerId,x:0,y:0,emote:null},this.playerId=this.uniPlayer.playerId,this.playerName=this.uniPlayer.playerName,this.x=this.uniPlayer.x,this.y=this.uniPlayer.y,this.emote=this.uniPlayer.emote,this.initMainPlayer(e),this.socket=null}initMainPlayer(e){let t=this.playerBox;this.selectionBoxPosition.x=Number(e[1447].x),this.selectionBoxPosition.y=Number(e[1447].y),t.style.left=`${this.selectionBoxPosition.x}px`,t.style.top=`${this.selectionBoxPosition.y}px`,this.playerPosition()}movePlayer(e){this.playerPosition();let t={left:0,right:0,top:0,bottom:0};switch(t.left=this.playerBox.getBoundingClientRect().left,t.top=this.playerBox.getBoundingClientRect().top+5,t.right=this.playerBox.getBoundingClientRect().right,t.bottom=this.playerBox.getBoundingClientRect().bottom,e){case"left":this.movementPaused==!1&&t.left>0&&(this.selectionBoxPosition.x-=this.tileSize,this.playerBox.style.left=`${this.selectionBoxPosition.x}px`,this.movementPaused=!0,setTimeout(()=>{this.movementPaused=!1},this.msL));break;case"right":this.movementPaused==!1&&t.right+this.tileSize<window.innerWidth&&(this.selectionBoxPosition.x+=this.tileSize,this.playerBox.style.left=`${this.selectionBoxPosition.x}px`,this.movementPaused=!0,setTimeout(()=>{this.movementPaused=!1},this.msR));break;case"up":this.movementPaused==!1&&t.top>0&&(this.selectionBoxPosition.y-=this.tileSize,this.playerBox.style.top=`${this.selectionBoxPosition.y}px`,this.movementPaused=!0,setTimeout(()=>{this.movementPaused=!1},this.msU));break;case"down":this.movementPaused==!1&&t.bottom+this.tileSize<window.innerHeight&&(this.selectionBoxPosition.y+=this.tileSize,this.playerBox.style.top=`${this.selectionBoxPosition.y}px`,this.movementPaused=!0,setTimeout(()=>{this.movementPaused=!1},this.msD));break}}playerPosition(){this.uniPlayer.previousX=this.uniPlayer.x,this.uniPlayer.previousY=this.uniPlayer.y;var e=this.playerBox,t=this.mapEvents.canvas.getBoundingClientRect(),r=e.getBoundingClientRect(),n={x:Math.round(r.left-t.left),y:Math.round(r.top-t.top)},s={x:Math.floor(n.x/this.tileSize),y:Math.floor(n.y/this.tileSize)},o=170-s.x;let a=s.x+s.y*(t.width/this.tileSize)+170;if(document.getElementById("selectPosBox").innerHTML=`Player Position: ${a}`,this.convertedSelPos=170-o+s.y*170,this.cityPosition.x=n.x-2,this.cityPosition.y=n.y-2,document.getElementById("playerCord").innerHTML=`Player Coordinates: ${this.cityPosition.x}, ${this.cityPosition.y}`,this.playerCoor.x=this.cityPosition.x,this.playerCoor.y=this.cityPosition.y,this.domain=a,document.getElementById("playerScreenCoor").innerHTML=`Player Screen Coordinates: ${r.left}, ${Math.round(r.top)+2}`,this.uniPlayer.x=this.cityPosition.x,this.uniPlayer.y=this.cityPosition.y+5,window.uniPlayer.x=this.cityPosition.x,window.uniPlayer.y=this.cityPosition.y,window.uniPlayer.playerId=this.playerId,window.uniPlayer.playerName=this.playerName,`${a}`===this.mapEvents.activeLandEvents[0]||`${a}`===this.mapEvents.activeLandEvents[1]||`${a}`===this.mapEvents.activeLandEvents[2]||`${a}`===this.mapEvents.activeLandEvents[3]||`${a}`===this.mapEvents.activeLandEvents[4]){window.soundtrack.loop("discovered-1"),window.soundtrack.setVolume("discovered-1",.8),window.soundtrack.play("discovered-1"),window.landActivated=!0,document.getElementById("selection").style.animationPlayState="running",document.getElementById("selection").style.animation="whiteBoxGlow 1s infinite",document.getElementById("selection").innerHTML='<div id="exclamationMark" style="position: absolute; top: 8px; left: 8px; width: 18px; height: 18px; background-color: #ff002d; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 18px; color: #fff; font-weight: 700;">!</div>';return}else window.soundtrack.stop("discovered-1"),window.domainType="canon",window.landActivated=!1,document.getElementById("selection").style.animationPlayState="paused",document.getElementById("selection").style.animation="none",document.getElementById("selection").innerHTML=""}}export{Pa as Player};
