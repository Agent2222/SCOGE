const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CLnLKdOW.js","assets/main-CjiS4ifE.js","assets/wScoge-BthgsBuw.js","assets/wScoge-CUf-lIoi.css","assets/main-CU5_KOYG.css"])))=>i.map(i=>d[i]);
import{b6 as As,b7 as Wg,cA as Je,cB as bx,cC as Gg,cD as Xr,b5 as Pr,cE as mi,ba as Ei,cF as Ex,cG as mp,bc as xx}from"./main-CjiS4ifE.js";import"./wScoge-BthgsBuw.js";var jh={exports:{}},io=typeof Reflect=="object"?Reflect:null,yp=io&&typeof io.apply=="function"?io.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Pu;io&&typeof io.ownKeys=="function"?Pu=io.ownKeys:Object.getOwnPropertySymbols?Pu=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Pu=function(e){return Object.getOwnPropertyNames(e)};function Sx(r){console&&console.warn&&console.warn(r)}var Vg=Number.isNaN||function(e){return e!==e};function Ft(){Ft.init.call(this)}jh.exports=Ft;jh.exports.once=Px;Ft.EventEmitter=Ft;Ft.prototype._events=void 0;Ft.prototype._eventsCount=0;Ft.prototype._maxListeners=void 0;var wp=10;function cc(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Ft,"defaultMaxListeners",{enumerable:!0,get:function(){return wp},set:function(r){if(typeof r!="number"||r<0||Vg(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");wp=r}});Ft.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ft.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Vg(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Jg(r){return r._maxListeners===void 0?Ft.defaultMaxListeners:r._maxListeners}Ft.prototype.getMaxListeners=function(){return Jg(this)};Ft.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var f=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw f.context=u,f}var d=a[e];if(d===void 0)return!1;if(typeof d=="function")yp(d,this,t);else for(var l=d.length,w=ev(d,l),n=0;n<l;++n)yp(w[n],this,t);return!0};function Yg(r,e,t,n){var i,a,u;if(cc(t),a=r._events,a===void 0?(a=r._events=Object.create(null),r._eventsCount=0):(a.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),u=a[e]),u===void 0)u=a[e]=t,++r._eventsCount;else if(typeof u=="function"?u=a[e]=n?[t,u]:[u,t]:n?u.unshift(t):u.push(t),i=Jg(r),i>0&&u.length>i&&!u.warned){u.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=r,f.type=e,f.count=u.length,Sx(f)}return r}Ft.prototype.addListener=function(e,t){return Yg(this,e,t,!1)};Ft.prototype.on=Ft.prototype.addListener;Ft.prototype.prependListener=function(e,t){return Yg(this,e,t,!0)};function Ix(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Xg(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Ix.bind(n);return i.listener=t,n.wrapFn=i,i}Ft.prototype.once=function(e,t){return cc(t),this.on(e,Xg(this,e,t)),this};Ft.prototype.prependOnceListener=function(e,t){return cc(t),this.prependListener(e,Xg(this,e,t)),this};Ft.prototype.removeListener=function(e,t){var n,i,a,u,f;if(cc(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(a=-1,u=n.length-1;u>=0;u--)if(n[u]===t||n[u].listener===t){f=n[u].listener,a=u;break}if(a<0)return this;a===0?n.shift():Ax(n,a),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,f||t)}return this};Ft.prototype.off=Ft.prototype.removeListener;Ft.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),u;for(i=0;i<a.length;++i)u=a[i],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Zg(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Ox(i):ev(i,i.length)}Ft.prototype.listeners=function(e){return Zg(this,e,!0)};Ft.prototype.rawListeners=function(e){return Zg(this,e,!1)};Ft.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):Qg.call(r,e)};Ft.prototype.listenerCount=Qg;function Qg(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Ft.prototype.eventNames=function(){return this._eventsCount>0?Pu(this._events):[]};function ev(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Ax(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Ox(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Px(r,e){return new Promise(function(t,n){function i(u){r.removeListener(e,a),n(u)}function a(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}tv(r,e,a,{once:!0}),e!=="error"&&Dx(r,i,{once:!0})})}function Dx(r,e,t){typeof r.on=="function"&&tv(r,"error",e,t)}function tv(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(a){n.once&&r.removeEventListener(e,i),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var Os=jh.exports;const Mx=As(Os);var Bh={exports:{}},so=typeof Reflect=="object"?Reflect:null,_p=so&&typeof so.apply=="function"?so.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Du;so&&typeof so.ownKeys=="function"?Du=so.ownKeys:Object.getOwnPropertySymbols?Du=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Du=function(e){return Object.getOwnPropertyNames(e)};function Lx(r){console&&console.warn&&console.warn(r)}var rv=Number.isNaN||function(e){return e!==e};function Ut(){Ut.init.call(this)}Bh.exports=Ut;Bh.exports.once=Tx;Ut.EventEmitter=Ut;Ut.prototype._events=void 0;Ut.prototype._eventsCount=0;Ut.prototype._maxListeners=void 0;var bp=10;function fc(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Ut,"defaultMaxListeners",{enumerable:!0,get:function(){return bp},set:function(r){if(typeof r!="number"||r<0||rv(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");bp=r}});Ut.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ut.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||rv(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function nv(r){return r._maxListeners===void 0?Ut.defaultMaxListeners:r._maxListeners}Ut.prototype.getMaxListeners=function(){return nv(this)};Ut.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var f=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw f.context=u,f}var d=a[e];if(d===void 0)return!1;if(typeof d=="function")_p(d,this,t);else for(var l=d.length,w=uv(d,l),n=0;n<l;++n)_p(w[n],this,t);return!0};function iv(r,e,t,n){var i,a,u;if(fc(t),a=r._events,a===void 0?(a=r._events=Object.create(null),r._eventsCount=0):(a.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),u=a[e]),u===void 0)u=a[e]=t,++r._eventsCount;else if(typeof u=="function"?u=a[e]=n?[t,u]:[u,t]:n?u.unshift(t):u.push(t),i=nv(r),i>0&&u.length>i&&!u.warned){u.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=r,f.type=e,f.count=u.length,Lx(f)}return r}Ut.prototype.addListener=function(e,t){return iv(this,e,t,!1)};Ut.prototype.on=Ut.prototype.addListener;Ut.prototype.prependListener=function(e,t){return iv(this,e,t,!0)};function Cx(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function sv(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Cx.bind(n);return i.listener=t,n.wrapFn=i,i}Ut.prototype.once=function(e,t){return fc(t),this.on(e,sv(this,e,t)),this};Ut.prototype.prependOnceListener=function(e,t){return fc(t),this.prependListener(e,sv(this,e,t)),this};Ut.prototype.removeListener=function(e,t){var n,i,a,u,f;if(fc(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(a=-1,u=n.length-1;u>=0;u--)if(n[u]===t||n[u].listener===t){f=n[u].listener,a=u;break}if(a<0)return this;a===0?n.shift():Rx(n,a),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,f||t)}return this};Ut.prototype.off=Ut.prototype.removeListener;Ut.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),u;for(i=0;i<a.length;++i)u=a[i],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function ov(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Nx(i):uv(i,i.length)}Ut.prototype.listeners=function(e){return ov(this,e,!0)};Ut.prototype.rawListeners=function(e){return ov(this,e,!1)};Ut.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):av.call(r,e)};Ut.prototype.listenerCount=av;function av(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Ut.prototype.eventNames=function(){return this._eventsCount>0?Du(this._events):[]};function uv(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Rx(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Nx(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Tx(r,e){return new Promise(function(t,n){function i(u){r.removeListener(e,a),n(u)}function a(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}cv(r,e,a,{once:!0}),e!=="error"&&$x(r,i,{once:!0})})}function $x(r,e,t){typeof r.on=="function"&&cv(r,"error",e,t)}function cv(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(a){n.once&&r.removeEventListener(e,i),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var Fx=Bh.exports,ge={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gh=function(r,e){return gh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])},gh(r,e)};function Ux(r,e){gh(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var vh=function(){return vh=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},vh.apply(this,arguments)};function qx(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function jx(r,e,t,n){var i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,e,t,n);else for(var f=r.length-1;f>=0;f--)(u=r[f])&&(a=(i<3?u(a):i>3?u(e,t,a):u(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function Bx(r,e){return function(t,n){e(t,n,r)}}function Kx(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function zx(r,e,t,n){function i(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function f(w){try{l(n.next(w))}catch(b){u(b)}}function d(w){try{l(n.throw(w))}catch(b){u(b)}}function l(w){w.done?a(w.value):i(w.value).then(f,d)}l((n=n.apply(r,e||[])).next())})}function Hx(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(l){return function(w){return d([l,w])}}function d(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(w){l=[6,w],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function kx(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function Wx(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function mh(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function fv(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,a=[],u;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(f){u={error:f}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(u)throw u.error}}return a}function Gx(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(fv(arguments[e]));return r}function Vx(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var a=arguments[e],u=0,f=a.length;u<f;u++,i++)n[i]=a[u];return n}function ta(r){return this instanceof ta?(this.v=r,this):new ta(r)}function Jx(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,a=[];return i={},u("next"),u("throw"),u("return"),i[Symbol.asyncIterator]=function(){return this},i;function u(S){n[S]&&(i[S]=function(I){return new Promise(function(M,z){a.push([S,I,M,z])>1||f(S,I)})})}function f(S,I){try{d(n[S](I))}catch(M){b(a[0][3],M)}}function d(S){S.value instanceof ta?Promise.resolve(S.value.v).then(l,w):b(a[0][2],S)}function l(S){f("next",S)}function w(S){f("throw",S)}function b(S,I){S(I),a.shift(),a.length&&f(a[0][0],a[0][1])}}function Yx(r){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,a){e[i]=r[i]?function(u){return(t=!t)?{value:ta(r[i](u)),done:i==="return"}:a?a(u):u}:a}}function Xx(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof mh=="function"?mh(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=r[a]&&function(u){return new Promise(function(f,d){u=r[a](u),i(f,d,u.done,u.value)})}}function i(a,u,f,d){Promise.resolve(d).then(function(l){a({value:l,done:f})},u)}}function Zx(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function Qx(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function e3(r){return r&&r.__esModule?r:{default:r}}function t3(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function r3(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const n3=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return vh},__asyncDelegator:Yx,__asyncGenerator:Jx,__asyncValues:Xx,__await:ta,__awaiter:zx,__classPrivateFieldGet:t3,__classPrivateFieldSet:r3,__createBinding:kx,__decorate:jx,__exportStar:Wx,__extends:Ux,__generator:Hx,__importDefault:e3,__importStar:Qx,__makeTemplateObject:Zx,__metadata:Kx,__param:Bx,__read:fv,__rest:qx,__spread:Gx,__spreadArrays:Vx,__values:mh},Symbol.toStringTag,{value:"Module"})),hc=Wg(n3);var Hf={},jo={},Ep;function i3(){if(Ep)return jo;Ep=1,Object.defineProperty(jo,"__esModule",{value:!0}),jo.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return jo.delay=r,jo}var ps={},kf={},gs={},xp;function s3(){return xp||(xp=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.ONE_THOUSAND=gs.ONE_HUNDRED=void 0,gs.ONE_HUNDRED=100,gs.ONE_THOUSAND=1e3),gs}var Wf={},Sp;function o3(){return Sp||(Sp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(Wf)),Wf}var Ip;function hv(){return Ip||(Ip=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=hc;e.__exportStar(s3(),r),e.__exportStar(o3(),r)}(kf)),kf}var Ap;function a3(){if(Ap)return ps;Ap=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.fromMiliseconds=ps.toMiliseconds=void 0;const r=hv();function e(n){return n*r.ONE_THOUSAND}ps.toMiliseconds=e;function t(n){return Math.floor(n/r.ONE_THOUSAND)}return ps.fromMiliseconds=t,ps}var Op;function u3(){return Op||(Op=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=hc;e.__exportStar(i3(),r),e.__exportStar(a3(),r)}(Hf)),Hf}var Xs={},Pp;function c3(){if(Pp)return Xs;Pp=1,Object.defineProperty(Xs,"__esModule",{value:!0}),Xs.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const n=this.get(t);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const i=Date.now()-n.started;this.timestamps.set(t,{started:n.started,elapsed:i})}get(t){const n=this.timestamps.get(t);if(typeof n>"u")throw new Error(`No timestamp found for label: ${t}`);return n}elapsed(t){const n=this.get(t);return n.elapsed||Date.now()-n.started}}return Xs.Watch=r,Xs.default=r,Xs}var Gf={},Bo={},Dp;function f3(){if(Dp)return Bo;Dp=1,Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.IWatch=void 0;class r{}return Bo.IWatch=r,Bo}var Mp;function h3(){return Mp||(Mp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),hc.__exportStar(f3(),r)}(Gf)),Gf}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=hc;e.__exportStar(u3(),r),e.__exportStar(c3(),r),e.__exportStar(h3(),r),e.__exportStar(hv(),r)})(ge);class Ps{}let l3=class extends Ps{constructor(e){super()}};const Lp=ge.FIVE_SECONDS,mo={pulse:"heartbeat_pulse"};let d3=class lv extends l3{constructor(e){super(e),this.events=new Fx.EventEmitter,this.interval=Lp,this.interval=(e==null?void 0:e.interval)||Lp}static async init(e){const t=new lv(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),ge.toMiliseconds(this.interval))}pulse(){this.events.emit(mo.pulse)}};const p3=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,g3=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,v3=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function m3(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){y3(r);return}return e}function y3(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function bu(r,e={}){if(typeof r!="string")return r;const t=r.trim();if(r[0]==='"'&&r.endsWith('"')&&!r.includes("\\"))return t.slice(1,-1);if(t.length<=9){const n=t.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!v3.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(p3.test(r)||g3.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,m3)}return JSON.parse(r)}catch(n){if(e.strict)throw n;return r}}function w3(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function br(r,...e){try{return w3(r(...e))}catch(t){return Promise.reject(t)}}function _3(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function b3(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function Mu(r){if(_3(r))return String(r);if(b3(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return Mu(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const yh="base64:";function E3(r){return typeof r=="string"?r:yh+I3(r)}function x3(r){return typeof r!="string"||!r.startsWith(yh)?r:S3(r.slice(yh.length))}function S3(r){return globalThis.Buffer?Buffer.from(r,"base64"):Uint8Array.from(globalThis.atob(r),e=>e.codePointAt(0))}function I3(r){return globalThis.Buffer?Buffer.from(r).toString("base64"):globalThis.btoa(String.fromCodePoint(...r))}function Jr(r){var e;return r&&((e=r.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function A3(...r){return Jr(r.join(":"))}function Eu(r){return r=Jr(r),r?r+":":""}function O3(r,e){if(e===void 0)return!0;let t=0,n=r.indexOf(":");for(;n>-1;)t++,n=r.indexOf(":",n+1);return t<=e}function P3(r,e){return e?r.startsWith(e)&&r[r.length-1]!=="$":r[r.length-1]!=="$"}const D3="memory",M3=()=>{const r=new Map;return{name:D3,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function L3(r={}){const e={mounts:{"":r.driver||M3()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=l=>{for(const w of e.mountpoints)if(l.startsWith(w))return{base:w,relativeKey:l.slice(w.length),driver:e.mounts[w]};return{base:"",relativeKey:l,driver:e.mounts[""]}},n=(l,w)=>e.mountpoints.filter(b=>b.startsWith(l)||w&&l.startsWith(b)).map(b=>({relativeBase:l.length>b.length?l.slice(b.length):void 0,mountpoint:b,driver:e.mounts[b]})),i=(l,w)=>{if(e.watching){w=Jr(w);for(const b of e.watchListeners)b(l,w)}},a=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await Cp(e.mounts[l],i,l)}},u=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},f=(l,w,b)=>{const S=new Map,I=M=>{let z=S.get(M.base);return z||(z={driver:M.driver,base:M.base,items:[]},S.set(M.base,z)),z};for(const M of l){const z=typeof M=="string",k=Jr(z?M:M.key),Y=z?void 0:M.value,te=z||!M.options?w:{...w,...M.options},ie=t(k);I(ie).items.push({key:k,value:Y,relativeKey:ie.relativeKey,options:te})}return Promise.all([...S.values()].map(M=>b(M))).then(M=>M.flat())},d={hasItem(l,w={}){l=Jr(l);const{relativeKey:b,driver:S}=t(l);return br(S.hasItem,b,w)},getItem(l,w={}){l=Jr(l);const{relativeKey:b,driver:S}=t(l);return br(S.getItem,b,w).then(I=>bu(I))},getItems(l,w={}){return f(l,w,b=>b.driver.getItems?br(b.driver.getItems,b.items.map(S=>({key:S.relativeKey,options:S.options})),w).then(S=>S.map(I=>({key:A3(b.base,I.key),value:bu(I.value)}))):Promise.all(b.items.map(S=>br(b.driver.getItem,S.relativeKey,S.options).then(I=>({key:S.key,value:bu(I)})))))},getItemRaw(l,w={}){l=Jr(l);const{relativeKey:b,driver:S}=t(l);return S.getItemRaw?br(S.getItemRaw,b,w):br(S.getItem,b,w).then(I=>x3(I))},async setItem(l,w,b={}){if(w===void 0)return d.removeItem(l);l=Jr(l);const{relativeKey:S,driver:I}=t(l);I.setItem&&(await br(I.setItem,S,Mu(w),b),I.watch||i("update",l))},async setItems(l,w){await f(l,w,async b=>{if(b.driver.setItems)return br(b.driver.setItems,b.items.map(S=>({key:S.relativeKey,value:Mu(S.value),options:S.options})),w);b.driver.setItem&&await Promise.all(b.items.map(S=>br(b.driver.setItem,S.relativeKey,Mu(S.value),S.options)))})},async setItemRaw(l,w,b={}){if(w===void 0)return d.removeItem(l,b);l=Jr(l);const{relativeKey:S,driver:I}=t(l);if(I.setItemRaw)await br(I.setItemRaw,S,w,b);else if(I.setItem)await br(I.setItem,S,E3(w),b);else return;I.watch||i("update",l)},async removeItem(l,w={}){typeof w=="boolean"&&(w={removeMeta:w}),l=Jr(l);const{relativeKey:b,driver:S}=t(l);S.removeItem&&(await br(S.removeItem,b,w),(w.removeMeta||w.removeMata)&&await br(S.removeItem,b+"$",w),S.watch||i("remove",l))},async getMeta(l,w={}){typeof w=="boolean"&&(w={nativeOnly:w}),l=Jr(l);const{relativeKey:b,driver:S}=t(l),I=Object.create(null);if(S.getMeta&&Object.assign(I,await br(S.getMeta,b,w)),!w.nativeOnly){const M=await br(S.getItem,b+"$",w).then(z=>bu(z));M&&typeof M=="object"&&(typeof M.atime=="string"&&(M.atime=new Date(M.atime)),typeof M.mtime=="string"&&(M.mtime=new Date(M.mtime)),Object.assign(I,M))}return I},setMeta(l,w,b={}){return this.setItem(l+"$",w,b)},removeMeta(l,w={}){return this.removeItem(l+"$",w)},async getKeys(l,w={}){var k;l=Eu(l);const b=n(l,!0);let S=[];const I=[];let M=!0;for(const Y of b){(k=Y.driver.flags)!=null&&k.maxDepth||(M=!1);const te=await br(Y.driver.getKeys,Y.relativeBase,w);for(const ie of te){const W=Y.mountpoint+Jr(ie);S.some(Z=>W.startsWith(Z))||I.push(W)}S=[Y.mountpoint,...S.filter(ie=>!ie.startsWith(Y.mountpoint))]}const z=w.maxDepth!==void 0&&!M;return I.filter(Y=>(!z||O3(Y,w.maxDepth))&&P3(Y,l))},async clear(l,w={}){l=Eu(l),await Promise.all(n(l,!1).map(async b=>{if(b.driver.clear)return br(b.driver.clear,b.relativeBase,w);if(b.driver.removeItem){const S=await b.driver.getKeys(b.relativeBase||"",w);return Promise.all(S.map(I=>b.driver.removeItem(I,w)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>Rp(l)))},async watch(l){return await a(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(w=>w!==l),e.watchListeners.length===0&&await u()}},async unwatch(){e.watchListeners=[],await u()},mount(l,w){if(l=Eu(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((b,S)=>S.length-b.length)),e.mounts[l]=w,e.watching&&Promise.resolve(Cp(w,i,l)).then(b=>{e.unwatch[l]=b}).catch(console.error),d},async unmount(l,w=!0){var b,S;l=Eu(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&((S=(b=e.unwatch)[l])==null||S.call(b),delete e.unwatch[l]),w&&await Rp(e.mounts[l]),e.mountpoints=e.mountpoints.filter(I=>I!==l),delete e.mounts[l])},getMount(l=""){l=Jr(l)+":";const w=t(l);return{driver:w.driver,base:w.base}},getMounts(l="",w={}){return l=Jr(l),n(l,w.parents).map(S=>({driver:S.driver,base:S.mountpoint}))},keys:(l,w={})=>d.getKeys(l,w),get:(l,w={})=>d.getItem(l,w),set:(l,w,b={})=>d.setItem(l,w,b),has:(l,w={})=>d.hasItem(l,w),del:(l,w={})=>d.removeItem(l,w),remove:(l,w={})=>d.removeItem(l,w)};return d}function Cp(r,e,t){return r.watch?r.watch((n,i)=>e(n,t+i)):()=>{}}async function Rp(r){typeof r.dispose=="function"&&await br(r.dispose)}function Ds(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function dv(r,e){const t=indexedDB.open(r);t.onupgradeneeded=()=>t.result.createObjectStore(e);const n=Ds(t);return(i,a)=>n.then(u=>a(u.transaction(e,i).objectStore(e)))}let Vf;function ua(){return Vf||(Vf=dv("keyval-store","keyval")),Vf}function Np(r,e=ua()){return e("readonly",t=>Ds(t.get(r)))}function C3(r,e,t=ua()){return t("readwrite",n=>(n.put(e,r),Ds(n.transaction)))}function R3(r,e=ua()){return e("readwrite",t=>(t.delete(r),Ds(t.transaction)))}function N3(r=ua()){return r("readwrite",e=>(e.clear(),Ds(e.transaction)))}function T3(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Ds(r.transaction)}function $3(r=ua()){return r("readonly",e=>{if(e.getAllKeys)return Ds(e.getAllKeys());const t=[];return T3(e,n=>t.push(n.key)).then(()=>t)})}const F3=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),U3=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(n,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function xs(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return U3(r)}catch{return r}}function xi(r){return typeof r=="string"?r:F3(r)||""}const q3="idb-keyval";var j3=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=i=>e+i;let n;return r.dbName&&r.storeName&&(n=dv(r.dbName,r.storeName)),{name:q3,options:r,async hasItem(i){return!(typeof await Np(t(i),n)>"u")},async getItem(i){return await Np(t(i),n)??null},setItem(i,a){return C3(t(i),a,n)},removeItem(i){return R3(t(i),n)},getKeys(){return $3(n)},clear(){return N3(n)}}};const B3="WALLET_CONNECT_V2_INDEXED_DB",K3="keyvaluestorage";let z3=class{constructor(){this.indexedDb=L3({driver:j3({dbName:B3,storeName:K3})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,xi(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Jf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Je<"u"?Je:typeof self<"u"?self:{},Lu={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,n){this[t]=String(n)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Jf<"u"&&Jf.localStorage?Lu.exports=Jf.localStorage:typeof window<"u"&&window.localStorage?Lu.exports=window.localStorage:Lu.exports=new e})();function H3(r){var e;return[r[0],xs((e=r[1])!=null?e:"")]}let k3=class{constructor(){this.localStorage=Lu.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(H3)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return xs(t)}async setItem(e,t){this.localStorage.setItem(e,xi(t))}async removeItem(e){this.localStorage.removeItem(e)}};const W3="wc_storage_version",Tp=1,G3=async(r,e,t)=>{const n=W3,i=await e.getItem(n);if(i&&i>=Tp){t(e);return}const a=await r.getKeys();if(!a.length){t(e);return}const u=[];for(;a.length;){const f=a.shift();if(!f)continue;const d=f.toLowerCase();if(d.includes("wc@")||d.includes("walletconnect")||d.includes("wc_")||d.includes("wallet_connect")){const l=await r.getItem(f);await e.setItem(f,l),u.push(f)}}await e.setItem(n,Tp),t(e),V3(r,u)},V3=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let J3=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new k3;this.storage=e;try{const t=new z3;G3(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};function Y3(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var X3=Z3;function Z3(r,e,t){var n=t&&t.stringify||Y3,i=1;if(typeof r=="object"&&r!==null){var a=e.length+i;if(a===1)return r;var u=new Array(a);u[0]=n(r);for(var f=1;f<a;f++)u[f]=n(e[f]);return u.join(" ")}if(typeof r!="string")return r;var d=e.length;if(d===0)return r;for(var l="",w=1-i,b=-1,S=r&&r.length||0,I=0;I<S;){if(r.charCodeAt(I)===37&&I+1<S){switch(b=b>-1?b:0,r.charCodeAt(I+1)){case 100:case 102:if(w>=d||e[w]==null)break;b<I&&(l+=r.slice(b,I)),l+=Number(e[w]),b=I+2,I++;break;case 105:if(w>=d||e[w]==null)break;b<I&&(l+=r.slice(b,I)),l+=Math.floor(Number(e[w])),b=I+2,I++;break;case 79:case 111:case 106:if(w>=d||e[w]===void 0)break;b<I&&(l+=r.slice(b,I));var M=typeof e[w];if(M==="string"){l+="'"+e[w]+"'",b=I+2,I++;break}if(M==="function"){l+=e[w].name||"<anonymous>",b=I+2,I++;break}l+=n(e[w]),b=I+2,I++;break;case 115:if(w>=d)break;b<I&&(l+=r.slice(b,I)),l+=String(e[w]),b=I+2,I++;break;case 37:b<I&&(l+=r.slice(b,I)),l+="%",b=I+2,I++,w--;break}++w}++I}return b===-1?r:(b<S&&(l+=r.slice(b)),l)}const $p=X3;var to=ri;const ra=u6().console||{},Q3={mapHttpRequest:xu,mapHttpResponse:xu,wrapRequestSerializer:Yf,wrapResponseSerializer:Yf,wrapErrorSerializer:Yf,req:xu,res:xu,err:i6};function e6(r,e){return Array.isArray(r)?r.filter(function(n){return n!=="!stdSerializers.err"}):r===!0?Object.keys(e):!1}function ri(r){r=r||{},r.browser=r.browser||{};const e=r.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=r.browser.write||ra;r.browser.write&&(r.browser.asObject=!0);const n=r.serializers||{},i=e6(r.browser.serialize,n);let a=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1);const u=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),r.enabled===!1&&(r.level="silent");const f=r.level||"info",d=Object.create(t);d.log||(d.log=na),Object.defineProperty(d,"levelVal",{get:w}),Object.defineProperty(d,"level",{get:b,set:S});const l={transmit:e,serialize:i,asObject:r.browser.asObject,levels:u,timestamp:s6(r)};d.levels=ri.levels,d.level=f,d.setMaxListeners=d.getMaxListeners=d.emit=d.addListener=d.on=d.prependListener=d.once=d.prependOnceListener=d.removeListener=d.removeAllListeners=d.listeners=d.listenerCount=d.eventNames=d.write=d.flush=na,d.serializers=n,d._serialize=i,d._stdErrSerialize=a,d.child=I,e&&(d._logEvent=wh());function w(){return this.level==="silent"?1/0:this.levels.values[this.level]}function b(){return this._level}function S(M){if(M!=="silent"&&!this.levels.values[M])throw Error("unknown level "+M);this._level=M,Zs(l,d,"error","log"),Zs(l,d,"fatal","error"),Zs(l,d,"warn","error"),Zs(l,d,"info","log"),Zs(l,d,"debug","log"),Zs(l,d,"trace","log")}function I(M,z){if(!M)throw new Error("missing bindings for child Pino");z=z||{},i&&M.serializers&&(z.serializers=M.serializers);const k=z.serializers;if(i&&k){var Y=Object.assign({},n,k),te=r.browser.serialize===!0?Object.keys(Y):i;delete M.serializers,lc([M],te,Y,this._stdErrSerialize)}function ie(W){this._childLevel=(W._childLevel|0)+1,this.error=Qs(W,M,"error"),this.fatal=Qs(W,M,"fatal"),this.warn=Qs(W,M,"warn"),this.info=Qs(W,M,"info"),this.debug=Qs(W,M,"debug"),this.trace=Qs(W,M,"trace"),Y&&(this.serializers=Y,this._serialize=te),e&&(this._logEvent=wh([].concat(W._logEvent.bindings,M)))}return ie.prototype=this,new ie(this)}return d}ri.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};ri.stdSerializers=Q3;ri.stdTimeFunctions=Object.assign({},{nullTime:pv,epochTime:gv,unixTime:o6,isoTime:a6});function Zs(r,e,t,n){const i=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?na:i[t]?i[t]:ra[t]||ra[n]||na,t6(r,e,t)}function t6(r,e,t){!r.transmit&&e[t]===na||(e[t]=function(n){return function(){const a=r.timestamp(),u=new Array(arguments.length),f=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ra?ra:this;for(var d=0;d<u.length;d++)u[d]=arguments[d];if(r.serialize&&!r.asObject&&lc(u,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?n.call(f,r6(this,t,u,a)):n.apply(f,u),r.transmit){const l=r.transmit.level||e.level,w=ri.levels.values[l],b=ri.levels.values[t];if(b<w)return;n6(this,{ts:a,methodLevel:t,methodValue:b,transmitValue:ri.levels.values[r.transmit.level||e.level],send:r.transmit.send,val:e.levelVal},u)}}}(e[t]))}function r6(r,e,t,n){r._serialize&&lc(t,r._serialize,r.serializers,r._stdErrSerialize);const i=t.slice();let a=i[0];const u={};n&&(u.time=n),u.level=ri.levels.values[e];let f=(r._childLevel|0)+1;if(f<1&&(f=1),a!==null&&typeof a=="object"){for(;f--&&typeof i[0]=="object";)Object.assign(u,i.shift());a=i.length?$p(i.shift(),i):void 0}else typeof a=="string"&&(a=$p(i.shift(),i));return a!==void 0&&(u.msg=a),u}function lc(r,e,t,n){for(const i in r)if(n&&r[i]instanceof Error)r[i]=ri.stdSerializers.err(r[i]);else if(typeof r[i]=="object"&&!Array.isArray(r[i]))for(const a in r[i])e&&e.indexOf(a)>-1&&a in t&&(r[i][a]=t[a](r[i][a]))}function Qs(r,e,t){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return r[t].apply(this,n)}}function n6(r,e,t){const n=e.send,i=e.ts,a=e.methodLevel,u=e.methodValue,f=e.val,d=r._logEvent.bindings;lc(t,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=i,r._logEvent.messages=t.filter(function(l){return d.indexOf(l)===-1}),r._logEvent.level.label=a,r._logEvent.level.value=u,n(a,r._logEvent,f),r._logEvent=wh(d)}function wh(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function i6(r){const e={type:r.constructor.name,msg:r.message,stack:r.stack};for(const t in r)e[t]===void 0&&(e[t]=r[t]);return e}function s6(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?pv:gv}function xu(){return{}}function Yf(r){return r}function na(){}function pv(){return!1}function gv(){return Date.now()}function o6(){return Math.round(Date.now()/1e3)}function a6(){return new Date(Date.now()).toISOString()}function u6(){function r(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}const ca=As(to),c6={level:"info"},fa="custom_context",Kh=1e3*1024;let f6=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Fp=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new f6(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},vv=class{constructor(e,t=Kh){this.level=e??"error",this.levelValue=to.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new Fp(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===to.levels.values.error?console.error(e):t===to.levels.values.warn?console.warn(e):t===to.levels.values.debug?console.debug(e):t===to.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(xi({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new Fp(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(xi({extraMetadata:e})),new Blob(t,{type:"application/json"})}},h6=class{constructor(e,t=Kh){this.baseChunkLogger=new vv(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=t,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}},l6=class{constructor(e,t=Kh){this.baseChunkLogger=new vv(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var d6=Object.defineProperty,p6=Object.defineProperties,g6=Object.getOwnPropertyDescriptors,Up=Object.getOwnPropertySymbols,v6=Object.prototype.hasOwnProperty,m6=Object.prototype.propertyIsEnumerable,qp=(r,e,t)=>e in r?d6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Gu=(r,e)=>{for(var t in e||(e={}))v6.call(e,t)&&qp(r,t,e[t]);if(Up)for(var t of Up(e))m6.call(e,t)&&qp(r,t,e[t]);return r},Vu=(r,e)=>p6(r,g6(e));function dc(r){return Vu(Gu({},r),{level:(r==null?void 0:r.level)||c6.level})}function y6(r,e=fa){return r[e]||""}function w6(r,e,t=fa){return r[t]=e,r}function Zr(r,e=fa){let t="";return typeof r.bindings>"u"?t=y6(r,e):t=r.bindings().context||"",t}function _6(r,e,t=fa){const n=Zr(r,t);return n.trim()?`${n}/${e}`:e}function zr(r,e,t=fa){const n=_6(r,e,t),i=r.child({context:n});return w6(i,n,t)}function b6(r){var e,t;const n=new h6((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:ca(Vu(Gu({},r.opts),{level:"trace",browser:Vu(Gu({},(t=r.opts)==null?void 0:t.browser),{write:i=>n.write(i)})})),chunkLoggerController:n}}function E6(r){var e;const t=new l6((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:ca(Vu(Gu({},r.opts),{level:"trace"}),t),chunkLoggerController:t}}function x6(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?b6(r):E6(r)}var mv={exports:{}},oo=typeof Reflect=="object"?Reflect:null,jp=oo&&typeof oo.apply=="function"?oo.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Cu;oo&&typeof oo.ownKeys=="function"?Cu=oo.ownKeys:Object.getOwnPropertySymbols?Cu=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Cu=function(e){return Object.getOwnPropertyNames(e)};function S6(r){console&&console.warn&&console.warn(r)}var yv=Number.isNaN||function(e){return e!==e};function qt(){qt.init.call(this)}mv.exports=qt;mv.exports.once=P6;qt.EventEmitter=qt;qt.prototype._events=void 0;qt.prototype._eventsCount=0;qt.prototype._maxListeners=void 0;var Bp=10;function pc(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(qt,"defaultMaxListeners",{enumerable:!0,get:function(){return Bp},set:function(r){if(typeof r!="number"||r<0||yv(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Bp=r}});qt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};qt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||yv(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function wv(r){return r._maxListeners===void 0?qt.defaultMaxListeners:r._maxListeners}qt.prototype.getMaxListeners=function(){return wv(this)};qt.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var f=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw f.context=u,f}var d=a[e];if(d===void 0)return!1;if(typeof d=="function")jp(d,this,t);else for(var l=d.length,w=Sv(d,l),n=0;n<l;++n)jp(w[n],this,t);return!0};function _v(r,e,t,n){var i,a,u;if(pc(t),a=r._events,a===void 0?(a=r._events=Object.create(null),r._eventsCount=0):(a.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),u=a[e]),u===void 0)u=a[e]=t,++r._eventsCount;else if(typeof u=="function"?u=a[e]=n?[t,u]:[u,t]:n?u.unshift(t):u.push(t),i=wv(r),i>0&&u.length>i&&!u.warned){u.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=r,f.type=e,f.count=u.length,S6(f)}return r}qt.prototype.addListener=function(e,t){return _v(this,e,t,!1)};qt.prototype.on=qt.prototype.addListener;qt.prototype.prependListener=function(e,t){return _v(this,e,t,!0)};function I6(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function bv(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=I6.bind(n);return i.listener=t,n.wrapFn=i,i}qt.prototype.once=function(e,t){return pc(t),this.on(e,bv(this,e,t)),this};qt.prototype.prependOnceListener=function(e,t){return pc(t),this.prependListener(e,bv(this,e,t)),this};qt.prototype.removeListener=function(e,t){var n,i,a,u,f;if(pc(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(a=-1,u=n.length-1;u>=0;u--)if(n[u]===t||n[u].listener===t){f=n[u].listener,a=u;break}if(a<0)return this;a===0?n.shift():A6(n,a),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,f||t)}return this};qt.prototype.off=qt.prototype.removeListener;qt.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),u;for(i=0;i<a.length;++i)u=a[i],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Ev(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?O6(i):Sv(i,i.length)}qt.prototype.listeners=function(e){return Ev(this,e,!0)};qt.prototype.rawListeners=function(e){return Ev(this,e,!1)};qt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):xv.call(r,e)};qt.prototype.listenerCount=xv;function xv(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}qt.prototype.eventNames=function(){return this._eventsCount>0?Cu(this._events):[]};function Sv(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function A6(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function O6(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function P6(r,e){return new Promise(function(t,n){function i(u){r.removeListener(e,a),n(u)}function a(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}Iv(r,e,a,{once:!0}),e!=="error"&&D6(r,i,{once:!0})})}function D6(r,e,t){typeof r.on=="function"&&Iv(r,"error",e,t)}function Iv(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(a){n.once&&r.removeEventListener(e,i),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}let M6=class extends Ps{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}},L6=class extends Ps{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}};class C6{constructor(e,t){this.logger=e,this.core=t}}let R6=class extends Ps{constructor(e,t){super(),this.relayer=e,this.logger=t}},N6=class extends Ps{constructor(e){super()}},T6=class{constructor(e,t,n,i){this.core=e,this.logger=t,this.name=n}},$6=class extends Ps{constructor(e,t){super(),this.relayer=e,this.logger=t}},F6=class extends Ps{constructor(e,t){super(),this.core=e,this.logger=t}},U6=class{constructor(e,t,n){this.core=e,this.logger=t,this.store=n}},q6=class{constructor(e,t){this.projectId=e,this.logger=t}},j6=class{constructor(e,t,n){this.core=e,this.logger=t,this.telemetryEnabled=n}},B6=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},K6=class{constructor(e){this.client=e}};var zh={},Hi={},gc={},vc={};Object.defineProperty(vc,"__esModule",{value:!0});vc.BrowserRandomSource=void 0;const Kp=65536;class z6{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let n=0;n<t.length;n+=Kp)this._crypto.getRandomValues(t.subarray(n,n+Math.min(t.length-n,Kp)));return t}}vc.BrowserRandomSource=z6;var mc={},fn={};Object.defineProperty(fn,"__esModule",{value:!0});function H6(r){for(var e=0;e<r.length;e++)r[e]=0;return r}fn.wipe=H6;Object.defineProperty(mc,"__esModule",{value:!0});mc.NodeRandomSource=void 0;const k6=fn;class W6{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof bx<"u"){const e=Gg;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=t[i];return(0,k6.wipe)(t),n}}mc.NodeRandomSource=W6;Object.defineProperty(gc,"__esModule",{value:!0});gc.SystemRandomSource=void 0;const G6=vc,V6=mc;class J6{constructor(){if(this.isAvailable=!1,this.name="",this._source=new G6.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new V6.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}gc.SystemRandomSource=J6;var ot={},Av={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});function e(f,d){var l=f>>>16&65535,w=f&65535,b=d>>>16&65535,S=d&65535;return w*S+(l*S+w*b<<16>>>0)|0}r.mul=Math.imul||e;function t(f,d){return f+d|0}r.add=t;function n(f,d){return f-d|0}r.sub=n;function i(f,d){return f<<d|f>>>32-d}r.rotl=i;function a(f,d){return f<<32-d|f>>>d}r.rotr=a;function u(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}r.isInteger=Number.isInteger||u,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(f){return r.isInteger(f)&&f>=-r.MAX_SAFE_INTEGER&&f<=r.MAX_SAFE_INTEGER}})(Av);Object.defineProperty(ot,"__esModule",{value:!0});var Ov=Av;function Y6(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}ot.readInt16BE=Y6;function X6(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}ot.readUint16BE=X6;function Z6(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}ot.readInt16LE=Z6;function Q6(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}ot.readUint16LE=Q6;function Pv(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}ot.writeUint16BE=Pv;ot.writeInt16BE=Pv;function Dv(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}ot.writeUint16LE=Dv;ot.writeInt16LE=Dv;function _h(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}ot.readInt32BE=_h;function bh(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}ot.readUint32BE=bh;function Eh(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}ot.readInt32LE=Eh;function xh(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}ot.readUint32LE=xh;function Ju(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}ot.writeUint32BE=Ju;ot.writeInt32BE=Ju;function Yu(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}ot.writeUint32LE=Yu;ot.writeInt32LE=Yu;function eS(r,e){e===void 0&&(e=0);var t=_h(r,e),n=_h(r,e+4);return t*4294967296+n-(n>>31)*4294967296}ot.readInt64BE=eS;function tS(r,e){e===void 0&&(e=0);var t=bh(r,e),n=bh(r,e+4);return t*4294967296+n}ot.readUint64BE=tS;function rS(r,e){e===void 0&&(e=0);var t=Eh(r,e),n=Eh(r,e+4);return n*4294967296+t-(t>>31)*4294967296}ot.readInt64LE=rS;function nS(r,e){e===void 0&&(e=0);var t=xh(r,e),n=xh(r,e+4);return n*4294967296+t}ot.readUint64LE=nS;function Mv(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Ju(r/4294967296>>>0,e,t),Ju(r>>>0,e,t+4),e}ot.writeUint64BE=Mv;ot.writeInt64BE=Mv;function Lv(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Yu(r>>>0,e,t),Yu(r/4294967296>>>0,e,t+4),e}ot.writeUint64LE=Lv;ot.writeInt64LE=Lv;function iS(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,a=r/8+t-1;a>=t;a--)n+=e[a]*i,i*=256;return n}ot.readUintBE=iS;function sS(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,a=t;a<t+r/8;a++)n+=e[a]*i,i*=256;return n}ot.readUintLE=sS;function oS(r,e,t,n){if(t===void 0&&(t=new Uint8Array(r/8)),n===void 0&&(n=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ov.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,a=r/8+n-1;a>=n;a--)t[a]=e/i&255,i*=256;return t}ot.writeUintBE=oS;function aS(r,e,t,n){if(t===void 0&&(t=new Uint8Array(r/8)),n===void 0&&(n=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ov.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,a=n;a<n+r/8;a++)t[a]=e/i&255,i*=256;return t}ot.writeUintLE=aS;function uS(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}ot.readFloat32BE=uS;function cS(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}ot.readFloat32LE=cS;function fS(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}ot.readFloat64BE=fS;function hS(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}ot.readFloat64LE=hS;function lS(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(t,r),e}ot.writeFloat32BE=lS;function dS(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(t,r,!0),e}ot.writeFloat32LE=dS;function pS(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(t,r),e}ot.writeFloat64BE=pS;function gS(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(t,r,!0),e}ot.writeFloat64LE=gS;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const e=gc,t=ot,n=fn;r.defaultRandomSource=new e.SystemRandomSource;function i(l,w=r.defaultRandomSource){return w.randomBytes(l)}r.randomBytes=i;function a(l=r.defaultRandomSource){const w=i(4,l),b=(0,t.readUint32LE)(w);return(0,n.wipe)(w),b}r.randomUint32=a;const u="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(l,w=u,b=r.defaultRandomSource){if(w.length<2)throw new Error("randomString charset is too short");if(w.length>256)throw new Error("randomString charset is too long");let S="";const I=w.length,M=256-256%I;for(;l>0;){const z=i(Math.ceil(l*256/M),b);for(let k=0;k<z.length&&l>0;k++){const Y=z[k];Y<M&&(S+=w.charAt(Y%I),l--)}(0,n.wipe)(z)}return S}r.randomString=f;function d(l,w=u,b=r.defaultRandomSource){const S=Math.ceil(l/(Math.log(w.length)/Math.LN2));return f(S,w,b)}r.randomStringForEntropy=d})(Hi);var Cv={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ot,t=fn;r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var n=function(){function f(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(d,l){if(l===void 0&&(l=d.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var w=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&l>0;)this._buffer[this._bufferLength++]=d[w++],l--;this._bufferLength===this.blockSize&&(a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(w=a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,d,w,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=d[w++],l--;return this},f.prototype.finish=function(d){if(!this._finished){var l=this._bytesHashed,w=this._bufferLength,b=l/536870912|0,S=l<<3,I=l%128<112?128:256;this._buffer[w]=128;for(var M=w+1;M<I-8;M++)this._buffer[M]=0;e.writeUint32BE(b,this._buffer,I-8),e.writeUint32BE(S,this._buffer,I-4),a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,I),this._finished=!0}for(var M=0;M<this.digestLength/8;M++)e.writeUint32BE(this._stateHi[M],d,M*8),e.writeUint32BE(this._stateLo[M],d,M*8+4);return this},f.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(d){return this._stateHi.set(d.stateHi),this._stateLo.set(d.stateLo),this._bufferLength=d.bufferLength,d.buffer&&this._buffer.set(d.buffer),this._bytesHashed=d.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(d){t.wipe(d.stateHi),t.wipe(d.stateLo),d.buffer&&t.wipe(d.buffer),d.bufferLength=0,d.bytesHashed=0},f}();r.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function a(f,d,l,w,b,S,I){for(var M=l[0],z=l[1],k=l[2],Y=l[3],te=l[4],ie=l[5],W=l[6],Z=l[7],V=w[0],y=w[1],B=w[2],he=w[3],de=w[4],pe=w[5],Ee=w[6],$=w[7],h,v,x,P,A,R,j,O;I>=128;){for(var m=0;m<16;m++){var L=8*m+S;f[m]=e.readUint32BE(b,L),d[m]=e.readUint32BE(b,L+4)}for(var m=0;m<80;m++){var ce=M,_=z,G=k,U=Y,T=te,F=ie,g=W,N=Z,ee=V,le=y,se=B,ve=he,et=de,Ae=pe,qe=Ee,bt=$;if(h=Z,v=$,A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=(te>>>14|de<<18)^(te>>>18|de<<14)^(de>>>9|te<<23),v=(de>>>14|te<<18)^(de>>>18|te<<14)^(te>>>9|de<<23),A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,h=te&ie^~te&W,v=de&pe^~de&Ee,A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,h=i[m*2],v=i[m*2+1],A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,h=f[m%16],v=d[m%16],A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,x=j&65535|O<<16,P=A&65535|R<<16,h=x,v=P,A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=(M>>>28|V<<4)^(V>>>2|M<<30)^(V>>>7|M<<25),v=(V>>>28|M<<4)^(M>>>2|V<<30)^(M>>>7|V<<25),A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,h=M&z^M&k^z&k,v=V&y^V&B^y&B,A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,N=j&65535|O<<16,bt=A&65535|R<<16,h=U,v=ve,A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=x,v=P,A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,U=j&65535|O<<16,ve=A&65535|R<<16,z=ce,k=_,Y=G,te=U,ie=T,W=F,Z=g,M=N,y=ee,B=le,he=se,de=ve,pe=et,Ee=Ae,$=qe,V=bt,m%16===15)for(var L=0;L<16;L++)h=f[L],v=d[L],A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=f[(L+9)%16],v=d[(L+9)%16],A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,x=f[(L+1)%16],P=d[(L+1)%16],h=(x>>>1|P<<31)^(x>>>8|P<<24)^x>>>7,v=(P>>>1|x<<31)^(P>>>8|x<<24)^(P>>>7|x<<25),A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,x=f[(L+14)%16],P=d[(L+14)%16],h=(x>>>19|P<<13)^(P>>>29|x<<3)^x>>>6,v=(P>>>19|x<<13)^(x>>>29|P<<3)^(P>>>6|x<<26),A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,f[L]=j&65535|O<<16,d[L]=A&65535|R<<16}h=M,v=V,A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=l[0],v=w[0],A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,l[0]=M=j&65535|O<<16,w[0]=V=A&65535|R<<16,h=z,v=y,A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=l[1],v=w[1],A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,l[1]=z=j&65535|O<<16,w[1]=y=A&65535|R<<16,h=k,v=B,A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=l[2],v=w[2],A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,l[2]=k=j&65535|O<<16,w[2]=B=A&65535|R<<16,h=Y,v=he,A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=l[3],v=w[3],A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,l[3]=Y=j&65535|O<<16,w[3]=he=A&65535|R<<16,h=te,v=de,A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=l[4],v=w[4],A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,l[4]=te=j&65535|O<<16,w[4]=de=A&65535|R<<16,h=ie,v=pe,A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=l[5],v=w[5],A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,l[5]=ie=j&65535|O<<16,w[5]=pe=A&65535|R<<16,h=W,v=Ee,A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=l[6],v=w[6],A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,l[6]=W=j&65535|O<<16,w[6]=Ee=A&65535|R<<16,h=Z,v=$,A=v&65535,R=v>>>16,j=h&65535,O=h>>>16,h=l[7],v=w[7],A+=v&65535,R+=v>>>16,j+=h&65535,O+=h>>>16,R+=A>>>16,j+=R>>>16,O+=j>>>16,l[7]=Z=j&65535|O<<16,w[7]=$=A&65535|R<<16,S+=128,I-=128}return S}function u(f){var d=new n;d.update(f);var l=d.digest();return d.clean(),l}r.hash=u})(Cv);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const e=Hi,t=Cv,n=fn;r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function i(U){const T=new Float64Array(16);if(U)for(let F=0;F<U.length;F++)T[F]=U[F];return T}const a=new Uint8Array(32);a[0]=9;const u=i(),f=i([1]),d=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),w=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),b=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),S=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function I(U,T){for(let F=0;F<16;F++)U[F]=T[F]|0}function M(U){let T=1;for(let F=0;F<16;F++){let g=U[F]+T+65535;T=Math.floor(g/65536),U[F]=g-T*65536}U[0]+=T-1+37*(T-1)}function z(U,T,F){const g=~(F-1);for(let N=0;N<16;N++){const ee=g&(U[N]^T[N]);U[N]^=ee,T[N]^=ee}}function k(U,T){const F=i(),g=i();for(let N=0;N<16;N++)g[N]=T[N];M(g),M(g),M(g);for(let N=0;N<2;N++){F[0]=g[0]-65517;for(let le=1;le<15;le++)F[le]=g[le]-65535-(F[le-1]>>16&1),F[le-1]&=65535;F[15]=g[15]-32767-(F[14]>>16&1);const ee=F[15]>>16&1;F[14]&=65535,z(g,F,1-ee)}for(let N=0;N<16;N++)U[2*N]=g[N]&255,U[2*N+1]=g[N]>>8}function Y(U,T){let F=0;for(let g=0;g<32;g++)F|=U[g]^T[g];return(1&F-1>>>8)-1}function te(U,T){const F=new Uint8Array(32),g=new Uint8Array(32);return k(F,U),k(g,T),Y(F,g)}function ie(U){const T=new Uint8Array(32);return k(T,U),T[0]&1}function W(U,T){for(let F=0;F<16;F++)U[F]=T[2*F]+(T[2*F+1]<<8);U[15]&=32767}function Z(U,T,F){for(let g=0;g<16;g++)U[g]=T[g]+F[g]}function V(U,T,F){for(let g=0;g<16;g++)U[g]=T[g]-F[g]}function y(U,T,F){let g,N,ee=0,le=0,se=0,ve=0,et=0,Ae=0,qe=0,bt=0,Pe=0,_e=0,je=0,xe=0,De=0,Te=0,Se=0,ye=0,$e=0,Me=0,be=0,tt=0,Le=0,Re=0,st=0,Ce=0,at=0,nr=0,gt=0,ut=0,Ar=0,wt=0,_t=0,St=F[0],Be=F[1],We=F[2],It=F[3],ke=F[4],Ke=F[5],Rt=F[6],Ze=F[7],Ge=F[8],Nt=F[9],Ve=F[10],Ye=F[11],At=F[12],Fe=F[13],Qe=F[14],Tt=F[15];g=T[0],ee+=g*St,le+=g*Be,se+=g*We,ve+=g*It,et+=g*ke,Ae+=g*Ke,qe+=g*Rt,bt+=g*Ze,Pe+=g*Ge,_e+=g*Nt,je+=g*Ve,xe+=g*Ye,De+=g*At,Te+=g*Fe,Se+=g*Qe,ye+=g*Tt,g=T[1],le+=g*St,se+=g*Be,ve+=g*We,et+=g*It,Ae+=g*ke,qe+=g*Ke,bt+=g*Rt,Pe+=g*Ze,_e+=g*Ge,je+=g*Nt,xe+=g*Ve,De+=g*Ye,Te+=g*At,Se+=g*Fe,ye+=g*Qe,$e+=g*Tt,g=T[2],se+=g*St,ve+=g*Be,et+=g*We,Ae+=g*It,qe+=g*ke,bt+=g*Ke,Pe+=g*Rt,_e+=g*Ze,je+=g*Ge,xe+=g*Nt,De+=g*Ve,Te+=g*Ye,Se+=g*At,ye+=g*Fe,$e+=g*Qe,Me+=g*Tt,g=T[3],ve+=g*St,et+=g*Be,Ae+=g*We,qe+=g*It,bt+=g*ke,Pe+=g*Ke,_e+=g*Rt,je+=g*Ze,xe+=g*Ge,De+=g*Nt,Te+=g*Ve,Se+=g*Ye,ye+=g*At,$e+=g*Fe,Me+=g*Qe,be+=g*Tt,g=T[4],et+=g*St,Ae+=g*Be,qe+=g*We,bt+=g*It,Pe+=g*ke,_e+=g*Ke,je+=g*Rt,xe+=g*Ze,De+=g*Ge,Te+=g*Nt,Se+=g*Ve,ye+=g*Ye,$e+=g*At,Me+=g*Fe,be+=g*Qe,tt+=g*Tt,g=T[5],Ae+=g*St,qe+=g*Be,bt+=g*We,Pe+=g*It,_e+=g*ke,je+=g*Ke,xe+=g*Rt,De+=g*Ze,Te+=g*Ge,Se+=g*Nt,ye+=g*Ve,$e+=g*Ye,Me+=g*At,be+=g*Fe,tt+=g*Qe,Le+=g*Tt,g=T[6],qe+=g*St,bt+=g*Be,Pe+=g*We,_e+=g*It,je+=g*ke,xe+=g*Ke,De+=g*Rt,Te+=g*Ze,Se+=g*Ge,ye+=g*Nt,$e+=g*Ve,Me+=g*Ye,be+=g*At,tt+=g*Fe,Le+=g*Qe,Re+=g*Tt,g=T[7],bt+=g*St,Pe+=g*Be,_e+=g*We,je+=g*It,xe+=g*ke,De+=g*Ke,Te+=g*Rt,Se+=g*Ze,ye+=g*Ge,$e+=g*Nt,Me+=g*Ve,be+=g*Ye,tt+=g*At,Le+=g*Fe,Re+=g*Qe,st+=g*Tt,g=T[8],Pe+=g*St,_e+=g*Be,je+=g*We,xe+=g*It,De+=g*ke,Te+=g*Ke,Se+=g*Rt,ye+=g*Ze,$e+=g*Ge,Me+=g*Nt,be+=g*Ve,tt+=g*Ye,Le+=g*At,Re+=g*Fe,st+=g*Qe,Ce+=g*Tt,g=T[9],_e+=g*St,je+=g*Be,xe+=g*We,De+=g*It,Te+=g*ke,Se+=g*Ke,ye+=g*Rt,$e+=g*Ze,Me+=g*Ge,be+=g*Nt,tt+=g*Ve,Le+=g*Ye,Re+=g*At,st+=g*Fe,Ce+=g*Qe,at+=g*Tt,g=T[10],je+=g*St,xe+=g*Be,De+=g*We,Te+=g*It,Se+=g*ke,ye+=g*Ke,$e+=g*Rt,Me+=g*Ze,be+=g*Ge,tt+=g*Nt,Le+=g*Ve,Re+=g*Ye,st+=g*At,Ce+=g*Fe,at+=g*Qe,nr+=g*Tt,g=T[11],xe+=g*St,De+=g*Be,Te+=g*We,Se+=g*It,ye+=g*ke,$e+=g*Ke,Me+=g*Rt,be+=g*Ze,tt+=g*Ge,Le+=g*Nt,Re+=g*Ve,st+=g*Ye,Ce+=g*At,at+=g*Fe,nr+=g*Qe,gt+=g*Tt,g=T[12],De+=g*St,Te+=g*Be,Se+=g*We,ye+=g*It,$e+=g*ke,Me+=g*Ke,be+=g*Rt,tt+=g*Ze,Le+=g*Ge,Re+=g*Nt,st+=g*Ve,Ce+=g*Ye,at+=g*At,nr+=g*Fe,gt+=g*Qe,ut+=g*Tt,g=T[13],Te+=g*St,Se+=g*Be,ye+=g*We,$e+=g*It,Me+=g*ke,be+=g*Ke,tt+=g*Rt,Le+=g*Ze,Re+=g*Ge,st+=g*Nt,Ce+=g*Ve,at+=g*Ye,nr+=g*At,gt+=g*Fe,ut+=g*Qe,Ar+=g*Tt,g=T[14],Se+=g*St,ye+=g*Be,$e+=g*We,Me+=g*It,be+=g*ke,tt+=g*Ke,Le+=g*Rt,Re+=g*Ze,st+=g*Ge,Ce+=g*Nt,at+=g*Ve,nr+=g*Ye,gt+=g*At,ut+=g*Fe,Ar+=g*Qe,wt+=g*Tt,g=T[15],ye+=g*St,$e+=g*Be,Me+=g*We,be+=g*It,tt+=g*ke,Le+=g*Ke,Re+=g*Rt,st+=g*Ze,Ce+=g*Ge,at+=g*Nt,nr+=g*Ve,gt+=g*Ye,ut+=g*At,Ar+=g*Fe,wt+=g*Qe,_t+=g*Tt,ee+=38*$e,le+=38*Me,se+=38*be,ve+=38*tt,et+=38*Le,Ae+=38*Re,qe+=38*st,bt+=38*Ce,Pe+=38*at,_e+=38*nr,je+=38*gt,xe+=38*ut,De+=38*Ar,Te+=38*wt,Se+=38*_t,N=1,g=ee+N+65535,N=Math.floor(g/65536),ee=g-N*65536,g=le+N+65535,N=Math.floor(g/65536),le=g-N*65536,g=se+N+65535,N=Math.floor(g/65536),se=g-N*65536,g=ve+N+65535,N=Math.floor(g/65536),ve=g-N*65536,g=et+N+65535,N=Math.floor(g/65536),et=g-N*65536,g=Ae+N+65535,N=Math.floor(g/65536),Ae=g-N*65536,g=qe+N+65535,N=Math.floor(g/65536),qe=g-N*65536,g=bt+N+65535,N=Math.floor(g/65536),bt=g-N*65536,g=Pe+N+65535,N=Math.floor(g/65536),Pe=g-N*65536,g=_e+N+65535,N=Math.floor(g/65536),_e=g-N*65536,g=je+N+65535,N=Math.floor(g/65536),je=g-N*65536,g=xe+N+65535,N=Math.floor(g/65536),xe=g-N*65536,g=De+N+65535,N=Math.floor(g/65536),De=g-N*65536,g=Te+N+65535,N=Math.floor(g/65536),Te=g-N*65536,g=Se+N+65535,N=Math.floor(g/65536),Se=g-N*65536,g=ye+N+65535,N=Math.floor(g/65536),ye=g-N*65536,ee+=N-1+37*(N-1),N=1,g=ee+N+65535,N=Math.floor(g/65536),ee=g-N*65536,g=le+N+65535,N=Math.floor(g/65536),le=g-N*65536,g=se+N+65535,N=Math.floor(g/65536),se=g-N*65536,g=ve+N+65535,N=Math.floor(g/65536),ve=g-N*65536,g=et+N+65535,N=Math.floor(g/65536),et=g-N*65536,g=Ae+N+65535,N=Math.floor(g/65536),Ae=g-N*65536,g=qe+N+65535,N=Math.floor(g/65536),qe=g-N*65536,g=bt+N+65535,N=Math.floor(g/65536),bt=g-N*65536,g=Pe+N+65535,N=Math.floor(g/65536),Pe=g-N*65536,g=_e+N+65535,N=Math.floor(g/65536),_e=g-N*65536,g=je+N+65535,N=Math.floor(g/65536),je=g-N*65536,g=xe+N+65535,N=Math.floor(g/65536),xe=g-N*65536,g=De+N+65535,N=Math.floor(g/65536),De=g-N*65536,g=Te+N+65535,N=Math.floor(g/65536),Te=g-N*65536,g=Se+N+65535,N=Math.floor(g/65536),Se=g-N*65536,g=ye+N+65535,N=Math.floor(g/65536),ye=g-N*65536,ee+=N-1+37*(N-1),U[0]=ee,U[1]=le,U[2]=se,U[3]=ve,U[4]=et,U[5]=Ae,U[6]=qe,U[7]=bt,U[8]=Pe,U[9]=_e,U[10]=je,U[11]=xe,U[12]=De,U[13]=Te,U[14]=Se,U[15]=ye}function B(U,T){y(U,T,T)}function he(U,T){const F=i();let g;for(g=0;g<16;g++)F[g]=T[g];for(g=253;g>=0;g--)B(F,F),g!==2&&g!==4&&y(F,F,T);for(g=0;g<16;g++)U[g]=F[g]}function de(U,T){const F=i();let g;for(g=0;g<16;g++)F[g]=T[g];for(g=250;g>=0;g--)B(F,F),g!==1&&y(F,F,T);for(g=0;g<16;g++)U[g]=F[g]}function pe(U,T){const F=i(),g=i(),N=i(),ee=i(),le=i(),se=i(),ve=i(),et=i(),Ae=i();V(F,U[1],U[0]),V(Ae,T[1],T[0]),y(F,F,Ae),Z(g,U[0],U[1]),Z(Ae,T[0],T[1]),y(g,g,Ae),y(N,U[3],T[3]),y(N,N,l),y(ee,U[2],T[2]),Z(ee,ee,ee),V(le,g,F),V(se,ee,N),Z(ve,ee,N),Z(et,g,F),y(U[0],le,se),y(U[1],et,ve),y(U[2],ve,se),y(U[3],le,et)}function Ee(U,T,F){for(let g=0;g<4;g++)z(U[g],T[g],F)}function $(U,T){const F=i(),g=i(),N=i();he(N,T[2]),y(F,T[0],N),y(g,T[1],N),k(U,g),U[31]^=ie(F)<<7}function h(U,T,F){I(U[0],u),I(U[1],f),I(U[2],f),I(U[3],u);for(let g=255;g>=0;--g){const N=F[g/8|0]>>(g&7)&1;Ee(U,T,N),pe(T,U),pe(U,U),Ee(U,T,N)}}function v(U,T){const F=[i(),i(),i(),i()];I(F[0],w),I(F[1],b),I(F[2],f),y(F[3],w,b),h(U,F,T)}function x(U){if(U.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const T=(0,t.hash)(U);T[0]&=248,T[31]&=127,T[31]|=64;const F=new Uint8Array(32),g=[i(),i(),i(),i()];v(g,T),$(F,g);const N=new Uint8Array(64);return N.set(U),N.set(F,32),{publicKey:F,secretKey:N}}r.generateKeyPairFromSeed=x;function P(U){const T=(0,e.randomBytes)(32,U),F=x(T);return(0,n.wipe)(T),F}r.generateKeyPair=P;function A(U){if(U.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(U.subarray(32))}r.extractPublicKeyFromSecretKey=A;const R=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function j(U,T){let F,g,N,ee;for(g=63;g>=32;--g){for(F=0,N=g-32,ee=g-12;N<ee;++N)T[N]+=F-16*T[g]*R[N-(g-32)],F=Math.floor((T[N]+128)/256),T[N]-=F*256;T[N]+=F,T[g]=0}for(F=0,N=0;N<32;N++)T[N]+=F-(T[31]>>4)*R[N],F=T[N]>>8,T[N]&=255;for(N=0;N<32;N++)T[N]-=F*R[N];for(g=0;g<32;g++)T[g+1]+=T[g]>>8,U[g]=T[g]&255}function O(U){const T=new Float64Array(64);for(let F=0;F<64;F++)T[F]=U[F];for(let F=0;F<64;F++)U[F]=0;j(U,T)}function m(U,T){const F=new Float64Array(64),g=[i(),i(),i(),i()],N=(0,t.hash)(U.subarray(0,32));N[0]&=248,N[31]&=127,N[31]|=64;const ee=new Uint8Array(64);ee.set(N.subarray(32),32);const le=new t.SHA512;le.update(ee.subarray(32)),le.update(T);const se=le.digest();le.clean(),O(se),v(g,se),$(ee,g),le.reset(),le.update(ee.subarray(0,32)),le.update(U.subarray(32)),le.update(T);const ve=le.digest();O(ve);for(let et=0;et<32;et++)F[et]=se[et];for(let et=0;et<32;et++)for(let Ae=0;Ae<32;Ae++)F[et+Ae]+=ve[et]*N[Ae];return j(ee.subarray(32),F),ee}r.sign=m;function L(U,T){const F=i(),g=i(),N=i(),ee=i(),le=i(),se=i(),ve=i();return I(U[2],f),W(U[1],T),B(N,U[1]),y(ee,N,d),V(N,N,U[2]),Z(ee,U[2],ee),B(le,ee),B(se,le),y(ve,se,le),y(F,ve,N),y(F,F,ee),de(F,F),y(F,F,N),y(F,F,ee),y(F,F,ee),y(U[0],F,ee),B(g,U[0]),y(g,g,ee),te(g,N)&&y(U[0],U[0],S),B(g,U[0]),y(g,g,ee),te(g,N)?-1:(ie(U[0])===T[31]>>7&&V(U[0],u,U[0]),y(U[3],U[0],U[1]),0)}function ce(U,T,F){const g=new Uint8Array(32),N=[i(),i(),i(),i()],ee=[i(),i(),i(),i()];if(F.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(L(ee,U))return!1;const le=new t.SHA512;le.update(F.subarray(0,32)),le.update(U),le.update(T);const se=le.digest();return O(se),h(N,ee,se),v(ee,F.subarray(32)),pe(N,ee),$(g,N),!Y(F,g)}r.verify=ce;function _(U){let T=[i(),i(),i(),i()];if(L(T,U))throw new Error("Ed25519: invalid public key");let F=i(),g=i(),N=T[1];Z(F,f,N),V(g,f,N),he(g,g),y(F,F,g);let ee=new Uint8Array(32);return k(ee,F),ee}r.convertPublicKeyToX25519=_;function G(U){const T=(0,t.hash)(U.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const F=new Uint8Array(T.subarray(0,32));return(0,n.wipe)(T),F}r.convertSecretKeyToX25519=G})(zh);const vS="EdDSA",mS="JWT",Xu=".",yc="base64url",Rv="utf8",Nv="utf8",yS=":",wS="did",_S="key",zp="base58btc",bS="z",ES="K36",xS=32;function Tv(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function Ru(r,e){e||(e=r.reduce((i,a)=>i+a.length,0));const t=Tv(e);let n=0;for(const i of r)t.set(i,n),n+=i.length;return t}function SS(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var a=r.charAt(i),u=a.charCodeAt(0);if(t[u]!==255)throw new TypeError(a+" is ambiguous");t[u]=i}var f=r.length,d=r.charAt(0),l=Math.log(f)/Math.log(256),w=Math.log(256)/Math.log(f);function b(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var z=0,k=0,Y=0,te=M.length;Y!==te&&M[Y]===0;)Y++,z++;for(var ie=(te-Y)*w+1>>>0,W=new Uint8Array(ie);Y!==te;){for(var Z=M[Y],V=0,y=ie-1;(Z!==0||V<k)&&y!==-1;y--,V++)Z+=256*W[y]>>>0,W[y]=Z%f>>>0,Z=Z/f>>>0;if(Z!==0)throw new Error("Non-zero carry");k=V,Y++}for(var B=ie-k;B!==ie&&W[B]===0;)B++;for(var he=d.repeat(z);B<ie;++B)he+=r.charAt(W[B]);return he}function S(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var z=0;if(M[z]!==" "){for(var k=0,Y=0;M[z]===d;)k++,z++;for(var te=(M.length-z)*l+1>>>0,ie=new Uint8Array(te);M[z];){var W=t[M.charCodeAt(z)];if(W===255)return;for(var Z=0,V=te-1;(W!==0||Z<Y)&&V!==-1;V--,Z++)W+=f*ie[V]>>>0,ie[V]=W%256>>>0,W=W/256>>>0;if(W!==0)throw new Error("Non-zero carry");Y=Z,z++}if(M[z]!==" "){for(var y=te-Y;y!==te&&ie[y]===0;)y++;for(var B=new Uint8Array(k+(te-y)),he=k;y!==te;)B[he++]=ie[y++];return B}}}function I(M){var z=S(M);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:S,decode:I}}var IS=SS,AS=IS;const OS=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},PS=r=>new TextEncoder().encode(r),DS=r=>new TextDecoder().decode(r);class MS{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class LS{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return $v(this,e)}}class CS{constructor(e){this.decoders=e}or(e){return $v(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const $v=(r,e)=>new CS({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class RS{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new MS(e,t,n),this.decoder=new LS(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const wc=({name:r,prefix:e,encode:t,decode:n})=>new RS(r,e,t,n),ha=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:i}=AS(t,e);return wc({prefix:r,name:e,encode:n,decode:a=>OS(i(a))})},NS=(r,e,t,n)=>{const i={};for(let w=0;w<e.length;++w)i[e[w]]=w;let a=r.length;for(;r[a-1]==="=";)--a;const u=new Uint8Array(a*t/8|0);let f=0,d=0,l=0;for(let w=0;w<a;++w){const b=i[r[w]];if(b===void 0)throw new SyntaxError(`Non-${n} character`);d=d<<t|b,f+=t,f>=8&&(f-=8,u[l++]=255&d>>f)}if(f>=t||255&d<<8-f)throw new SyntaxError("Unexpected end of data");return u},TS=(r,e,t)=>{const n=e[e.length-1]==="=",i=(1<<t)-1;let a="",u=0,f=0;for(let d=0;d<r.length;++d)for(f=f<<8|r[d],u+=8;u>t;)u-=t,a+=e[i&f>>u];if(u&&(a+=e[i&f<<t-u]),n)for(;a.length*t&7;)a+="=";return a},Dr=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>wc({prefix:e,name:r,encode(i){return TS(i,n,t)},decode(i){return NS(i,n,t,r)}}),$S=wc({prefix:"\0",name:"identity",encode:r=>DS(r),decode:r=>PS(r)}),FS=Object.freeze(Object.defineProperty({__proto__:null,identity:$S},Symbol.toStringTag,{value:"Module"})),US=Dr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),qS=Object.freeze(Object.defineProperty({__proto__:null,base2:US},Symbol.toStringTag,{value:"Module"})),jS=Dr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),BS=Object.freeze(Object.defineProperty({__proto__:null,base8:jS},Symbol.toStringTag,{value:"Module"})),KS=ha({prefix:"9",name:"base10",alphabet:"0123456789"}),zS=Object.freeze(Object.defineProperty({__proto__:null,base10:KS},Symbol.toStringTag,{value:"Module"})),HS=Dr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),kS=Dr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),WS=Object.freeze(Object.defineProperty({__proto__:null,base16:HS,base16upper:kS},Symbol.toStringTag,{value:"Module"})),GS=Dr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),VS=Dr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),JS=Dr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),YS=Dr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),XS=Dr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ZS=Dr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),QS=Dr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),eI=Dr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),tI=Dr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),rI=Object.freeze(Object.defineProperty({__proto__:null,base32:GS,base32hex:XS,base32hexpad:QS,base32hexpadupper:eI,base32hexupper:ZS,base32pad:JS,base32padupper:YS,base32upper:VS,base32z:tI},Symbol.toStringTag,{value:"Module"})),nI=ha({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),iI=ha({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),sI=Object.freeze(Object.defineProperty({__proto__:null,base36:nI,base36upper:iI},Symbol.toStringTag,{value:"Module"})),oI=ha({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),aI=ha({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),uI=Object.freeze(Object.defineProperty({__proto__:null,base58btc:oI,base58flickr:aI},Symbol.toStringTag,{value:"Module"})),cI=Dr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),fI=Dr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),hI=Dr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),lI=Dr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),dI=Object.freeze(Object.defineProperty({__proto__:null,base64:cI,base64pad:fI,base64url:hI,base64urlpad:lI},Symbol.toStringTag,{value:"Module"})),Fv=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),pI=Fv.reduce((r,e,t)=>(r[t]=e,r),[]),gI=Fv.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function vI(r){return r.reduce((e,t)=>(e+=pI[t],e),"")}function mI(r){const e=[];for(const t of r){const n=gI[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const yI=wc({prefix:"🚀",name:"base256emoji",encode:vI,decode:mI}),wI=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:yI},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Hp={...FS,...qS,...BS,...zS,...WS,...rI,...sI,...uI,...dI,...wI};function Uv(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const kp=Uv("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Xf=Uv("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=Tv(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),qv={utf8:kp,"utf-8":kp,hex:Hp.base16,latin1:Xf,ascii:Xf,binary:Xf,...Hp};function Sr(r,e="utf8"){const t=qv[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function xr(r,e="utf8"){const t=qv[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function Wp(r){return xs(Sr(xr(r,yc),Rv))}function Zu(r){return Sr(xr(xi(r),Rv),yc)}function jv(r){const e=xr(ES,zp),t=bS+Sr(Ru([e,r]),zp);return[wS,_S,t].join(yS)}function _I(r){return Sr(r,yc)}function bI(r){return xr(r,yc)}function EI(r){return xr([Zu(r.header),Zu(r.payload)].join(Xu),Nv)}function xI(r){return[Zu(r.header),Zu(r.payload),_I(r.signature)].join(Xu)}function Sh(r){const e=r.split(Xu),t=Wp(e[0]),n=Wp(e[1]),i=bI(e[2]),a=xr(e.slice(0,2).join(Xu),Nv);return{header:t,payload:n,signature:i,data:a}}function Gp(r=Hi.randomBytes(xS)){return zh.generateKeyPairFromSeed(r)}async function SI(r,e,t,n,i=ge.fromMiliseconds(Date.now())){const a={alg:vS,typ:mS},u=jv(n.publicKey),f=i+t,d={iss:u,sub:r,aud:e,iat:i,exp:f},l=EI({header:a,payload:d}),w=zh.sign(n.secretKey,l);return xI({header:a,payload:d,signature:w})}var Vp=function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return r.concat(a||Array.prototype.slice.call(e))},II=function(){function r(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}return r}(),AI=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=Xr.platform}return r}(),OI=function(){function r(e,t,n,i){this.name=e,this.version=t,this.os=n,this.bot=i,this.type="bot-device"}return r}(),PI=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),DI=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),MI=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,LI=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Jp=3,CI=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",MI]],Yp=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function RI(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new DI:typeof navigator<"u"?TI(navigator.userAgent):FI()}function NI(r){return r!==""&&CI.reduce(function(e,t){var n=t[0],i=t[1];if(e)return e;var a=i.exec(r);return!!a&&[n,a]},!1)}function TI(r){var e=NI(r);if(!e)return null;var t=e[0],n=e[1];if(t==="searchbot")return new PI;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<Jp&&(i=Vp(Vp([],i,!0),UI(Jp-i.length),!0)):i=[];var a=i.join("."),u=$I(r),f=LI.exec(r);return f&&f[1]?new OI(t,a,u,f[1]):new II(t,a,u)}function $I(r){for(var e=0,t=Yp.length;e<t;e++){var n=Yp[e],i=n[0],a=n[1],u=a.exec(r);if(u)return i}return null}function FI(){var r=typeof Xr<"u"&&Xr.version;return r?new AI(Xr.version.slice(1)):null}function UI(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var Xt={};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.getLocalStorage=Xt.getLocalStorageOrThrow=Xt.getCrypto=Xt.getCryptoOrThrow=Bv=Xt.getLocation=Xt.getLocationOrThrow=Hh=Xt.getNavigator=Xt.getNavigatorOrThrow=la=Xt.getDocument=Xt.getDocumentOrThrow=Xt.getFromWindowOrThrow=Xt.getFromWindow=void 0;function Ms(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}Xt.getFromWindow=Ms;function yo(r){const e=Ms(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}Xt.getFromWindowOrThrow=yo;function qI(){return yo("document")}Xt.getDocumentOrThrow=qI;function jI(){return Ms("document")}var la=Xt.getDocument=jI;function BI(){return yo("navigator")}Xt.getNavigatorOrThrow=BI;function KI(){return Ms("navigator")}var Hh=Xt.getNavigator=KI;function zI(){return yo("location")}Xt.getLocationOrThrow=zI;function HI(){return Ms("location")}var Bv=Xt.getLocation=HI;function kI(){return yo("crypto")}Xt.getCryptoOrThrow=kI;function WI(){return Ms("crypto")}Xt.getCrypto=WI;function GI(){return yo("localStorage")}Xt.getLocalStorageOrThrow=GI;function VI(){return Ms("localStorage")}Xt.getLocalStorage=VI;var kh={};Object.defineProperty(kh,"__esModule",{value:!0});var Kv=kh.getWindowMetadata=void 0;const Xp=Xt;function JI(){let r,e;try{r=Xp.getDocumentOrThrow(),e=Xp.getLocationOrThrow()}catch{return null}function t(){const b=r.getElementsByTagName("link"),S=[];for(let I=0;I<b.length;I++){const M=b[I],z=M.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const k=M.getAttribute("href");if(k)if(k.toLowerCase().indexOf("https:")===-1&&k.toLowerCase().indexOf("http:")===-1&&k.indexOf("//")!==0){let Y=e.protocol+"//"+e.host;if(k.indexOf("/")===0)Y+=k;else{const te=e.pathname.split("/");te.pop();const ie=te.join("/");Y+=ie+"/"+k}S.push(Y)}else if(k.indexOf("//")===0){const Y=e.protocol+k;S.push(Y)}else S.push(k)}}return S}function n(...b){const S=r.getElementsByTagName("meta");for(let I=0;I<S.length;I++){const M=S[I],z=["itemprop","property","name"].map(k=>M.getAttribute(k)).filter(k=>k?b.includes(k):!1);if(z.length&&z){const k=M.getAttribute("content");if(k)return k}}return""}function i(){let b=n("name","og:site_name","og:title","twitter:title");return b||(b=r.title),b}function a(){return n("description","og:description","twitter:description","keywords")}const u=i(),f=a(),d=e.origin,l=t();return{description:f,url:d,icons:l,name:u}}Kv=kh.getWindowMetadata=JI;var zv={exports:{}};(function(r){(function(){var e="input is invalid type",t="finalize already called",n=typeof window=="object",i=n?window:{};i.JS_SHA3_NO_WINDOW&&(n=!1);var a=!n&&typeof self=="object",u=!i.JS_SHA3_NO_NODE_JS&&typeof Xr=="object"&&Xr.versions&&Xr.versions.node;u?i=Pr:a&&(i=self);var f=!i.JS_SHA3_NO_COMMON_JS&&!0&&r.exports,d=!i.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",l="0123456789abcdef".split(""),w=[31,7936,2031616,520093696],b=[4,1024,262144,67108864],S=[1,256,65536,16777216],I=[6,1536,393216,100663296],M=[0,8,16,24],z=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],k=[224,256,384,512],Y=[128,256],te=["hex","buffer","arrayBuffer","array","digest"],ie={128:168,256:136};(i.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(_){return Object.prototype.toString.call(_)==="[object Array]"}),d&&(i.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(_){return typeof _=="object"&&_.buffer&&_.buffer.constructor===ArrayBuffer});for(var W=function(_,G,U){return function(T){return new m(_,G,_).update(T)[U]()}},Z=function(_,G,U){return function(T,F){return new m(_,G,F).update(T)[U]()}},V=function(_,G,U){return function(T,F,g,N){return h["cshake"+_].update(T,F,g,N)[U]()}},y=function(_,G,U){return function(T,F,g,N){return h["kmac"+_].update(T,F,g,N)[U]()}},B=function(_,G,U,T){for(var F=0;F<te.length;++F){var g=te[F];_[g]=G(U,T,g)}return _},he=function(_,G){var U=W(_,G,"hex");return U.create=function(){return new m(_,G,_)},U.update=function(T){return U.create().update(T)},B(U,W,_,G)},de=function(_,G){var U=Z(_,G,"hex");return U.create=function(T){return new m(_,G,T)},U.update=function(T,F){return U.create(F).update(T)},B(U,Z,_,G)},pe=function(_,G){var U=ie[_],T=V(_,G,"hex");return T.create=function(F,g,N){return!g&&!N?h["shake"+_].create(F):new m(_,G,F).bytepad([g,N],U)},T.update=function(F,g,N,ee){return T.create(g,N,ee).update(F)},B(T,V,_,G)},Ee=function(_,G){var U=ie[_],T=y(_,G,"hex");return T.create=function(F,g,N){return new L(_,G,g).bytepad(["KMAC",N],U).bytepad([F],U)},T.update=function(F,g,N,ee){return T.create(F,N,ee).update(g)},B(T,y,_,G)},$=[{name:"keccak",padding:S,bits:k,createMethod:he},{name:"sha3",padding:I,bits:k,createMethod:he},{name:"shake",padding:w,bits:Y,createMethod:de},{name:"cshake",padding:b,bits:Y,createMethod:pe},{name:"kmac",padding:b,bits:Y,createMethod:Ee}],h={},v=[],x=0;x<$.length;++x)for(var P=$[x],A=P.bits,R=0;R<A.length;++R){var j=P.name+"_"+A[R];if(v.push(j),h[j]=P.createMethod(A[R],P.padding),P.name!=="sha3"){var O=P.name+A[R];v.push(O),h[O]=h[j]}}function m(_,G,U){this.blocks=[],this.s=[],this.padding=G,this.outputBits=U,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(_<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=U>>5,this.extraBytes=(U&31)>>3;for(var T=0;T<50;++T)this.s[T]=0}m.prototype.update=function(_){if(this.finalized)throw new Error(t);var G,U=typeof _;if(U!=="string"){if(U==="object"){if(_===null)throw new Error(e);if(d&&_.constructor===ArrayBuffer)_=new Uint8Array(_);else if(!Array.isArray(_)&&(!d||!ArrayBuffer.isView(_)))throw new Error(e)}else throw new Error(e);G=!0}for(var T=this.blocks,F=this.byteCount,g=_.length,N=this.blockCount,ee=0,le=this.s,se,ve;ee<g;){if(this.reset)for(this.reset=!1,T[0]=this.block,se=1;se<N+1;++se)T[se]=0;if(G)for(se=this.start;ee<g&&se<F;++ee)T[se>>2]|=_[ee]<<M[se++&3];else for(se=this.start;ee<g&&se<F;++ee)ve=_.charCodeAt(ee),ve<128?T[se>>2]|=ve<<M[se++&3]:ve<2048?(T[se>>2]|=(192|ve>>6)<<M[se++&3],T[se>>2]|=(128|ve&63)<<M[se++&3]):ve<55296||ve>=57344?(T[se>>2]|=(224|ve>>12)<<M[se++&3],T[se>>2]|=(128|ve>>6&63)<<M[se++&3],T[se>>2]|=(128|ve&63)<<M[se++&3]):(ve=65536+((ve&1023)<<10|_.charCodeAt(++ee)&1023),T[se>>2]|=(240|ve>>18)<<M[se++&3],T[se>>2]|=(128|ve>>12&63)<<M[se++&3],T[se>>2]|=(128|ve>>6&63)<<M[se++&3],T[se>>2]|=(128|ve&63)<<M[se++&3]);if(this.lastByteIndex=se,se>=F){for(this.start=se-F,this.block=T[N],se=0;se<N;++se)le[se]^=T[se];ce(le),this.reset=!0}else this.start=se}return this},m.prototype.encode=function(_,G){var U=_&255,T=1,F=[U];for(_=_>>8,U=_&255;U>0;)F.unshift(U),_=_>>8,U=_&255,++T;return G?F.push(T):F.unshift(T),this.update(F),F.length},m.prototype.encodeString=function(_){var G,U=typeof _;if(U!=="string"){if(U==="object"){if(_===null)throw new Error(e);if(d&&_.constructor===ArrayBuffer)_=new Uint8Array(_);else if(!Array.isArray(_)&&(!d||!ArrayBuffer.isView(_)))throw new Error(e)}else throw new Error(e);G=!0}var T=0,F=_.length;if(G)T=F;else for(var g=0;g<_.length;++g){var N=_.charCodeAt(g);N<128?T+=1:N<2048?T+=2:N<55296||N>=57344?T+=3:(N=65536+((N&1023)<<10|_.charCodeAt(++g)&1023),T+=4)}return T+=this.encode(T*8),this.update(_),T},m.prototype.bytepad=function(_,G){for(var U=this.encode(G),T=0;T<_.length;++T)U+=this.encodeString(_[T]);var F=G-U%G,g=[];return g.length=F,this.update(g),this},m.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var _=this.blocks,G=this.lastByteIndex,U=this.blockCount,T=this.s;if(_[G>>2]|=this.padding[G&3],this.lastByteIndex===this.byteCount)for(_[0]=_[U],G=1;G<U+1;++G)_[G]=0;for(_[U-1]|=2147483648,G=0;G<U;++G)T[G]^=_[G];ce(T)}},m.prototype.toString=m.prototype.hex=function(){this.finalize();for(var _=this.blockCount,G=this.s,U=this.outputBlocks,T=this.extraBytes,F=0,g=0,N="",ee;g<U;){for(F=0;F<_&&g<U;++F,++g)ee=G[F],N+=l[ee>>4&15]+l[ee&15]+l[ee>>12&15]+l[ee>>8&15]+l[ee>>20&15]+l[ee>>16&15]+l[ee>>28&15]+l[ee>>24&15];g%_===0&&(ce(G),F=0)}return T&&(ee=G[F],N+=l[ee>>4&15]+l[ee&15],T>1&&(N+=l[ee>>12&15]+l[ee>>8&15]),T>2&&(N+=l[ee>>20&15]+l[ee>>16&15])),N},m.prototype.arrayBuffer=function(){this.finalize();var _=this.blockCount,G=this.s,U=this.outputBlocks,T=this.extraBytes,F=0,g=0,N=this.outputBits>>3,ee;T?ee=new ArrayBuffer(U+1<<2):ee=new ArrayBuffer(N);for(var le=new Uint32Array(ee);g<U;){for(F=0;F<_&&g<U;++F,++g)le[g]=G[F];g%_===0&&ce(G)}return T&&(le[F]=G[F],ee=ee.slice(0,N)),ee},m.prototype.buffer=m.prototype.arrayBuffer,m.prototype.digest=m.prototype.array=function(){this.finalize();for(var _=this.blockCount,G=this.s,U=this.outputBlocks,T=this.extraBytes,F=0,g=0,N=[],ee,le;g<U;){for(F=0;F<_&&g<U;++F,++g)ee=g<<2,le=G[F],N[ee]=le&255,N[ee+1]=le>>8&255,N[ee+2]=le>>16&255,N[ee+3]=le>>24&255;g%_===0&&ce(G)}return T&&(ee=g<<2,le=G[F],N[ee]=le&255,T>1&&(N[ee+1]=le>>8&255),T>2&&(N[ee+2]=le>>16&255)),N};function L(_,G,U){m.call(this,_,G,U)}L.prototype=new m,L.prototype.finalize=function(){return this.encode(this.outputBits,!0),m.prototype.finalize.call(this)};var ce=function(_){var G,U,T,F,g,N,ee,le,se,ve,et,Ae,qe,bt,Pe,_e,je,xe,De,Te,Se,ye,$e,Me,be,tt,Le,Re,st,Ce,at,nr,gt,ut,Ar,wt,_t,St,Be,We,It,ke,Ke,Rt,Ze,Ge,Nt,Ve,Ye,At,Fe,Qe,Tt,Pt,Dt,Cn,lt,Mt,ln,dn,pn,gn,mr;for(T=0;T<48;T+=2)F=_[0]^_[10]^_[20]^_[30]^_[40],g=_[1]^_[11]^_[21]^_[31]^_[41],N=_[2]^_[12]^_[22]^_[32]^_[42],ee=_[3]^_[13]^_[23]^_[33]^_[43],le=_[4]^_[14]^_[24]^_[34]^_[44],se=_[5]^_[15]^_[25]^_[35]^_[45],ve=_[6]^_[16]^_[26]^_[36]^_[46],et=_[7]^_[17]^_[27]^_[37]^_[47],Ae=_[8]^_[18]^_[28]^_[38]^_[48],qe=_[9]^_[19]^_[29]^_[39]^_[49],G=Ae^(N<<1|ee>>>31),U=qe^(ee<<1|N>>>31),_[0]^=G,_[1]^=U,_[10]^=G,_[11]^=U,_[20]^=G,_[21]^=U,_[30]^=G,_[31]^=U,_[40]^=G,_[41]^=U,G=F^(le<<1|se>>>31),U=g^(se<<1|le>>>31),_[2]^=G,_[3]^=U,_[12]^=G,_[13]^=U,_[22]^=G,_[23]^=U,_[32]^=G,_[33]^=U,_[42]^=G,_[43]^=U,G=N^(ve<<1|et>>>31),U=ee^(et<<1|ve>>>31),_[4]^=G,_[5]^=U,_[14]^=G,_[15]^=U,_[24]^=G,_[25]^=U,_[34]^=G,_[35]^=U,_[44]^=G,_[45]^=U,G=le^(Ae<<1|qe>>>31),U=se^(qe<<1|Ae>>>31),_[6]^=G,_[7]^=U,_[16]^=G,_[17]^=U,_[26]^=G,_[27]^=U,_[36]^=G,_[37]^=U,_[46]^=G,_[47]^=U,G=ve^(F<<1|g>>>31),U=et^(g<<1|F>>>31),_[8]^=G,_[9]^=U,_[18]^=G,_[19]^=U,_[28]^=G,_[29]^=U,_[38]^=G,_[39]^=U,_[48]^=G,_[49]^=U,bt=_[0],Pe=_[1],Ge=_[11]<<4|_[10]>>>28,Nt=_[10]<<4|_[11]>>>28,Re=_[20]<<3|_[21]>>>29,st=_[21]<<3|_[20]>>>29,dn=_[31]<<9|_[30]>>>23,pn=_[30]<<9|_[31]>>>23,ke=_[40]<<18|_[41]>>>14,Ke=_[41]<<18|_[40]>>>14,ut=_[2]<<1|_[3]>>>31,Ar=_[3]<<1|_[2]>>>31,_e=_[13]<<12|_[12]>>>20,je=_[12]<<12|_[13]>>>20,Ve=_[22]<<10|_[23]>>>22,Ye=_[23]<<10|_[22]>>>22,Ce=_[33]<<13|_[32]>>>19,at=_[32]<<13|_[33]>>>19,gn=_[42]<<2|_[43]>>>30,mr=_[43]<<2|_[42]>>>30,Pt=_[5]<<30|_[4]>>>2,Dt=_[4]<<30|_[5]>>>2,wt=_[14]<<6|_[15]>>>26,_t=_[15]<<6|_[14]>>>26,xe=_[25]<<11|_[24]>>>21,De=_[24]<<11|_[25]>>>21,At=_[34]<<15|_[35]>>>17,Fe=_[35]<<15|_[34]>>>17,nr=_[45]<<29|_[44]>>>3,gt=_[44]<<29|_[45]>>>3,Me=_[6]<<28|_[7]>>>4,be=_[7]<<28|_[6]>>>4,Cn=_[17]<<23|_[16]>>>9,lt=_[16]<<23|_[17]>>>9,St=_[26]<<25|_[27]>>>7,Be=_[27]<<25|_[26]>>>7,Te=_[36]<<21|_[37]>>>11,Se=_[37]<<21|_[36]>>>11,Qe=_[47]<<24|_[46]>>>8,Tt=_[46]<<24|_[47]>>>8,Rt=_[8]<<27|_[9]>>>5,Ze=_[9]<<27|_[8]>>>5,tt=_[18]<<20|_[19]>>>12,Le=_[19]<<20|_[18]>>>12,Mt=_[29]<<7|_[28]>>>25,ln=_[28]<<7|_[29]>>>25,We=_[38]<<8|_[39]>>>24,It=_[39]<<8|_[38]>>>24,ye=_[48]<<14|_[49]>>>18,$e=_[49]<<14|_[48]>>>18,_[0]=bt^~_e&xe,_[1]=Pe^~je&De,_[10]=Me^~tt&Re,_[11]=be^~Le&st,_[20]=ut^~wt&St,_[21]=Ar^~_t&Be,_[30]=Rt^~Ge&Ve,_[31]=Ze^~Nt&Ye,_[40]=Pt^~Cn&Mt,_[41]=Dt^~lt&ln,_[2]=_e^~xe&Te,_[3]=je^~De&Se,_[12]=tt^~Re&Ce,_[13]=Le^~st&at,_[22]=wt^~St&We,_[23]=_t^~Be&It,_[32]=Ge^~Ve&At,_[33]=Nt^~Ye&Fe,_[42]=Cn^~Mt&dn,_[43]=lt^~ln&pn,_[4]=xe^~Te&ye,_[5]=De^~Se&$e,_[14]=Re^~Ce&nr,_[15]=st^~at&gt,_[24]=St^~We&ke,_[25]=Be^~It&Ke,_[34]=Ve^~At&Qe,_[35]=Ye^~Fe&Tt,_[44]=Mt^~dn&gn,_[45]=ln^~pn&mr,_[6]=Te^~ye&bt,_[7]=Se^~$e&Pe,_[16]=Ce^~nr&Me,_[17]=at^~gt&be,_[26]=We^~ke&ut,_[27]=It^~Ke&Ar,_[36]=At^~Qe&Rt,_[37]=Fe^~Tt&Ze,_[46]=dn^~gn&Pt,_[47]=pn^~mr&Dt,_[8]=ye^~bt&_e,_[9]=$e^~Pe&je,_[18]=nr^~Me&tt,_[19]=gt^~be&Le,_[28]=ke^~ut&wt,_[29]=Ke^~Ar&_t,_[38]=Qe^~Rt&Ge,_[39]=Tt^~Ze&Nt,_[48]=gn^~Pt&Cn,_[49]=mr^~Dt&lt,_[0]^=z[T],_[1]^=z[T+1]};if(f)r.exports=h;else for(x=0;x<v.length;++x)i[v[x]]=h[v[x]]})()})(zv);var YI=zv.exports;const XI=As(YI),ZI="logger/5.8.0";let Zp=!1,Qp=!1;const Nu={debug:1,default:2,info:2,warning:3,error:4,off:5};let e0=Nu.default,Zf=null;function QI(){try{const r=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{r.push(e)}}),r.length)throw new Error("missing "+r.join(", "));if("é".normalize("NFD")!=="é")throw new Error("broken implementation")}catch(r){return r.message}return null}const t0=QI();var Ih;(function(r){r.DEBUG="DEBUG",r.INFO="INFO",r.WARNING="WARNING",r.ERROR="ERROR",r.OFF="OFF"})(Ih||(Ih={}));var Bn;(function(r){r.UNKNOWN_ERROR="UNKNOWN_ERROR",r.NOT_IMPLEMENTED="NOT_IMPLEMENTED",r.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.TIMEOUT="TIMEOUT",r.BUFFER_OVERRUN="BUFFER_OVERRUN",r.NUMERIC_FAULT="NUMERIC_FAULT",r.MISSING_NEW="MISSING_NEW",r.INVALID_ARGUMENT="INVALID_ARGUMENT",r.MISSING_ARGUMENT="MISSING_ARGUMENT",r.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",r.CALL_EXCEPTION="CALL_EXCEPTION",r.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",r.NONCE_EXPIRED="NONCE_EXPIRED",r.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",r.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",r.TRANSACTION_REPLACED="TRANSACTION_REPLACED",r.ACTION_REJECTED="ACTION_REJECTED"})(Bn||(Bn={}));const r0="0123456789abcdef";class er{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){const n=e.toLowerCase();Nu[n]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!(e0>Nu[n])&&console.log.apply(console,t)}debug(...e){this._log(er.levels.DEBUG,e)}info(...e){this._log(er.levels.INFO,e)}warn(...e){this._log(er.levels.WARNING,e)}makeError(e,t,n){if(Qp)return this.makeError("censored error",t,{});t||(t=er.errors.UNKNOWN_ERROR),n||(n={});const i=[];Object.keys(n).forEach(d=>{const l=n[d];try{if(l instanceof Uint8Array){let w="";for(let b=0;b<l.length;b++)w+=r0[l[b]>>4],w+=r0[l[b]&15];i.push(d+"=Uint8Array(0x"+w+")")}else i.push(d+"="+JSON.stringify(l))}catch{i.push(d+"="+JSON.stringify(n[d].toString()))}}),i.push(`code=${t}`),i.push(`version=${this.version}`);const a=e;let u="";switch(t){case Bn.NUMERIC_FAULT:{u="NUMERIC_FAULT";const d=e;switch(d){case"overflow":case"underflow":case"division-by-zero":u+="-"+d;break;case"negative-power":case"negative-width":u+="-unsupported";break;case"unbound-bitwise-result":u+="-unbound-result";break}break}case Bn.CALL_EXCEPTION:case Bn.INSUFFICIENT_FUNDS:case Bn.MISSING_NEW:case Bn.NONCE_EXPIRED:case Bn.REPLACEMENT_UNDERPRICED:case Bn.TRANSACTION_REPLACED:case Bn.UNPREDICTABLE_GAS_LIMIT:u=t;break}u&&(e+=" [ See: https://links.ethers.org/v5-errors-"+u+" ]"),i.length&&(e+=" ("+i.join(", ")+")");const f=new Error(e);return f.reason=a,f.code=t,Object.keys(n).forEach(function(d){f[d]=n[d]}),f}throwError(e,t,n){throw this.makeError(e,t,n)}throwArgumentError(e,t,n){return this.throwError(e,er.errors.INVALID_ARGUMENT,{argument:t,value:n})}assert(e,t,n,i){e||this.throwError(t,n,i)}assertArgument(e,t,n,i){e||this.throwArgumentError(t,n,i)}checkNormalize(e){t0&&this.throwError("platform missing String.prototype.normalize",er.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:t0})}checkSafeUint53(e,t){typeof e=="number"&&(t==null&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,er.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,er.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,n){n?n=": "+n:n="",e<t&&this.throwError("missing argument"+n,er.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+n,er.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){(e===Object||e==null)&&this.throwError("missing new",er.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",er.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",er.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return Zf||(Zf=new er(ZI)),Zf}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",er.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),Zp){if(!e)return;this.globalLogger().throwError("error censorship permanent",er.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Qp=!!e,Zp=!!t}static setLogLevel(e){const t=Nu[e.toLowerCase()];if(t==null){er.globalLogger().warn("invalid log level - "+e);return}e0=t}static from(e){return new er(e)}}er.errors=Bn;er.levels=Ih;const eA="bytes/5.8.0",cr=new er(eA);function Hv(r){return!!r.toHexString}function ao(r){return r.slice||(r.slice=function(){const e=Array.prototype.slice.call(arguments);return ao(new Uint8Array(Array.prototype.slice.apply(r,e)))}),r}function tA(r){return ni(r)&&!(r.length%2)||Wh(r)}function n0(r){return typeof r=="number"&&r==r&&r%1===0}function Wh(r){if(r==null)return!1;if(r.constructor===Uint8Array)return!0;if(typeof r=="string"||!n0(r.length)||r.length<0)return!1;for(let e=0;e<r.length;e++){const t=r[e];if(!n0(t)||t<0||t>=256)return!1}return!0}function dr(r,e){if(e||(e={}),typeof r=="number"){cr.checkSafeUint53(r,"invalid arrayify value");const t=[];for(;r;)t.unshift(r&255),r=parseInt(String(r/256));return t.length===0&&t.push(0),ao(new Uint8Array(t))}if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),Hv(r)&&(r=r.toHexString()),ni(r)){let t=r.substring(2);t.length%2&&(e.hexPad==="left"?t="0"+t:e.hexPad==="right"?t+="0":cr.throwArgumentError("hex data is odd-length","value",r));const n=[];for(let i=0;i<t.length;i+=2)n.push(parseInt(t.substring(i,i+2),16));return ao(new Uint8Array(n))}return Wh(r)?ao(new Uint8Array(r)):cr.throwArgumentError("invalid arrayify value","value",r)}function rA(r){const e=r.map(i=>dr(i)),t=e.reduce((i,a)=>i+a.length,0),n=new Uint8Array(t);return e.reduce((i,a)=>(n.set(a,i),i+a.length),0),ao(n)}function nA(r,e){r=dr(r),r.length>e&&cr.throwArgumentError("value out of range","value",arguments[0]);const t=new Uint8Array(e);return t.set(r,e-r.length),ao(t)}function ni(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||e&&r.length!==2+2*e)}const Qf="0123456789abcdef";function an(r,e){if(e||(e={}),typeof r=="number"){cr.checkSafeUint53(r,"invalid hexlify value");let t="";for(;r;)t=Qf[r&15]+t,r=Math.floor(r/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if(typeof r=="bigint")return r=r.toString(16),r.length%2?"0x0"+r:"0x"+r;if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),Hv(r))return r.toHexString();if(ni(r))return r.length%2&&(e.hexPad==="left"?r="0x0"+r.substring(2):e.hexPad==="right"?r+="0":cr.throwArgumentError("hex data is odd-length","value",r)),r.toLowerCase();if(Wh(r)){let t="0x";for(let n=0;n<r.length;n++){let i=r[n];t+=Qf[(i&240)>>4]+Qf[i&15]}return t}return cr.throwArgumentError("invalid hexlify value","value",r)}function iA(r){if(typeof r!="string")r=an(r);else if(!ni(r)||r.length%2)return null;return(r.length-2)/2}function i0(r,e,t){return typeof r!="string"?r=an(r):(!ni(r)||r.length%2)&&cr.throwArgumentError("invalid hexData","value",r),e=2+2*e,"0x"+r.substring(e)}function uo(r,e){for(typeof r!="string"?r=an(r):ni(r)||cr.throwArgumentError("invalid hex string","value",r),r.length>2*e+2&&cr.throwArgumentError("value out of range","value",arguments[1]);r.length<2*e+2;)r="0x0"+r.substring(2);return r}function kv(r){const e={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(tA(r)){let t=dr(r);t.length===64?(e.v=27+(t[32]>>7),t[32]&=127,e.r=an(t.slice(0,32)),e.s=an(t.slice(32,64))):t.length===65?(e.r=an(t.slice(0,32)),e.s=an(t.slice(32,64)),e.v=t[64]):cr.throwArgumentError("invalid signature string","signature",r),e.v<27&&(e.v===0||e.v===1?e.v+=27:cr.throwArgumentError("signature invalid v byte","signature",r)),e.recoveryParam=1-e.v%2,e.recoveryParam&&(t[32]|=128),e._vs=an(t.slice(32,64))}else{if(e.r=r.r,e.s=r.s,e.v=r.v,e.recoveryParam=r.recoveryParam,e._vs=r._vs,e._vs!=null){const i=nA(dr(e._vs),32);e._vs=an(i);const a=i[0]>=128?1:0;e.recoveryParam==null?e.recoveryParam=a:e.recoveryParam!==a&&cr.throwArgumentError("signature recoveryParam mismatch _vs","signature",r),i[0]&=127;const u=an(i);e.s==null?e.s=u:e.s!==u&&cr.throwArgumentError("signature v mismatch _vs","signature",r)}if(e.recoveryParam==null)e.v==null?cr.throwArgumentError("signature missing v and recoveryParam","signature",r):e.v===0||e.v===1?e.recoveryParam=e.v:e.recoveryParam=1-e.v%2;else if(e.v==null)e.v=27+e.recoveryParam;else{const i=e.v===0||e.v===1?e.v:1-e.v%2;e.recoveryParam!==i&&cr.throwArgumentError("signature recoveryParam mismatch v","signature",r)}e.r==null||!ni(e.r)?cr.throwArgumentError("signature missing or invalid r","signature",r):e.r=uo(e.r,32),e.s==null||!ni(e.s)?cr.throwArgumentError("signature missing or invalid s","signature",r):e.s=uo(e.s,32);const t=dr(e.s);t[0]>=128&&cr.throwArgumentError("signature s out of range","signature",r),e.recoveryParam&&(t[0]|=128);const n=an(t);e._vs&&(ni(e._vs)||cr.throwArgumentError("signature invalid _vs","signature",r),e._vs=uo(e._vs,32)),e._vs==null?e._vs=n:e._vs!==n&&cr.throwArgumentError("signature _vs mismatch v and s","signature",r)}return e.yParityAndS=e._vs,e.compact=e.r+e.yParityAndS.substring(2),e}function Gh(r){return"0x"+XI.keccak_256(dr(r))}var Vh={exports:{}};Vh.exports;(function(r){(function(e,t){function n($,h){if(!$)throw new Error(h||"Assertion failed")}function i($,h){$.super_=h;var v=function(){};v.prototype=h.prototype,$.prototype=new v,$.prototype.constructor=$}function a($,h,v){if(a.isBN($))return $;this.negative=0,this.words=null,this.length=0,this.red=null,$!==null&&((h==="le"||h==="be")&&(v=h,h=10),this._init($||0,h||10,v||"be"))}typeof e=="object"?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;var u;try{typeof window<"u"&&typeof window.Buffer<"u"?u=window.Buffer:u=Gg.Buffer}catch{}a.isBN=function(h){return h instanceof a?!0:h!==null&&typeof h=="object"&&h.constructor.wordSize===a.wordSize&&Array.isArray(h.words)},a.max=function(h,v){return h.cmp(v)>0?h:v},a.min=function(h,v){return h.cmp(v)<0?h:v},a.prototype._init=function(h,v,x){if(typeof h=="number")return this._initNumber(h,v,x);if(typeof h=="object")return this._initArray(h,v,x);v==="hex"&&(v=16),n(v===(v|0)&&v>=2&&v<=36),h=h.toString().replace(/\s+/g,"");var P=0;h[0]==="-"&&(P++,this.negative=1),P<h.length&&(v===16?this._parseHex(h,P,x):(this._parseBase(h,v,P),x==="le"&&this._initArray(this.toArray(),v,x)))},a.prototype._initNumber=function(h,v,x){h<0&&(this.negative=1,h=-h),h<67108864?(this.words=[h&67108863],this.length=1):h<4503599627370496?(this.words=[h&67108863,h/67108864&67108863],this.length=2):(n(h<9007199254740992),this.words=[h&67108863,h/67108864&67108863,1],this.length=3),x==="le"&&this._initArray(this.toArray(),v,x)},a.prototype._initArray=function(h,v,x){if(n(typeof h.length=="number"),h.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(h.length/3),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var A,R,j=0;if(x==="be")for(P=h.length-1,A=0;P>=0;P-=3)R=h[P]|h[P-1]<<8|h[P-2]<<16,this.words[A]|=R<<j&67108863,this.words[A+1]=R>>>26-j&67108863,j+=24,j>=26&&(j-=26,A++);else if(x==="le")for(P=0,A=0;P<h.length;P+=3)R=h[P]|h[P+1]<<8|h[P+2]<<16,this.words[A]|=R<<j&67108863,this.words[A+1]=R>>>26-j&67108863,j+=24,j>=26&&(j-=26,A++);return this._strip()};function f($,h){var v=$.charCodeAt(h);if(v>=48&&v<=57)return v-48;if(v>=65&&v<=70)return v-55;if(v>=97&&v<=102)return v-87;n(!1,"Invalid character in "+$)}function d($,h,v){var x=f($,v);return v-1>=h&&(x|=f($,v-1)<<4),x}a.prototype._parseHex=function(h,v,x){this.length=Math.ceil((h.length-v)/6),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var A=0,R=0,j;if(x==="be")for(P=h.length-1;P>=v;P-=2)j=d(h,v,P)<<A,this.words[R]|=j&67108863,A>=18?(A-=18,R+=1,this.words[R]|=j>>>26):A+=8;else{var O=h.length-v;for(P=O%2===0?v+1:v;P<h.length;P+=2)j=d(h,v,P)<<A,this.words[R]|=j&67108863,A>=18?(A-=18,R+=1,this.words[R]|=j>>>26):A+=8}this._strip()};function l($,h,v,x){for(var P=0,A=0,R=Math.min($.length,v),j=h;j<R;j++){var O=$.charCodeAt(j)-48;P*=x,O>=49?A=O-49+10:O>=17?A=O-17+10:A=O,n(O>=0&&A<x,"Invalid character"),P+=A}return P}a.prototype._parseBase=function(h,v,x){this.words=[0],this.length=1;for(var P=0,A=1;A<=67108863;A*=v)P++;P--,A=A/v|0;for(var R=h.length-x,j=R%P,O=Math.min(R,R-j)+x,m=0,L=x;L<O;L+=P)m=l(h,L,L+P,v),this.imuln(A),this.words[0]+m<67108864?this.words[0]+=m:this._iaddn(m);if(j!==0){var ce=1;for(m=l(h,L,h.length,v),L=0;L<j;L++)ce*=v;this.imuln(ce),this.words[0]+m<67108864?this.words[0]+=m:this._iaddn(m)}this._strip()},a.prototype.copy=function(h){h.words=new Array(this.length);for(var v=0;v<this.length;v++)h.words[v]=this.words[v];h.length=this.length,h.negative=this.negative,h.red=this.red};function w($,h){$.words=h.words,$.length=h.length,$.negative=h.negative,$.red=h.red}if(a.prototype._move=function(h){w(h,this)},a.prototype.clone=function(){var h=new a(null);return this.copy(h),h},a.prototype._expand=function(h){for(;this.length<h;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{a.prototype[Symbol.for("nodejs.util.inspect.custom")]=b}catch{a.prototype.inspect=b}else a.prototype.inspect=b;function b(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var S=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],I=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],M=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(h,v){h=h||10,v=v|0||1;var x;if(h===16||h==="hex"){x="";for(var P=0,A=0,R=0;R<this.length;R++){var j=this.words[R],O=((j<<P|A)&16777215).toString(16);A=j>>>24-P&16777215,P+=2,P>=26&&(P-=26,R--),A!==0||R!==this.length-1?x=S[6-O.length]+O+x:x=O+x}for(A!==0&&(x=A.toString(16)+x);x.length%v!==0;)x="0"+x;return this.negative!==0&&(x="-"+x),x}if(h===(h|0)&&h>=2&&h<=36){var m=I[h],L=M[h];x="";var ce=this.clone();for(ce.negative=0;!ce.isZero();){var _=ce.modrn(L).toString(h);ce=ce.idivn(L),ce.isZero()?x=_+x:x=S[m-_.length]+_+x}for(this.isZero()&&(x="0"+x);x.length%v!==0;)x="0"+x;return this.negative!==0&&(x="-"+x),x}n(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var h=this.words[0];return this.length===2?h+=this.words[1]*67108864:this.length===3&&this.words[2]===1?h+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-h:h},a.prototype.toJSON=function(){return this.toString(16,2)},u&&(a.prototype.toBuffer=function(h,v){return this.toArrayLike(u,h,v)}),a.prototype.toArray=function(h,v){return this.toArrayLike(Array,h,v)};var z=function(h,v){return h.allocUnsafe?h.allocUnsafe(v):new h(v)};a.prototype.toArrayLike=function(h,v,x){this._strip();var P=this.byteLength(),A=x||Math.max(1,P);n(P<=A,"byte array longer than desired length"),n(A>0,"Requested array length <= 0");var R=z(h,A),j=v==="le"?"LE":"BE";return this["_toArrayLike"+j](R,P),R},a.prototype._toArrayLikeLE=function(h,v){for(var x=0,P=0,A=0,R=0;A<this.length;A++){var j=this.words[A]<<R|P;h[x++]=j&255,x<h.length&&(h[x++]=j>>8&255),x<h.length&&(h[x++]=j>>16&255),R===6?(x<h.length&&(h[x++]=j>>24&255),P=0,R=0):(P=j>>>24,R+=2)}if(x<h.length)for(h[x++]=P;x<h.length;)h[x++]=0},a.prototype._toArrayLikeBE=function(h,v){for(var x=h.length-1,P=0,A=0,R=0;A<this.length;A++){var j=this.words[A]<<R|P;h[x--]=j&255,x>=0&&(h[x--]=j>>8&255),x>=0&&(h[x--]=j>>16&255),R===6?(x>=0&&(h[x--]=j>>24&255),P=0,R=0):(P=j>>>24,R+=2)}if(x>=0)for(h[x--]=P;x>=0;)h[x--]=0},Math.clz32?a.prototype._countBits=function(h){return 32-Math.clz32(h)}:a.prototype._countBits=function(h){var v=h,x=0;return v>=4096&&(x+=13,v>>>=13),v>=64&&(x+=7,v>>>=7),v>=8&&(x+=4,v>>>=4),v>=2&&(x+=2,v>>>=2),x+v},a.prototype._zeroBits=function(h){if(h===0)return 26;var v=h,x=0;return v&8191||(x+=13,v>>>=13),v&127||(x+=7,v>>>=7),v&15||(x+=4,v>>>=4),v&3||(x+=2,v>>>=2),v&1||x++,x},a.prototype.bitLength=function(){var h=this.words[this.length-1],v=this._countBits(h);return(this.length-1)*26+v};function k($){for(var h=new Array($.bitLength()),v=0;v<h.length;v++){var x=v/26|0,P=v%26;h[v]=$.words[x]>>>P&1}return h}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var h=0,v=0;v<this.length;v++){var x=this._zeroBits(this.words[v]);if(h+=x,x!==26)break}return h},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(h){return this.negative!==0?this.abs().inotn(h).iaddn(1):this.clone()},a.prototype.fromTwos=function(h){return this.testn(h-1)?this.notn(h).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(h){for(;this.length<h.length;)this.words[this.length++]=0;for(var v=0;v<h.length;v++)this.words[v]=this.words[v]|h.words[v];return this._strip()},a.prototype.ior=function(h){return n((this.negative|h.negative)===0),this.iuor(h)},a.prototype.or=function(h){return this.length>h.length?this.clone().ior(h):h.clone().ior(this)},a.prototype.uor=function(h){return this.length>h.length?this.clone().iuor(h):h.clone().iuor(this)},a.prototype.iuand=function(h){var v;this.length>h.length?v=h:v=this;for(var x=0;x<v.length;x++)this.words[x]=this.words[x]&h.words[x];return this.length=v.length,this._strip()},a.prototype.iand=function(h){return n((this.negative|h.negative)===0),this.iuand(h)},a.prototype.and=function(h){return this.length>h.length?this.clone().iand(h):h.clone().iand(this)},a.prototype.uand=function(h){return this.length>h.length?this.clone().iuand(h):h.clone().iuand(this)},a.prototype.iuxor=function(h){var v,x;this.length>h.length?(v=this,x=h):(v=h,x=this);for(var P=0;P<x.length;P++)this.words[P]=v.words[P]^x.words[P];if(this!==v)for(;P<v.length;P++)this.words[P]=v.words[P];return this.length=v.length,this._strip()},a.prototype.ixor=function(h){return n((this.negative|h.negative)===0),this.iuxor(h)},a.prototype.xor=function(h){return this.length>h.length?this.clone().ixor(h):h.clone().ixor(this)},a.prototype.uxor=function(h){return this.length>h.length?this.clone().iuxor(h):h.clone().iuxor(this)},a.prototype.inotn=function(h){n(typeof h=="number"&&h>=0);var v=Math.ceil(h/26)|0,x=h%26;this._expand(v),x>0&&v--;for(var P=0;P<v;P++)this.words[P]=~this.words[P]&67108863;return x>0&&(this.words[P]=~this.words[P]&67108863>>26-x),this._strip()},a.prototype.notn=function(h){return this.clone().inotn(h)},a.prototype.setn=function(h,v){n(typeof h=="number"&&h>=0);var x=h/26|0,P=h%26;return this._expand(x+1),v?this.words[x]=this.words[x]|1<<P:this.words[x]=this.words[x]&~(1<<P),this._strip()},a.prototype.iadd=function(h){var v;if(this.negative!==0&&h.negative===0)return this.negative=0,v=this.isub(h),this.negative^=1,this._normSign();if(this.negative===0&&h.negative!==0)return h.negative=0,v=this.isub(h),h.negative=1,v._normSign();var x,P;this.length>h.length?(x=this,P=h):(x=h,P=this);for(var A=0,R=0;R<P.length;R++)v=(x.words[R]|0)+(P.words[R]|0)+A,this.words[R]=v&67108863,A=v>>>26;for(;A!==0&&R<x.length;R++)v=(x.words[R]|0)+A,this.words[R]=v&67108863,A=v>>>26;if(this.length=x.length,A!==0)this.words[this.length]=A,this.length++;else if(x!==this)for(;R<x.length;R++)this.words[R]=x.words[R];return this},a.prototype.add=function(h){var v;return h.negative!==0&&this.negative===0?(h.negative=0,v=this.sub(h),h.negative^=1,v):h.negative===0&&this.negative!==0?(this.negative=0,v=h.sub(this),this.negative=1,v):this.length>h.length?this.clone().iadd(h):h.clone().iadd(this)},a.prototype.isub=function(h){if(h.negative!==0){h.negative=0;var v=this.iadd(h);return h.negative=1,v._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(h),this.negative=1,this._normSign();var x=this.cmp(h);if(x===0)return this.negative=0,this.length=1,this.words[0]=0,this;var P,A;x>0?(P=this,A=h):(P=h,A=this);for(var R=0,j=0;j<A.length;j++)v=(P.words[j]|0)-(A.words[j]|0)+R,R=v>>26,this.words[j]=v&67108863;for(;R!==0&&j<P.length;j++)v=(P.words[j]|0)+R,R=v>>26,this.words[j]=v&67108863;if(R===0&&j<P.length&&P!==this)for(;j<P.length;j++)this.words[j]=P.words[j];return this.length=Math.max(this.length,j),P!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(h){return this.clone().isub(h)};function Y($,h,v){v.negative=h.negative^$.negative;var x=$.length+h.length|0;v.length=x,x=x-1|0;var P=$.words[0]|0,A=h.words[0]|0,R=P*A,j=R&67108863,O=R/67108864|0;v.words[0]=j;for(var m=1;m<x;m++){for(var L=O>>>26,ce=O&67108863,_=Math.min(m,h.length-1),G=Math.max(0,m-$.length+1);G<=_;G++){var U=m-G|0;P=$.words[U]|0,A=h.words[G]|0,R=P*A+ce,L+=R/67108864|0,ce=R&67108863}v.words[m]=ce|0,O=L|0}return O!==0?v.words[m]=O|0:v.length--,v._strip()}var te=function(h,v,x){var P=h.words,A=v.words,R=x.words,j=0,O,m,L,ce=P[0]|0,_=ce&8191,G=ce>>>13,U=P[1]|0,T=U&8191,F=U>>>13,g=P[2]|0,N=g&8191,ee=g>>>13,le=P[3]|0,se=le&8191,ve=le>>>13,et=P[4]|0,Ae=et&8191,qe=et>>>13,bt=P[5]|0,Pe=bt&8191,_e=bt>>>13,je=P[6]|0,xe=je&8191,De=je>>>13,Te=P[7]|0,Se=Te&8191,ye=Te>>>13,$e=P[8]|0,Me=$e&8191,be=$e>>>13,tt=P[9]|0,Le=tt&8191,Re=tt>>>13,st=A[0]|0,Ce=st&8191,at=st>>>13,nr=A[1]|0,gt=nr&8191,ut=nr>>>13,Ar=A[2]|0,wt=Ar&8191,_t=Ar>>>13,St=A[3]|0,Be=St&8191,We=St>>>13,It=A[4]|0,ke=It&8191,Ke=It>>>13,Rt=A[5]|0,Ze=Rt&8191,Ge=Rt>>>13,Nt=A[6]|0,Ve=Nt&8191,Ye=Nt>>>13,At=A[7]|0,Fe=At&8191,Qe=At>>>13,Tt=A[8]|0,Pt=Tt&8191,Dt=Tt>>>13,Cn=A[9]|0,lt=Cn&8191,Mt=Cn>>>13;x.negative=h.negative^v.negative,x.length=19,O=Math.imul(_,Ce),m=Math.imul(_,at),m=m+Math.imul(G,Ce)|0,L=Math.imul(G,at);var ln=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(ln>>>26)|0,ln&=67108863,O=Math.imul(T,Ce),m=Math.imul(T,at),m=m+Math.imul(F,Ce)|0,L=Math.imul(F,at),O=O+Math.imul(_,gt)|0,m=m+Math.imul(_,ut)|0,m=m+Math.imul(G,gt)|0,L=L+Math.imul(G,ut)|0;var dn=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(dn>>>26)|0,dn&=67108863,O=Math.imul(N,Ce),m=Math.imul(N,at),m=m+Math.imul(ee,Ce)|0,L=Math.imul(ee,at),O=O+Math.imul(T,gt)|0,m=m+Math.imul(T,ut)|0,m=m+Math.imul(F,gt)|0,L=L+Math.imul(F,ut)|0,O=O+Math.imul(_,wt)|0,m=m+Math.imul(_,_t)|0,m=m+Math.imul(G,wt)|0,L=L+Math.imul(G,_t)|0;var pn=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(pn>>>26)|0,pn&=67108863,O=Math.imul(se,Ce),m=Math.imul(se,at),m=m+Math.imul(ve,Ce)|0,L=Math.imul(ve,at),O=O+Math.imul(N,gt)|0,m=m+Math.imul(N,ut)|0,m=m+Math.imul(ee,gt)|0,L=L+Math.imul(ee,ut)|0,O=O+Math.imul(T,wt)|0,m=m+Math.imul(T,_t)|0,m=m+Math.imul(F,wt)|0,L=L+Math.imul(F,_t)|0,O=O+Math.imul(_,Be)|0,m=m+Math.imul(_,We)|0,m=m+Math.imul(G,Be)|0,L=L+Math.imul(G,We)|0;var gn=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(gn>>>26)|0,gn&=67108863,O=Math.imul(Ae,Ce),m=Math.imul(Ae,at),m=m+Math.imul(qe,Ce)|0,L=Math.imul(qe,at),O=O+Math.imul(se,gt)|0,m=m+Math.imul(se,ut)|0,m=m+Math.imul(ve,gt)|0,L=L+Math.imul(ve,ut)|0,O=O+Math.imul(N,wt)|0,m=m+Math.imul(N,_t)|0,m=m+Math.imul(ee,wt)|0,L=L+Math.imul(ee,_t)|0,O=O+Math.imul(T,Be)|0,m=m+Math.imul(T,We)|0,m=m+Math.imul(F,Be)|0,L=L+Math.imul(F,We)|0,O=O+Math.imul(_,ke)|0,m=m+Math.imul(_,Ke)|0,m=m+Math.imul(G,ke)|0,L=L+Math.imul(G,Ke)|0;var mr=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(mr>>>26)|0,mr&=67108863,O=Math.imul(Pe,Ce),m=Math.imul(Pe,at),m=m+Math.imul(_e,Ce)|0,L=Math.imul(_e,at),O=O+Math.imul(Ae,gt)|0,m=m+Math.imul(Ae,ut)|0,m=m+Math.imul(qe,gt)|0,L=L+Math.imul(qe,ut)|0,O=O+Math.imul(se,wt)|0,m=m+Math.imul(se,_t)|0,m=m+Math.imul(ve,wt)|0,L=L+Math.imul(ve,_t)|0,O=O+Math.imul(N,Be)|0,m=m+Math.imul(N,We)|0,m=m+Math.imul(ee,Be)|0,L=L+Math.imul(ee,We)|0,O=O+Math.imul(T,ke)|0,m=m+Math.imul(T,Ke)|0,m=m+Math.imul(F,ke)|0,L=L+Math.imul(F,Ke)|0,O=O+Math.imul(_,Ze)|0,m=m+Math.imul(_,Ge)|0,m=m+Math.imul(G,Ze)|0,L=L+Math.imul(G,Ge)|0;var Hn=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(Hn>>>26)|0,Hn&=67108863,O=Math.imul(xe,Ce),m=Math.imul(xe,at),m=m+Math.imul(De,Ce)|0,L=Math.imul(De,at),O=O+Math.imul(Pe,gt)|0,m=m+Math.imul(Pe,ut)|0,m=m+Math.imul(_e,gt)|0,L=L+Math.imul(_e,ut)|0,O=O+Math.imul(Ae,wt)|0,m=m+Math.imul(Ae,_t)|0,m=m+Math.imul(qe,wt)|0,L=L+Math.imul(qe,_t)|0,O=O+Math.imul(se,Be)|0,m=m+Math.imul(se,We)|0,m=m+Math.imul(ve,Be)|0,L=L+Math.imul(ve,We)|0,O=O+Math.imul(N,ke)|0,m=m+Math.imul(N,Ke)|0,m=m+Math.imul(ee,ke)|0,L=L+Math.imul(ee,Ke)|0,O=O+Math.imul(T,Ze)|0,m=m+Math.imul(T,Ge)|0,m=m+Math.imul(F,Ze)|0,L=L+Math.imul(F,Ge)|0,O=O+Math.imul(_,Ve)|0,m=m+Math.imul(_,Ye)|0,m=m+Math.imul(G,Ve)|0,L=L+Math.imul(G,Ye)|0;var Vi=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(Vi>>>26)|0,Vi&=67108863,O=Math.imul(Se,Ce),m=Math.imul(Se,at),m=m+Math.imul(ye,Ce)|0,L=Math.imul(ye,at),O=O+Math.imul(xe,gt)|0,m=m+Math.imul(xe,ut)|0,m=m+Math.imul(De,gt)|0,L=L+Math.imul(De,ut)|0,O=O+Math.imul(Pe,wt)|0,m=m+Math.imul(Pe,_t)|0,m=m+Math.imul(_e,wt)|0,L=L+Math.imul(_e,_t)|0,O=O+Math.imul(Ae,Be)|0,m=m+Math.imul(Ae,We)|0,m=m+Math.imul(qe,Be)|0,L=L+Math.imul(qe,We)|0,O=O+Math.imul(se,ke)|0,m=m+Math.imul(se,Ke)|0,m=m+Math.imul(ve,ke)|0,L=L+Math.imul(ve,Ke)|0,O=O+Math.imul(N,Ze)|0,m=m+Math.imul(N,Ge)|0,m=m+Math.imul(ee,Ze)|0,L=L+Math.imul(ee,Ge)|0,O=O+Math.imul(T,Ve)|0,m=m+Math.imul(T,Ye)|0,m=m+Math.imul(F,Ve)|0,L=L+Math.imul(F,Ye)|0,O=O+Math.imul(_,Fe)|0,m=m+Math.imul(_,Qe)|0,m=m+Math.imul(G,Fe)|0,L=L+Math.imul(G,Qe)|0;var kn=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(kn>>>26)|0,kn&=67108863,O=Math.imul(Me,Ce),m=Math.imul(Me,at),m=m+Math.imul(be,Ce)|0,L=Math.imul(be,at),O=O+Math.imul(Se,gt)|0,m=m+Math.imul(Se,ut)|0,m=m+Math.imul(ye,gt)|0,L=L+Math.imul(ye,ut)|0,O=O+Math.imul(xe,wt)|0,m=m+Math.imul(xe,_t)|0,m=m+Math.imul(De,wt)|0,L=L+Math.imul(De,_t)|0,O=O+Math.imul(Pe,Be)|0,m=m+Math.imul(Pe,We)|0,m=m+Math.imul(_e,Be)|0,L=L+Math.imul(_e,We)|0,O=O+Math.imul(Ae,ke)|0,m=m+Math.imul(Ae,Ke)|0,m=m+Math.imul(qe,ke)|0,L=L+Math.imul(qe,Ke)|0,O=O+Math.imul(se,Ze)|0,m=m+Math.imul(se,Ge)|0,m=m+Math.imul(ve,Ze)|0,L=L+Math.imul(ve,Ge)|0,O=O+Math.imul(N,Ve)|0,m=m+Math.imul(N,Ye)|0,m=m+Math.imul(ee,Ve)|0,L=L+Math.imul(ee,Ye)|0,O=O+Math.imul(T,Fe)|0,m=m+Math.imul(T,Qe)|0,m=m+Math.imul(F,Fe)|0,L=L+Math.imul(F,Qe)|0,O=O+Math.imul(_,Pt)|0,m=m+Math.imul(_,Dt)|0,m=m+Math.imul(G,Pt)|0,L=L+Math.imul(G,Dt)|0;var Ji=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(Ji>>>26)|0,Ji&=67108863,O=Math.imul(Le,Ce),m=Math.imul(Le,at),m=m+Math.imul(Re,Ce)|0,L=Math.imul(Re,at),O=O+Math.imul(Me,gt)|0,m=m+Math.imul(Me,ut)|0,m=m+Math.imul(be,gt)|0,L=L+Math.imul(be,ut)|0,O=O+Math.imul(Se,wt)|0,m=m+Math.imul(Se,_t)|0,m=m+Math.imul(ye,wt)|0,L=L+Math.imul(ye,_t)|0,O=O+Math.imul(xe,Be)|0,m=m+Math.imul(xe,We)|0,m=m+Math.imul(De,Be)|0,L=L+Math.imul(De,We)|0,O=O+Math.imul(Pe,ke)|0,m=m+Math.imul(Pe,Ke)|0,m=m+Math.imul(_e,ke)|0,L=L+Math.imul(_e,Ke)|0,O=O+Math.imul(Ae,Ze)|0,m=m+Math.imul(Ae,Ge)|0,m=m+Math.imul(qe,Ze)|0,L=L+Math.imul(qe,Ge)|0,O=O+Math.imul(se,Ve)|0,m=m+Math.imul(se,Ye)|0,m=m+Math.imul(ve,Ve)|0,L=L+Math.imul(ve,Ye)|0,O=O+Math.imul(N,Fe)|0,m=m+Math.imul(N,Qe)|0,m=m+Math.imul(ee,Fe)|0,L=L+Math.imul(ee,Qe)|0,O=O+Math.imul(T,Pt)|0,m=m+Math.imul(T,Dt)|0,m=m+Math.imul(F,Pt)|0,L=L+Math.imul(F,Dt)|0,O=O+Math.imul(_,lt)|0,m=m+Math.imul(_,Mt)|0,m=m+Math.imul(G,lt)|0,L=L+Math.imul(G,Mt)|0;var Yi=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(Yi>>>26)|0,Yi&=67108863,O=Math.imul(Le,gt),m=Math.imul(Le,ut),m=m+Math.imul(Re,gt)|0,L=Math.imul(Re,ut),O=O+Math.imul(Me,wt)|0,m=m+Math.imul(Me,_t)|0,m=m+Math.imul(be,wt)|0,L=L+Math.imul(be,_t)|0,O=O+Math.imul(Se,Be)|0,m=m+Math.imul(Se,We)|0,m=m+Math.imul(ye,Be)|0,L=L+Math.imul(ye,We)|0,O=O+Math.imul(xe,ke)|0,m=m+Math.imul(xe,Ke)|0,m=m+Math.imul(De,ke)|0,L=L+Math.imul(De,Ke)|0,O=O+Math.imul(Pe,Ze)|0,m=m+Math.imul(Pe,Ge)|0,m=m+Math.imul(_e,Ze)|0,L=L+Math.imul(_e,Ge)|0,O=O+Math.imul(Ae,Ve)|0,m=m+Math.imul(Ae,Ye)|0,m=m+Math.imul(qe,Ve)|0,L=L+Math.imul(qe,Ye)|0,O=O+Math.imul(se,Fe)|0,m=m+Math.imul(se,Qe)|0,m=m+Math.imul(ve,Fe)|0,L=L+Math.imul(ve,Qe)|0,O=O+Math.imul(N,Pt)|0,m=m+Math.imul(N,Dt)|0,m=m+Math.imul(ee,Pt)|0,L=L+Math.imul(ee,Dt)|0,O=O+Math.imul(T,lt)|0,m=m+Math.imul(T,Mt)|0,m=m+Math.imul(F,lt)|0,L=L+Math.imul(F,Mt)|0;var Wn=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(Wn>>>26)|0,Wn&=67108863,O=Math.imul(Le,wt),m=Math.imul(Le,_t),m=m+Math.imul(Re,wt)|0,L=Math.imul(Re,_t),O=O+Math.imul(Me,Be)|0,m=m+Math.imul(Me,We)|0,m=m+Math.imul(be,Be)|0,L=L+Math.imul(be,We)|0,O=O+Math.imul(Se,ke)|0,m=m+Math.imul(Se,Ke)|0,m=m+Math.imul(ye,ke)|0,L=L+Math.imul(ye,Ke)|0,O=O+Math.imul(xe,Ze)|0,m=m+Math.imul(xe,Ge)|0,m=m+Math.imul(De,Ze)|0,L=L+Math.imul(De,Ge)|0,O=O+Math.imul(Pe,Ve)|0,m=m+Math.imul(Pe,Ye)|0,m=m+Math.imul(_e,Ve)|0,L=L+Math.imul(_e,Ye)|0,O=O+Math.imul(Ae,Fe)|0,m=m+Math.imul(Ae,Qe)|0,m=m+Math.imul(qe,Fe)|0,L=L+Math.imul(qe,Qe)|0,O=O+Math.imul(se,Pt)|0,m=m+Math.imul(se,Dt)|0,m=m+Math.imul(ve,Pt)|0,L=L+Math.imul(ve,Dt)|0,O=O+Math.imul(N,lt)|0,m=m+Math.imul(N,Mt)|0,m=m+Math.imul(ee,lt)|0,L=L+Math.imul(ee,Mt)|0;var Ii=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(Ii>>>26)|0,Ii&=67108863,O=Math.imul(Le,Be),m=Math.imul(Le,We),m=m+Math.imul(Re,Be)|0,L=Math.imul(Re,We),O=O+Math.imul(Me,ke)|0,m=m+Math.imul(Me,Ke)|0,m=m+Math.imul(be,ke)|0,L=L+Math.imul(be,Ke)|0,O=O+Math.imul(Se,Ze)|0,m=m+Math.imul(Se,Ge)|0,m=m+Math.imul(ye,Ze)|0,L=L+Math.imul(ye,Ge)|0,O=O+Math.imul(xe,Ve)|0,m=m+Math.imul(xe,Ye)|0,m=m+Math.imul(De,Ve)|0,L=L+Math.imul(De,Ye)|0,O=O+Math.imul(Pe,Fe)|0,m=m+Math.imul(Pe,Qe)|0,m=m+Math.imul(_e,Fe)|0,L=L+Math.imul(_e,Qe)|0,O=O+Math.imul(Ae,Pt)|0,m=m+Math.imul(Ae,Dt)|0,m=m+Math.imul(qe,Pt)|0,L=L+Math.imul(qe,Dt)|0,O=O+Math.imul(se,lt)|0,m=m+Math.imul(se,Mt)|0,m=m+Math.imul(ve,lt)|0,L=L+Math.imul(ve,Mt)|0;var Ai=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(Ai>>>26)|0,Ai&=67108863,O=Math.imul(Le,ke),m=Math.imul(Le,Ke),m=m+Math.imul(Re,ke)|0,L=Math.imul(Re,Ke),O=O+Math.imul(Me,Ze)|0,m=m+Math.imul(Me,Ge)|0,m=m+Math.imul(be,Ze)|0,L=L+Math.imul(be,Ge)|0,O=O+Math.imul(Se,Ve)|0,m=m+Math.imul(Se,Ye)|0,m=m+Math.imul(ye,Ve)|0,L=L+Math.imul(ye,Ye)|0,O=O+Math.imul(xe,Fe)|0,m=m+Math.imul(xe,Qe)|0,m=m+Math.imul(De,Fe)|0,L=L+Math.imul(De,Qe)|0,O=O+Math.imul(Pe,Pt)|0,m=m+Math.imul(Pe,Dt)|0,m=m+Math.imul(_e,Pt)|0,L=L+Math.imul(_e,Dt)|0,O=O+Math.imul(Ae,lt)|0,m=m+Math.imul(Ae,Mt)|0,m=m+Math.imul(qe,lt)|0,L=L+Math.imul(qe,Mt)|0;var $r=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+($r>>>26)|0,$r&=67108863,O=Math.imul(Le,Ze),m=Math.imul(Le,Ge),m=m+Math.imul(Re,Ze)|0,L=Math.imul(Re,Ge),O=O+Math.imul(Me,Ve)|0,m=m+Math.imul(Me,Ye)|0,m=m+Math.imul(be,Ve)|0,L=L+Math.imul(be,Ye)|0,O=O+Math.imul(Se,Fe)|0,m=m+Math.imul(Se,Qe)|0,m=m+Math.imul(ye,Fe)|0,L=L+Math.imul(ye,Qe)|0,O=O+Math.imul(xe,Pt)|0,m=m+Math.imul(xe,Dt)|0,m=m+Math.imul(De,Pt)|0,L=L+Math.imul(De,Dt)|0,O=O+Math.imul(Pe,lt)|0,m=m+Math.imul(Pe,Mt)|0,m=m+Math.imul(_e,lt)|0,L=L+Math.imul(_e,Mt)|0;var Xi=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(Xi>>>26)|0,Xi&=67108863,O=Math.imul(Le,Ve),m=Math.imul(Le,Ye),m=m+Math.imul(Re,Ve)|0,L=Math.imul(Re,Ye),O=O+Math.imul(Me,Fe)|0,m=m+Math.imul(Me,Qe)|0,m=m+Math.imul(be,Fe)|0,L=L+Math.imul(be,Qe)|0,O=O+Math.imul(Se,Pt)|0,m=m+Math.imul(Se,Dt)|0,m=m+Math.imul(ye,Pt)|0,L=L+Math.imul(ye,Dt)|0,O=O+Math.imul(xe,lt)|0,m=m+Math.imul(xe,Mt)|0,m=m+Math.imul(De,lt)|0,L=L+Math.imul(De,Mt)|0;var Zi=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(Zi>>>26)|0,Zi&=67108863,O=Math.imul(Le,Fe),m=Math.imul(Le,Qe),m=m+Math.imul(Re,Fe)|0,L=Math.imul(Re,Qe),O=O+Math.imul(Me,Pt)|0,m=m+Math.imul(Me,Dt)|0,m=m+Math.imul(be,Pt)|0,L=L+Math.imul(be,Dt)|0,O=O+Math.imul(Se,lt)|0,m=m+Math.imul(Se,Mt)|0,m=m+Math.imul(ye,lt)|0,L=L+Math.imul(ye,Mt)|0;var Qi=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(Qi>>>26)|0,Qi&=67108863,O=Math.imul(Le,Pt),m=Math.imul(Le,Dt),m=m+Math.imul(Re,Pt)|0,L=Math.imul(Re,Dt),O=O+Math.imul(Me,lt)|0,m=m+Math.imul(Me,Mt)|0,m=m+Math.imul(be,lt)|0,L=L+Math.imul(be,Mt)|0;var es=(j+O|0)+((m&8191)<<13)|0;j=(L+(m>>>13)|0)+(es>>>26)|0,es&=67108863,O=Math.imul(Le,lt),m=Math.imul(Le,Mt),m=m+Math.imul(Re,lt)|0,L=Math.imul(Re,Mt);var Oi=(j+O|0)+((m&8191)<<13)|0;return j=(L+(m>>>13)|0)+(Oi>>>26)|0,Oi&=67108863,R[0]=ln,R[1]=dn,R[2]=pn,R[3]=gn,R[4]=mr,R[5]=Hn,R[6]=Vi,R[7]=kn,R[8]=Ji,R[9]=Yi,R[10]=Wn,R[11]=Ii,R[12]=Ai,R[13]=$r,R[14]=Xi,R[15]=Zi,R[16]=Qi,R[17]=es,R[18]=Oi,j!==0&&(R[19]=j,x.length++),x};Math.imul||(te=Y);function ie($,h,v){v.negative=h.negative^$.negative,v.length=$.length+h.length;for(var x=0,P=0,A=0;A<v.length-1;A++){var R=P;P=0;for(var j=x&67108863,O=Math.min(A,h.length-1),m=Math.max(0,A-$.length+1);m<=O;m++){var L=A-m,ce=$.words[L]|0,_=h.words[m]|0,G=ce*_,U=G&67108863;R=R+(G/67108864|0)|0,U=U+j|0,j=U&67108863,R=R+(U>>>26)|0,P+=R>>>26,R&=67108863}v.words[A]=j,x=R,R=P}return x!==0?v.words[A]=x:v.length--,v._strip()}function W($,h,v){return ie($,h,v)}a.prototype.mulTo=function(h,v){var x,P=this.length+h.length;return this.length===10&&h.length===10?x=te(this,h,v):P<63?x=Y(this,h,v):P<1024?x=ie(this,h,v):x=W(this,h,v),x},a.prototype.mul=function(h){var v=new a(null);return v.words=new Array(this.length+h.length),this.mulTo(h,v)},a.prototype.mulf=function(h){var v=new a(null);return v.words=new Array(this.length+h.length),W(this,h,v)},a.prototype.imul=function(h){return this.clone().mulTo(h,this)},a.prototype.imuln=function(h){var v=h<0;v&&(h=-h),n(typeof h=="number"),n(h<67108864);for(var x=0,P=0;P<this.length;P++){var A=(this.words[P]|0)*h,R=(A&67108863)+(x&67108863);x>>=26,x+=A/67108864|0,x+=R>>>26,this.words[P]=R&67108863}return x!==0&&(this.words[P]=x,this.length++),v?this.ineg():this},a.prototype.muln=function(h){return this.clone().imuln(h)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(h){var v=k(h);if(v.length===0)return new a(1);for(var x=this,P=0;P<v.length&&v[P]===0;P++,x=x.sqr());if(++P<v.length)for(var A=x.sqr();P<v.length;P++,A=A.sqr())v[P]!==0&&(x=x.mul(A));return x},a.prototype.iushln=function(h){n(typeof h=="number"&&h>=0);var v=h%26,x=(h-v)/26,P=67108863>>>26-v<<26-v,A;if(v!==0){var R=0;for(A=0;A<this.length;A++){var j=this.words[A]&P,O=(this.words[A]|0)-j<<v;this.words[A]=O|R,R=j>>>26-v}R&&(this.words[A]=R,this.length++)}if(x!==0){for(A=this.length-1;A>=0;A--)this.words[A+x]=this.words[A];for(A=0;A<x;A++)this.words[A]=0;this.length+=x}return this._strip()},a.prototype.ishln=function(h){return n(this.negative===0),this.iushln(h)},a.prototype.iushrn=function(h,v,x){n(typeof h=="number"&&h>=0);var P;v?P=(v-v%26)/26:P=0;var A=h%26,R=Math.min((h-A)/26,this.length),j=67108863^67108863>>>A<<A,O=x;if(P-=R,P=Math.max(0,P),O){for(var m=0;m<R;m++)O.words[m]=this.words[m];O.length=R}if(R!==0)if(this.length>R)for(this.length-=R,m=0;m<this.length;m++)this.words[m]=this.words[m+R];else this.words[0]=0,this.length=1;var L=0;for(m=this.length-1;m>=0&&(L!==0||m>=P);m--){var ce=this.words[m]|0;this.words[m]=L<<26-A|ce>>>A,L=ce&j}return O&&L!==0&&(O.words[O.length++]=L),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(h,v,x){return n(this.negative===0),this.iushrn(h,v,x)},a.prototype.shln=function(h){return this.clone().ishln(h)},a.prototype.ushln=function(h){return this.clone().iushln(h)},a.prototype.shrn=function(h){return this.clone().ishrn(h)},a.prototype.ushrn=function(h){return this.clone().iushrn(h)},a.prototype.testn=function(h){n(typeof h=="number"&&h>=0);var v=h%26,x=(h-v)/26,P=1<<v;if(this.length<=x)return!1;var A=this.words[x];return!!(A&P)},a.prototype.imaskn=function(h){n(typeof h=="number"&&h>=0);var v=h%26,x=(h-v)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=x)return this;if(v!==0&&x++,this.length=Math.min(x,this.length),v!==0){var P=67108863^67108863>>>v<<v;this.words[this.length-1]&=P}return this._strip()},a.prototype.maskn=function(h){return this.clone().imaskn(h)},a.prototype.iaddn=function(h){return n(typeof h=="number"),n(h<67108864),h<0?this.isubn(-h):this.negative!==0?this.length===1&&(this.words[0]|0)<=h?(this.words[0]=h-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(h),this.negative=1,this):this._iaddn(h)},a.prototype._iaddn=function(h){this.words[0]+=h;for(var v=0;v<this.length&&this.words[v]>=67108864;v++)this.words[v]-=67108864,v===this.length-1?this.words[v+1]=1:this.words[v+1]++;return this.length=Math.max(this.length,v+1),this},a.prototype.isubn=function(h){if(n(typeof h=="number"),n(h<67108864),h<0)return this.iaddn(-h);if(this.negative!==0)return this.negative=0,this.iaddn(h),this.negative=1,this;if(this.words[0]-=h,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var v=0;v<this.length&&this.words[v]<0;v++)this.words[v]+=67108864,this.words[v+1]-=1;return this._strip()},a.prototype.addn=function(h){return this.clone().iaddn(h)},a.prototype.subn=function(h){return this.clone().isubn(h)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(h,v,x){var P=h.length+x,A;this._expand(P);var R,j=0;for(A=0;A<h.length;A++){R=(this.words[A+x]|0)+j;var O=(h.words[A]|0)*v;R-=O&67108863,j=(R>>26)-(O/67108864|0),this.words[A+x]=R&67108863}for(;A<this.length-x;A++)R=(this.words[A+x]|0)+j,j=R>>26,this.words[A+x]=R&67108863;if(j===0)return this._strip();for(n(j===-1),j=0,A=0;A<this.length;A++)R=-(this.words[A]|0)+j,j=R>>26,this.words[A]=R&67108863;return this.negative=1,this._strip()},a.prototype._wordDiv=function(h,v){var x=this.length-h.length,P=this.clone(),A=h,R=A.words[A.length-1]|0,j=this._countBits(R);x=26-j,x!==0&&(A=A.ushln(x),P.iushln(x),R=A.words[A.length-1]|0);var O=P.length-A.length,m;if(v!=="mod"){m=new a(null),m.length=O+1,m.words=new Array(m.length);for(var L=0;L<m.length;L++)m.words[L]=0}var ce=P.clone()._ishlnsubmul(A,1,O);ce.negative===0&&(P=ce,m&&(m.words[O]=1));for(var _=O-1;_>=0;_--){var G=(P.words[A.length+_]|0)*67108864+(P.words[A.length+_-1]|0);for(G=Math.min(G/R|0,67108863),P._ishlnsubmul(A,G,_);P.negative!==0;)G--,P.negative=0,P._ishlnsubmul(A,1,_),P.isZero()||(P.negative^=1);m&&(m.words[_]=G)}return m&&m._strip(),P._strip(),v!=="div"&&x!==0&&P.iushrn(x),{div:m||null,mod:P}},a.prototype.divmod=function(h,v,x){if(n(!h.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var P,A,R;return this.negative!==0&&h.negative===0?(R=this.neg().divmod(h,v),v!=="mod"&&(P=R.div.neg()),v!=="div"&&(A=R.mod.neg(),x&&A.negative!==0&&A.iadd(h)),{div:P,mod:A}):this.negative===0&&h.negative!==0?(R=this.divmod(h.neg(),v),v!=="mod"&&(P=R.div.neg()),{div:P,mod:R.mod}):this.negative&h.negative?(R=this.neg().divmod(h.neg(),v),v!=="div"&&(A=R.mod.neg(),x&&A.negative!==0&&A.isub(h)),{div:R.div,mod:A}):h.length>this.length||this.cmp(h)<0?{div:new a(0),mod:this}:h.length===1?v==="div"?{div:this.divn(h.words[0]),mod:null}:v==="mod"?{div:null,mod:new a(this.modrn(h.words[0]))}:{div:this.divn(h.words[0]),mod:new a(this.modrn(h.words[0]))}:this._wordDiv(h,v)},a.prototype.div=function(h){return this.divmod(h,"div",!1).div},a.prototype.mod=function(h){return this.divmod(h,"mod",!1).mod},a.prototype.umod=function(h){return this.divmod(h,"mod",!0).mod},a.prototype.divRound=function(h){var v=this.divmod(h);if(v.mod.isZero())return v.div;var x=v.div.negative!==0?v.mod.isub(h):v.mod,P=h.ushrn(1),A=h.andln(1),R=x.cmp(P);return R<0||A===1&&R===0?v.div:v.div.negative!==0?v.div.isubn(1):v.div.iaddn(1)},a.prototype.modrn=function(h){var v=h<0;v&&(h=-h),n(h<=67108863);for(var x=(1<<26)%h,P=0,A=this.length-1;A>=0;A--)P=(x*P+(this.words[A]|0))%h;return v?-P:P},a.prototype.modn=function(h){return this.modrn(h)},a.prototype.idivn=function(h){var v=h<0;v&&(h=-h),n(h<=67108863);for(var x=0,P=this.length-1;P>=0;P--){var A=(this.words[P]|0)+x*67108864;this.words[P]=A/h|0,x=A%h}return this._strip(),v?this.ineg():this},a.prototype.divn=function(h){return this.clone().idivn(h)},a.prototype.egcd=function(h){n(h.negative===0),n(!h.isZero());var v=this,x=h.clone();v.negative!==0?v=v.umod(h):v=v.clone();for(var P=new a(1),A=new a(0),R=new a(0),j=new a(1),O=0;v.isEven()&&x.isEven();)v.iushrn(1),x.iushrn(1),++O;for(var m=x.clone(),L=v.clone();!v.isZero();){for(var ce=0,_=1;!(v.words[0]&_)&&ce<26;++ce,_<<=1);if(ce>0)for(v.iushrn(ce);ce-- >0;)(P.isOdd()||A.isOdd())&&(P.iadd(m),A.isub(L)),P.iushrn(1),A.iushrn(1);for(var G=0,U=1;!(x.words[0]&U)&&G<26;++G,U<<=1);if(G>0)for(x.iushrn(G);G-- >0;)(R.isOdd()||j.isOdd())&&(R.iadd(m),j.isub(L)),R.iushrn(1),j.iushrn(1);v.cmp(x)>=0?(v.isub(x),P.isub(R),A.isub(j)):(x.isub(v),R.isub(P),j.isub(A))}return{a:R,b:j,gcd:x.iushln(O)}},a.prototype._invmp=function(h){n(h.negative===0),n(!h.isZero());var v=this,x=h.clone();v.negative!==0?v=v.umod(h):v=v.clone();for(var P=new a(1),A=new a(0),R=x.clone();v.cmpn(1)>0&&x.cmpn(1)>0;){for(var j=0,O=1;!(v.words[0]&O)&&j<26;++j,O<<=1);if(j>0)for(v.iushrn(j);j-- >0;)P.isOdd()&&P.iadd(R),P.iushrn(1);for(var m=0,L=1;!(x.words[0]&L)&&m<26;++m,L<<=1);if(m>0)for(x.iushrn(m);m-- >0;)A.isOdd()&&A.iadd(R),A.iushrn(1);v.cmp(x)>=0?(v.isub(x),P.isub(A)):(x.isub(v),A.isub(P))}var ce;return v.cmpn(1)===0?ce=P:ce=A,ce.cmpn(0)<0&&ce.iadd(h),ce},a.prototype.gcd=function(h){if(this.isZero())return h.abs();if(h.isZero())return this.abs();var v=this.clone(),x=h.clone();v.negative=0,x.negative=0;for(var P=0;v.isEven()&&x.isEven();P++)v.iushrn(1),x.iushrn(1);do{for(;v.isEven();)v.iushrn(1);for(;x.isEven();)x.iushrn(1);var A=v.cmp(x);if(A<0){var R=v;v=x,x=R}else if(A===0||x.cmpn(1)===0)break;v.isub(x)}while(!0);return x.iushln(P)},a.prototype.invm=function(h){return this.egcd(h).a.umod(h)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(h){return this.words[0]&h},a.prototype.bincn=function(h){n(typeof h=="number");var v=h%26,x=(h-v)/26,P=1<<v;if(this.length<=x)return this._expand(x+1),this.words[x]|=P,this;for(var A=P,R=x;A!==0&&R<this.length;R++){var j=this.words[R]|0;j+=A,A=j>>>26,j&=67108863,this.words[R]=j}return A!==0&&(this.words[R]=A,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(h){var v=h<0;if(this.negative!==0&&!v)return-1;if(this.negative===0&&v)return 1;this._strip();var x;if(this.length>1)x=1;else{v&&(h=-h),n(h<=67108863,"Number is too big");var P=this.words[0]|0;x=P===h?0:P<h?-1:1}return this.negative!==0?-x|0:x},a.prototype.cmp=function(h){if(this.negative!==0&&h.negative===0)return-1;if(this.negative===0&&h.negative!==0)return 1;var v=this.ucmp(h);return this.negative!==0?-v|0:v},a.prototype.ucmp=function(h){if(this.length>h.length)return 1;if(this.length<h.length)return-1;for(var v=0,x=this.length-1;x>=0;x--){var P=this.words[x]|0,A=h.words[x]|0;if(P!==A){P<A?v=-1:P>A&&(v=1);break}}return v},a.prototype.gtn=function(h){return this.cmpn(h)===1},a.prototype.gt=function(h){return this.cmp(h)===1},a.prototype.gten=function(h){return this.cmpn(h)>=0},a.prototype.gte=function(h){return this.cmp(h)>=0},a.prototype.ltn=function(h){return this.cmpn(h)===-1},a.prototype.lt=function(h){return this.cmp(h)===-1},a.prototype.lten=function(h){return this.cmpn(h)<=0},a.prototype.lte=function(h){return this.cmp(h)<=0},a.prototype.eqn=function(h){return this.cmpn(h)===0},a.prototype.eq=function(h){return this.cmp(h)===0},a.red=function(h){return new pe(h)},a.prototype.toRed=function(h){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),h.convertTo(this)._forceRed(h)},a.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(h){return this.red=h,this},a.prototype.forceRed=function(h){return n(!this.red,"Already a number in reduction context"),this._forceRed(h)},a.prototype.redAdd=function(h){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,h)},a.prototype.redIAdd=function(h){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,h)},a.prototype.redSub=function(h){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,h)},a.prototype.redISub=function(h){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,h)},a.prototype.redShl=function(h){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,h)},a.prototype.redMul=function(h){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,h),this.red.mul(this,h)},a.prototype.redIMul=function(h){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,h),this.red.imul(this,h)},a.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(h){return n(this.red&&!h.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,h)};var Z={k256:null,p224:null,p192:null,p25519:null};function V($,h){this.name=$,this.p=new a(h,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}V.prototype._tmp=function(){var h=new a(null);return h.words=new Array(Math.ceil(this.n/13)),h},V.prototype.ireduce=function(h){var v=h,x;do this.split(v,this.tmp),v=this.imulK(v),v=v.iadd(this.tmp),x=v.bitLength();while(x>this.n);var P=x<this.n?-1:v.ucmp(this.p);return P===0?(v.words[0]=0,v.length=1):P>0?v.isub(this.p):v.strip!==void 0?v.strip():v._strip(),v},V.prototype.split=function(h,v){h.iushrn(this.n,0,v)},V.prototype.imulK=function(h){return h.imul(this.k)};function y(){V.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(y,V),y.prototype.split=function(h,v){for(var x=4194303,P=Math.min(h.length,9),A=0;A<P;A++)v.words[A]=h.words[A];if(v.length=P,h.length<=9){h.words[0]=0,h.length=1;return}var R=h.words[9];for(v.words[v.length++]=R&x,A=10;A<h.length;A++){var j=h.words[A]|0;h.words[A-10]=(j&x)<<4|R>>>22,R=j}R>>>=22,h.words[A-10]=R,R===0&&h.length>10?h.length-=10:h.length-=9},y.prototype.imulK=function(h){h.words[h.length]=0,h.words[h.length+1]=0,h.length+=2;for(var v=0,x=0;x<h.length;x++){var P=h.words[x]|0;v+=P*977,h.words[x]=v&67108863,v=P*64+(v/67108864|0)}return h.words[h.length-1]===0&&(h.length--,h.words[h.length-1]===0&&h.length--),h};function B(){V.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(B,V);function he(){V.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(he,V);function de(){V.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(de,V),de.prototype.imulK=function(h){for(var v=0,x=0;x<h.length;x++){var P=(h.words[x]|0)*19+v,A=P&67108863;P>>>=26,h.words[x]=A,v=P}return v!==0&&(h.words[h.length++]=v),h},a._prime=function(h){if(Z[h])return Z[h];var v;if(h==="k256")v=new y;else if(h==="p224")v=new B;else if(h==="p192")v=new he;else if(h==="p25519")v=new de;else throw new Error("Unknown prime "+h);return Z[h]=v,v};function pe($){if(typeof $=="string"){var h=a._prime($);this.m=h.p,this.prime=h}else n($.gtn(1),"modulus must be greater than 1"),this.m=$,this.prime=null}pe.prototype._verify1=function(h){n(h.negative===0,"red works only with positives"),n(h.red,"red works only with red numbers")},pe.prototype._verify2=function(h,v){n((h.negative|v.negative)===0,"red works only with positives"),n(h.red&&h.red===v.red,"red works only with red numbers")},pe.prototype.imod=function(h){return this.prime?this.prime.ireduce(h)._forceRed(this):(w(h,h.umod(this.m)._forceRed(this)),h)},pe.prototype.neg=function(h){return h.isZero()?h.clone():this.m.sub(h)._forceRed(this)},pe.prototype.add=function(h,v){this._verify2(h,v);var x=h.add(v);return x.cmp(this.m)>=0&&x.isub(this.m),x._forceRed(this)},pe.prototype.iadd=function(h,v){this._verify2(h,v);var x=h.iadd(v);return x.cmp(this.m)>=0&&x.isub(this.m),x},pe.prototype.sub=function(h,v){this._verify2(h,v);var x=h.sub(v);return x.cmpn(0)<0&&x.iadd(this.m),x._forceRed(this)},pe.prototype.isub=function(h,v){this._verify2(h,v);var x=h.isub(v);return x.cmpn(0)<0&&x.iadd(this.m),x},pe.prototype.shl=function(h,v){return this._verify1(h),this.imod(h.ushln(v))},pe.prototype.imul=function(h,v){return this._verify2(h,v),this.imod(h.imul(v))},pe.prototype.mul=function(h,v){return this._verify2(h,v),this.imod(h.mul(v))},pe.prototype.isqr=function(h){return this.imul(h,h.clone())},pe.prototype.sqr=function(h){return this.mul(h,h)},pe.prototype.sqrt=function(h){if(h.isZero())return h.clone();var v=this.m.andln(3);if(n(v%2===1),v===3){var x=this.m.add(new a(1)).iushrn(2);return this.pow(h,x)}for(var P=this.m.subn(1),A=0;!P.isZero()&&P.andln(1)===0;)A++,P.iushrn(1);n(!P.isZero());var R=new a(1).toRed(this),j=R.redNeg(),O=this.m.subn(1).iushrn(1),m=this.m.bitLength();for(m=new a(2*m*m).toRed(this);this.pow(m,O).cmp(j)!==0;)m.redIAdd(j);for(var L=this.pow(m,P),ce=this.pow(h,P.addn(1).iushrn(1)),_=this.pow(h,P),G=A;_.cmp(R)!==0;){for(var U=_,T=0;U.cmp(R)!==0;T++)U=U.redSqr();n(T<G);var F=this.pow(L,new a(1).iushln(G-T-1));ce=ce.redMul(F),L=F.redSqr(),_=_.redMul(L),G=T}return ce},pe.prototype.invm=function(h){var v=h._invmp(this.m);return v.negative!==0?(v.negative=0,this.imod(v).redNeg()):this.imod(v)},pe.prototype.pow=function(h,v){if(v.isZero())return new a(1).toRed(this);if(v.cmpn(1)===0)return h.clone();var x=4,P=new Array(1<<x);P[0]=new a(1).toRed(this),P[1]=h;for(var A=2;A<P.length;A++)P[A]=this.mul(P[A-1],h);var R=P[0],j=0,O=0,m=v.bitLength()%26;for(m===0&&(m=26),A=v.length-1;A>=0;A--){for(var L=v.words[A],ce=m-1;ce>=0;ce--){var _=L>>ce&1;if(R!==P[0]&&(R=this.sqr(R)),_===0&&j===0){O=0;continue}j<<=1,j|=_,O++,!(O!==x&&(A!==0||ce!==0))&&(R=this.mul(R,P[j]),O=0,j=0)}m=26}return R},pe.prototype.convertTo=function(h){var v=h.umod(this.m);return v===h?v.clone():v},pe.prototype.convertFrom=function(h){var v=h.clone();return v.red=null,v},a.mont=function(h){return new Ee(h)};function Ee($){pe.call(this,$),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(Ee,pe),Ee.prototype.convertTo=function(h){return this.imod(h.ushln(this.shift))},Ee.prototype.convertFrom=function(h){var v=this.imod(h.mul(this.rinv));return v.red=null,v},Ee.prototype.imul=function(h,v){if(h.isZero()||v.isZero())return h.words[0]=0,h.length=1,h;var x=h.imul(v),P=x.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),A=x.isub(P).iushrn(this.shift),R=A;return A.cmp(this.m)>=0?R=A.isub(this.m):A.cmpn(0)<0&&(R=A.iadd(this.m)),R._forceRed(this)},Ee.prototype.mul=function(h,v){if(h.isZero()||v.isZero())return new a(0)._forceRed(this);var x=h.mul(v),P=x.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),A=x.isub(P).iushrn(this.shift),R=A;return A.cmp(this.m)>=0?R=A.isub(this.m):A.cmpn(0)<0&&(R=A.iadd(this.m)),R._forceRed(this)},Ee.prototype.invm=function(h){var v=this.imod(h._invmp(this.m).mul(this.r2));return v._forceRed(this)}})(r,Pr)})(Vh);var sA=Vh.exports;const Xe=As(sA);var oA=Xe.BN;function aA(r){return new oA(r,36).toString(16)}const uA="strings/5.8.0",cA=new er(uA);var Qu;(function(r){r.current="",r.NFC="NFC",r.NFD="NFD",r.NFKC="NFKC",r.NFKD="NFKD"})(Qu||(Qu={}));var s0;(function(r){r.UNEXPECTED_CONTINUE="unexpected continuation byte",r.BAD_PREFIX="bad codepoint prefix",r.OVERRUN="string overrun",r.MISSING_CONTINUE="missing continuation byte",r.OUT_OF_RANGE="out of UTF-8 range",r.UTF16_SURROGATE="UTF-16 surrogate",r.OVERLONG="overlong representation"})(s0||(s0={}));function eh(r,e=Qu.current){e!=Qu.current&&(cA.checkNormalize(),r=r.normalize(e));let t=[];for(let n=0;n<r.length;n++){const i=r.charCodeAt(n);if(i<128)t.push(i);else if(i<2048)t.push(i>>6|192),t.push(i&63|128);else if((i&64512)==55296){n++;const a=r.charCodeAt(n);if(n>=r.length||(a&64512)!==56320)throw new Error("invalid utf-8 string");const u=65536+((i&1023)<<10)+(a&1023);t.push(u>>18|240),t.push(u>>12&63|128),t.push(u>>6&63|128),t.push(u&63|128)}else t.push(i>>12|224),t.push(i>>6&63|128),t.push(i&63|128)}return dr(t)}const fA=`Ethereum Signed Message:
`;function Wv(r){return typeof r=="string"&&(r=eh(r)),Gh(rA([eh(fA),eh(String(r.length)),r]))}const hA="address/5.8.0",Jo=new er(hA);function o0(r){ni(r,20)||Jo.throwArgumentError("invalid address","address",r),r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let i=0;i<40;i++)t[i]=e[i].charCodeAt(0);const n=dr(Gh(t));for(let i=0;i<40;i+=2)n[i>>1]>>4>=8&&(e[i]=e[i].toUpperCase()),(n[i>>1]&15)>=8&&(e[i+1]=e[i+1].toUpperCase());return"0x"+e.join("")}const lA=9007199254740991;function dA(r){return Math.log10?Math.log10(r):Math.log(r)/Math.LN10}const Jh={};for(let r=0;r<10;r++)Jh[String(r)]=String(r);for(let r=0;r<26;r++)Jh[String.fromCharCode(65+r)]=String(10+r);const a0=Math.floor(dA(lA));function pA(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(n=>Jh[n]).join("");for(;e.length>=a0;){let n=e.substring(0,a0);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}function gA(r){let e=null;if(typeof r!="string"&&Jo.throwArgumentError("invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/))r.substring(0,2)!=="0x"&&(r="0x"+r),e=o0(r),r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==r&&Jo.throwArgumentError("bad address checksum","address",r);else if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(r.substring(2,4)!==pA(r)&&Jo.throwArgumentError("bad icap checksum","address",r),e=aA(r.substring(4));e.length<40;)e="0"+e;e=o0("0x"+e)}else Jo.throwArgumentError("invalid address","address",r);return e}function Ko(r,e,t){Object.defineProperty(r,e,{enumerable:!0,value:t,writable:!1})}function wo(r,e,t){return t={path:e,exports:{},require:function(n,i){return vA(n,i??t.path)}},r(t,t.exports),t.exports}function vA(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Yh=Gv;function Gv(r,e){if(!r)throw new Error(e||"Assertion failed")}Gv.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)};var Kn=wo(function(r,e){var t=e;function n(u,f){if(Array.isArray(u))return u.slice();if(!u)return[];var d=[];if(typeof u!="string"){for(var l=0;l<u.length;l++)d[l]=u[l]|0;return d}if(f==="hex"){u=u.replace(/[^a-z0-9]+/ig,""),u.length%2!==0&&(u="0"+u);for(var l=0;l<u.length;l+=2)d.push(parseInt(u[l]+u[l+1],16))}else for(var l=0;l<u.length;l++){var w=u.charCodeAt(l),b=w>>8,S=w&255;b?d.push(b,S):d.push(S)}return d}t.toArray=n;function i(u){return u.length===1?"0"+u:u}t.zero2=i;function a(u){for(var f="",d=0;d<u.length;d++)f+=i(u[d].toString(16));return f}t.toHex=a,t.encode=function(f,d){return d==="hex"?a(f):f}}),hn=wo(function(r,e){var t=e;t.assert=Yh,t.toArray=Kn.toArray,t.zero2=Kn.zero2,t.toHex=Kn.toHex,t.encode=Kn.encode;function n(d,l,w){var b=new Array(Math.max(d.bitLength(),w)+1),S;for(S=0;S<b.length;S+=1)b[S]=0;var I=1<<l+1,M=d.clone();for(S=0;S<b.length;S++){var z,k=M.andln(I-1);M.isOdd()?(k>(I>>1)-1?z=(I>>1)-k:z=k,M.isubn(z)):z=0,b[S]=z,M.iushrn(1)}return b}t.getNAF=n;function i(d,l){var w=[[],[]];d=d.clone(),l=l.clone();for(var b=0,S=0,I;d.cmpn(-b)>0||l.cmpn(-S)>0;){var M=d.andln(3)+b&3,z=l.andln(3)+S&3;M===3&&(M=-1),z===3&&(z=-1);var k;M&1?(I=d.andln(7)+b&7,(I===3||I===5)&&z===2?k=-M:k=M):k=0,w[0].push(k);var Y;z&1?(I=l.andln(7)+S&7,(I===3||I===5)&&M===2?Y=-z:Y=z):Y=0,w[1].push(Y),2*b===k+1&&(b=1-b),2*S===Y+1&&(S=1-S),d.iushrn(1),l.iushrn(1)}return w}t.getJSF=i;function a(d,l,w){var b="_"+l;d.prototype[l]=function(){return this[b]!==void 0?this[b]:this[b]=w.call(this)}}t.cachedProperty=a;function u(d){return typeof d=="string"?t.toArray(d,"hex"):d}t.parseBytes=u;function f(d){return new Xe(d,"hex","le")}t.intFromLE=f}),ec=hn.getNAF,mA=hn.getJSF,tc=hn.assert;function ki(r,e){this.type=r,this.p=new Xe(e.p,16),this.red=e.prime?Xe.red(e.prime):Xe.mont(this.p),this.zero=new Xe(0).toRed(this.red),this.one=new Xe(1).toRed(this.red),this.two=new Xe(2).toRed(this.red),this.n=e.n&&new Xe(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Ls=ki;ki.prototype.point=function(){throw new Error("Not implemented")};ki.prototype.validate=function(){throw new Error("Not implemented")};ki.prototype._fixedNafMul=function(e,t){tc(e.precomputed);var n=e._getDoubles(),i=ec(t,1,this._bitLength),a=(1<<n.step+1)-(n.step%2===0?2:1);a/=3;var u=[],f,d;for(f=0;f<i.length;f+=n.step){d=0;for(var l=f+n.step-1;l>=f;l--)d=(d<<1)+i[l];u.push(d)}for(var w=this.jpoint(null,null,null),b=this.jpoint(null,null,null),S=a;S>0;S--){for(f=0;f<u.length;f++)d=u[f],d===S?b=b.mixedAdd(n.points[f]):d===-S&&(b=b.mixedAdd(n.points[f].neg()));w=w.add(b)}return w.toP()};ki.prototype._wnafMul=function(e,t){var n=4,i=e._getNAFPoints(n);n=i.wnd;for(var a=i.points,u=ec(t,n,this._bitLength),f=this.jpoint(null,null,null),d=u.length-1;d>=0;d--){for(var l=0;d>=0&&u[d]===0;d--)l++;if(d>=0&&l++,f=f.dblp(l),d<0)break;var w=u[d];tc(w!==0),e.type==="affine"?w>0?f=f.mixedAdd(a[w-1>>1]):f=f.mixedAdd(a[-w-1>>1].neg()):w>0?f=f.add(a[w-1>>1]):f=f.add(a[-w-1>>1].neg())}return e.type==="affine"?f.toP():f};ki.prototype._wnafMulAdd=function(e,t,n,i,a){var u=this._wnafT1,f=this._wnafT2,d=this._wnafT3,l=0,w,b,S;for(w=0;w<i;w++){S=t[w];var I=S._getNAFPoints(e);u[w]=I.wnd,f[w]=I.points}for(w=i-1;w>=1;w-=2){var M=w-1,z=w;if(u[M]!==1||u[z]!==1){d[M]=ec(n[M],u[M],this._bitLength),d[z]=ec(n[z],u[z],this._bitLength),l=Math.max(d[M].length,l),l=Math.max(d[z].length,l);continue}var k=[t[M],null,null,t[z]];t[M].y.cmp(t[z].y)===0?(k[1]=t[M].add(t[z]),k[2]=t[M].toJ().mixedAdd(t[z].neg())):t[M].y.cmp(t[z].y.redNeg())===0?(k[1]=t[M].toJ().mixedAdd(t[z]),k[2]=t[M].add(t[z].neg())):(k[1]=t[M].toJ().mixedAdd(t[z]),k[2]=t[M].toJ().mixedAdd(t[z].neg()));var Y=[-3,-1,-5,-7,0,7,5,1,3],te=mA(n[M],n[z]);for(l=Math.max(te[0].length,l),d[M]=new Array(l),d[z]=new Array(l),b=0;b<l;b++){var ie=te[0][b]|0,W=te[1][b]|0;d[M][b]=Y[(ie+1)*3+(W+1)],d[z][b]=0,f[M]=k}}var Z=this.jpoint(null,null,null),V=this._wnafT4;for(w=l;w>=0;w--){for(var y=0;w>=0;){var B=!0;for(b=0;b<i;b++)V[b]=d[b][w]|0,V[b]!==0&&(B=!1);if(!B)break;y++,w--}if(w>=0&&y++,Z=Z.dblp(y),w<0)break;for(b=0;b<i;b++){var he=V[b];he!==0&&(he>0?S=f[b][he-1>>1]:he<0&&(S=f[b][-he-1>>1].neg()),S.type==="affine"?Z=Z.mixedAdd(S):Z=Z.add(S))}}for(w=0;w<i;w++)f[w]=null;return a?Z:Z.toP()};function Pn(r,e){this.curve=r,this.type=e,this.precomputed=null}ki.BasePoint=Pn;Pn.prototype.eq=function(){throw new Error("Not implemented")};Pn.prototype.validate=function(){return this.curve.validate(this)};ki.prototype.decodePoint=function(e,t){e=hn.toArray(e,t);var n=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*n){e[0]===6?tc(e[e.length-1]%2===0):e[0]===7&&tc(e[e.length-1]%2===1);var i=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return i}else if((e[0]===2||e[0]===3)&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),e[0]===3);throw new Error("Unknown point format")};Pn.prototype.encodeCompressed=function(e){return this.encode(e,!0)};Pn.prototype._encode=function(e){var t=this.curve.p.byteLength(),n=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",t))};Pn.prototype.encode=function(e,t){return hn.encode(this._encode(t),e)};Pn.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};Pn.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};Pn.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,a=0;a<t;a+=e){for(var u=0;u<e;u++)i=i.dbl();n.push(i)}return{step:e,points:n}};Pn.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],n=(1<<e)-1,i=n===1?null:this.dbl(),a=1;a<n;a++)t[a]=t[a-1].add(i);return{wnd:e,points:t}};Pn.prototype._getBeta=function(){return null};Pn.prototype.dblp=function(e){for(var t=this,n=0;n<e;n++)t=t.dbl();return t};var Xh=wo(function(r){typeof Object.create=="function"?r.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:r.exports=function(t,n){if(n){t.super_=n;var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}}}),yA=hn.assert;function Dn(r){Ls.call(this,"short",r),this.a=new Xe(r.a,16).toRed(this.red),this.b=new Xe(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Xh(Dn,Ls);var wA=Dn;Dn.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,n;if(e.beta)t=new Xe(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);t=i[0].cmp(i[1])<0?i[0]:i[1],t=t.toRed(this.red)}if(e.lambda)n=new Xe(e.lambda,16);else{var a=this._getEndoRoots(this.n);this.g.mul(a[0]).x.cmp(this.g.x.redMul(t))===0?n=a[0]:(n=a[1],yA(this.g.mul(n).x.cmp(this.g.x.redMul(t))===0))}var u;return e.basis?u=e.basis.map(function(f){return{a:new Xe(f.a,16),b:new Xe(f.b,16)}}):u=this._getEndoBasis(n),{beta:t,lambda:n,basis:u}}};Dn.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:Xe.mont(e),n=new Xe(2).toRed(t).redInvm(),i=n.redNeg(),a=new Xe(3).toRed(t).redNeg().redSqrt().redMul(n),u=i.redAdd(a).fromRed(),f=i.redSub(a).fromRed();return[u,f]};Dn.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=e,i=this.n.clone(),a=new Xe(1),u=new Xe(0),f=new Xe(0),d=new Xe(1),l,w,b,S,I,M,z,k=0,Y,te;n.cmpn(0)!==0;){var ie=i.div(n);Y=i.sub(ie.mul(n)),te=f.sub(ie.mul(a));var W=d.sub(ie.mul(u));if(!b&&Y.cmp(t)<0)l=z.neg(),w=a,b=Y.neg(),S=te;else if(b&&++k===2)break;z=Y,i=n,n=Y,f=a,a=te,d=u,u=W}I=Y.neg(),M=te;var Z=b.sqr().add(S.sqr()),V=I.sqr().add(M.sqr());return V.cmp(Z)>=0&&(I=l,M=w),b.negative&&(b=b.neg(),S=S.neg()),I.negative&&(I=I.neg(),M=M.neg()),[{a:b,b:S},{a:I,b:M}]};Dn.prototype._endoSplit=function(e){var t=this.endo.basis,n=t[0],i=t[1],a=i.b.mul(e).divRound(this.n),u=n.b.neg().mul(e).divRound(this.n),f=a.mul(n.a),d=u.mul(i.a),l=a.mul(n.b),w=u.mul(i.b),b=e.sub(f).sub(d),S=l.add(w).neg();return{k1:b,k2:S}};Dn.prototype.pointFromX=function(e,t){e=new Xe(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var a=i.fromRed().isOdd();return(t&&!a||!t&&a)&&(i=i.redNeg()),this.point(e,i)};Dn.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,n=e.y,i=this.a.redMul(t),a=t.redSqr().redMul(t).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(a).cmpn(0)===0};Dn.prototype._endoWnafMulAdd=function(e,t,n){for(var i=this._endoWnafT1,a=this._endoWnafT2,u=0;u<e.length;u++){var f=this._endoSplit(t[u]),d=e[u],l=d._getBeta();f.k1.negative&&(f.k1.ineg(),d=d.neg(!0)),f.k2.negative&&(f.k2.ineg(),l=l.neg(!0)),i[u*2]=d,i[u*2+1]=l,a[u*2]=f.k1,a[u*2+1]=f.k2}for(var w=this._wnafMulAdd(1,i,a,u*2,n),b=0;b<u*2;b++)i[b]=null,a[b]=null;return w};function Ir(r,e,t,n){Ls.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Xe(e,16),this.y=new Xe(t,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Xh(Ir,Ls.BasePoint);Dn.prototype.point=function(e,t,n){return new Ir(this,e,t,n)};Dn.prototype.pointFromJSON=function(e,t){return Ir.fromJSON(this,e,t)};Ir.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,i=function(a){return n.point(a.x.redMul(n.endo.beta),a.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return t}};Ir.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Ir.fromJSON=function(e,t,n){typeof t=="string"&&(t=JSON.parse(t));var i=e.point(t[0],t[1],n);if(!t[2])return i;function a(f){return e.point(f[0],f[1],n)}var u=t[2];return i.precomputed={beta:null,doubles:u.doubles&&{step:u.doubles.step,points:[i].concat(u.doubles.points.map(a))},naf:u.naf&&{wnd:u.naf.wnd,points:[i].concat(u.naf.points.map(a))}},i};Ir.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Ir.prototype.isInfinity=function(){return this.inf};Ir.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var n=t.redSqr().redISub(this.x).redISub(e.x),i=t.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};Ir.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,n=this.x.redSqr(),i=e.redInvm(),a=n.redAdd(n).redIAdd(n).redIAdd(t).redMul(i),u=a.redSqr().redISub(this.x.redAdd(this.x)),f=a.redMul(this.x.redSub(u)).redISub(this.y);return this.curve.point(u,f)};Ir.prototype.getX=function(){return this.x.fromRed()};Ir.prototype.getY=function(){return this.y.fromRed()};Ir.prototype.mul=function(e){return e=new Xe(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Ir.prototype.mulAdd=function(e,t,n){var i=[this,t],a=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,a):this.curve._wnafMulAdd(1,i,a,2)};Ir.prototype.jmulAdd=function(e,t,n){var i=[this,t],a=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,a,!0):this.curve._wnafMulAdd(1,i,a,2,!0)};Ir.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Ir.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,i=function(a){return a.neg()};t.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return t};Ir.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Mr(r,e,t,n){Ls.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Xe(0)):(this.x=new Xe(e,16),this.y=new Xe(t,16),this.z=new Xe(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Xh(Mr,Ls.BasePoint);Dn.prototype.jpoint=function(e,t,n){return new Mr(this,e,t,n)};Mr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),n=this.x.redMul(t),i=this.y.redMul(t).redMul(e);return this.curve.point(n,i)};Mr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Mr.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(t),a=e.x.redMul(n),u=this.y.redMul(t.redMul(e.z)),f=e.y.redMul(n.redMul(this.z)),d=i.redSub(a),l=u.redSub(f);if(d.cmpn(0)===0)return l.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var w=d.redSqr(),b=w.redMul(d),S=i.redMul(w),I=l.redSqr().redIAdd(b).redISub(S).redISub(S),M=l.redMul(S.redISub(I)).redISub(u.redMul(b)),z=this.z.redMul(e.z).redMul(d);return this.curve.jpoint(I,M,z)};Mr.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),n=this.x,i=e.x.redMul(t),a=this.y,u=e.y.redMul(t).redMul(this.z),f=n.redSub(i),d=a.redSub(u);if(f.cmpn(0)===0)return d.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=f.redSqr(),w=l.redMul(f),b=n.redMul(l),S=d.redSqr().redIAdd(w).redISub(b).redISub(b),I=d.redMul(b.redISub(S)).redISub(a.redMul(w)),M=this.z.redMul(f);return this.curve.jpoint(S,I,M)};Mr.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var n=this;for(t=0;t<e;t++)n=n.dbl();return n}var i=this.curve.a,a=this.curve.tinv,u=this.x,f=this.y,d=this.z,l=d.redSqr().redSqr(),w=f.redAdd(f);for(t=0;t<e;t++){var b=u.redSqr(),S=w.redSqr(),I=S.redSqr(),M=b.redAdd(b).redIAdd(b).redIAdd(i.redMul(l)),z=u.redMul(S),k=M.redSqr().redISub(z.redAdd(z)),Y=z.redISub(k),te=M.redMul(Y);te=te.redIAdd(te).redISub(I);var ie=w.redMul(d);t+1<e&&(l=l.redMul(I)),u=k,d=ie,w=te}return this.curve.jpoint(u,w.redMul(a),d)};Mr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Mr.prototype._zeroDbl=function(){var e,t,n;if(this.zOne){var i=this.x.redSqr(),a=this.y.redSqr(),u=a.redSqr(),f=this.x.redAdd(a).redSqr().redISub(i).redISub(u);f=f.redIAdd(f);var d=i.redAdd(i).redIAdd(i),l=d.redSqr().redISub(f).redISub(f),w=u.redIAdd(u);w=w.redIAdd(w),w=w.redIAdd(w),e=l,t=d.redMul(f.redISub(l)).redISub(w),n=this.y.redAdd(this.y)}else{var b=this.x.redSqr(),S=this.y.redSqr(),I=S.redSqr(),M=this.x.redAdd(S).redSqr().redISub(b).redISub(I);M=M.redIAdd(M);var z=b.redAdd(b).redIAdd(b),k=z.redSqr(),Y=I.redIAdd(I);Y=Y.redIAdd(Y),Y=Y.redIAdd(Y),e=k.redISub(M).redISub(M),t=z.redMul(M.redISub(e)).redISub(Y),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,t,n)};Mr.prototype._threeDbl=function(){var e,t,n;if(this.zOne){var i=this.x.redSqr(),a=this.y.redSqr(),u=a.redSqr(),f=this.x.redAdd(a).redSqr().redISub(i).redISub(u);f=f.redIAdd(f);var d=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),l=d.redSqr().redISub(f).redISub(f);e=l;var w=u.redIAdd(u);w=w.redIAdd(w),w=w.redIAdd(w),t=d.redMul(f.redISub(l)).redISub(w),n=this.y.redAdd(this.y)}else{var b=this.z.redSqr(),S=this.y.redSqr(),I=this.x.redMul(S),M=this.x.redSub(b).redMul(this.x.redAdd(b));M=M.redAdd(M).redIAdd(M);var z=I.redIAdd(I);z=z.redIAdd(z);var k=z.redAdd(z);e=M.redSqr().redISub(k),n=this.y.redAdd(this.z).redSqr().redISub(S).redISub(b);var Y=S.redSqr();Y=Y.redIAdd(Y),Y=Y.redIAdd(Y),Y=Y.redIAdd(Y),t=M.redMul(z.redISub(e)).redISub(Y)}return this.curve.jpoint(e,t,n)};Mr.prototype._dbl=function(){var e=this.curve.a,t=this.x,n=this.y,i=this.z,a=i.redSqr().redSqr(),u=t.redSqr(),f=n.redSqr(),d=u.redAdd(u).redIAdd(u).redIAdd(e.redMul(a)),l=t.redAdd(t);l=l.redIAdd(l);var w=l.redMul(f),b=d.redSqr().redISub(w.redAdd(w)),S=w.redISub(b),I=f.redSqr();I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var M=d.redMul(S).redISub(I),z=n.redAdd(n).redMul(i);return this.curve.jpoint(b,M,z)};Mr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr(),i=t.redSqr(),a=e.redAdd(e).redIAdd(e),u=a.redSqr(),f=this.x.redAdd(t).redSqr().redISub(e).redISub(i);f=f.redIAdd(f),f=f.redAdd(f).redIAdd(f),f=f.redISub(u);var d=f.redSqr(),l=i.redIAdd(i);l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var w=a.redIAdd(f).redSqr().redISub(u).redISub(d).redISub(l),b=t.redMul(w);b=b.redIAdd(b),b=b.redIAdd(b);var S=this.x.redMul(d).redISub(b);S=S.redIAdd(S),S=S.redIAdd(S);var I=this.y.redMul(w.redMul(l.redISub(w)).redISub(f.redMul(d)));I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var M=this.z.redAdd(f).redSqr().redISub(n).redISub(d);return this.curve.jpoint(S,I,M)};Mr.prototype.mul=function(e,t){return e=new Xe(e,t),this.curve._wnafMul(this,e)};Mr.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),n=e.z.redSqr();if(this.x.redMul(n).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var i=t.redMul(this.z),a=n.redMul(e.z);return this.y.redMul(a).redISub(e.y.redMul(i)).cmpn(0)===0};Mr.prototype.eqXToP=function(e){var t=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(n)===0)return!0;for(var i=e.clone(),a=this.curve.redN.redMul(t);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(a),this.x.cmp(n)===0)return!0}};Mr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Mr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Tu=wo(function(r,e){var t=e;t.base=Ls,t.short=wA,t.mont=null,t.edwards=null}),$u=wo(function(r,e){var t=e,n=hn.assert;function i(f){f.type==="short"?this.curve=new Tu.short(f):f.type==="edwards"?this.curve=new Tu.edwards(f):this.curve=new Tu.mont(f),this.g=this.curve.g,this.n=this.curve.n,this.hash=f.hash,n(this.g.validate(),"Invalid curve"),n(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}t.PresetCurve=i;function a(f,d){Object.defineProperty(t,f,{configurable:!0,enumerable:!0,get:function(){var l=new i(d);return Object.defineProperty(t,f,{configurable:!0,enumerable:!0,value:l}),l}})}a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:mi.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:mi.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:mi.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:mi.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:mi.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:mi.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:mi.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var u;try{u=null.crash()}catch{u=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:mi.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",u]})});function zi(r){if(!(this instanceof zi))return new zi(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Kn.toArray(r.entropy,r.entropyEnc||"hex"),t=Kn.toArray(r.nonce,r.nonceEnc||"hex"),n=Kn.toArray(r.pers,r.persEnc||"hex");Yh(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,n)}var Vv=zi;zi.prototype._init=function(e,t,n){var i=e.concat(t).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var a=0;a<this.V.length;a++)this.K[a]=0,this.V[a]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656};zi.prototype._hmac=function(){return new mi.hmac(this.hash,this.K)};zi.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};zi.prototype.reseed=function(e,t,n,i){typeof t!="string"&&(i=n,n=t,t=null),e=Kn.toArray(e,t),n=Kn.toArray(n,i),Yh(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this._reseed=1};zi.prototype.generate=function(e,t,n,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(i=n,n=t,t=null),n&&(n=Kn.toArray(n,i||"hex"),this._update(n));for(var a=[];a.length<e;)this.V=this._hmac().update(this.V).digest(),a=a.concat(this.V);var u=a.slice(0,e);return this._update(n),this._reseed++,Kn.encode(u,t)};var Ah=hn.assert;function Tr(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var Zh=Tr;Tr.fromPublic=function(e,t,n){return t instanceof Tr?t:new Tr(e,{pub:t,pubEnc:n})};Tr.fromPrivate=function(e,t,n){return t instanceof Tr?t:new Tr(e,{priv:t,privEnc:n})};Tr.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Tr.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};Tr.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};Tr.prototype._importPrivate=function(e,t){this.priv=new Xe(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};Tr.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?Ah(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Ah(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};Tr.prototype.derive=function(e){return e.validate()||Ah(e.validate(),"public point not validated"),e.mul(this.priv).getX()};Tr.prototype.sign=function(e,t,n){return this.ec.sign(e,this,t,n)};Tr.prototype.verify=function(e,t,n){return this.ec.verify(e,t,this,void 0,n)};Tr.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var _A=hn.assert;function _c(r,e){if(r instanceof _c)return r;this._importDER(r,e)||(_A(r.r&&r.s,"Signature without r or s"),this.r=new Xe(r.r,16),this.s=new Xe(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}var bc=_c;function bA(){this.place=0}function th(r,e){var t=r[e.place++];if(!(t&128))return t;var n=t&15;if(n===0||n>4||r[e.place]===0)return!1;for(var i=0,a=0,u=e.place;a<n;a++,u++)i<<=8,i|=r[u],i>>>=0;return i<=127?!1:(e.place=u,i)}function u0(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}_c.prototype._importDER=function(e,t){e=hn.toArray(e,t);var n=new bA;if(e[n.place++]!==48)return!1;var i=th(e,n);if(i===!1||i+n.place!==e.length||e[n.place++]!==2)return!1;var a=th(e,n);if(a===!1||e[n.place]&128)return!1;var u=e.slice(n.place,a+n.place);if(n.place+=a,e[n.place++]!==2)return!1;var f=th(e,n);if(f===!1||e.length!==f+n.place||e[n.place]&128)return!1;var d=e.slice(n.place,f+n.place);if(u[0]===0)if(u[1]&128)u=u.slice(1);else return!1;if(d[0]===0)if(d[1]&128)d=d.slice(1);else return!1;return this.r=new Xe(u),this.s=new Xe(d),this.recoveryParam=null,!0};function rh(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}_c.prototype.toDER=function(e){var t=this.r.toArray(),n=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),n[0]&128&&(n=[0].concat(n)),t=u0(t),n=u0(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];rh(i,t.length),i=i.concat(t),i.push(2),rh(i,n.length);var a=i.concat(n),u=[48];return rh(u,a.length),u=u.concat(a),hn.encode(u,e)};var EA=function(){throw new Error("unsupported")},ws=hn.assert;function On(r){if(!(this instanceof On))return new On(r);typeof r=="string"&&(ws(Object.prototype.hasOwnProperty.call($u,r),"Unknown curve "+r),r=$u[r]),r instanceof $u.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}var xA=On;On.prototype.keyPair=function(e){return new Zh(this,e)};On.prototype.keyFromPrivate=function(e,t){return Zh.fromPrivate(this,e,t)};On.prototype.keyFromPublic=function(e,t){return Zh.fromPublic(this,e,t)};On.prototype.genKeyPair=function(e){e||(e={});for(var t=new Vv({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||EA(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new Xe(2));;){var a=new Xe(t.generate(n));if(!(a.cmp(i)>0))return a.iaddn(1),this.keyFromPrivate(a)}};On.prototype._truncateToN=function(e,t,n){var i;if(Xe.isBN(e)||typeof e=="number")e=new Xe(e,16),i=e.byteLength();else if(typeof e=="object")i=e.length,e=new Xe(e,16);else{var a=e.toString();i=a.length+1>>>1,e=new Xe(a,16)}typeof n!="number"&&(n=i*8);var u=n-this.n.bitLength();return u>0&&(e=e.ushrn(u)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};On.prototype.sign=function(e,t,n,i){if(typeof n=="object"&&(i=n,n=null),i||(i={}),typeof e!="string"&&typeof e!="number"&&!Xe.isBN(e)){ws(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),ws(e.length>>>0===e.length);for(var a=0;a<e.length;a++)ws((e[a]&255)===e[a])}t=this.keyFromPrivate(t,n),e=this._truncateToN(e,!1,i.msgBitLength),ws(!e.isNeg(),"Can not sign a negative message");var u=this.n.byteLength(),f=t.getPrivate().toArray("be",u),d=e.toArray("be",u);ws(new Xe(d).eq(e),"Can not sign message");for(var l=new Vv({hash:this.hash,entropy:f,nonce:d,pers:i.pers,persEnc:i.persEnc||"utf8"}),w=this.n.sub(new Xe(1)),b=0;;b++){var S=i.k?i.k(b):new Xe(l.generate(this.n.byteLength()));if(S=this._truncateToN(S,!0),!(S.cmpn(1)<=0||S.cmp(w)>=0)){var I=this.g.mul(S);if(!I.isInfinity()){var M=I.getX(),z=M.umod(this.n);if(z.cmpn(0)!==0){var k=S.invm(this.n).mul(z.mul(t.getPrivate()).iadd(e));if(k=k.umod(this.n),k.cmpn(0)!==0){var Y=(I.getY().isOdd()?1:0)|(M.cmp(z)!==0?2:0);return i.canonical&&k.cmp(this.nh)>0&&(k=this.n.sub(k),Y^=1),new bc({r:z,s:k,recoveryParam:Y})}}}}}};On.prototype.verify=function(e,t,n,i,a){a||(a={}),e=this._truncateToN(e,!1,a.msgBitLength),n=this.keyFromPublic(n,i),t=new bc(t,"hex");var u=t.r,f=t.s;if(u.cmpn(1)<0||u.cmp(this.n)>=0||f.cmpn(1)<0||f.cmp(this.n)>=0)return!1;var d=f.invm(this.n),l=d.mul(e).umod(this.n),w=d.mul(u).umod(this.n),b;return this.curve._maxwellTrick?(b=this.g.jmulAdd(l,n.getPublic(),w),b.isInfinity()?!1:b.eqXToP(u)):(b=this.g.mulAdd(l,n.getPublic(),w),b.isInfinity()?!1:b.getX().umod(this.n).cmp(u)===0)};On.prototype.recoverPubKey=function(r,e,t,n){ws((3&t)===t,"The recovery param is more than two bits"),e=new bc(e,n);var i=this.n,a=new Xe(r),u=e.r,f=e.s,d=t&1,l=t>>1;if(u.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");l?u=this.curve.pointFromX(u.add(this.curve.n),d):u=this.curve.pointFromX(u,d);var w=e.r.invm(i),b=i.sub(a).mul(w).umod(i),S=f.mul(w).umod(i);return this.g.mulAdd(b,u,S)};On.prototype.getKeyRecoveryParam=function(r,e,t,n){if(e=new bc(e,n),e.recoveryParam!==null)return e.recoveryParam;for(var i=0;i<4;i++){var a;try{a=this.recoverPubKey(r,e,i)}catch{continue}if(a.eq(t))return i}throw new Error("Unable to find valid recovery factor")};var SA=wo(function(r,e){var t=e;t.version="6.6.1",t.utils=hn,t.rand=function(){throw new Error("unsupported")},t.curve=Tu,t.curves=$u,t.ec=xA,t.eddsa=null}),IA=SA.ec;const AA="signing-key/5.8.0",Oh=new er(AA);let nh=null;function Ui(){return nh||(nh=new IA("secp256k1")),nh}class OA{constructor(e){Ko(this,"curve","secp256k1"),Ko(this,"privateKey",an(e)),iA(this.privateKey)!==32&&Oh.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const t=Ui().keyFromPrivate(dr(this.privateKey));Ko(this,"publicKey","0x"+t.getPublic(!1,"hex")),Ko(this,"compressedPublicKey","0x"+t.getPublic(!0,"hex")),Ko(this,"_isSigningKey",!0)}_addPoint(e){const t=Ui().keyFromPublic(dr(this.publicKey)),n=Ui().keyFromPublic(dr(e));return"0x"+t.pub.add(n.pub).encodeCompressed("hex")}signDigest(e){const t=Ui().keyFromPrivate(dr(this.privateKey)),n=dr(e);n.length!==32&&Oh.throwArgumentError("bad digest length","digest",e);const i=t.sign(n,{canonical:!0});return kv({recoveryParam:i.recoveryParam,r:uo("0x"+i.r.toString(16),32),s:uo("0x"+i.s.toString(16),32)})}computeSharedSecret(e){const t=Ui().keyFromPrivate(dr(this.privateKey)),n=Ui().keyFromPublic(dr(Jv(e)));return uo("0x"+t.derive(n.getPublic()).toString(16),32)}static isSigningKey(e){return!!(e&&e._isSigningKey)}}function PA(r,e){const t=kv(e),n={r:dr(t.r),s:dr(t.s)};return"0x"+Ui().recoverPubKey(dr(r),n,t.recoveryParam).encode("hex",!1)}function Jv(r,e){const t=dr(r);return t.length===32?new OA(t).publicKey:t.length===33?"0x"+Ui().keyFromPublic(t).getPublic(!1,"hex"):t.length===65?an(t):Oh.throwArgumentError("invalid public or private key","key","[REDACTED]")}var c0;(function(r){r[r.legacy=0]="legacy",r[r.eip2930=1]="eip2930",r[r.eip1559=2]="eip1559"})(c0||(c0={}));function DA(r){const e=Jv(r);return gA(i0(Gh(i0(e,1)),12))}function MA(r,e){return DA(PA(dr(r),e))}var Qh={},Ec={};Object.defineProperty(Ec,"__esModule",{value:!0});var Nr=ot,Ph=fn,LA=20;function CA(r,e,t){for(var n=1634760805,i=857760878,a=2036477234,u=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],d=t[7]<<24|t[6]<<16|t[5]<<8|t[4],l=t[11]<<24|t[10]<<16|t[9]<<8|t[8],w=t[15]<<24|t[14]<<16|t[13]<<8|t[12],b=t[19]<<24|t[18]<<16|t[17]<<8|t[16],S=t[23]<<24|t[22]<<16|t[21]<<8|t[20],I=t[27]<<24|t[26]<<16|t[25]<<8|t[24],M=t[31]<<24|t[30]<<16|t[29]<<8|t[28],z=e[3]<<24|e[2]<<16|e[1]<<8|e[0],k=e[7]<<24|e[6]<<16|e[5]<<8|e[4],Y=e[11]<<24|e[10]<<16|e[9]<<8|e[8],te=e[15]<<24|e[14]<<16|e[13]<<8|e[12],ie=n,W=i,Z=a,V=u,y=f,B=d,he=l,de=w,pe=b,Ee=S,$=I,h=M,v=z,x=k,P=Y,A=te,R=0;R<LA;R+=2)ie=ie+y|0,v^=ie,v=v>>>16|v<<16,pe=pe+v|0,y^=pe,y=y>>>20|y<<12,W=W+B|0,x^=W,x=x>>>16|x<<16,Ee=Ee+x|0,B^=Ee,B=B>>>20|B<<12,Z=Z+he|0,P^=Z,P=P>>>16|P<<16,$=$+P|0,he^=$,he=he>>>20|he<<12,V=V+de|0,A^=V,A=A>>>16|A<<16,h=h+A|0,de^=h,de=de>>>20|de<<12,Z=Z+he|0,P^=Z,P=P>>>24|P<<8,$=$+P|0,he^=$,he=he>>>25|he<<7,V=V+de|0,A^=V,A=A>>>24|A<<8,h=h+A|0,de^=h,de=de>>>25|de<<7,W=W+B|0,x^=W,x=x>>>24|x<<8,Ee=Ee+x|0,B^=Ee,B=B>>>25|B<<7,ie=ie+y|0,v^=ie,v=v>>>24|v<<8,pe=pe+v|0,y^=pe,y=y>>>25|y<<7,ie=ie+B|0,A^=ie,A=A>>>16|A<<16,$=$+A|0,B^=$,B=B>>>20|B<<12,W=W+he|0,v^=W,v=v>>>16|v<<16,h=h+v|0,he^=h,he=he>>>20|he<<12,Z=Z+de|0,x^=Z,x=x>>>16|x<<16,pe=pe+x|0,de^=pe,de=de>>>20|de<<12,V=V+y|0,P^=V,P=P>>>16|P<<16,Ee=Ee+P|0,y^=Ee,y=y>>>20|y<<12,Z=Z+de|0,x^=Z,x=x>>>24|x<<8,pe=pe+x|0,de^=pe,de=de>>>25|de<<7,V=V+y|0,P^=V,P=P>>>24|P<<8,Ee=Ee+P|0,y^=Ee,y=y>>>25|y<<7,W=W+he|0,v^=W,v=v>>>24|v<<8,h=h+v|0,he^=h,he=he>>>25|he<<7,ie=ie+B|0,A^=ie,A=A>>>24|A<<8,$=$+A|0,B^=$,B=B>>>25|B<<7;Nr.writeUint32LE(ie+n|0,r,0),Nr.writeUint32LE(W+i|0,r,4),Nr.writeUint32LE(Z+a|0,r,8),Nr.writeUint32LE(V+u|0,r,12),Nr.writeUint32LE(y+f|0,r,16),Nr.writeUint32LE(B+d|0,r,20),Nr.writeUint32LE(he+l|0,r,24),Nr.writeUint32LE(de+w|0,r,28),Nr.writeUint32LE(pe+b|0,r,32),Nr.writeUint32LE(Ee+S|0,r,36),Nr.writeUint32LE($+I|0,r,40),Nr.writeUint32LE(h+M|0,r,44),Nr.writeUint32LE(v+z|0,r,48),Nr.writeUint32LE(x+k|0,r,52),Nr.writeUint32LE(P+Y|0,r,56),Nr.writeUint32LE(A+te|0,r,60)}function Yv(r,e,t,n,i){if(i===void 0&&(i=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<t.length)throw new Error("ChaCha: destination is shorter than source");var a,u;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");a=new Uint8Array(16),u=a.length-e.length,a.set(e,u)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");a=e,u=i}for(var f=new Uint8Array(64),d=0;d<t.length;d+=64){CA(f,a,r);for(var l=d;l<d+64&&l<t.length;l++)n[l]=t[l]^f[l-d];NA(a,0,u)}return Ph.wipe(f),i===0&&Ph.wipe(a),n}Ec.streamXOR=Yv;function RA(r,e,t,n){return n===void 0&&(n=0),Ph.wipe(t),Yv(r,e,t,t,n)}Ec.stream=RA;function NA(r,e,t){for(var n=1;t--;)n=n+(r[e]&255)|0,r[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var Xv={},Wi={};Object.defineProperty(Wi,"__esModule",{value:!0});function TA(r,e,t){return~(r-1)&e|r-1&t}Wi.select=TA;function $A(r,e){return(r|0)-(e|0)-1>>>31&1}Wi.lessOrEqual=$A;function Zv(r,e){if(r.length!==e.length)return 0;for(var t=0,n=0;n<r.length;n++)t|=r[n]^e[n];return 1&t-1>>>8}Wi.compare=Zv;function FA(r,e){return r.length===0||e.length===0?!1:Zv(r,e)!==0}Wi.equal=FA;(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Wi,t=fn;r.DIGEST_LENGTH=16;var n=function(){function u(f){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var d=f[0]|f[1]<<8;this._r[0]=d&8191;var l=f[2]|f[3]<<8;this._r[1]=(d>>>13|l<<3)&8191;var w=f[4]|f[5]<<8;this._r[2]=(l>>>10|w<<6)&7939;var b=f[6]|f[7]<<8;this._r[3]=(w>>>7|b<<9)&8191;var S=f[8]|f[9]<<8;this._r[4]=(b>>>4|S<<12)&255,this._r[5]=S>>>1&8190;var I=f[10]|f[11]<<8;this._r[6]=(S>>>14|I<<2)&8191;var M=f[12]|f[13]<<8;this._r[7]=(I>>>11|M<<5)&8065;var z=f[14]|f[15]<<8;this._r[8]=(M>>>8|z<<8)&8191,this._r[9]=z>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return u.prototype._blocks=function(f,d,l){for(var w=this._fin?0:2048,b=this._h[0],S=this._h[1],I=this._h[2],M=this._h[3],z=this._h[4],k=this._h[5],Y=this._h[6],te=this._h[7],ie=this._h[8],W=this._h[9],Z=this._r[0],V=this._r[1],y=this._r[2],B=this._r[3],he=this._r[4],de=this._r[5],pe=this._r[6],Ee=this._r[7],$=this._r[8],h=this._r[9];l>=16;){var v=f[d+0]|f[d+1]<<8;b+=v&8191;var x=f[d+2]|f[d+3]<<8;S+=(v>>>13|x<<3)&8191;var P=f[d+4]|f[d+5]<<8;I+=(x>>>10|P<<6)&8191;var A=f[d+6]|f[d+7]<<8;M+=(P>>>7|A<<9)&8191;var R=f[d+8]|f[d+9]<<8;z+=(A>>>4|R<<12)&8191,k+=R>>>1&8191;var j=f[d+10]|f[d+11]<<8;Y+=(R>>>14|j<<2)&8191;var O=f[d+12]|f[d+13]<<8;te+=(j>>>11|O<<5)&8191;var m=f[d+14]|f[d+15]<<8;ie+=(O>>>8|m<<8)&8191,W+=m>>>5|w;var L=0,ce=L;ce+=b*Z,ce+=S*(5*h),ce+=I*(5*$),ce+=M*(5*Ee),ce+=z*(5*pe),L=ce>>>13,ce&=8191,ce+=k*(5*de),ce+=Y*(5*he),ce+=te*(5*B),ce+=ie*(5*y),ce+=W*(5*V),L+=ce>>>13,ce&=8191;var _=L;_+=b*V,_+=S*Z,_+=I*(5*h),_+=M*(5*$),_+=z*(5*Ee),L=_>>>13,_&=8191,_+=k*(5*pe),_+=Y*(5*de),_+=te*(5*he),_+=ie*(5*B),_+=W*(5*y),L+=_>>>13,_&=8191;var G=L;G+=b*y,G+=S*V,G+=I*Z,G+=M*(5*h),G+=z*(5*$),L=G>>>13,G&=8191,G+=k*(5*Ee),G+=Y*(5*pe),G+=te*(5*de),G+=ie*(5*he),G+=W*(5*B),L+=G>>>13,G&=8191;var U=L;U+=b*B,U+=S*y,U+=I*V,U+=M*Z,U+=z*(5*h),L=U>>>13,U&=8191,U+=k*(5*$),U+=Y*(5*Ee),U+=te*(5*pe),U+=ie*(5*de),U+=W*(5*he),L+=U>>>13,U&=8191;var T=L;T+=b*he,T+=S*B,T+=I*y,T+=M*V,T+=z*Z,L=T>>>13,T&=8191,T+=k*(5*h),T+=Y*(5*$),T+=te*(5*Ee),T+=ie*(5*pe),T+=W*(5*de),L+=T>>>13,T&=8191;var F=L;F+=b*de,F+=S*he,F+=I*B,F+=M*y,F+=z*V,L=F>>>13,F&=8191,F+=k*Z,F+=Y*(5*h),F+=te*(5*$),F+=ie*(5*Ee),F+=W*(5*pe),L+=F>>>13,F&=8191;var g=L;g+=b*pe,g+=S*de,g+=I*he,g+=M*B,g+=z*y,L=g>>>13,g&=8191,g+=k*V,g+=Y*Z,g+=te*(5*h),g+=ie*(5*$),g+=W*(5*Ee),L+=g>>>13,g&=8191;var N=L;N+=b*Ee,N+=S*pe,N+=I*de,N+=M*he,N+=z*B,L=N>>>13,N&=8191,N+=k*y,N+=Y*V,N+=te*Z,N+=ie*(5*h),N+=W*(5*$),L+=N>>>13,N&=8191;var ee=L;ee+=b*$,ee+=S*Ee,ee+=I*pe,ee+=M*de,ee+=z*he,L=ee>>>13,ee&=8191,ee+=k*B,ee+=Y*y,ee+=te*V,ee+=ie*Z,ee+=W*(5*h),L+=ee>>>13,ee&=8191;var le=L;le+=b*h,le+=S*$,le+=I*Ee,le+=M*pe,le+=z*de,L=le>>>13,le&=8191,le+=k*he,le+=Y*B,le+=te*y,le+=ie*V,le+=W*Z,L+=le>>>13,le&=8191,L=(L<<2)+L|0,L=L+ce|0,ce=L&8191,L=L>>>13,_+=L,b=ce,S=_,I=G,M=U,z=T,k=F,Y=g,te=N,ie=ee,W=le,d+=16,l-=16}this._h[0]=b,this._h[1]=S,this._h[2]=I,this._h[3]=M,this._h[4]=z,this._h[5]=k,this._h[6]=Y,this._h[7]=te,this._h[8]=ie,this._h[9]=W},u.prototype.finish=function(f,d){d===void 0&&(d=0);var l=new Uint16Array(10),w,b,S,I;if(this._leftover){for(I=this._leftover,this._buffer[I++]=1;I<16;I++)this._buffer[I]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(w=this._h[1]>>>13,this._h[1]&=8191,I=2;I<10;I++)this._h[I]+=w,w=this._h[I]>>>13,this._h[I]&=8191;for(this._h[0]+=w*5,w=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=w,w=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=w,l[0]=this._h[0]+5,w=l[0]>>>13,l[0]&=8191,I=1;I<10;I++)l[I]=this._h[I]+w,w=l[I]>>>13,l[I]&=8191;for(l[9]-=8192,b=(w^1)-1,I=0;I<10;I++)l[I]&=b;for(b=~b,I=0;I<10;I++)this._h[I]=this._h[I]&b|l[I];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,S=this._h[0]+this._pad[0],this._h[0]=S&65535,I=1;I<8;I++)S=(this._h[I]+this._pad[I]|0)+(S>>>16)|0,this._h[I]=S&65535;return f[d+0]=this._h[0]>>>0,f[d+1]=this._h[0]>>>8,f[d+2]=this._h[1]>>>0,f[d+3]=this._h[1]>>>8,f[d+4]=this._h[2]>>>0,f[d+5]=this._h[2]>>>8,f[d+6]=this._h[3]>>>0,f[d+7]=this._h[3]>>>8,f[d+8]=this._h[4]>>>0,f[d+9]=this._h[4]>>>8,f[d+10]=this._h[5]>>>0,f[d+11]=this._h[5]>>>8,f[d+12]=this._h[6]>>>0,f[d+13]=this._h[6]>>>8,f[d+14]=this._h[7]>>>0,f[d+15]=this._h[7]>>>8,this._finished=!0,this},u.prototype.update=function(f){var d=0,l=f.length,w;if(this._leftover){w=16-this._leftover,w>l&&(w=l);for(var b=0;b<w;b++)this._buffer[this._leftover+b]=f[d+b];if(l-=w,d+=w,this._leftover+=w,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(l>=16&&(w=l-l%16,this._blocks(f,d,w),d+=w,l-=w),l){for(var b=0;b<l;b++)this._buffer[this._leftover+b]=f[d+b];this._leftover+=l}return this},u.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},u.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},u}();r.Poly1305=n;function i(u,f){var d=new n(u);d.update(f);var l=d.digest();return d.clean(),l}r.oneTimeAuth=i;function a(u,f){return u.length!==r.DIGEST_LENGTH||f.length!==r.DIGEST_LENGTH?!1:e.equal(u,f)}r.equal=a})(Xv);(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Ec,t=Xv,n=fn,i=ot,a=Wi;r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var u=new Uint8Array(16),f=function(){function d(l){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,l.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(l)}return d.prototype.seal=function(l,w,b,S){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var I=new Uint8Array(16);I.set(l,I.length-l.length);var M=new Uint8Array(32);e.stream(this._key,I,M,4);var z=w.length+this.tagLength,k;if(S){if(S.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");k=S}else k=new Uint8Array(z);return e.streamXOR(this._key,I,w,k,4),this._authenticate(k.subarray(k.length-this.tagLength,k.length),M,k.subarray(0,k.length-this.tagLength),b),n.wipe(I),k},d.prototype.open=function(l,w,b,S){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(w.length<this.tagLength)return null;var I=new Uint8Array(16);I.set(l,I.length-l.length);var M=new Uint8Array(32);e.stream(this._key,I,M,4);var z=new Uint8Array(this.tagLength);if(this._authenticate(z,M,w.subarray(0,w.length-this.tagLength),b),!a.equal(z,w.subarray(w.length-this.tagLength,w.length)))return null;var k=w.length-this.tagLength,Y;if(S){if(S.length!==k)throw new Error("ChaCha20Poly1305: incorrect destination length");Y=S}else Y=new Uint8Array(k);return e.streamXOR(this._key,I,w.subarray(0,w.length-this.tagLength),Y,4),n.wipe(I),Y},d.prototype.clean=function(){return n.wipe(this._key),this},d.prototype._authenticate=function(l,w,b,S){var I=new t.Poly1305(w);S&&(I.update(S),S.length%16>0&&I.update(u.subarray(S.length%16))),I.update(b),b.length%16>0&&I.update(u.subarray(b.length%16));var M=new Uint8Array(8);S&&i.writeUint64LE(S.length,M),I.update(M),i.writeUint64LE(b.length,M),I.update(M);for(var z=I.digest(),k=0;k<z.length;k++)l[k]=z[k];I.clean(),n.wipe(z),n.wipe(M)},d}();r.ChaCha20Poly1305=f})(Qh);var Qv={},da={},el={};Object.defineProperty(el,"__esModule",{value:!0});function UA(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}el.isSerializableHash=UA;Object.defineProperty(da,"__esModule",{value:!0});var Zn=el,qA=Wi,jA=fn,em=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(n).clean():n.set(t);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),Zn.isSerializableHash(this._inner)&&Zn.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),jA.wipe(n)}return r.prototype.reset=function(){if(!Zn.isSerializableHash(this._inner)||!Zn.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){Zn.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Zn.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!Zn.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!Zn.isSerializableHash(this._inner)||!Zn.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!Zn.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();da.HMAC=em;function BA(r,e,t){var n=new em(r,e);n.update(t);var i=n.digest();return n.clean(),i}da.hmac=BA;da.equal=qA.equal;Object.defineProperty(Qv,"__esModule",{value:!0});var f0=da,h0=fn,KA=function(){function r(e,t,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var a=f0.hmac(this._hash,n,t);this._hmac=new f0.HMAC(e,a),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),n=0;n<t.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[n]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),h0.wipe(this._buffer),h0.wipe(this._counter),this._bufpos=0},r}(),zA=Qv.HKDF=KA,pa={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ot,t=fn;r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var n=function(){function f(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(d,l){if(l===void 0&&(l=d.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var w=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&l>0;)this._buffer[this._bufferLength++]=d[w++],l--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(w=a(this._temp,this._state,d,w,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=d[w++],l--;return this},f.prototype.finish=function(d){if(!this._finished){var l=this._bytesHashed,w=this._bufferLength,b=l/536870912|0,S=l<<3,I=l%64<56?64:128;this._buffer[w]=128;for(var M=w+1;M<I-8;M++)this._buffer[M]=0;e.writeUint32BE(b,this._buffer,I-8),e.writeUint32BE(S,this._buffer,I-4),a(this._temp,this._state,this._buffer,0,I),this._finished=!0}for(var M=0;M<this.digestLength/4;M++)e.writeUint32BE(this._state[M],d,M*4);return this},f.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(d){return this._state.set(d.state),this._bufferLength=d.bufferLength,d.buffer&&this._buffer.set(d.buffer),this._bytesHashed=d.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(d){t.wipe(d.state),d.buffer&&t.wipe(d.buffer),d.bufferLength=0,d.bytesHashed=0},f}();r.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(f,d,l,w,b){for(;b>=64;){for(var S=d[0],I=d[1],M=d[2],z=d[3],k=d[4],Y=d[5],te=d[6],ie=d[7],W=0;W<16;W++){var Z=w+W*4;f[W]=e.readUint32BE(l,Z)}for(var W=16;W<64;W++){var V=f[W-2],y=(V>>>17|V<<15)^(V>>>19|V<<13)^V>>>10;V=f[W-15];var B=(V>>>7|V<<25)^(V>>>18|V<<14)^V>>>3;f[W]=(y+f[W-7]|0)+(B+f[W-16]|0)}for(var W=0;W<64;W++){var y=(((k>>>6|k<<26)^(k>>>11|k<<21)^(k>>>25|k<<7))+(k&Y^~k&te)|0)+(ie+(i[W]+f[W]|0)|0)|0,B=((S>>>2|S<<30)^(S>>>13|S<<19)^(S>>>22|S<<10))+(S&I^S&M^I&M)|0;ie=te,te=Y,Y=k,k=z+y|0,z=M,M=I,I=S,S=y+B|0}d[0]+=S,d[1]+=I,d[2]+=M,d[3]+=z,d[4]+=k,d[5]+=Y,d[6]+=te,d[7]+=ie,w+=64,b-=64}return w}function u(f){var d=new n;d.update(f);var l=d.digest();return d.clean(),l}r.hash=u})(pa);var tl={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const e=Hi,t=fn;r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function n(W){const Z=new Float64Array(16);if(W)for(let V=0;V<W.length;V++)Z[V]=W[V];return Z}const i=new Uint8Array(32);i[0]=9;const a=n([56129,1]);function u(W){let Z=1;for(let V=0;V<16;V++){let y=W[V]+Z+65535;Z=Math.floor(y/65536),W[V]=y-Z*65536}W[0]+=Z-1+37*(Z-1)}function f(W,Z,V){const y=~(V-1);for(let B=0;B<16;B++){const he=y&(W[B]^Z[B]);W[B]^=he,Z[B]^=he}}function d(W,Z){const V=n(),y=n();for(let B=0;B<16;B++)y[B]=Z[B];u(y),u(y),u(y);for(let B=0;B<2;B++){V[0]=y[0]-65517;for(let de=1;de<15;de++)V[de]=y[de]-65535-(V[de-1]>>16&1),V[de-1]&=65535;V[15]=y[15]-32767-(V[14]>>16&1);const he=V[15]>>16&1;V[14]&=65535,f(y,V,1-he)}for(let B=0;B<16;B++)W[2*B]=y[B]&255,W[2*B+1]=y[B]>>8}function l(W,Z){for(let V=0;V<16;V++)W[V]=Z[2*V]+(Z[2*V+1]<<8);W[15]&=32767}function w(W,Z,V){for(let y=0;y<16;y++)W[y]=Z[y]+V[y]}function b(W,Z,V){for(let y=0;y<16;y++)W[y]=Z[y]-V[y]}function S(W,Z,V){let y,B,he=0,de=0,pe=0,Ee=0,$=0,h=0,v=0,x=0,P=0,A=0,R=0,j=0,O=0,m=0,L=0,ce=0,_=0,G=0,U=0,T=0,F=0,g=0,N=0,ee=0,le=0,se=0,ve=0,et=0,Ae=0,qe=0,bt=0,Pe=V[0],_e=V[1],je=V[2],xe=V[3],De=V[4],Te=V[5],Se=V[6],ye=V[7],$e=V[8],Me=V[9],be=V[10],tt=V[11],Le=V[12],Re=V[13],st=V[14],Ce=V[15];y=Z[0],he+=y*Pe,de+=y*_e,pe+=y*je,Ee+=y*xe,$+=y*De,h+=y*Te,v+=y*Se,x+=y*ye,P+=y*$e,A+=y*Me,R+=y*be,j+=y*tt,O+=y*Le,m+=y*Re,L+=y*st,ce+=y*Ce,y=Z[1],de+=y*Pe,pe+=y*_e,Ee+=y*je,$+=y*xe,h+=y*De,v+=y*Te,x+=y*Se,P+=y*ye,A+=y*$e,R+=y*Me,j+=y*be,O+=y*tt,m+=y*Le,L+=y*Re,ce+=y*st,_+=y*Ce,y=Z[2],pe+=y*Pe,Ee+=y*_e,$+=y*je,h+=y*xe,v+=y*De,x+=y*Te,P+=y*Se,A+=y*ye,R+=y*$e,j+=y*Me,O+=y*be,m+=y*tt,L+=y*Le,ce+=y*Re,_+=y*st,G+=y*Ce,y=Z[3],Ee+=y*Pe,$+=y*_e,h+=y*je,v+=y*xe,x+=y*De,P+=y*Te,A+=y*Se,R+=y*ye,j+=y*$e,O+=y*Me,m+=y*be,L+=y*tt,ce+=y*Le,_+=y*Re,G+=y*st,U+=y*Ce,y=Z[4],$+=y*Pe,h+=y*_e,v+=y*je,x+=y*xe,P+=y*De,A+=y*Te,R+=y*Se,j+=y*ye,O+=y*$e,m+=y*Me,L+=y*be,ce+=y*tt,_+=y*Le,G+=y*Re,U+=y*st,T+=y*Ce,y=Z[5],h+=y*Pe,v+=y*_e,x+=y*je,P+=y*xe,A+=y*De,R+=y*Te,j+=y*Se,O+=y*ye,m+=y*$e,L+=y*Me,ce+=y*be,_+=y*tt,G+=y*Le,U+=y*Re,T+=y*st,F+=y*Ce,y=Z[6],v+=y*Pe,x+=y*_e,P+=y*je,A+=y*xe,R+=y*De,j+=y*Te,O+=y*Se,m+=y*ye,L+=y*$e,ce+=y*Me,_+=y*be,G+=y*tt,U+=y*Le,T+=y*Re,F+=y*st,g+=y*Ce,y=Z[7],x+=y*Pe,P+=y*_e,A+=y*je,R+=y*xe,j+=y*De,O+=y*Te,m+=y*Se,L+=y*ye,ce+=y*$e,_+=y*Me,G+=y*be,U+=y*tt,T+=y*Le,F+=y*Re,g+=y*st,N+=y*Ce,y=Z[8],P+=y*Pe,A+=y*_e,R+=y*je,j+=y*xe,O+=y*De,m+=y*Te,L+=y*Se,ce+=y*ye,_+=y*$e,G+=y*Me,U+=y*be,T+=y*tt,F+=y*Le,g+=y*Re,N+=y*st,ee+=y*Ce,y=Z[9],A+=y*Pe,R+=y*_e,j+=y*je,O+=y*xe,m+=y*De,L+=y*Te,ce+=y*Se,_+=y*ye,G+=y*$e,U+=y*Me,T+=y*be,F+=y*tt,g+=y*Le,N+=y*Re,ee+=y*st,le+=y*Ce,y=Z[10],R+=y*Pe,j+=y*_e,O+=y*je,m+=y*xe,L+=y*De,ce+=y*Te,_+=y*Se,G+=y*ye,U+=y*$e,T+=y*Me,F+=y*be,g+=y*tt,N+=y*Le,ee+=y*Re,le+=y*st,se+=y*Ce,y=Z[11],j+=y*Pe,O+=y*_e,m+=y*je,L+=y*xe,ce+=y*De,_+=y*Te,G+=y*Se,U+=y*ye,T+=y*$e,F+=y*Me,g+=y*be,N+=y*tt,ee+=y*Le,le+=y*Re,se+=y*st,ve+=y*Ce,y=Z[12],O+=y*Pe,m+=y*_e,L+=y*je,ce+=y*xe,_+=y*De,G+=y*Te,U+=y*Se,T+=y*ye,F+=y*$e,g+=y*Me,N+=y*be,ee+=y*tt,le+=y*Le,se+=y*Re,ve+=y*st,et+=y*Ce,y=Z[13],m+=y*Pe,L+=y*_e,ce+=y*je,_+=y*xe,G+=y*De,U+=y*Te,T+=y*Se,F+=y*ye,g+=y*$e,N+=y*Me,ee+=y*be,le+=y*tt,se+=y*Le,ve+=y*Re,et+=y*st,Ae+=y*Ce,y=Z[14],L+=y*Pe,ce+=y*_e,_+=y*je,G+=y*xe,U+=y*De,T+=y*Te,F+=y*Se,g+=y*ye,N+=y*$e,ee+=y*Me,le+=y*be,se+=y*tt,ve+=y*Le,et+=y*Re,Ae+=y*st,qe+=y*Ce,y=Z[15],ce+=y*Pe,_+=y*_e,G+=y*je,U+=y*xe,T+=y*De,F+=y*Te,g+=y*Se,N+=y*ye,ee+=y*$e,le+=y*Me,se+=y*be,ve+=y*tt,et+=y*Le,Ae+=y*Re,qe+=y*st,bt+=y*Ce,he+=38*_,de+=38*G,pe+=38*U,Ee+=38*T,$+=38*F,h+=38*g,v+=38*N,x+=38*ee,P+=38*le,A+=38*se,R+=38*ve,j+=38*et,O+=38*Ae,m+=38*qe,L+=38*bt,B=1,y=he+B+65535,B=Math.floor(y/65536),he=y-B*65536,y=de+B+65535,B=Math.floor(y/65536),de=y-B*65536,y=pe+B+65535,B=Math.floor(y/65536),pe=y-B*65536,y=Ee+B+65535,B=Math.floor(y/65536),Ee=y-B*65536,y=$+B+65535,B=Math.floor(y/65536),$=y-B*65536,y=h+B+65535,B=Math.floor(y/65536),h=y-B*65536,y=v+B+65535,B=Math.floor(y/65536),v=y-B*65536,y=x+B+65535,B=Math.floor(y/65536),x=y-B*65536,y=P+B+65535,B=Math.floor(y/65536),P=y-B*65536,y=A+B+65535,B=Math.floor(y/65536),A=y-B*65536,y=R+B+65535,B=Math.floor(y/65536),R=y-B*65536,y=j+B+65535,B=Math.floor(y/65536),j=y-B*65536,y=O+B+65535,B=Math.floor(y/65536),O=y-B*65536,y=m+B+65535,B=Math.floor(y/65536),m=y-B*65536,y=L+B+65535,B=Math.floor(y/65536),L=y-B*65536,y=ce+B+65535,B=Math.floor(y/65536),ce=y-B*65536,he+=B-1+37*(B-1),B=1,y=he+B+65535,B=Math.floor(y/65536),he=y-B*65536,y=de+B+65535,B=Math.floor(y/65536),de=y-B*65536,y=pe+B+65535,B=Math.floor(y/65536),pe=y-B*65536,y=Ee+B+65535,B=Math.floor(y/65536),Ee=y-B*65536,y=$+B+65535,B=Math.floor(y/65536),$=y-B*65536,y=h+B+65535,B=Math.floor(y/65536),h=y-B*65536,y=v+B+65535,B=Math.floor(y/65536),v=y-B*65536,y=x+B+65535,B=Math.floor(y/65536),x=y-B*65536,y=P+B+65535,B=Math.floor(y/65536),P=y-B*65536,y=A+B+65535,B=Math.floor(y/65536),A=y-B*65536,y=R+B+65535,B=Math.floor(y/65536),R=y-B*65536,y=j+B+65535,B=Math.floor(y/65536),j=y-B*65536,y=O+B+65535,B=Math.floor(y/65536),O=y-B*65536,y=m+B+65535,B=Math.floor(y/65536),m=y-B*65536,y=L+B+65535,B=Math.floor(y/65536),L=y-B*65536,y=ce+B+65535,B=Math.floor(y/65536),ce=y-B*65536,he+=B-1+37*(B-1),W[0]=he,W[1]=de,W[2]=pe,W[3]=Ee,W[4]=$,W[5]=h,W[6]=v,W[7]=x,W[8]=P,W[9]=A,W[10]=R,W[11]=j,W[12]=O,W[13]=m,W[14]=L,W[15]=ce}function I(W,Z){S(W,Z,Z)}function M(W,Z){const V=n();for(let y=0;y<16;y++)V[y]=Z[y];for(let y=253;y>=0;y--)I(V,V),y!==2&&y!==4&&S(V,V,Z);for(let y=0;y<16;y++)W[y]=V[y]}function z(W,Z){const V=new Uint8Array(32),y=new Float64Array(80),B=n(),he=n(),de=n(),pe=n(),Ee=n(),$=n();for(let P=0;P<31;P++)V[P]=W[P];V[31]=W[31]&127|64,V[0]&=248,l(y,Z);for(let P=0;P<16;P++)he[P]=y[P];B[0]=pe[0]=1;for(let P=254;P>=0;--P){const A=V[P>>>3]>>>(P&7)&1;f(B,he,A),f(de,pe,A),w(Ee,B,de),b(B,B,de),w(de,he,pe),b(he,he,pe),I(pe,Ee),I($,B),S(B,de,B),S(de,he,Ee),w(Ee,B,de),b(B,B,de),I(he,B),b(de,pe,$),S(B,de,a),w(B,B,pe),S(de,de,B),S(B,pe,$),S(pe,he,y),I(he,Ee),f(B,he,A),f(de,pe,A)}for(let P=0;P<16;P++)y[P+16]=B[P],y[P+32]=de[P],y[P+48]=he[P],y[P+64]=pe[P];const h=y.subarray(32),v=y.subarray(16);M(h,h),S(v,v,h);const x=new Uint8Array(32);return d(x,v),x}r.scalarMult=z;function k(W){return z(W,i)}r.scalarMultBase=k;function Y(W){if(W.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const Z=new Uint8Array(W);return{publicKey:k(Z),secretKey:Z}}r.generateKeyPairFromSeed=Y;function te(W){const Z=(0,e.randomBytes)(32,W),V=Y(Z);return(0,t.wipe)(Z),V}r.generateKeyPair=te;function ie(W,Z,V=!1){if(W.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(Z.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const y=z(W,Z);if(V){let B=0;for(let he=0;he<y.length;he++)B|=y[he];if(B===0)throw new Error("X25519: invalid shared key")}return y}r.sharedKey=ie})(tl);const HA={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var kA={};const WA=":";function co(r){const[e,t]=r.split(WA);return{namespace:e,reference:t}}function l0(r,e=[]){const t=[];return Object.keys(r).forEach(n=>{if(e.length&&!e.includes(n))return;const i=r[n];t.push(...i.accounts)}),t}function tm(r,e){return r.includes(":")?[r]:e.chains||[]}const GA="ReactNative",un={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},VA="js";function rc(){return typeof Xr<"u"&&typeof Xr.versions<"u"&&typeof Xr.versions.node<"u"}function Gi(){return!la()&&!!Hh()&&navigator.product===GA}function JA(){return Gi()&&typeof Je<"u"&&typeof(Je==null?void 0:Je.Platform)<"u"&&(Je==null?void 0:Je.Platform.OS)==="android"}function YA(){return Gi()&&typeof Je<"u"&&typeof(Je==null?void 0:Je.Platform)<"u"&&(Je==null?void 0:Je.Platform.OS)==="ios"}function ga(){return!rc()&&!!Hh()&&!!la()}function va(){return Gi()?un.reactNative:rc()?un.node:ga()?un.browser:un.unknown}function d0(){var r;try{return Gi()&&typeof Je<"u"&&typeof(Je==null?void 0:Je.Application)<"u"?(r=Je.Application)==null?void 0:r.applicationId:void 0}catch{return}}function XA(r,e){const t=new URLSearchParams(r);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const i=e[n];i!==void 0&&t.set(n,i)}return t.toString()}function rm(){return Kv()||{name:"",description:"",url:"",icons:[""]}}function ZA(){if(va()===un.reactNative&&typeof Je<"u"&&typeof(Je==null?void 0:Je.Platform)<"u"){const{OS:t,Version:n}=Je.Platform;return[t,n].join("-")}const r=RI();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function QA(){var r;const e=va();return e===un.browser?[e,((r=Bv())==null?void 0:r.host)||"unknown"].join(":"):e}function nm(r,e,t){const n=ZA(),i=QA();return[[r,e].join("-"),[VA,t].join("-"),n,i].join("/")}function e5({protocol:r,version:e,relayUrl:t,sdkVersion:n,auth:i,projectId:a,useOnCloseEvent:u,bundleId:f,packageName:d}){const l=t.split("?"),w=nm(r,e,n),b={auth:i,ua:w,projectId:a,useOnCloseEvent:u,packageName:d||void 0,bundleId:f||void 0},S=XA(l[1]||"",b);return l[0]+"?"+S}function bs(r,e){return r.filter(t=>e.includes(t)).length===r.length}function im(r){return Object.fromEntries(r.entries())}function sm(r){return new Map(Object.entries(r))}function ys(r=ge.FIVE_MINUTES,e){const t=ge.toMiliseconds(r||ge.FIVE_MINUTES);let n,i,a,u;return{resolve:f=>{a&&n&&(clearTimeout(a),n(f),u=Promise.resolve(f))},reject:f=>{a&&i&&(clearTimeout(a),i(f))},done:()=>new Promise((f,d)=>{if(u)return f(u);a=setTimeout(()=>{const l=new Error(e);u=Promise.reject(l),d(l)},t),n=f,i=d})}}function ji(r,e,t){return new Promise(async(n,i)=>{const a=setTimeout(()=>i(new Error(t)),e);try{const u=await r;n(u)}catch(u){i(u)}clearTimeout(a)})}function om(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function t5(r){return om("topic",r)}function r5(r){return om("id",r)}function am(r){const[e,t]=r.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")n.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))n.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return n}function vr(r,e){return ge.fromMiliseconds(Date.now()+ge.toMiliseconds(r))}function qi(r){return Date.now()>=ge.toMiliseconds(r)}function pt(r,e){return`${r}${e?`:${e}`:""}`}function Fu(r=[],e=[]){return[...new Set([...r,...e])]}async function n5({id:r,topic:e,wcDeepLink:t}){var n;try{if(!t)return;const i=typeof t=="string"?JSON.parse(t):t,a=i==null?void 0:i.href;if(typeof a!="string")return;const u=i5(a,r,e),f=va();if(f===un.browser){if(!((n=la())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}s5(u)}else f===un.reactNative&&typeof(Je==null?void 0:Je.Linking)<"u"&&await Je.Linking.openURL(u)}catch(i){console.error(i)}}function i5(r,e,t){const n=`requestId=${e}&sessionTopic=${t}`;r.endsWith("/")&&(r=r.slice(0,-1));let i=`${r}`;if(r.startsWith("https://t.me")){const a=r.includes("?")?"&startapp=":"?startapp=";i=`${i}${a}${c5(n,!0)}`}else i=`${i}/wc?${n}`;return i}function s5(r){let e="_self";u5()?e="_top":(a5()||r.startsWith("https://")||r.startsWith("http://"))&&(e="_blank"),window.open(r,e,"noreferrer noopener")}async function o5(r,e){let t="";try{if(ga()&&(t=localStorage.getItem(e),t))return t;t=await r.getItem(e)}catch(n){console.error(n)}return t}function p0(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),n=t.indexOf(e);return t[n+2]}function g0(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}function rl(){return typeof Xr<"u"&&kA.IS_VITEST==="true"}function a5(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function u5(){try{return window.self!==window.top}catch{return!1}}function c5(r,e=!1){const t=Ei.from(r).toString("base64");return e?t.replace(/[=]/g,""):t}function um(r){return Ei.from(r,"base64").toString("utf-8")}function f5(r){return new Promise(e=>setTimeout(e,r))}const h5="https://rpc.walletconnect.org/v1";async function l5(r,e,t,n,i,a){switch(t.t){case"eip191":return d5(r,e,t.s);case"eip1271":return await p5(r,e,t.s,n,i,a);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}function d5(r,e,t){return MA(Wv(e),t).toLowerCase()===r.toLowerCase()}async function p5(r,e,t,n,i,a){const u=co(n);if(!u.namespace||!u.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const f="0x1626ba7e",d="0000000000000000000000000000000000000000000000000000000000000040",l="0000000000000000000000000000000000000000000000000000000000000041",w=t.substring(2),b=Wv(e).substring(2),S=f+b+d+l+w,I=await fetch(`${a||h5}/?chainId=${n}&projectId=${i}`,{method:"POST",body:JSON.stringify({id:g5(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:S},"latest"]})}),{result:M}=await I.json();return M?M.slice(0,f.length).toLowerCase()===f.toLowerCase():!1}catch(f){return console.error("isValidEip1271Signature: ",f),!1}}function g5(){return Date.now()+Math.floor(Math.random()*1e3)}var v5=Object.defineProperty,m5=Object.defineProperties,y5=Object.getOwnPropertyDescriptors,v0=Object.getOwnPropertySymbols,w5=Object.prototype.hasOwnProperty,_5=Object.prototype.propertyIsEnumerable,m0=(r,e,t)=>e in r?v5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,b5=(r,e)=>{for(var t in e||(e={}))w5.call(e,t)&&m0(r,t,e[t]);if(v0)for(var t of v0(e))_5.call(e,t)&&m0(r,t,e[t]);return r},E5=(r,e)=>m5(r,y5(e));const x5="did:pkh:",nl=r=>r==null?void 0:r.split(":"),S5=r=>{const e=r&&nl(r);if(e)return r.includes(x5)?e[3]:e[1]},Dh=r=>{const e=r&&nl(r);if(e)return e[2]+":"+e[3]},nc=r=>{const e=r&&nl(r);if(e)return e.pop()};async function y0(r){const{cacao:e,projectId:t}=r,{s:n,p:i}=e,a=cm(i,i.iss),u=nc(i.iss);return await l5(u,a,n,Dh(i.iss),t)}const cm=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,n=nc(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=r.statement||void 0;const a=`URI: ${r.aud||r.uri}`,u=`Version: ${r.version}`,f=`Chain ID: ${S5(e)}`,d=`Nonce: ${r.nonce}`,l=`Issued At: ${r.iat}`,w=r.exp?`Expiration Time: ${r.exp}`:void 0,b=r.nbf?`Not Before: ${r.nbf}`:void 0,S=r.requestId?`Request ID: ${r.requestId}`:void 0,I=r.resources?`Resources:${r.resources.map(z=>`
- ${z}`).join("")}`:void 0,M=Uu(r.resources);if(M){const z=ia(M);i=R5(i,z)}return[t,n,"",i,"",a,u,f,d,l,w,b,S,I].filter(z=>z!=null).join(`
`)};function I5(r){return Ei.from(JSON.stringify(r)).toString("base64")}function A5(r){return JSON.parse(Ei.from(r,"base64").toString("utf-8"))}function Ss(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const n=r.att[t];if(Array.isArray(n))throw new Error(`Resource must be an object: ${t}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(n).forEach(i=>{const a=n[i];if(!Array.isArray(a))throw new Error(`Ability limits ${i} must be an array of objects, found: ${a}`);if(!a.length)throw new Error(`Value of ${i} is empty array, must be an array with objects`);a.forEach(u=>{if(typeof u!="object")throw new Error(`Ability limits (${i}) must be an array of objects, found: ${u}`)})})})}function O5(r,e,t,n={}){return t==null||t.sort((i,a)=>i.localeCompare(a)),{att:{[r]:P5(e,t,n)}}}function P5(r,e,t={}){e=e==null?void 0:e.sort((i,a)=>i.localeCompare(a));const n=e.map(i=>({[`${r}/${i}`]:[t]}));return Object.assign({},...n)}function fm(r){return Ss(r),`urn:recap:${I5(r).replace(/=/g,"")}`}function ia(r){const e=A5(r.replace("urn:recap:",""));return Ss(e),e}function D5(r,e,t){const n=O5(r,e,t);return fm(n)}function M5(r){return r&&r.includes("urn:recap:")}function L5(r,e){const t=ia(r),n=ia(e),i=C5(t,n);return fm(i)}function C5(r,e){Ss(r),Ss(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((i,a)=>i.localeCompare(a)),n={att:{}};return t.forEach(i=>{var a,u;Object.keys(((a=r.att)==null?void 0:a[i])||{}).concat(Object.keys(((u=e.att)==null?void 0:u[i])||{})).sort((f,d)=>f.localeCompare(d)).forEach(f=>{var d,l;n.att[i]=E5(b5({},n.att[i]),{[f]:((d=r.att[i])==null?void 0:d[f])||((l=e.att[i])==null?void 0:l[f])})})}),n}function R5(r="",e){Ss(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const n=[];let i=0;Object.keys(e.att).forEach(f=>{const d=Object.keys(e.att[f]).map(b=>({ability:b.split("/")[0],action:b.split("/")[1]}));d.sort((b,S)=>b.action.localeCompare(S.action));const l={};d.forEach(b=>{l[b.ability]||(l[b.ability]=[]),l[b.ability].push(b.action)});const w=Object.keys(l).map(b=>(i++,`(${i}) '${b}': '${l[b].join("', '")}' for '${f}'.`));n.push(w.join(", ").replace(".,","."))});const a=n.join(" "),u=`${t}${a}`;return`${r?r+" ":""}${u}`}function w0(r){var e;const t=ia(r);Ss(t);const n=(e=t.att)==null?void 0:e.eip155;return n?Object.keys(n).map(i=>i.split("/")[1]):[]}function _0(r){const e=ia(r);Ss(e);const t=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(i=>{var a;(a=i==null?void 0:i[0])!=null&&a.chains&&t.push(i[0].chains)})}),[...new Set(t.flat())]}function Uu(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return M5(e)?e:void 0}const hm="base10",Kr="base16",Bi="base64pad",zo="base64url",ma="utf8",lm=0,bi=1,ya=2,N5=0,b0=1,Zo=12,il=32;function T5(){const r=tl.generateKeyPair();return{privateKey:Sr(r.secretKey,Kr),publicKey:Sr(r.publicKey,Kr)}}function Mh(){const r=Hi.randomBytes(il);return Sr(r,Kr)}function $5(r,e){const t=tl.sharedKey(xr(r,Kr),xr(e,Kr),!0),n=new zA(pa.SHA256,t).expand(il);return Sr(n,Kr)}function qu(r){const e=pa.hash(xr(r,Kr));return Sr(e,Kr)}function _i(r){const e=pa.hash(xr(r,ma));return Sr(e,Kr)}function dm(r){return xr(`${r}`,hm)}function Is(r){return Number(Sr(r,hm))}function F5(r){const e=dm(typeof r.type<"u"?r.type:lm);if(Is(e)===bi&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?xr(r.senderPublicKey,Kr):void 0,n=typeof r.iv<"u"?xr(r.iv,Kr):Hi.randomBytes(Zo),i=new Qh.ChaCha20Poly1305(xr(r.symKey,Kr)).seal(n,xr(r.message,ma));return pm({type:e,sealed:i,iv:n,senderPublicKey:t,encoding:r.encoding})}function U5(r,e){const t=dm(ya),n=Hi.randomBytes(Zo),i=xr(r,ma);return pm({type:t,sealed:i,iv:n,encoding:e})}function q5(r){const e=new Qh.ChaCha20Poly1305(xr(r.symKey,Kr)),{sealed:t,iv:n}=sa({encoded:r.encoded,encoding:r==null?void 0:r.encoding}),i=e.open(n,t);if(i===null)throw new Error("Failed to decrypt");return Sr(i,ma)}function j5(r,e){const{sealed:t}=sa({encoded:r,encoding:e});return Sr(t,ma)}function pm(r){const{encoding:e=Bi}=r;if(Is(r.type)===ya)return Sr(Ru([r.type,r.sealed]),e);if(Is(r.type)===bi){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Sr(Ru([r.type,r.senderPublicKey,r.iv,r.sealed]),e)}return Sr(Ru([r.type,r.iv,r.sealed]),e)}function sa(r){const{encoded:e,encoding:t=Bi}=r,n=xr(e,t),i=n.slice(N5,b0),a=b0;if(Is(i)===bi){const l=a+il,w=l+Zo,b=n.slice(a,l),S=n.slice(l,w),I=n.slice(w);return{type:i,sealed:I,iv:S,senderPublicKey:b}}if(Is(i)===ya){const l=n.slice(a),w=Hi.randomBytes(Zo);return{type:i,sealed:l,iv:w}}const u=a+Zo,f=n.slice(a,u),d=n.slice(u);return{type:i,sealed:d,iv:f}}function B5(r,e){const t=sa({encoded:r,encoding:e==null?void 0:e.encoding});return gm({type:Is(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?Sr(t.senderPublicKey,Kr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function gm(r){const e=(r==null?void 0:r.type)||lm;if(e===bi){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function E0(r){return r.type===bi&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function x0(r){return r.type===ya}function K5(r){return new Ex.ec("p256").keyFromPublic({x:Ei.from(r.x,"base64").toString("hex"),y:Ei.from(r.y,"base64").toString("hex")},"hex")}function z5(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");const t=e.length%4;return t>0&&(e+="=".repeat(4-t)),e}function H5(r){return Ei.from(z5(r),"base64")}function k5(r,e){const[t,n,i]=r.split("."),a=H5(i);if(a.length!==64)throw new Error("Invalid signature length");const u=a.slice(0,32).toString("hex"),f=a.slice(32,64).toString("hex"),d=`${t}.${n}`,l=new pa.SHA256().update(Ei.from(d)).digest(),w=K5(e),b=Ei.from(l).toString("hex");if(!w.verify(b,{r:u,s:f}))throw new Error("Invalid signature");return Sh(r).payload}const W5="irn";function ic(r){return(r==null?void 0:r.relay)||{protocol:W5}}function Yo(r){const e=HA[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}function G5(r,e="-"){const t={},n="relay"+e;return Object.keys(r).forEach(i=>{if(i.startsWith(n)){const a=i.replace(n,""),u=r[i];t[a]=u}}),t}function S0(r){if(!r.includes("wc:")){const l=um(r);l!=null&&l.includes("wc:")&&(r=l)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,n=r.substring(0,e),i=r.substring(e+1,t).split("@"),a=typeof t<"u"?r.substring(t):"",u=new URLSearchParams(a),f={};u.forEach((l,w)=>{f[w]=l});const d=typeof f.methods=="string"?f.methods.split(","):void 0;return{protocol:n,topic:V5(i[0]),version:parseInt(i[1],10),symKey:f.symKey,relay:G5(f),methods:d,expiryTimestamp:f.expiryTimestamp?parseInt(f.expiryTimestamp,10):void 0}}function V5(r){return r.startsWith("//")?r.substring(2):r}function J5(r,e="-"){const t="relay",n={};return Object.keys(r).forEach(i=>{const a=t+e+i;r[i]&&(n[a]=r[i])}),n}function I0(r){const e=new URLSearchParams,t=J5(r.relay);Object.keys(t).sort().forEach(i=>{e.set(i,t[i])}),e.set("symKey",r.symKey),r.expiryTimestamp&&e.set("expiryTimestamp",r.expiryTimestamp.toString()),r.methods&&e.set("methods",r.methods.join(","));const n=e.toString();return`${r.protocol}:${r.topic}@${r.version}?${n}`}function Su(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}function _o(r){const e=[];return r.forEach(t=>{const[n,i]=t.split(":");e.push(`${n}:${i}`)}),e}function Y5(r){const e=[];return Object.values(r).forEach(t=>{e.push(..._o(t.accounts))}),e}function X5(r,e){const t=[];return Object.values(r).forEach(n=>{_o(n.accounts).includes(e)&&t.push(...n.methods)}),t}function Z5(r,e){const t=[];return Object.values(r).forEach(n=>{_o(n.accounts).includes(e)&&t.push(...n.events)}),t}function sl(r){return r.includes(":")}function Xo(r){return sl(r)?r.split(":")[0]:r}function Q5(r){const e={};return r==null||r.forEach(t=>{const[n,i]=t.split(":");e[n]||(e[n]={accounts:[],chains:[],events:[]}),e[n].accounts.push(t),e[n].chains.push(`${n}:${i}`)}),e}function A0(r,e){e=e.map(n=>n.replace("did:pkh:",""));const t=Q5(e);for(const[n,i]of Object.entries(t))i.methods?i.methods=Fu(i.methods,r):i.methods=r,i.events=["chainChanged","accountsChanged"];return t}const eO={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},tO={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function me(r,e){const{message:t,code:n}=tO[r];return{message:e?`${t} ${e}`:t,code:n}}function Ct(r,e){const{message:t,code:n}=eO[r];return{message:e?`${t} ${e}`:t,code:n}}function Si(r,e){return!!Array.isArray(r)}function oa(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function Br(r){return typeof r>"u"}function fr(r,e){return e&&Br(r)?!0:typeof r=="string"&&!!r.trim().length}function ol(r,e){return e&&Br(r)?!0:typeof r=="number"&&!isNaN(r)}function rO(r,e){const{requiredNamespaces:t}=e,n=Object.keys(r.namespaces),i=Object.keys(t);let a=!0;return bs(i,n)?(n.forEach(u=>{const{accounts:f,methods:d,events:l}=r.namespaces[u],w=_o(f),b=t[u];(!bs(tm(u,b),w)||!bs(b.methods,d)||!bs(b.events,l))&&(a=!1)}),a):!1}function sc(r){return fr(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function nO(r){if(fr(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&sc(t)}}return!1}function iO(r){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(fr(r,!1)){if(e(r))return!0;const t=um(r);return e(t)}}catch{}return!1}function sO(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function oO(r){return r==null?void 0:r.topic}function aO(r,e){let t=null;return fr(r==null?void 0:r.publicKey,!1)||(t=me("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function O0(r){let e=!0;return Si(r)?r.length&&(e=r.every(t=>fr(t,!1))):e=!1,e}function uO(r,e,t){let n=null;return Si(e)&&e.length?e.forEach(i=>{n||sc(i)||(n=Ct("UNSUPPORTED_CHAINS",`${t}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):sc(r)||(n=Ct("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function cO(r,e,t){let n=null;return Object.entries(r).forEach(([i,a])=>{if(n)return;const u=uO(i,tm(i,a),`${e} ${t}`);u&&(n=u)}),n}function fO(r,e){let t=null;return Si(r)?r.forEach(n=>{t||nO(n)||(t=Ct("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):t=Ct("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function hO(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const i=fO(n==null?void 0:n.accounts,`${e} namespace`);i&&(t=i)}),t}function lO(r,e){let t=null;return O0(r==null?void 0:r.methods)?O0(r==null?void 0:r.events)||(t=Ct("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Ct("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function vm(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const i=lO(n,`${e}, namespace`);i&&(t=i)}),t}function dO(r,e,t){let n=null;if(r&&oa(r)){const i=vm(r,e);i&&(n=i);const a=cO(r,e,t);a&&(n=a)}else n=me("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return n}function ih(r,e){let t=null;if(r&&oa(r)){const n=vm(r,e);n&&(t=n);const i=hO(r,e);i&&(t=i)}else t=me("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function mm(r){return fr(r.protocol,!0)}function pO(r,e){let t=!1;return r?r&&Si(r)&&r.length&&r.forEach(n=>{t=mm(n)}):t=!0,t}function gO(r){return typeof r=="number"}function Yr(r){return typeof r<"u"&&typeof r!==null}function vO(r){return!(!r||typeof r!="object"||!r.code||!ol(r.code,!1)||!r.message||!fr(r.message,!1))}function mO(r){return!(Br(r)||!fr(r.method,!1))}function yO(r){return!(Br(r)||Br(r.result)&&Br(r.error)||!ol(r.id,!1)||!fr(r.jsonrpc,!1))}function wO(r){return!(Br(r)||!fr(r.name,!1))}function P0(r,e){return!(!sc(e)||!Y5(r).includes(e))}function _O(r,e,t){return fr(t,!1)?X5(r,e).includes(t):!1}function bO(r,e,t){return fr(t,!1)?Z5(r,e).includes(t):!1}function D0(r,e,t){let n=null;const i=EO(r),a=xO(e),u=Object.keys(i),f=Object.keys(a),d=M0(Object.keys(r)),l=M0(Object.keys(e)),w=d.filter(b=>!l.includes(b));return w.length&&(n=me("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${w.toString()}
      Received: ${Object.keys(e).toString()}`)),bs(u,f)||(n=me("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${u.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(b=>{if(!b.includes(":")||n)return;const S=_o(e[b].accounts);S.includes(b)||(n=me("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${b}
        Required: ${b}
        Approved: ${S.toString()}`))}),u.forEach(b=>{n||(bs(i[b].methods,a[b].methods)?bs(i[b].events,a[b].events)||(n=me("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${b}`)):n=me("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${b}`))}),n}function EO(r){const e={};return Object.keys(r).forEach(t=>{var n;t.includes(":")?e[t]=r[t]:(n=r[t].chains)==null||n.forEach(i=>{e[i]={methods:r[t].methods,events:r[t].events}})}),e}function M0(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function xO(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const n=_o(r[t].accounts);n==null||n.forEach(i=>{e[i]={accounts:r[t].accounts.filter(a=>a.includes(`${i}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function SO(r,e){return ol(r,!1)&&r<=e.max&&r>=e.min}function L0(){const r=va();return new Promise(e=>{switch(r){case un.browser:e(IO());break;case un.reactNative:e(AO());break;case un.node:e(OO());break;default:e(!0)}})}function IO(){return ga()&&(navigator==null?void 0:navigator.onLine)}async function AO(){if(Gi()&&typeof Je<"u"&&Je!=null&&Je.NetInfo){const r=await(Je==null?void 0:Je.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function OO(){return!0}function PO(r){switch(va()){case un.browser:DO(r);break;case un.reactNative:MO(r);break}}function DO(r){!Gi()&&ga()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function MO(r){var e;Gi()&&typeof Je<"u"&&Je!=null&&Je.NetInfo&&((e=Je)==null||e.NetInfo.addEventListener(t=>r(t==null?void 0:t.isConnected)))}const sh={};class Ho{static get(e){return sh[e]}static set(e,t){sh[e]=t}static delete(e){delete sh[e]}}var al={exports:{}},fo=typeof Reflect=="object"?Reflect:null,C0=fo&&typeof fo.apply=="function"?fo.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},ju;fo&&typeof fo.ownKeys=="function"?ju=fo.ownKeys:Object.getOwnPropertySymbols?ju=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ju=function(e){return Object.getOwnPropertyNames(e)};function LO(r){console&&console.warn&&console.warn(r)}var ym=Number.isNaN||function(e){return e!==e};function jt(){jt.init.call(this)}al.exports=jt;al.exports.once=TO;jt.EventEmitter=jt;jt.prototype._events=void 0;jt.prototype._eventsCount=0;jt.prototype._maxListeners=void 0;var R0=10;function xc(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(jt,"defaultMaxListeners",{enumerable:!0,get:function(){return R0},set:function(r){if(typeof r!="number"||r<0||ym(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");R0=r}});jt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};jt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ym(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function wm(r){return r._maxListeners===void 0?jt.defaultMaxListeners:r._maxListeners}jt.prototype.getMaxListeners=function(){return wm(this)};jt.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var f=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw f.context=u,f}var d=a[e];if(d===void 0)return!1;if(typeof d=="function")C0(d,this,t);else for(var l=d.length,w=Sm(d,l),n=0;n<l;++n)C0(w[n],this,t);return!0};function _m(r,e,t,n){var i,a,u;if(xc(t),a=r._events,a===void 0?(a=r._events=Object.create(null),r._eventsCount=0):(a.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),u=a[e]),u===void 0)u=a[e]=t,++r._eventsCount;else if(typeof u=="function"?u=a[e]=n?[t,u]:[u,t]:n?u.unshift(t):u.push(t),i=wm(r),i>0&&u.length>i&&!u.warned){u.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=r,f.type=e,f.count=u.length,LO(f)}return r}jt.prototype.addListener=function(e,t){return _m(this,e,t,!1)};jt.prototype.on=jt.prototype.addListener;jt.prototype.prependListener=function(e,t){return _m(this,e,t,!0)};function CO(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function bm(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=CO.bind(n);return i.listener=t,n.wrapFn=i,i}jt.prototype.once=function(e,t){return xc(t),this.on(e,bm(this,e,t)),this};jt.prototype.prependOnceListener=function(e,t){return xc(t),this.prependListener(e,bm(this,e,t)),this};jt.prototype.removeListener=function(e,t){var n,i,a,u,f;if(xc(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(a=-1,u=n.length-1;u>=0;u--)if(n[u]===t||n[u].listener===t){f=n[u].listener,a=u;break}if(a<0)return this;a===0?n.shift():RO(n,a),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,f||t)}return this};jt.prototype.off=jt.prototype.removeListener;jt.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),u;for(i=0;i<a.length;++i)u=a[i],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Em(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?NO(i):Sm(i,i.length)}jt.prototype.listeners=function(e){return Em(this,e,!0)};jt.prototype.rawListeners=function(e){return Em(this,e,!1)};jt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):xm.call(r,e)};jt.prototype.listenerCount=xm;function xm(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}jt.prototype.eventNames=function(){return this._eventsCount>0?ju(this._events):[]};function Sm(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function RO(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function NO(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function TO(r,e){return new Promise(function(t,n){function i(u){r.removeListener(e,a),n(u)}function a(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}Im(r,e,a,{once:!0}),e!=="error"&&$O(r,i,{once:!0})})}function $O(r,e,t){typeof r.on=="function"&&Im(r,"error",e,t)}function Im(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(a){n.once&&r.removeEventListener(e,i),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var FO=al.exports;const UO="PARSE_ERROR",qO="INVALID_REQUEST",jO="METHOD_NOT_FOUND",BO="INVALID_PARAMS",Am="INTERNAL_ERROR",ul="SERVER_ERROR",KO=[-32700,-32600,-32601,-32602,-32603],Qo={[UO]:{code:-32700,message:"Parse error"},[qO]:{code:-32600,message:"Invalid Request"},[jO]:{code:-32601,message:"Method not found"},[BO]:{code:-32602,message:"Invalid params"},[Am]:{code:-32603,message:"Internal error"},[ul]:{code:-32e3,message:"Server error"}},Om=ul;function zO(r){return KO.includes(r)}function N0(r){return Object.keys(Qo).includes(r)?Qo[r]:Qo[Om]}function HO(r){const e=Object.values(Qo).find(t=>t.code===r);return e||Qo[Om]}function Pm(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var Dm={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Lh=function(r,e){return Lh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])},Lh(r,e)};function kO(r,e){Lh(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ch=function(){return Ch=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Ch.apply(this,arguments)};function WO(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function GO(r,e,t,n){var i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,e,t,n);else for(var f=r.length-1;f>=0;f--)(u=r[f])&&(a=(i<3?u(a):i>3?u(e,t,a):u(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function VO(r,e){return function(t,n){e(t,n,r)}}function JO(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function YO(r,e,t,n){function i(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function f(w){try{l(n.next(w))}catch(b){u(b)}}function d(w){try{l(n.throw(w))}catch(b){u(b)}}function l(w){w.done?a(w.value):i(w.value).then(f,d)}l((n=n.apply(r,e||[])).next())})}function XO(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(l){return function(w){return d([l,w])}}function d(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(w){l=[6,w],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function ZO(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function QO(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Rh(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Mm(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,a=[],u;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(f){u={error:f}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(u)throw u.error}}return a}function eP(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Mm(arguments[e]));return r}function tP(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var a=arguments[e],u=0,f=a.length;u<f;u++,i++)n[i]=a[u];return n}function aa(r){return this instanceof aa?(this.v=r,this):new aa(r)}function rP(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,a=[];return i={},u("next"),u("throw"),u("return"),i[Symbol.asyncIterator]=function(){return this},i;function u(S){n[S]&&(i[S]=function(I){return new Promise(function(M,z){a.push([S,I,M,z])>1||f(S,I)})})}function f(S,I){try{d(n[S](I))}catch(M){b(a[0][3],M)}}function d(S){S.value instanceof aa?Promise.resolve(S.value.v).then(l,w):b(a[0][2],S)}function l(S){f("next",S)}function w(S){f("throw",S)}function b(S,I){S(I),a.shift(),a.length&&f(a[0][0],a[0][1])}}function nP(r){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,a){e[i]=r[i]?function(u){return(t=!t)?{value:aa(r[i](u)),done:i==="return"}:a?a(u):u}:a}}function iP(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Rh=="function"?Rh(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=r[a]&&function(u){return new Promise(function(f,d){u=r[a](u),i(f,d,u.done,u.value)})}}function i(a,u,f,d){Promise.resolve(d).then(function(l){a({value:l,done:f})},u)}}function sP(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function oP(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function aP(r){return r&&r.__esModule?r:{default:r}}function uP(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function cP(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const fP=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ch},__asyncDelegator:nP,__asyncGenerator:rP,__asyncValues:iP,__await:aa,__awaiter:YO,__classPrivateFieldGet:uP,__classPrivateFieldSet:cP,__createBinding:ZO,__decorate:GO,__exportStar:QO,__extends:kO,__generator:XO,__importDefault:aP,__importStar:oP,__makeTemplateObject:sP,__metadata:JO,__param:VO,__read:Mm,__rest:WO,__spread:eP,__spreadArrays:tP,__values:Rh},Symbol.toStringTag,{value:"Module"})),hP=Wg(fP);var gi={},T0;function lP(){if(T0)return gi;T0=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.isBrowserCryptoAvailable=gi.getSubtleCrypto=gi.getBrowerCrypto=void 0;function r(){return(Pr===null||Pr===void 0?void 0:Pr.crypto)||(Pr===null||Pr===void 0?void 0:Pr.msCrypto)||{}}gi.getBrowerCrypto=r;function e(){const n=r();return n.subtle||n.webkitSubtle}gi.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return gi.isBrowserCryptoAvailable=t,gi}var vi={},$0;function dP(){if($0)return vi;$0=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.isBrowser=vi.isNode=vi.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}vi.isReactNative=r;function e(){return typeof Xr<"u"&&typeof Xr.versions<"u"&&typeof Xr.versions.node<"u"}vi.isNode=e;function t(){return!r()&&!e()}return vi.isBrowser=t,vi}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=hP;e.__exportStar(lP(),r),e.__exportStar(dP(),r)})(Dm);function wi(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function Es(r=6){return BigInt(wi(r))}function Ki(r,e,t){return{id:t||wi(),jsonrpc:"2.0",method:r,params:e}}function Sc(r,e){return{id:r,jsonrpc:"2.0",result:e}}function Ic(r,e,t){return{id:r,jsonrpc:"2.0",error:pP(e)}}function pP(r,e){return typeof r>"u"?N0(Am):(typeof r=="string"&&(r=Object.assign(Object.assign({},N0(ul)),{message:r})),zO(r.code)&&(r=HO(r.code)),r)}class gP{}class vP extends gP{constructor(){super()}}class mP extends vP{constructor(e){super()}}const yP="^https?:",wP="^wss?:";function _P(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Lm(r,e){const t=_P(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function F0(r){return Lm(r,yP)}function U0(r){return Lm(r,wP)}function bP(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function Cm(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function cl(r){return Cm(r)&&"method"in r}function Ac(r){return Cm(r)&&(ti(r)||An(r))}function ti(r){return"result"in r}function An(r){return"error"in r}let Mn=class extends mP{constructor(e){super(e),this.events=new FO.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Ki(e.method,e.params||[],e.id||Es().toString()),t)}async requestStrict(e,t){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(a){i(a)}this.events.on(`${e.id}`,a=>{An(a)?i(a.error):n(a.result)});try{await this.connection.send(e,t)}catch(a){i(a)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ac(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};var fl={exports:{}},ho=typeof Reflect=="object"?Reflect:null,q0=ho&&typeof ho.apply=="function"?ho.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Bu;ho&&typeof ho.ownKeys=="function"?Bu=ho.ownKeys:Object.getOwnPropertySymbols?Bu=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Bu=function(e){return Object.getOwnPropertyNames(e)};function EP(r){console&&console.warn&&console.warn(r)}var Rm=Number.isNaN||function(e){return e!==e};function Bt(){Bt.init.call(this)}fl.exports=Bt;fl.exports.once=AP;Bt.EventEmitter=Bt;Bt.prototype._events=void 0;Bt.prototype._eventsCount=0;Bt.prototype._maxListeners=void 0;var j0=10;function Oc(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Bt,"defaultMaxListeners",{enumerable:!0,get:function(){return j0},set:function(r){if(typeof r!="number"||r<0||Rm(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");j0=r}});Bt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Bt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Rm(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Nm(r){return r._maxListeners===void 0?Bt.defaultMaxListeners:r._maxListeners}Bt.prototype.getMaxListeners=function(){return Nm(this)};Bt.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var f=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw f.context=u,f}var d=a[e];if(d===void 0)return!1;if(typeof d=="function")q0(d,this,t);else for(var l=d.length,w=qm(d,l),n=0;n<l;++n)q0(w[n],this,t);return!0};function Tm(r,e,t,n){var i,a,u;if(Oc(t),a=r._events,a===void 0?(a=r._events=Object.create(null),r._eventsCount=0):(a.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),u=a[e]),u===void 0)u=a[e]=t,++r._eventsCount;else if(typeof u=="function"?u=a[e]=n?[t,u]:[u,t]:n?u.unshift(t):u.push(t),i=Nm(r),i>0&&u.length>i&&!u.warned){u.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=r,f.type=e,f.count=u.length,EP(f)}return r}Bt.prototype.addListener=function(e,t){return Tm(this,e,t,!1)};Bt.prototype.on=Bt.prototype.addListener;Bt.prototype.prependListener=function(e,t){return Tm(this,e,t,!0)};function xP(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function $m(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=xP.bind(n);return i.listener=t,n.wrapFn=i,i}Bt.prototype.once=function(e,t){return Oc(t),this.on(e,$m(this,e,t)),this};Bt.prototype.prependOnceListener=function(e,t){return Oc(t),this.prependListener(e,$m(this,e,t)),this};Bt.prototype.removeListener=function(e,t){var n,i,a,u,f;if(Oc(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(a=-1,u=n.length-1;u>=0;u--)if(n[u]===t||n[u].listener===t){f=n[u].listener,a=u;break}if(a<0)return this;a===0?n.shift():SP(n,a),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,f||t)}return this};Bt.prototype.off=Bt.prototype.removeListener;Bt.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),u;for(i=0;i<a.length;++i)u=a[i],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Fm(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?IP(i):qm(i,i.length)}Bt.prototype.listeners=function(e){return Fm(this,e,!0)};Bt.prototype.rawListeners=function(e){return Fm(this,e,!1)};Bt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):Um.call(r,e)};Bt.prototype.listenerCount=Um;function Um(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Bt.prototype.eventNames=function(){return this._eventsCount>0?Bu(this._events):[]};function qm(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function SP(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function IP(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function AP(r,e){return new Promise(function(t,n){function i(u){r.removeListener(e,a),n(u)}function a(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}jm(r,e,a,{once:!0}),e!=="error"&&OP(r,i,{once:!0})})}function OP(r,e,t){typeof r.on=="function"&&jm(r,"error",e,t)}function jm(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(a){n.once&&r.removeEventListener(e,i),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var PP=fl.exports;const DP=()=>typeof WebSocket<"u"?WebSocket:typeof Je<"u"&&typeof Je.WebSocket<"u"?Je.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),MP=()=>typeof WebSocket<"u"||typeof Je<"u"&&typeof Je.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",B0=r=>r.split("?")[0],K0=10,LP=DP();let CP=class{constructor(e){if(this.url=e,this.events=new PP.EventEmitter,this.registering=!1,!U0(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(xi(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!U0(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,i)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),i(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,n)=>{const i=Dm.isReactNative()?void 0:{rejectUnauthorized:!bP(e)},a=new LP(e,[],i);MP()?a.onerror=u=>{const f=u;n(this.emitError(f.error))}:a.on("error",u=>{n(this.emitError(u))}),a.onopen=()=>{this.onOpen(a),t(a)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?xs(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),i=n.message||n.toString(),a=Ic(e,i);this.events.emit("payload",a)}parseError(e,t=this.url){return Pm(e,B0(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>K0&&this.events.setMaxListeners(K0)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${B0(this.url)}`));return this.events.emit("register_error",t),t}};var oc={exports:{}};oc.exports;(function(r,e){var t=200,n="__lodash_hash_undefined__",i=1,a=2,u=9007199254740991,f="[object Arguments]",d="[object Array]",l="[object AsyncFunction]",w="[object Boolean]",b="[object Date]",S="[object Error]",I="[object Function]",M="[object GeneratorFunction]",z="[object Map]",k="[object Number]",Y="[object Null]",te="[object Object]",ie="[object Promise]",W="[object Proxy]",Z="[object RegExp]",V="[object Set]",y="[object String]",B="[object Symbol]",he="[object Undefined]",de="[object WeakMap]",pe="[object ArrayBuffer]",Ee="[object DataView]",$="[object Float32Array]",h="[object Float64Array]",v="[object Int8Array]",x="[object Int16Array]",P="[object Int32Array]",A="[object Uint8Array]",R="[object Uint8ClampedArray]",j="[object Uint16Array]",O="[object Uint32Array]",m=/[\\^$.*+?()[\]{}|]/g,L=/^\[object .+?Constructor\]$/,ce=/^(?:0|[1-9]\d*)$/,_={};_[$]=_[h]=_[v]=_[x]=_[P]=_[A]=_[R]=_[j]=_[O]=!0,_[f]=_[d]=_[pe]=_[w]=_[Ee]=_[b]=_[S]=_[I]=_[z]=_[k]=_[te]=_[Z]=_[V]=_[y]=_[de]=!1;var G=typeof Pr=="object"&&Pr&&Pr.Object===Object&&Pr,U=typeof self=="object"&&self&&self.Object===Object&&self,T=G||U||Function("return this")(),F=e&&!e.nodeType&&e,g=F&&!0&&r&&!r.nodeType&&r,N=g&&g.exports===F,ee=N&&G.process,le=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),se=le&&le.isTypedArray;function ve(q,X){for(var ue=-1,Ie=q==null?0:q.length,Gt=0,nt=[];++ue<Ie;){var Zt=q[ue];X(Zt,ue,q)&&(nt[Gt++]=Zt)}return nt}function et(q,X){for(var ue=-1,Ie=X.length,Gt=q.length;++ue<Ie;)q[Gt+ue]=X[ue];return q}function Ae(q,X){for(var ue=-1,Ie=q==null?0:q.length;++ue<Ie;)if(X(q[ue],ue,q))return!0;return!1}function qe(q,X){for(var ue=-1,Ie=Array(q);++ue<q;)Ie[ue]=X(ue);return Ie}function bt(q){return function(X){return q(X)}}function Pe(q,X){return q.has(X)}function _e(q,X){return q==null?void 0:q[X]}function je(q){var X=-1,ue=Array(q.size);return q.forEach(function(Ie,Gt){ue[++X]=[Gt,Ie]}),ue}function xe(q,X){return function(ue){return q(X(ue))}}function De(q){var X=-1,ue=Array(q.size);return q.forEach(function(Ie){ue[++X]=Ie}),ue}var Te=Array.prototype,Se=Function.prototype,ye=Object.prototype,$e=T["__core-js_shared__"],Me=Se.toString,be=ye.hasOwnProperty,tt=function(){var q=/[^.]+$/.exec($e&&$e.keys&&$e.keys.IE_PROTO||"");return q?"Symbol(src)_1."+q:""}(),Le=ye.toString,Re=RegExp("^"+Me.call(be).replace(m,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),st=N?T.Buffer:void 0,Ce=T.Symbol,at=T.Uint8Array,nr=ye.propertyIsEnumerable,gt=Te.splice,ut=Ce?Ce.toStringTag:void 0,Ar=Object.getOwnPropertySymbols,wt=st?st.isBuffer:void 0,_t=xe(Object.keys,Object),St=Qr(T,"DataView"),Be=Qr(T,"Map"),We=Qr(T,"Promise"),It=Qr(T,"Set"),ke=Qr(T,"WeakMap"),Ke=Qr(Object,"create"),Rt=si(St),Ze=si(Be),Ge=si(We),Nt=si(It),Ve=si(ke),Ye=Ce?Ce.prototype:void 0,At=Ye?Ye.valueOf:void 0;function Fe(q){var X=-1,ue=q==null?0:q.length;for(this.clear();++X<ue;){var Ie=q[X];this.set(Ie[0],Ie[1])}}function Qe(){this.__data__=Ke?Ke(null):{},this.size=0}function Tt(q){var X=this.has(q)&&delete this.__data__[q];return this.size-=X?1:0,X}function Pt(q){var X=this.__data__;if(Ke){var ue=X[q];return ue===n?void 0:ue}return be.call(X,q)?X[q]:void 0}function Dt(q){var X=this.__data__;return Ke?X[q]!==void 0:be.call(X,q)}function Cn(q,X){var ue=this.__data__;return this.size+=this.has(q)?0:1,ue[q]=Ke&&X===void 0?n:X,this}Fe.prototype.clear=Qe,Fe.prototype.delete=Tt,Fe.prototype.get=Pt,Fe.prototype.has=Dt,Fe.prototype.set=Cn;function lt(q){var X=-1,ue=q==null?0:q.length;for(this.clear();++X<ue;){var Ie=q[X];this.set(Ie[0],Ie[1])}}function Mt(){this.__data__=[],this.size=0}function ln(q){var X=this.__data__,ue=ts(X,q);if(ue<0)return!1;var Ie=X.length-1;return ue==Ie?X.pop():gt.call(X,ue,1),--this.size,!0}function dn(q){var X=this.__data__,ue=ts(X,q);return ue<0?void 0:X[ue][1]}function pn(q){return ts(this.__data__,q)>-1}function gn(q,X){var ue=this.__data__,Ie=ts(ue,q);return Ie<0?(++this.size,ue.push([q,X])):ue[Ie][1]=X,this}lt.prototype.clear=Mt,lt.prototype.delete=ln,lt.prototype.get=dn,lt.prototype.has=pn,lt.prototype.set=gn;function mr(q){var X=-1,ue=q==null?0:q.length;for(this.clear();++X<ue;){var Ie=q[X];this.set(Ie[0],Ie[1])}}function Hn(){this.size=0,this.__data__={hash:new Fe,map:new(Be||lt),string:new Fe}}function Vi(q){var X=Pi(this,q).delete(q);return this.size-=X?1:0,X}function kn(q){return Pi(this,q).get(q)}function Ji(q){return Pi(this,q).has(q)}function Yi(q,X){var ue=Pi(this,q),Ie=ue.size;return ue.set(q,X),this.size+=ue.size==Ie?0:1,this}mr.prototype.clear=Hn,mr.prototype.delete=Vi,mr.prototype.get=kn,mr.prototype.has=Ji,mr.prototype.set=Yi;function Wn(q){var X=-1,ue=q==null?0:q.length;for(this.__data__=new mr;++X<ue;)this.add(q[X])}function Ii(q){return this.__data__.set(q,n),this}function Ai(q){return this.__data__.has(q)}Wn.prototype.add=Wn.prototype.push=Ii,Wn.prototype.has=Ai;function $r(q){var X=this.__data__=new lt(q);this.size=X.size}function Xi(){this.__data__=new lt,this.size=0}function Zi(q){var X=this.__data__,ue=X.delete(q);return this.size=X.size,ue}function Qi(q){return this.__data__.get(q)}function es(q){return this.__data__.has(q)}function Oi(q,X){var ue=this.__data__;if(ue instanceof lt){var Ie=ue.__data__;if(!Be||Ie.length<t-1)return Ie.push([q,X]),this.size=++ue.size,this;ue=this.__data__=new mr(Ie)}return ue.set(q,X),this.size=ue.size,this}$r.prototype.clear=Xi,$r.prototype.delete=Zi,$r.prototype.get=Qi,$r.prototype.has=es,$r.prototype.set=Oi;function _a(q,X){var ue=$s(q),Ie=!ue&&Ca(q),Gt=!ue&&!Ie&&xo(q),nt=!ue&&!Ie&&!Gt&&Ta(q),Zt=ue||Ie||Gt||nt,hr=Zt?qe(q.length,String):[],mt=hr.length;for(var Vt in q)be.call(q,Vt)&&!(Zt&&(Vt=="length"||Gt&&(Vt=="offset"||Vt=="parent")||nt&&(Vt=="buffer"||Vt=="byteLength"||Vt=="byteOffset")||Oa(Vt,mt)))&&hr.push(Vt);return hr}function ts(q,X){for(var ue=q.length;ue--;)if(La(q[ue][0],X))return ue;return-1}function bo(q,X,ue){var Ie=X(q);return $s(q)?Ie:et(Ie,ue(q))}function rs(q){return q==null?q===void 0?he:Y:ut&&ut in Object(q)?Ia(q):$c(q)}function Eo(q){return is(q)&&rs(q)==f}function ns(q,X,ue,Ie,Gt){return q===X?!0:q==null||X==null||!is(q)&&!is(X)?q!==q&&X!==X:ba(q,X,ue,Ie,ns,Gt)}function ba(q,X,ue,Ie,Gt,nt){var Zt=$s(q),hr=$s(X),mt=Zt?d:Gn(q),Vt=hr?d:Gn(X);mt=mt==f?te:mt,Vt=Vt==f?te:Vt;var or=mt==te,Hr=Vt==te,lr=mt==Vt;if(lr&&xo(q)){if(!xo(X))return!1;Zt=!0,or=!1}if(lr&&!or)return nt||(nt=new $r),Zt||Ta(q)?Ns(q,X,ue,Ie,Gt,nt):Tc(q,X,mt,ue,Ie,Gt,nt);if(!(ue&i)){var Qt=or&&be.call(q,"__wrapped__"),Fr=Hr&&be.call(X,"__wrapped__");if(Qt||Fr){var Rn=Qt?q.value():q,vn=Fr?X.value():X;return nt||(nt=new $r),Gt(Rn,vn,ue,Ie,nt)}}return lr?(nt||(nt=new $r),Sa(q,X,ue,Ie,Gt,nt)):!1}function Nc(q){if(!Na(q)||Da(q))return!1;var X=Fs(q)?Re:L;return X.test(si(q))}function Ea(q){return is(q)&&Ra(q.length)&&!!_[rs(q)]}function xa(q){if(!Ma(q))return _t(q);var X=[];for(var ue in Object(q))be.call(q,ue)&&ue!="constructor"&&X.push(ue);return X}function Ns(q,X,ue,Ie,Gt,nt){var Zt=ue&i,hr=q.length,mt=X.length;if(hr!=mt&&!(Zt&&mt>hr))return!1;var Vt=nt.get(q);if(Vt&&nt.get(X))return Vt==X;var or=-1,Hr=!0,lr=ue&a?new Wn:void 0;for(nt.set(q,X),nt.set(X,q);++or<hr;){var Qt=q[or],Fr=X[or];if(Ie)var Rn=Zt?Ie(Fr,Qt,or,X,q,nt):Ie(Qt,Fr,or,q,X,nt);if(Rn!==void 0){if(Rn)continue;Hr=!1;break}if(lr){if(!Ae(X,function(vn,Vn){if(!Pe(lr,Vn)&&(Qt===vn||Gt(Qt,vn,ue,Ie,nt)))return lr.push(Vn)})){Hr=!1;break}}else if(!(Qt===Fr||Gt(Qt,Fr,ue,Ie,nt))){Hr=!1;break}}return nt.delete(q),nt.delete(X),Hr}function Tc(q,X,ue,Ie,Gt,nt,Zt){switch(ue){case Ee:if(q.byteLength!=X.byteLength||q.byteOffset!=X.byteOffset)return!1;q=q.buffer,X=X.buffer;case pe:return!(q.byteLength!=X.byteLength||!nt(new at(q),new at(X)));case w:case b:case k:return La(+q,+X);case S:return q.name==X.name&&q.message==X.message;case Z:case y:return q==X+"";case z:var hr=je;case V:var mt=Ie&i;if(hr||(hr=De),q.size!=X.size&&!mt)return!1;var Vt=Zt.get(q);if(Vt)return Vt==X;Ie|=a,Zt.set(q,X);var or=Ns(hr(q),hr(X),Ie,Gt,nt,Zt);return Zt.delete(q),or;case B:if(At)return At.call(q)==At.call(X)}return!1}function Sa(q,X,ue,Ie,Gt,nt){var Zt=ue&i,hr=Ts(q),mt=hr.length,Vt=Ts(X),or=Vt.length;if(mt!=or&&!Zt)return!1;for(var Hr=mt;Hr--;){var lr=hr[Hr];if(!(Zt?lr in X:be.call(X,lr)))return!1}var Qt=nt.get(q);if(Qt&&nt.get(X))return Qt==X;var Fr=!0;nt.set(q,X),nt.set(X,q);for(var Rn=Zt;++Hr<mt;){lr=hr[Hr];var vn=q[lr],Vn=X[lr];if(Ie)var So=Zt?Ie(Vn,vn,lr,X,q,nt):Ie(vn,Vn,lr,q,X,nt);if(!(So===void 0?vn===Vn||Gt(vn,Vn,ue,Ie,nt):So)){Fr=!1;break}Rn||(Rn=lr=="constructor")}if(Fr&&!Rn){var ss=q.constructor,yr=X.constructor;ss!=yr&&"constructor"in q&&"constructor"in X&&!(typeof ss=="function"&&ss instanceof ss&&typeof yr=="function"&&yr instanceof yr)&&(Fr=!1)}return nt.delete(q),nt.delete(X),Fr}function Ts(q){return bo(q,qc,Aa)}function Pi(q,X){var ue=q.__data__;return Pa(X)?ue[typeof X=="string"?"string":"hash"]:ue.map}function Qr(q,X){var ue=_e(q,X);return Nc(ue)?ue:void 0}function Ia(q){var X=be.call(q,ut),ue=q[ut];try{q[ut]=void 0;var Ie=!0}catch{}var Gt=Le.call(q);return Ie&&(X?q[ut]=ue:delete q[ut]),Gt}var Aa=Ar?function(q){return q==null?[]:(q=Object(q),ve(Ar(q),function(X){return nr.call(q,X)}))}:Wt,Gn=rs;(St&&Gn(new St(new ArrayBuffer(1)))!=Ee||Be&&Gn(new Be)!=z||We&&Gn(We.resolve())!=ie||It&&Gn(new It)!=V||ke&&Gn(new ke)!=de)&&(Gn=function(q){var X=rs(q),ue=X==te?q.constructor:void 0,Ie=ue?si(ue):"";if(Ie)switch(Ie){case Rt:return Ee;case Ze:return z;case Ge:return ie;case Nt:return V;case Ve:return de}return X});function Oa(q,X){return X=X??u,!!X&&(typeof q=="number"||ce.test(q))&&q>-1&&q%1==0&&q<X}function Pa(q){var X=typeof q;return X=="string"||X=="number"||X=="symbol"||X=="boolean"?q!=="__proto__":q===null}function Da(q){return!!tt&&tt in q}function Ma(q){var X=q&&q.constructor,ue=typeof X=="function"&&X.prototype||ye;return q===ue}function $c(q){return Le.call(q)}function si(q){if(q!=null){try{return Me.call(q)}catch{}try{return q+""}catch{}}return""}function La(q,X){return q===X||q!==q&&X!==X}var Ca=Eo(function(){return arguments}())?Eo:function(q){return is(q)&&be.call(q,"callee")&&!nr.call(q,"callee")},$s=Array.isArray;function Fc(q){return q!=null&&Ra(q.length)&&!Fs(q)}var xo=wt||$t;function Uc(q,X){return ns(q,X)}function Fs(q){if(!Na(q))return!1;var X=rs(q);return X==I||X==M||X==l||X==W}function Ra(q){return typeof q=="number"&&q>-1&&q%1==0&&q<=u}function Na(q){var X=typeof q;return q!=null&&(X=="object"||X=="function")}function is(q){return q!=null&&typeof q=="object"}var Ta=se?bt(se):Ea;function qc(q){return Fc(q)?_a(q):xa(q)}function Wt(){return[]}function $t(){return!1}r.exports=Uc})(oc,oc.exports);var RP=oc.exports;const NP=As(RP),Bm="wc",Km=2,Nh="core",ii=`${Bm}@2:${Nh}:`,TP={logger:"error"},$P={database:":memory:"},FP="crypto",z0="client_ed25519_seed",UP=ge.ONE_DAY,qP="keychain",jP="0.3",BP="messages",KP="0.3",H0=ge.SIX_HOURS,zP="publisher",zm="irn",HP="error",Hm="wss://relay.walletconnect.org",kP="relayer",Er={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},WP="_subscription",Sn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},GP=.1,Th="2.17.5",Yt={link_mode:"link_mode",relay:"relay"},VP="0.3",JP="WALLETCONNECT_CLIENT_ID",k0="WALLETCONNECT_LINK_MODE_APPS",on={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},YP="subscription",XP="0.3",ZP=ge.FIVE_SECONDS*1e3,QP="pairing",eD="0.3",ko={wc_pairingDelete:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ge.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ge.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:0},res:{ttl:ge.ONE_DAY,prompt:!1,tag:0}}},_s={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Un={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},tD="history",rD="0.3",nD="expirer",In={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},iD="0.3",sD="verify-api",oD="https://verify.walletconnect.com",km="https://verify.walletconnect.org",ea=km,aD=`${ea}/v3`,uD=[oD,km],cD="echo",fD="https://echo.walletconnect.com",ei={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},yi={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},qn={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},vs={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},ms={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Wo={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},hD=.1,lD="event-client",dD=86400,pD="https://pulse.walletconnect.org/batch";function gD(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var a=r.charAt(i),u=a.charCodeAt(0);if(t[u]!==255)throw new TypeError(a+" is ambiguous");t[u]=i}var f=r.length,d=r.charAt(0),l=Math.log(f)/Math.log(256),w=Math.log(256)/Math.log(f);function b(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var z=0,k=0,Y=0,te=M.length;Y!==te&&M[Y]===0;)Y++,z++;for(var ie=(te-Y)*w+1>>>0,W=new Uint8Array(ie);Y!==te;){for(var Z=M[Y],V=0,y=ie-1;(Z!==0||V<k)&&y!==-1;y--,V++)Z+=256*W[y]>>>0,W[y]=Z%f>>>0,Z=Z/f>>>0;if(Z!==0)throw new Error("Non-zero carry");k=V,Y++}for(var B=ie-k;B!==ie&&W[B]===0;)B++;for(var he=d.repeat(z);B<ie;++B)he+=r.charAt(W[B]);return he}function S(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var z=0;if(M[z]!==" "){for(var k=0,Y=0;M[z]===d;)k++,z++;for(var te=(M.length-z)*l+1>>>0,ie=new Uint8Array(te);M[z];){var W=t[M.charCodeAt(z)];if(W===255)return;for(var Z=0,V=te-1;(W!==0||Z<Y)&&V!==-1;V--,Z++)W+=f*ie[V]>>>0,ie[V]=W%256>>>0,W=W/256>>>0;if(W!==0)throw new Error("Non-zero carry");Y=Z,z++}if(M[z]!==" "){for(var y=te-Y;y!==te&&ie[y]===0;)y++;for(var B=new Uint8Array(k+(te-y)),he=k;y!==te;)B[he++]=ie[y++];return B}}}function I(M){var z=S(M);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:S,decode:I}}var vD=gD,mD=vD;const Wm=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},yD=r=>new TextEncoder().encode(r),wD=r=>new TextDecoder().decode(r);class _D{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class bD{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Gm(this,e)}}class ED{constructor(e){this.decoders=e}or(e){return Gm(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Gm=(r,e)=>new ED({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class xD{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new _D(e,t,n),this.decoder=new bD(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Pc=({name:r,prefix:e,encode:t,decode:n})=>new xD(r,e,t,n),wa=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:i}=mD(t,e);return Pc({prefix:r,name:e,encode:n,decode:a=>Wm(i(a))})},SD=(r,e,t,n)=>{const i={};for(let w=0;w<e.length;++w)i[e[w]]=w;let a=r.length;for(;r[a-1]==="=";)--a;const u=new Uint8Array(a*t/8|0);let f=0,d=0,l=0;for(let w=0;w<a;++w){const b=i[r[w]];if(b===void 0)throw new SyntaxError(`Non-${n} character`);d=d<<t|b,f+=t,f>=8&&(f-=8,u[l++]=255&d>>f)}if(f>=t||255&d<<8-f)throw new SyntaxError("Unexpected end of data");return u},ID=(r,e,t)=>{const n=e[e.length-1]==="=",i=(1<<t)-1;let a="",u=0,f=0;for(let d=0;d<r.length;++d)for(f=f<<8|r[d],u+=8;u>t;)u-=t,a+=e[i&f>>u];if(u&&(a+=e[i&f<<t-u]),n)for(;a.length*t&7;)a+="=";return a},Lr=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Pc({prefix:e,name:r,encode(i){return ID(i,n,t)},decode(i){return SD(i,n,t,r)}}),AD=Pc({prefix:"\0",name:"identity",encode:r=>wD(r),decode:r=>yD(r)});var OD=Object.freeze({__proto__:null,identity:AD});const PD=Lr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var DD=Object.freeze({__proto__:null,base2:PD});const MD=Lr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var LD=Object.freeze({__proto__:null,base8:MD});const CD=wa({prefix:"9",name:"base10",alphabet:"0123456789"});var RD=Object.freeze({__proto__:null,base10:CD});const ND=Lr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),TD=Lr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var $D=Object.freeze({__proto__:null,base16:ND,base16upper:TD});const FD=Lr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),UD=Lr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qD=Lr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),jD=Lr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),BD=Lr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),KD=Lr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),zD=Lr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),HD=Lr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),kD=Lr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var WD=Object.freeze({__proto__:null,base32:FD,base32upper:UD,base32pad:qD,base32padupper:jD,base32hex:BD,base32hexupper:KD,base32hexpad:zD,base32hexpadupper:HD,base32z:kD});const GD=wa({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),VD=wa({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var JD=Object.freeze({__proto__:null,base36:GD,base36upper:VD});const YD=wa({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),XD=wa({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ZD=Object.freeze({__proto__:null,base58btc:YD,base58flickr:XD});const QD=Lr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),eM=Lr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),tM=Lr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),rM=Lr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var nM=Object.freeze({__proto__:null,base64:QD,base64pad:eM,base64url:tM,base64urlpad:rM});const Vm=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),iM=Vm.reduce((r,e,t)=>(r[t]=e,r),[]),sM=Vm.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function oM(r){return r.reduce((e,t)=>(e+=iM[t],e),"")}function aM(r){const e=[];for(const t of r){const n=sM[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const uM=Pc({prefix:"🚀",name:"base256emoji",encode:oM,decode:aM});var cM=Object.freeze({__proto__:null,base256emoji:uM}),fM=Jm,W0=128,hM=-128,lM=Math.pow(2,31);function Jm(r,e,t){e=e||[],t=t||0;for(var n=t;r>=lM;)e[t++]=r&255|W0,r/=128;for(;r&hM;)e[t++]=r&255|W0,r>>>=7;return e[t]=r|0,Jm.bytes=t-n+1,e}var dM=$h,pM=128,G0=127;function $h(r,n){var t=0,n=n||0,i=0,a=n,u,f=r.length;do{if(a>=f)throw $h.bytes=0,new RangeError("Could not decode varint");u=r[a++],t+=i<28?(u&G0)<<i:(u&G0)*Math.pow(2,i),i+=7}while(u>=pM);return $h.bytes=a-n,t}var gM=Math.pow(2,7),vM=Math.pow(2,14),mM=Math.pow(2,21),yM=Math.pow(2,28),wM=Math.pow(2,35),_M=Math.pow(2,42),bM=Math.pow(2,49),EM=Math.pow(2,56),xM=Math.pow(2,63),SM=function(r){return r<gM?1:r<vM?2:r<mM?3:r<yM?4:r<wM?5:r<_M?6:r<bM?7:r<EM?8:r<xM?9:10},IM={encode:fM,decode:dM,encodingLength:SM},Ym=IM;const V0=(r,e,t=0)=>(Ym.encode(r,e,t),e),J0=r=>Ym.encodingLength(r),Fh=(r,e)=>{const t=e.byteLength,n=J0(r),i=n+J0(t),a=new Uint8Array(i+t);return V0(r,a,0),V0(t,a,n),a.set(e,i),new AM(r,t,e,a)};class AM{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}}const Xm=({name:r,code:e,encode:t})=>new OM(r,e,t);class OM{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Fh(this.code,t):t.then(n=>Fh(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Zm=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),PM=Xm({name:"sha2-256",code:18,encode:Zm("SHA-256")}),DM=Xm({name:"sha2-512",code:19,encode:Zm("SHA-512")});var MM=Object.freeze({__proto__:null,sha256:PM,sha512:DM});const Qm=0,LM="identity",ey=Wm,CM=r=>Fh(Qm,ey(r)),RM={code:Qm,name:LM,encode:ey,digest:CM};var NM=Object.freeze({__proto__:null,identity:RM});new TextEncoder,new TextDecoder;const Y0={...OD,...DD,...LD,...RD,...$D,...WD,...JD,...ZD,...nM,...cM};({...MM,...NM});function TM(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function ty(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const X0=ty("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),oh=ty("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=TM(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),$M={utf8:X0,"utf-8":X0,hex:Y0.base16,latin1:oh,ascii:oh,binary:oh,...Y0};function FM(r,e="utf8"){const t=$M[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}let UM=class{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=qP,this.version=jP,this.initialized=!1,this.storagePrefix=ii,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:a}=me("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(a)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=zr(t,this.name)}get context(){return Zr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,im(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?sm(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}};class qM{constructor(e,t,n){this.core=e,this.logger=t,this.name=FP,this.randomSessionIdentifier=Mh(),this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),a=Gp(i);return jv(a.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=T5();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const a=await this.getClientSeed(),u=Gp(a),f=this.randomSessionIdentifier;return await SI(f,i,UP,u)},this.generateSharedKey=(i,a,u)=>{this.isInitialized();const f=this.getPrivateKey(i),d=$5(f,a);return this.setSymKey(d,u)},this.setSymKey=async(i,a)=>{this.isInitialized();const u=a||qu(i);return await this.keychain.set(u,i),u},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,a,u)=>{this.isInitialized();const f=gm(u),d=xi(a);if(x0(f))return U5(d,u==null?void 0:u.encoding);if(E0(f)){const S=f.senderPublicKey,I=f.receiverPublicKey;i=await this.generateSharedKey(S,I)}const l=this.getSymKey(i),{type:w,senderPublicKey:b}=f;return F5({type:w,symKey:l,message:d,senderPublicKey:b,encoding:u==null?void 0:u.encoding})},this.decode=async(i,a,u)=>{this.isInitialized();const f=B5(a,u);if(x0(f)){const d=j5(a,u==null?void 0:u.encoding);return xs(d)}if(E0(f)){const d=f.receiverPublicKey,l=f.senderPublicKey;i=await this.generateSharedKey(d,l)}try{const d=this.getSymKey(i),l=q5({symKey:d,encoded:a,encoding:u==null?void 0:u.encoding});return xs(l)}catch(d){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(d)}},this.getPayloadType=(i,a=Bi)=>{const u=sa({encoded:i,encoding:a});return Is(u.type)},this.getPayloadSenderPublicKey=(i,a=Bi)=>{const u=sa({encoded:i,encoding:a});return u.senderPublicKey?Sr(u.senderPublicKey,Kr):void 0},this.core=e,this.logger=zr(t,this.name),this.keychain=n||new UM(this.core,this.logger)}get context(){return Zr(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(z0)}catch{e=Mh(),await this.keychain.set(z0,e)}return FM(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}}class jM extends C6{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=BP,this.version=KP,this.initialized=!1,this.storagePrefix=ii,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const a=_i(i);let u=this.messages.get(n);return typeof u>"u"&&(u={}),typeof u[a]<"u"||(u[a]=i,this.messages.set(n,u),await this.persist()),a},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const a=this.get(n),u=_i(i);return typeof a[u]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=zr(e,this.name),this.core=t}get context(){return Zr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,im(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?sm(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}}var BM=Object.defineProperty,KM=Object.defineProperties,zM=Object.getOwnPropertyDescriptors,Z0=Object.getOwnPropertySymbols,HM=Object.prototype.hasOwnProperty,kM=Object.prototype.propertyIsEnumerable,Q0=(r,e,t)=>e in r?BM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,eg=(r,e)=>{for(var t in e||(e={}))HM.call(e,t)&&Q0(r,t,e[t]);if(Z0)for(var t of Z0(e))kM.call(e,t)&&Q0(r,t,e[t]);return r},tg=(r,e)=>KM(r,zM(e));class WM extends R6{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Os.EventEmitter,this.name=zP,this.queue=new Map,this.publishTimeout=ge.toMiliseconds(ge.ONE_MINUTE),this.initialPublishTimeout=ge.toMiliseconds(ge.ONE_SECOND*15),this.needsTransportRestart=!1,this.publish=async(n,i,a)=>{var u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:a}});const f=(a==null?void 0:a.ttl)||H0,d=ic(a),l=(a==null?void 0:a.prompt)||!1,w=(a==null?void 0:a.tag)||0,b=(a==null?void 0:a.id)||Es().toString(),S={topic:n,message:i,opts:{ttl:f,relay:d,prompt:l,tag:w,id:b,attestation:a==null?void 0:a.attestation}},I=`Failed to publish payload, please try again. id:${b} tag:${w}`;try{const M=new Promise(async z=>{const k=({id:te})=>{S.opts.id===te&&(this.removeRequestFromQueue(te),this.relayer.events.removeListener(Er.publish,k),z(S))};this.relayer.events.on(Er.publish,k);const Y=ji(new Promise((te,ie)=>{this.rpcPublish({topic:n,message:i,ttl:f,prompt:l,tag:w,id:b,attestation:a==null?void 0:a.attestation}).then(te).catch(W=>{this.logger.warn(W,W==null?void 0:W.message),ie(W)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${b} tag:${w}`);try{await Y,this.events.removeListener(Er.publish,k)}catch(te){this.queue.set(b,tg(eg({},S),{attempt:1})),this.logger.warn(te,te==null?void 0:te.message)}});this.logger.trace({type:"method",method:"publish",params:{id:b,topic:n,message:i,opts:a}}),await ji(M,this.publishTimeout,I)}catch(M){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(M),(u=a==null?void 0:a.internal)!=null&&u.throwOnFailedPublish)throw M}finally{this.queue.delete(b)}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=zr(t,this.name),this.registerEventListeners()}get context(){return Zr(this.logger)}async rpcPublish(e){var t,n,i,a;const{topic:u,message:f,ttl:d=H0,prompt:l,tag:w,id:b,attestation:S}=e,I={method:Yo(ic().protocol).publish,params:{topic:u,message:f,ttl:d,prompt:l,tag:w,attestation:S},id:b};Br((t=I.params)==null?void 0:t.prompt)&&((n=I.params)==null||delete n.prompt),Br((i=I.params)==null?void 0:i.tag)&&((a=I.params)==null||delete a.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:I});const M=await this.relayer.request(I);return this.relayer.events.emit(Er.publish,e),this.logger.debug("Successfully Published Payload"),M}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{const n=e.attempt+1;this.queue.set(t,tg(eg({},e),{attempt:n}));const{topic:i,message:a,opts:u,attestation:f}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish({topic:i,message:a,ttl:u.ttl,prompt:u.prompt,tag:u.tag,id:u.id,attestation:f}),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(mo.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Er.connection_stalled);return}this.checkQueue()}),this.relayer.on(Er.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class GM{constructor(){this.map=new Map,this.set=(e,t)=>{const n=this.get(e);this.exists(e,t)||this.map.set(e,[...n,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,t))return;const i=n.filter(a=>a!==t);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var VM=Object.defineProperty,JM=Object.defineProperties,YM=Object.getOwnPropertyDescriptors,rg=Object.getOwnPropertySymbols,XM=Object.prototype.hasOwnProperty,ZM=Object.prototype.propertyIsEnumerable,ng=(r,e,t)=>e in r?VM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Go=(r,e)=>{for(var t in e||(e={}))XM.call(e,t)&&ng(r,t,e[t]);if(rg)for(var t of rg(e))ZM.call(e,t)&&ng(r,t,e[t]);return r},ah=(r,e)=>JM(r,YM(e));class QM extends $6{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new GM,this.events=new Os.EventEmitter,this.name=YP,this.version=XP,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=ii,this.subscribeTimeout=ge.toMiliseconds(ge.ONE_MINUTE),this.initialSubscribeTimeout=ge.toMiliseconds(ge.ONE_SECOND*15),this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId(),await this.restore()),this.initialized=!0},this.subscribe=async(n,i)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const a=ic(i),u={topic:n,relay:a,transportType:i==null?void 0:i.transportType};this.pending.set(n,u);const f=await this.rpcSubscribe(n,a,i);return typeof f=="string"&&(this.onSubscribe(f,u),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}})),f}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}},this.unsubscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),typeof(i==null?void 0:i.id)<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>{if(this.topics.includes(n))return!0;const i=`${this.pendingSubscriptionWatchLabel}_${n}`;return await new Promise((a,u)=>{const f=new ge.Watch;f.start(i);const d=setInterval(()=>{(!this.pending.has(n)&&this.topics.includes(n)||this.cached.some(l=>l.topic===n))&&(clearInterval(d),f.stop(i),a(!0)),f.elapsed(i)>=ZP&&(clearInterval(d),f.stop(i),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{await this.restore(),await this.onRestart()},this.checkPending=async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(i=>{n.push(i)}),await this.batchSubscribe(n)},this.registerEventListeners=()=>{this.relayer.core.heartbeat.on(mo.pulse,async()=>{await this.checkPending()}),this.events.on(on.created,async n=>{const i=on.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()}),this.events.on(on.deleted,async n=>{const i=on.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()})},this.relayer=e,this.logger=zr(t,this.name),this.clientId=""}get context(){return Zr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let n=!1;try{n=this.getSubscription(e).topic===t}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,t)))}async unsubscribeById(e,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}});try{const i=ic(n);await this.rpcUnsubscribe(e,t,i);const a=Ct("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,a),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,t,n){var i;(n==null?void 0:n.transportType)===Yt.relay&&await this.restartToComplete();const a={method:Yo(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const u=(i=n==null?void 0:n.internal)==null?void 0:i.throwOnFailedPublish;try{const f=this.getSubscriptionId(e);if((n==null?void 0:n.transportType)===Yt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(w=>this.logger.warn(w))},ge.toMiliseconds(ge.ONE_SECOND)),f;const d=new Promise(async w=>{const b=S=>{S.topic===e&&(this.events.removeListener(on.created,b),w(S.id))};this.events.on(on.created,b);try{const S=await ji(new Promise((I,M)=>{this.relayer.request(a).catch(z=>{this.logger.warn(z,z==null?void 0:z.message),M(z)}).then(I)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(on.created,b),w(S)}catch{}}),l=await ji(d,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!l&&u)throw new Error(`Subscribing to ${e} failed, please try again`);return l?f:null}catch(f){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Er.connection_stalled),u)throw f}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,n={method:Yo(t.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await ji(new Promise(i=>{this.relayer.request(n).catch(a=>this.logger.warn(a)).then(i)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Er.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,n={method:Yo(t.protocol).batchFetchMessages,params:{topics:e.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let i;try{i=await await ji(new Promise((a,u)=>{this.relayer.request(n).catch(f=>{this.logger.warn(f),u(f)}).then(a)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Er.connection_stalled)}return i}rpcUnsubscribe(e,t,n){const i={method:Yo(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,ah(Go({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Go({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Go({},t)),this.topicMap.set(t.topic,e),this.events.emit(on.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:n}=me("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(on.deleted,ah(Go({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(on.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<t;n++){const i=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(on.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=me("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(e.map(t=>ah(Go({},t),{id:this.getSubscriptionId(t.topic)}))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await f5(ge.toMiliseconds(ge.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){!this.relayer.connected&&!this.relayer.connecting&&await this.relayer.transportOpen()}getSubscriptionId(e){return _i(e+this.clientId)}}var eL=Object.defineProperty,ig=Object.getOwnPropertySymbols,tL=Object.prototype.hasOwnProperty,rL=Object.prototype.propertyIsEnumerable,sg=(r,e,t)=>e in r?eL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,og=(r,e)=>{for(var t in e||(e={}))tL.call(e,t)&&sg(r,t,e[t]);if(ig)for(var t of ig(e))rL.call(e,t)&&sg(r,t,e[t]);return r};class nL extends N6{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Os.EventEmitter,this.name=kP,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1,this.heartBeatTimeout=ge.toMiliseconds(ge.THIRTY_SECONDS+ge.FIVE_SECONDS),this.requestsInFlight=[],this.connectTimeout=ge.toMiliseconds(ge.ONE_SECOND*15),this.request=async t=>{var n,i;this.logger.debug("Publishing Request Payload");const a=t.id||Es().toString();await this.toEstablishConnection();try{this.logger.trace({id:a,method:t.method,topic:(n=t.params)==null?void 0:n.topic},"relayer.request - publishing...");const u=`${a}:${((i=t.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(u);const f=await this.provider.request(t);return this.requestsInFlight=this.requestsInFlight.filter(d=>d!==u),f}catch(u){throw this.logger.debug(`Failed to Publish Request: ${a}`),u}},this.resetPingTimeout=()=>{if(rc())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,n,i;this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null||i.terminate()},this.heartBeatTimeout)}catch(t){this.logger.warn(t,t==null?void 0:t.message)}},this.onPayloadHandler=t=>{this.onProviderPayload(t),this.resetPingTimeout()},this.onConnectHandler=()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(Er.connect)},this.onDisconnectHandler=()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.fatal(t,`Fatal socket error: ${t==null?void 0:t.message}`),this.events.emit(Er.error,t),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Sn.payload,this.onPayloadHandler),this.provider.on(Sn.connect,this.onConnectHandler),this.provider.on(Sn.disconnect,this.onDisconnectHandler),this.provider.on(Sn.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?zr(e.logger,this.name):ca(dc({level:e.logger||HP})),this.messages=new jM(this.logger,e.core),this.subscriber=new QM(this,this.logger),this.publisher=new WM(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Hm,this.projectId=e.projectId,JA()?this.packageName=d0():YA()&&(this.bundleId=d0()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.cached.length>0)try{await this.transportOpen()}catch(e){this.logger.warn(e,e==null?void 0:e.message)}}get context(){return Zr(this.logger)}get connected(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===1}get connecting(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===0}async publish(e,t,n){this.isInitialized(),await this.publisher.publish(e,t,n),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:Yt.relay})}async subscribe(e,t){var n,i,a;this.isInitialized(),(!(t!=null&&t.transportType)||(t==null?void 0:t.transportType)==="relay")&&await this.toEstablishConnection();const u=typeof((n=t==null?void 0:t.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(i=t==null?void 0:t.internal)==null?void 0:i.throwOnFailedPublish;let f=((a=this.subscriber.topicMap.get(e))==null?void 0:a[0])||"",d;const l=w=>{w.topic===e&&(this.subscriber.off(on.created,l),d())};return await Promise.all([new Promise(w=>{d=w,this.subscriber.on(on.created,l)}),new Promise(async(w,b)=>{f=await this.subscriber.subscribe(e,og({internal:{throwOnFailedPublish:u}},t)).catch(S=>{u&&b(S)})||f,w()})]),f}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await ji(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,n)=>{await this.connect(e).then(t).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await L0())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((n,i)=>n.publishedAt-i.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const n of t)try{await this.onMessageEvent(n)}catch(i){this.logger.warn(i,"Error while processing batch message event: "+(i==null?void 0:i.message))}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:n}=e;if(!t.sessionExists){const i=vr(ge.FIVE_MINUTES),a={topic:n,expiry:i,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,a)}this.events.emit(Er.message,e),await this.recordMessageEvent(e)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(n,i)=>{const a=()=>{i(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Sn.disconnect,a),await ji(new Promise((u,f)=>{this.provider.connect().then(u).catch(f)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(u=>{i(u)}).finally(()=>{this.provider.off(Sn.disconnect,a),clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0}),await new Promise(async(u,f)=>{const d=()=>{f(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Sn.disconnect,d),await this.subscriber.start().then(u).catch(f).finally(()=>{this.provider.off(Sn.disconnect,d)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const i=n;this.logger.warn({},i.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(n=>setTimeout(n,ge.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,n,i,a;if(rc())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((a=(i=(n=this.provider)==null?void 0:n.connection)==null?void 0:i.socket)==null||a.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(u){this.logger.warn(u,u==null?void 0:u.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Mn(new CP(e5({sdkVersion:Th,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:n}=e;await this.messages.set(t,n)}async shouldIgnoreMessageEvent(e){const{topic:t,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.warn(`Ignoring message for non-subscribed topic ${t}`),!0;const i=this.messages.has(t,n);return i&&this.logger.warn(`Ignoring duplicate message: ${n}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),cl(e)){if(!e.method.endsWith(WP))return;const t=e.params,{topic:n,message:i,publishedAt:a,attestation:u}=t.data,f={topic:n,message:i,publishedAt:a,transportType:Yt.relay,attestation:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(og({type:"event",event:t.id},f)),this.events.emit(t.id,f),await this.acknowledgePayload(e),await this.onMessageEvent(f)}else Ac(e)&&this.events.emit(Er.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Er.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=Sc(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Sn.payload,this.onPayloadHandler),this.provider.off(Sn.connect,this.onConnectHandler),this.provider.off(Sn.disconnect,this.onDisconnectHandler),this.provider.off(Sn.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await L0();PO(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(n=>this.logger.error(n,n==null?void 0:n.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),clearTimeout(this.pingTimeout),this.events.emit(Er.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&(this.reconnectTimeout||this.connectPromise||(this.reconnectTimeout=setTimeout(async()=>{clearTimeout(this.reconnectTimeout),await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message))},ge.toMiliseconds(GP))))}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.transportOpen()}}var iL=Object.defineProperty,ag=Object.getOwnPropertySymbols,sL=Object.prototype.hasOwnProperty,oL=Object.prototype.propertyIsEnumerable,ug=(r,e,t)=>e in r?iL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,cg=(r,e)=>{for(var t in e||(e={}))sL.call(e,t)&&ug(r,t,e[t]);if(ag)for(var t of ag(e))oL.call(e,t)&&ug(r,t,e[t]);return r};class Cs extends T6{constructor(e,t,n,i=ii,a=void 0){super(e,t,n,i),this.core=e,this.logger=t,this.name=n,this.map=new Map,this.version=VP,this.cached=[],this.initialized=!1,this.storagePrefix=ii,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(u=>{this.getKey&&u!==null&&!Br(u)?this.map.set(this.getKey(u),u):sO(u)?this.map.set(u.id,u):oO(u)&&this.map.set(u.topic,u)}),this.cached=[],this.initialized=!0)},this.set=async(u,f)=>{this.isInitialized(),this.map.has(u)?await this.update(u,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:u,value:f}),this.map.set(u,f),await this.persist())},this.get=u=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:u}),this.getData(u)),this.getAll=u=>(this.isInitialized(),u?this.values.filter(f=>Object.keys(u).every(d=>NP(f[d],u[d]))):this.values),this.update=async(u,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:u,update:f});const d=cg(cg({},this.getData(u)),f);this.map.set(u,d),await this.persist()},this.delete=async(u,f)=>{this.isInitialized(),this.map.has(u)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:u,reason:f}),this.map.delete(u),this.addToRecentlyDeleted(u),await this.persist())},this.logger=zr(t,this.name),this.storagePrefix=i,this.getKey=a}get context(){return Zr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:i}=me("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}const{message:n}=me("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=me("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}}class aL{constructor(e,t){this.core=e,this.logger=t,this.name=QP,this.version=eD,this.events=new Mx,this.initialized=!1,this.storagePrefix=ii,this.ignoredPayloadTypes=[bi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async n=>{this.isInitialized();const i=Mh(),a=await this.core.crypto.setSymKey(i),u=vr(ge.FIVE_MINUTES),f={protocol:zm},d={topic:a,expiry:u,relay:f,active:!1,methods:n==null?void 0:n.methods},l=I0({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:i,relay:f,expiryTimestamp:u,methods:n==null?void 0:n.methods});return this.events.emit(_s.create,d),this.core.expirer.set(a,u),await this.pairings.set(a,d),await this.core.relayer.subscribe(a,{transportType:n==null?void 0:n.transportType}),{topic:a,uri:l}},this.pair=async n=>{this.isInitialized();const i=this.core.eventClient.createEvent({properties:{topic:n==null?void 0:n.uri,trace:[ei.pairing_started]}});this.isValidPair(n,i);const{topic:a,symKey:u,relay:f,expiryTimestamp:d,methods:l}=S0(n.uri);i.props.properties.topic=a,i.addTrace(ei.pairing_uri_validation_success),i.addTrace(ei.pairing_uri_not_expired);let w;if(this.pairings.keys.includes(a)){if(w=this.pairings.get(a),i.addTrace(ei.existing_pairing),w.active)throw i.setError(yi.active_pairing_already_exists),new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);i.addTrace(ei.pairing_not_expired)}const b=d||vr(ge.FIVE_MINUTES),S={topic:a,relay:f,expiry:b,active:!1,methods:l};this.core.expirer.set(a,b),await this.pairings.set(a,S),i.addTrace(ei.store_new_pairing),n.activatePairing&&await this.activate({topic:a}),this.events.emit(_s.create,S),i.addTrace(ei.emit_inactive_pairing),this.core.crypto.keychain.has(a)||await this.core.crypto.setSymKey(u,a),i.addTrace(ei.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(yi.no_internet_connection)}try{await this.core.relayer.subscribe(a,{relay:f})}catch(I){throw i.setError(yi.subscribe_pairing_topic_failure),I}return i.addTrace(ei.subscribe_pairing_topic_success),S},this.activate=async({topic:n})=>{this.isInitialized();const i=vr(ge.FIVE_MINUTES);this.core.expirer.set(n,i),await this.pairings.update(n,{active:!0,expiry:i})},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:i}=n;if(this.pairings.keys.includes(i)){const a=await this.sendRequest(i,"wc_pairingPing",{}),{done:u,resolve:f,reject:d}=ys();this.events.once(pt("pairing_ping",a),({error:l})=>{l?d(l):f()}),await u()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Ct("USER_DISCONNECTED")),await this.deletePairing(i))},this.formatUriFromPairing=n=>{this.isInitialized();const{topic:i,relay:a,expiry:u,methods:f}=n,d=this.core.crypto.keychain.get(i);return I0({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:d,relay:a,expiryTimestamp:u,methods:f})},this.sendRequest=async(n,i,a)=>{const u=Ki(i,a),f=await this.core.crypto.encode(n,u),d=ko[i].req;return this.core.history.set(n,u),this.core.relayer.publish(n,f,d),u.id},this.sendResult=async(n,i,a)=>{const u=Sc(n,a),f=await this.core.crypto.encode(i,u),d=await this.core.history.get(i,n),l=ko[d.request.method].res;await this.core.relayer.publish(i,f,l),await this.core.history.resolve(u)},this.sendError=async(n,i,a)=>{const u=Ic(n,a),f=await this.core.crypto.encode(i,u),d=await this.core.history.get(i,n),l=ko[d.request.method]?ko[d.request.method].res:ko.unregistered_method.res;await this.core.relayer.publish(i,f,l),await this.core.history.resolve(u)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Ct("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>qi(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:a}=n;switch(a.method){case"wc_pairingPing":return this.onPairingPingRequest(i,a);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,a);default:return this.onUnknownRpcMethodRequest(i,a)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:a}=n,u=(await this.core.history.get(i,a.id)).request.method;switch(u){case"wc_pairingPing":return this.onPairingPingResponse(i,a);default:return this.onUnknownRpcMethodResponse(u)}},this.onPairingPingRequest=async(n,i)=>{const{id:a}=i;try{this.isValidPing({topic:n}),await this.sendResult(a,n,!0),this.events.emit(_s.ping,{id:a,topic:n})}catch(u){await this.sendError(a,n,u),this.logger.error(u)}},this.onPairingPingResponse=(n,i)=>{const{id:a}=i;setTimeout(()=>{ti(i)?this.events.emit(pt("pairing_ping",a),{}):An(i)&&this.events.emit(pt("pairing_ping",a),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:a}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(_s.delete,{id:a,topic:n})}catch(u){await this.sendError(a,n,u),this.logger.error(u)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:a,method:u}=i;try{if(this.registeredMethods.includes(u))return;const f=Ct("WC_METHOD_UNSUPPORTED",u);await this.sendError(a,n,f),this.logger.error(f)}catch(f){await this.sendError(a,n,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Ct("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=(n,i)=>{var a;if(!Yr(n)){const{message:f}=me("MISSING_OR_INVALID",`pair() params: ${n}`);throw i.setError(yi.malformed_pairing_uri),new Error(f)}if(!iO(n.uri)){const{message:f}=me("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw i.setError(yi.malformed_pairing_uri),new Error(f)}const u=S0(n==null?void 0:n.uri);if(!((a=u==null?void 0:u.relay)!=null&&a.protocol)){const{message:f}=me("MISSING_OR_INVALID","pair() uri#relay-protocol");throw i.setError(yi.malformed_pairing_uri),new Error(f)}if(!(u!=null&&u.symKey)){const{message:f}=me("MISSING_OR_INVALID","pair() uri#symKey");throw i.setError(yi.malformed_pairing_uri),new Error(f)}if(u!=null&&u.expiryTimestamp&&ge.toMiliseconds(u==null?void 0:u.expiryTimestamp)<Date.now()){i.setError(yi.pairing_expired);const{message:f}=me("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(f)}},this.isValidPing=async n=>{if(!Yr(n)){const{message:a}=me("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(a)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!Yr(n)){const{message:a}=me("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(a)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!fr(n,!1)){const{message:i}=me("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=me("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(qi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=me("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=zr(t,this.name),this.pairings=new Cs(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Zr(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Er.message,async e=>{const{topic:t,message:n,transportType:i}=e;if(!this.pairings.keys.includes(t)||i===Yt.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const a=await this.core.crypto.decode(t,n);try{cl(a)?(this.core.history.set(t,a),this.onRelayEventRequest({topic:t,payload:a})):Ac(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a}),this.core.history.delete(t,a.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on(In.expired,async e=>{const{topic:t}=am(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(_s.expire,{topic:t}))})}}class uL extends L6{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Os.EventEmitter,this.name=tD,this.version=rD,this.cached=[],this.initialized=!1,this.storagePrefix=ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,a)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:a}),this.records.has(i.id))return;const u={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:a,expiry:vr(ge.THIRTY_DAYS)};this.records.set(u.id,u),this.persist(),this.events.emit(Un.created,u)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=An(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.persist(),this.events.emit(Un.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(a=>{if(a.topic===n){if(typeof i<"u"&&a.id!==i)return;this.records.delete(a.id),this.events.emit(Un.deleted,a)}}),this.persist()},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=zr(t,this.name)}get context(){return Zr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:Ki(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:n}=me("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Un.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=me("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Un.created,e=>{const t=Un.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Un.updated,e=>{const t=Un.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Un.deleted,e=>{const t=Un.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(mo.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{ge.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(Un.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}}class cL extends F6{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Os.EventEmitter,this.name=nD,this.version=iD,this.cached=[],this.initialized=!1,this.storagePrefix=ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const a=this.formatTarget(n),u={target:a,expiry:i};this.expirations.set(a,u),this.checkExpiry(a,u),this.events.emit(In.created,{target:a,expiration:u})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),a=this.getExpiration(i);this.expirations.delete(i),this.events.emit(In.deleted,{target:i,expiration:a})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=zr(t,this.name)}get context(){return Zr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return t5(e);if(typeof e=="number")return r5(e);const{message:t}=me("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(In.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=me("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:n}=me("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return t}checkExpiry(e,t){const{expiry:n}=t;ge.toMiliseconds(n)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(In.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(mo.pulse,()=>this.checkExpirations()),this.events.on(In.created,e=>{const t=In.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(In.expired,e=>{const t=In.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(In.deleted,e=>{const t=In.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}}class fL extends U6{constructor(e,t,n){super(e,t,n),this.core=e,this.logger=t,this.store=n,this.name=sD,this.verifyUrlV3=aD,this.storagePrefix=ii,this.version=Km,this.init=async()=>{var i;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&ge.toMiliseconds((i=this.publicKey)==null?void 0:i.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))},this.register=async i=>{if(!ga()||this.isDevEnv)return;const a=window.location.origin,{id:u,decryptedId:f}=i,d=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${a}&id=${u}&decryptedId=${f}`;try{const l=la(),w=this.startAbortTimer(ge.ONE_SECOND*5),b=await new Promise((S,I)=>{const M=()=>{window.removeEventListener("message",k),l.body.removeChild(z),I("attestation aborted")};this.abortController.signal.addEventListener("abort",M);const z=l.createElement("iframe");z.src=d,z.style.display="none",z.addEventListener("error",M,{signal:this.abortController.signal});const k=Y=>{if(Y.data&&typeof Y.data=="string")try{const te=JSON.parse(Y.data);if(te.type==="verify_attestation"){if(Sh(te.attestation).payload.id!==u)return;clearInterval(w),l.body.removeChild(z),this.abortController.signal.removeEventListener("abort",M),window.removeEventListener("message",k),S(te.attestation===null?"":te.attestation)}}catch(te){this.logger.warn(te)}};l.body.appendChild(z),window.addEventListener("message",k,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",b),b}catch(l){this.logger.warn(l)}return""},this.resolve=async i=>{if(this.isDevEnv)return"";const{attestationId:a,hash:u,encryptedId:f}=i;if(a===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(a){if(Sh(a).payload.id!==f)return;const l=await this.isValidJwtAttestation(a);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!u)return;const d=this.getVerifyUrl(i==null?void 0:i.verifyUrl);return this.fetchAttestation(u,d)},this.fetchAttestation=async(i,a)=>{this.logger.debug(`resolving attestation: ${i} from url: ${a}`);const u=this.startAbortTimer(ge.ONE_SECOND*5),f=await fetch(`${a}/attestation/${i}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(u),f.status===200?await f.json():void 0},this.getVerifyUrl=i=>{let a=i||ea;return uD.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${ea}`),a=ea),a},this.fetchPublicKey=async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const i=this.startAbortTimer(ge.FIVE_SECONDS),a=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(i),await a.json()}catch(i){this.logger.warn(i)}},this.persistPublicKey=async i=>{this.logger.debug("persisting public key to local storage",i),await this.store.setItem(this.storeKey,i),this.publicKey=i},this.removePublicKey=async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0},this.isValidJwtAttestation=async i=>{const a=await this.getPublicKey();try{if(a)return this.validateAttestation(i,a)}catch(f){this.logger.error(f),this.logger.warn("error validating attestation")}const u=await this.fetchAndPersistPublicKey();try{if(u)return this.validateAttestation(i,u)}catch(f){this.logger.error(f),this.logger.warn("error validating attestation")}},this.getPublicKey=async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey(),this.fetchAndPersistPublicKey=async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async a=>{const u=await this.fetchPublicKey();u&&(await this.persistPublicKey(u),a(u))});const i=await this.fetchPromise;return this.fetchPromise=void 0,i},this.validateAttestation=(i,a)=>{const u=k5(i,a.publicKey),f={hasExpired:ge.toMiliseconds(u.exp)<Date.now(),payload:u};if(f.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:f.payload.origin,isScam:f.payload.isScam,isVerified:f.payload.isVerified}},this.logger=zr(t,this.name),this.abortController=new AbortController,this.isDevEnv=rl(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Zr(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ge.toMiliseconds(e))}}class hL extends q6{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=cD,this.registerDeviceToken=async n=>{const{clientId:i,token:a,notificationType:u,enableEncrypted:f=!1}=n,d=`${fD}/${this.projectId}/clients`;await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:i,type:u,token:a,always_raw:f})})},this.logger=zr(t,this.context)}}var lL=Object.defineProperty,fg=Object.getOwnPropertySymbols,dL=Object.prototype.hasOwnProperty,pL=Object.prototype.propertyIsEnumerable,hg=(r,e,t)=>e in r?lL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vo=(r,e)=>{for(var t in e||(e={}))dL.call(e,t)&&hg(r,t,e[t]);if(fg)for(var t of fg(e))pL.call(e,t)&&hg(r,t,e[t]);return r};class gL extends j6{constructor(e,t,n=!0){super(e,t,n),this.core=e,this.logger=t,this.context=lD,this.storagePrefix=ii,this.storageVersion=hD,this.events=new Map,this.shouldPersist=!1,this.init=async()=>{if(!rl())try{const i={eventId:g0(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:nm(this.core.relayer.protocol,this.core.relayer.version,Th)}}};await this.sendEvent([i])}catch(i){this.logger.warn(i)}},this.createEvent=i=>{const{event:a="ERROR",type:u="",properties:{topic:f,trace:d}}=i,l=g0(),w=this.core.projectId||"",b=Date.now(),S=Vo({eventId:l,timestamp:b,props:{event:a,type:u,properties:{topic:f,trace:d}},bundleId:w,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,S),this.shouldPersist=!0),S},this.getEvent=i=>{const{eventId:a,topic:u}=i;if(a)return this.events.get(a);const f=Array.from(this.events.values()).find(d=>d.props.properties.topic===u);if(f)return Vo(Vo({},f),this.setMethods(f.eventId))},this.deleteEvent=i=>{const{eventId:a}=i;this.events.delete(a),this.shouldPersist=!0},this.setEventListeners=()=>{this.core.heartbeat.on(mo.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(i=>{ge.fromMiliseconds(Date.now())-ge.fromMiliseconds(i.timestamp)>dD&&(this.events.delete(i.eventId),this.shouldPersist=!0)})})},this.setMethods=i=>({addTrace:a=>this.addTrace(i,a),setError:a=>this.setError(i,a)}),this.addTrace=(i,a)=>{const u=this.events.get(i);u&&(u.props.properties.trace.push(a),this.events.set(i,u),this.shouldPersist=!0)},this.setError=(i,a)=>{const u=this.events.get(i);u&&(u.props.type=a,u.timestamp=Date.now(),this.events.set(i,u),this.shouldPersist=!0)},this.persist=async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1},this.restore=async()=>{try{const i=await this.core.storage.getItem(this.storageKey)||[];if(!i.length)return;i.forEach(a=>{this.events.set(a.eventId,Vo(Vo({},a),this.setMethods(a.eventId)))})}catch(i){this.logger.warn(i)}},this.submit=async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const i=[];for(const[a,u]of this.events)u.props.type&&i.push(u);if(i.length!==0)try{if((await this.sendEvent(i)).ok)for(const a of i)this.events.delete(a.eventId),this.shouldPersist=!0}catch(a){this.logger.warn(a)}},this.sendEvent=async i=>{const a=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${pD}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Th}${a}`,{method:"POST",body:JSON.stringify(i)})},this.getAppDomain=()=>rm().url,this.logger=zr(t,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var vL=Object.defineProperty,lg=Object.getOwnPropertySymbols,mL=Object.prototype.hasOwnProperty,yL=Object.prototype.propertyIsEnumerable,dg=(r,e,t)=>e in r?vL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,pg=(r,e)=>{for(var t in e||(e={}))mL.call(e,t)&&dg(r,t,e[t]);if(lg)for(var t of lg(e))yL.call(e,t)&&dg(r,t,e[t]);return r};let wL=class ry extends M6{constructor(e){var t;super(e),this.protocol=Bm,this.version=Km,this.name=Nh,this.events=new Os.EventEmitter,this.initialized=!1,this.on=(u,f)=>this.events.on(u,f),this.once=(u,f)=>this.events.once(u,f),this.off=(u,f)=>this.events.off(u,f),this.removeListener=(u,f)=>this.events.removeListener(u,f),this.dispatchEnvelope=({topic:u,message:f,sessionExists:d})=>{if(!u||!f)return;const l={topic:u,message:f,publishedAt:Date.now(),transportType:Yt.link_mode};this.relayer.onLinkMessageEvent(l,{sessionExists:d})},this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Hm,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const n=dc({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:TP.logger,name:Nh}),{logger:i,chunkLoggerController:a}=x6({opts:n,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=a,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var u,f;(u=this.logChunkController)!=null&&u.downloadLogsBlobInBrowser&&((f=this.logChunkController)==null||f.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=zr(i,this.name),this.heartbeat=new d3,this.crypto=new qM(this,this.logger,e==null?void 0:e.keychain),this.history=new uL(this,this.logger),this.expirer=new cL(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new J3(pg(pg({},$P),e==null?void 0:e.storageOptions)),this.relayer=new nL({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new aL(this,this.logger),this.verify=new fL(this,this.logger,this.storage),this.echoClient=new hL(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new gL(this,this.logger,e==null?void 0:e.telemetryEnabled)}static async init(e){const t=new ry(e);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(JP,n),t}get context(){return Zr(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(k0,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(k0)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}};const _L=wL;var hl={exports:{}},lo=typeof Reflect=="object"?Reflect:null,gg=lo&&typeof lo.apply=="function"?lo.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Ku;lo&&typeof lo.ownKeys=="function"?Ku=lo.ownKeys:Object.getOwnPropertySymbols?Ku=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ku=function(e){return Object.getOwnPropertyNames(e)};function bL(r){console&&console.warn&&console.warn(r)}var ny=Number.isNaN||function(e){return e!==e};function Kt(){Kt.init.call(this)}hl.exports=Kt;hl.exports.once=IL;Kt.EventEmitter=Kt;Kt.prototype._events=void 0;Kt.prototype._eventsCount=0;Kt.prototype._maxListeners=void 0;var vg=10;function Dc(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Kt,"defaultMaxListeners",{enumerable:!0,get:function(){return vg},set:function(r){if(typeof r!="number"||r<0||ny(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");vg=r}});Kt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Kt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ny(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function iy(r){return r._maxListeners===void 0?Kt.defaultMaxListeners:r._maxListeners}Kt.prototype.getMaxListeners=function(){return iy(this)};Kt.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var f=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw f.context=u,f}var d=a[e];if(d===void 0)return!1;if(typeof d=="function")gg(d,this,t);else for(var l=d.length,w=cy(d,l),n=0;n<l;++n)gg(w[n],this,t);return!0};function sy(r,e,t,n){var i,a,u;if(Dc(t),a=r._events,a===void 0?(a=r._events=Object.create(null),r._eventsCount=0):(a.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),u=a[e]),u===void 0)u=a[e]=t,++r._eventsCount;else if(typeof u=="function"?u=a[e]=n?[t,u]:[u,t]:n?u.unshift(t):u.push(t),i=iy(r),i>0&&u.length>i&&!u.warned){u.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=r,f.type=e,f.count=u.length,bL(f)}return r}Kt.prototype.addListener=function(e,t){return sy(this,e,t,!1)};Kt.prototype.on=Kt.prototype.addListener;Kt.prototype.prependListener=function(e,t){return sy(this,e,t,!0)};function EL(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function oy(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=EL.bind(n);return i.listener=t,n.wrapFn=i,i}Kt.prototype.once=function(e,t){return Dc(t),this.on(e,oy(this,e,t)),this};Kt.prototype.prependOnceListener=function(e,t){return Dc(t),this.prependListener(e,oy(this,e,t)),this};Kt.prototype.removeListener=function(e,t){var n,i,a,u,f;if(Dc(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(a=-1,u=n.length-1;u>=0;u--)if(n[u]===t||n[u].listener===t){f=n[u].listener,a=u;break}if(a<0)return this;a===0?n.shift():xL(n,a),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,f||t)}return this};Kt.prototype.off=Kt.prototype.removeListener;Kt.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),u;for(i=0;i<a.length;++i)u=a[i],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function ay(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?SL(i):cy(i,i.length)}Kt.prototype.listeners=function(e){return ay(this,e,!0)};Kt.prototype.rawListeners=function(e){return ay(this,e,!1)};Kt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):uy.call(r,e)};Kt.prototype.listenerCount=uy;function uy(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Kt.prototype.eventNames=function(){return this._eventsCount>0?Ku(this._events):[]};function cy(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function xL(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function SL(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function IL(r,e){return new Promise(function(t,n){function i(u){r.removeListener(e,a),n(u)}function a(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}fy(r,e,a,{once:!0}),e!=="error"&&AL(r,i,{once:!0})})}function AL(r,e,t){typeof r.on=="function"&&fy(r,"error",e,t)}function fy(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(a){n.once&&r.removeEventListener(e,i),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var hy=hl.exports;const OL=As(hy),ly="wc",dy=2,py="client",ll=`${ly}@${dy}:${py}:`,uh={name:py,logger:"error"},mg="WALLETCONNECT_DEEPLINK_CHOICE",PL="proposal",gy="Proposal expired",DL="session",eo=ge.SEVEN_DAYS,ML="engine",_r={wc_sessionPropose:{req:{ttl:ge.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ge.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ge.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1114},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:ge.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:ge.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1119}}},ch={min:ge.FIVE_MINUTES,max:ge.SEVEN_DAYS},Qn={idle:"IDLE",active:"ACTIVE"},LL="request",CL=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],RL="wc",NL="auth",TL="authKeys",$L="pairingTopics",FL="requests",Mc=`${RL}@${1.5}:${NL}:`,zu=`${Mc}:PUB_KEY`;var UL=Object.defineProperty,qL=Object.defineProperties,jL=Object.getOwnPropertyDescriptors,yg=Object.getOwnPropertySymbols,BL=Object.prototype.hasOwnProperty,KL=Object.prototype.propertyIsEnumerable,wg=(r,e,t)=>e in r?UL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,sr=(r,e)=>{for(var t in e||(e={}))BL.call(e,t)&&wg(r,t,e[t]);if(yg)for(var t of yg(e))KL.call(e,t)&&wg(r,t,e[t]);return r},jn=(r,e)=>qL(r,jL(e));class zL extends K6{constructor(e){super(e),this.name=ML,this.events=new OL,this.initialized=!1,this.requestQueue={state:Qn.idle,queue:[]},this.sessionRequestQueue={state:Qn.idle,queue:[]},this.requestQueueDelay=ge.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.relayMessageCache=[],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(_r)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ge.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=jn(sr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:i,requiredNamespaces:a,optionalNamespaces:u,sessionProperties:f,relays:d}=n;let l=i,w,b=!1;try{if(l){const W=this.client.core.pairing.pairings.get(l);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),b=W.active}}catch(W){throw this.client.logger.error(`connect() -> pairing.get(${l}) failed`),W}if(!l||!b){const{topic:W,uri:Z}=await this.client.core.pairing.create();l=W,w=Z}if(!l){const{message:W}=me("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(W)}const S=await this.client.core.crypto.generateKeyPair(),I=_r.wc_sessionPropose.req.ttl||ge.FIVE_MINUTES,M=vr(I),z=sr({requiredNamespaces:a,optionalNamespaces:u,relays:d??[{protocol:zm}],proposer:{publicKey:S,metadata:this.client.metadata},expiryTimestamp:M,pairingTopic:l},f&&{sessionProperties:f}),{reject:k,resolve:Y,done:te}=ys(I,gy);this.events.once(pt("session_connect"),async({error:W,session:Z})=>{if(W)k(W);else if(Z){Z.self.publicKey=S;const V=jn(sr({},Z),{pairingTopic:z.pairingTopic,requiredNamespaces:z.requiredNamespaces,optionalNamespaces:z.optionalNamespaces,transportType:Yt.relay});await this.client.session.set(Z.topic,V),await this.setExpiry(Z.topic,Z.expiry),l&&await this.client.core.pairing.updateMetadata({topic:l,metadata:Z.peer.metadata}),this.cleanupDuplicatePairings(V),Y(V)}});const ie=await this.sendRequest({topic:l,method:"wc_sessionPropose",params:z,throwOnFailedPublish:!0});return await this.setProposal(ie,sr({id:ie},z)),{uri:w,approval:te}},this.pair=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(n){throw this.client.logger.error("pair() failed"),n}},this.approve=async t=>{var n,i,a;const u=this.client.core.eventClient.createEvent({properties:{topic:(n=t==null?void 0:t.id)==null?void 0:n.toString(),trace:[qn.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(B){throw u.setError(vs.no_internet_connection),B}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(B){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),u.setError(vs.proposal_not_found),B}try{await this.isValidApprove(t)}catch(B){throw this.client.logger.error("approve() -> isValidApprove() failed"),u.setError(vs.session_approve_namespace_validation_failure),B}const{id:f,relayProtocol:d,namespaces:l,sessionProperties:w,sessionConfig:b}=t,S=this.client.proposal.get(f);this.client.core.eventClient.deleteEvent({eventId:u.eventId});const{pairingTopic:I,proposer:M,requiredNamespaces:z,optionalNamespaces:k}=S;let Y=(i=this.client.core.eventClient)==null?void 0:i.getEvent({topic:I});Y||(Y=(a=this.client.core.eventClient)==null?void 0:a.createEvent({type:qn.session_approve_started,properties:{topic:I,trace:[qn.session_approve_started,qn.session_namespaces_validation_success]}}));const te=await this.client.core.crypto.generateKeyPair(),ie=M.publicKey,W=await this.client.core.crypto.generateSharedKey(te,ie),Z=sr(sr({relay:{protocol:d??"irn"},namespaces:l,controller:{publicKey:te,metadata:this.client.metadata},expiry:vr(eo)},w&&{sessionProperties:w}),b&&{sessionConfig:b}),V=Yt.relay;Y.addTrace(qn.subscribing_session_topic);try{await this.client.core.relayer.subscribe(W,{transportType:V})}catch(B){throw Y.setError(vs.subscribe_session_topic_failure),B}Y.addTrace(qn.subscribe_session_topic_success);const y=jn(sr({},Z),{topic:W,requiredNamespaces:z,optionalNamespaces:k,pairingTopic:I,acknowledged:!1,self:Z.controller,peer:{publicKey:M.publicKey,metadata:M.metadata},controller:te,transportType:Yt.relay});await this.client.session.set(W,y),Y.addTrace(qn.store_session);try{Y.addTrace(qn.publishing_session_settle),await this.sendRequest({topic:W,method:"wc_sessionSettle",params:Z,throwOnFailedPublish:!0}).catch(B=>{throw Y==null||Y.setError(vs.session_settle_publish_failure),B}),Y.addTrace(qn.session_settle_publish_success),Y.addTrace(qn.publishing_session_approve),await this.sendResult({id:f,topic:I,result:{relay:{protocol:d??"irn"},responderPublicKey:te},throwOnFailedPublish:!0}).catch(B=>{throw Y==null||Y.setError(vs.session_approve_publish_failure),B}),Y.addTrace(qn.session_approve_publish_success)}catch(B){throw this.client.logger.error(B),this.client.session.delete(W,Ct("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(W),B}return this.client.core.eventClient.deleteEvent({eventId:Y.eventId}),await this.client.core.pairing.updateMetadata({topic:I,metadata:M.metadata}),await this.client.proposal.delete(f,Ct("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:I}),await this.setExpiry(W,vr(eo)),{topic:W,acknowledged:()=>Promise.resolve(this.client.session.get(W))}},this.reject=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(u){throw this.client.logger.error("reject() -> isValidReject() failed"),u}const{id:n,reason:i}=t;let a;try{a=this.client.proposal.get(n).pairingTopic}catch(u){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),u}a&&(await this.sendError({id:n,topic:a,error:i,rpcOpts:_r.wc_sessionPropose.reject}),await this.client.proposal.delete(n,Ct("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(b){throw this.client.logger.error("update() -> isValidUpdate() failed"),b}const{topic:n,namespaces:i}=t,{done:a,resolve:u,reject:f}=ys(),d=wi(),l=Es().toString(),w=this.client.session.get(n).namespaces;return this.events.once(pt("session_update",d),({error:b})=>{b?f(b):u()}),await this.client.session.update(n,{namespaces:i}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:i},throwOnFailedPublish:!0,clientRpcId:d,relayRpcId:l}).catch(b=>{this.client.logger.error(b),this.client.session.update(n,{namespaces:w}),f(b)}),{acknowledged:a}},this.extend=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(d){throw this.client.logger.error("extend() -> isValidExtend() failed"),d}const{topic:n}=t,i=wi(),{done:a,resolve:u,reject:f}=ys();return this.events.once(pt("session_extend",i),({error:d})=>{d?f(d):u()}),await this.setExpiry(n,vr(eo)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:i,throwOnFailedPublish:!0}).catch(d=>{f(d)}),{acknowledged:a}},this.request=async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(M){throw this.client.logger.error("request() -> isValidRequest() failed"),M}const{chainId:n,request:i,topic:a,expiry:u=_r.wc_sessionRequest.req.ttl}=t,f=this.client.session.get(a);(f==null?void 0:f.transportType)===Yt.relay&&await this.confirmOnlineStateOrThrow();const d=wi(),l=Es().toString(),{done:w,resolve:b,reject:S}=ys(u,"Request expired. Please try again.");this.events.once(pt("session_request",d),({error:M,result:z})=>{M?S(M):b(z)});const I=this.getAppLinkIfEnabled(f.peer.metadata,f.transportType);return I?(await this.sendRequest({clientRpcId:d,relayRpcId:l,topic:a,method:"wc_sessionRequest",params:{request:jn(sr({},i),{expiryTimestamp:vr(u)}),chainId:n},expiry:u,throwOnFailedPublish:!0,appLink:I}).catch(M=>S(M)),this.client.events.emit("session_request_sent",{topic:a,request:i,chainId:n,id:d}),await w()):await Promise.all([new Promise(async M=>{await this.sendRequest({clientRpcId:d,relayRpcId:l,topic:a,method:"wc_sessionRequest",params:{request:jn(sr({},i),{expiryTimestamp:vr(u)}),chainId:n},expiry:u,throwOnFailedPublish:!0}).catch(z=>S(z)),this.client.events.emit("session_request_sent",{topic:a,request:i,chainId:n,id:d}),M()}),new Promise(async M=>{var z;if(!((z=f.sessionConfig)!=null&&z.disableDeepLink)){const k=await o5(this.client.core.storage,mg);await n5({id:d,topic:a,wcDeepLink:k})}M()}),w()]).then(M=>M[2])},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:i}=t,{id:a}=i,u=this.client.session.get(n);u.transportType===Yt.relay&&await this.confirmOnlineStateOrThrow();const f=this.getAppLinkIfEnabled(u.peer.metadata,u.transportType);ti(i)?await this.sendResult({id:a,topic:n,result:i.result,throwOnFailedPublish:!0,appLink:f}):An(i)&&await this.sendError({id:a,topic:n,error:i.error,appLink:f}),this.cleanupAfterResponse(t)},this.ping=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(i){throw this.client.logger.error("ping() -> isValidPing() failed"),i}const{topic:n}=t;if(this.client.session.keys.includes(n)){const i=wi(),a=Es().toString(),{done:u,resolve:f,reject:d}=ys();this.events.once(pt("session_ping",i),({error:l})=>{l?d(l):f()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:i,relayRpcId:a}),u()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))},this.emit=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:n,event:i,chainId:a}=t,u=Es().toString(),f=wi();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:i,chainId:a},throwOnFailedPublish:!0,relayRpcId:u,clientRpcId:f})},this.disconnect=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:n}=t;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Ct("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:i}=me("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(i)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(n=>rO(n,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async(t,n)=>{var i;this.isInitialized(),this.isValidAuthenticate(t);const a=n&&this.client.core.linkModeSupportedApps.includes(n)&&((i=this.client.metadata.redirect)==null?void 0:i.linkMode),u=a?Yt.link_mode:Yt.relay;u===Yt.relay&&await this.confirmOnlineStateOrThrow();const{chains:f,statement:d="",uri:l,domain:w,nonce:b,type:S,exp:I,nbf:M,methods:z=[],expiry:k}=t,Y=[...t.resources||[]],{topic:te,uri:ie}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:u});this.client.logger.info({message:"Generated new pairing",pairing:{topic:te,uri:ie}});const W=await this.client.core.crypto.generateKeyPair(),Z=qu(W);if(await Promise.all([this.client.auth.authKeys.set(zu,{responseTopic:Z,publicKey:W}),this.client.auth.pairingTopics.set(Z,{topic:Z,pairingTopic:te})]),await this.client.core.relayer.subscribe(Z,{transportType:u}),this.client.logger.info(`sending request to new pairing topic: ${te}`),z.length>0){const{namespace:A}=co(f[0]);let R=D5(A,"request",z);Uu(Y)&&(R=L5(R,Y.pop())),Y.push(R)}const V=k&&k>_r.wc_sessionAuthenticate.req.ttl?k:_r.wc_sessionAuthenticate.req.ttl,y={authPayload:{type:S??"caip122",chains:f,statement:d,aud:l,domain:w,version:"1",nonce:b,iat:new Date().toISOString(),exp:I,nbf:M,resources:Y},requester:{publicKey:W,metadata:this.client.metadata},expiryTimestamp:vr(V)},B={eip155:{chains:f,methods:[...new Set(["personal_sign",...z])],events:["chainChanged","accountsChanged"]}},he={requiredNamespaces:{},optionalNamespaces:B,relays:[{protocol:"irn"}],pairingTopic:te,proposer:{publicKey:W,metadata:this.client.metadata},expiryTimestamp:vr(_r.wc_sessionPropose.req.ttl)},{done:de,resolve:pe,reject:Ee}=ys(V,"Request expired"),$=async({error:A,session:R})=>{if(this.events.off(pt("session_request",v),h),A)Ee(A);else if(R){R.self.publicKey=W,await this.client.session.set(R.topic,R),await this.setExpiry(R.topic,R.expiry),te&&await this.client.core.pairing.updateMetadata({topic:te,metadata:R.peer.metadata});const j=this.client.session.get(R.topic);await this.deleteProposal(x),pe({session:j})}},h=async A=>{var R,j,O;if(await this.deletePendingAuthRequest(v,{message:"fulfilled",code:0}),A.error){const T=Ct("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return A.error.code===T.code?void 0:(this.events.off(pt("session_connect"),$),Ee(A.error.message))}await this.deleteProposal(x),this.events.off(pt("session_connect"),$);const{cacaos:m,responder:L}=A.result,ce=[],_=[];for(const T of m){await y0({cacao:T,projectId:this.client.core.projectId})||(this.client.logger.error(T,"Signature verification failed"),Ee(Ct("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:F}=T,g=Uu(F.resources),N=[Dh(F.iss)],ee=nc(F.iss);if(g){const le=w0(g),se=_0(g);ce.push(...le),N.push(...se)}for(const le of N)_.push(`${le}:${ee}`)}const G=await this.client.core.crypto.generateSharedKey(W,L.publicKey);let U;ce.length>0&&(U={topic:G,acknowledged:!0,self:{publicKey:W,metadata:this.client.metadata},peer:L,controller:L.publicKey,expiry:vr(eo),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:te,namespaces:A0([...new Set(ce)],[...new Set(_)]),transportType:u},await this.client.core.relayer.subscribe(G,{transportType:u}),await this.client.session.set(G,U),te&&await this.client.core.pairing.updateMetadata({topic:te,metadata:L.metadata}),U=this.client.session.get(G)),(R=this.client.metadata.redirect)!=null&&R.linkMode&&(j=L.metadata.redirect)!=null&&j.linkMode&&(O=L.metadata.redirect)!=null&&O.universal&&n&&(this.client.core.addLinkModeSupportedApp(L.metadata.redirect.universal),this.client.session.update(G,{transportType:Yt.link_mode})),pe({auths:m,session:U})},v=wi(),x=wi();this.events.once(pt("session_connect"),$),this.events.once(pt("session_request",v),h);let P;try{if(a){const A=Ki("wc_sessionAuthenticate",y,v);this.client.core.history.set(te,A);const R=await this.client.core.crypto.encode("",A,{type:ya,encoding:zo});P=Su(n,te,R)}else await Promise.all([this.sendRequest({topic:te,method:"wc_sessionAuthenticate",params:y,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:v}),this.sendRequest({topic:te,method:"wc_sessionPropose",params:he,expiry:_r.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:x})])}catch(A){throw this.events.off(pt("session_connect"),$),this.events.off(pt("session_request",v),h),A}return await this.setProposal(x,sr({id:x},he)),await this.setAuthRequest(v,{request:jn(sr({},y),{verifyContext:{}}),pairingTopic:te,transportType:u}),{uri:P??ie,response:de}},this.approveSessionAuthenticate=async t=>{const{id:n,auths:i}=t,a=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[ms.authenticated_session_approve_started]}});try{this.isInitialized()}catch(k){throw a.setError(Wo.no_internet_connection),k}const u=this.getPendingAuthRequest(n);if(!u)throw a.setError(Wo.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const f=u.transportType||Yt.relay;f===Yt.relay&&await this.confirmOnlineStateOrThrow();const d=u.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),w=qu(d),b={type:bi,receiverPublicKey:d,senderPublicKey:l},S=[],I=[];for(const k of i){if(!await y0({cacao:k,projectId:this.client.core.projectId})){a.setError(Wo.invalid_cacao);const Z=Ct("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:w,error:Z,encodeOpts:b}),new Error(Z.message)}a.addTrace(ms.cacaos_verified);const{p:Y}=k,te=Uu(Y.resources),ie=[Dh(Y.iss)],W=nc(Y.iss);if(te){const Z=w0(te),V=_0(te);S.push(...Z),ie.push(...V)}for(const Z of ie)I.push(`${Z}:${W}`)}const M=await this.client.core.crypto.generateSharedKey(l,d);a.addTrace(ms.create_authenticated_session_topic);let z;if((S==null?void 0:S.length)>0){z={topic:M,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:d,metadata:u.requester.metadata},controller:d,expiry:vr(eo),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:u.pairingTopic,namespaces:A0([...new Set(S)],[...new Set(I)]),transportType:f},a.addTrace(ms.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(M,{transportType:f})}catch(k){throw a.setError(Wo.subscribe_authenticated_session_topic_failure),k}a.addTrace(ms.subscribe_authenticated_session_topic_success),await this.client.session.set(M,z),a.addTrace(ms.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:u.pairingTopic,metadata:u.requester.metadata})}a.addTrace(ms.publishing_authenticated_session_approve);try{await this.sendResult({topic:w,id:n,result:{cacaos:i,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:b,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(u.requester.metadata,f)})}catch(k){throw a.setError(Wo.authenticated_session_approve_publish_failure),k}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:u.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:a.eventId}),{session:z}},this.rejectSessionAuthenticate=async t=>{this.isInitialized();const{id:n,reason:i}=t,a=this.getPendingAuthRequest(n);if(!a)throw new Error(`Could not find pending auth request with id ${n}`);a.transportType===Yt.relay&&await this.confirmOnlineStateOrThrow();const u=a.requester.publicKey,f=await this.client.core.crypto.generateKeyPair(),d=qu(u),l={type:bi,receiverPublicKey:u,senderPublicKey:f};await this.sendError({id:n,topic:d,error:i,encodeOpts:l,rpcOpts:_r.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(a.requester.metadata,a.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.client.proposal.delete(n,Ct("USER_DISCONNECTED"))},this.formatAuthMessage=t=>{this.isInitialized();const{request:n,iss:i}=t;return cm(n,i)},this.processRelayMessageCache=()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)},this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),i=this.client.core.pairing.pairings.getAll().filter(a=>{var u,f;return((u=a.peerMetadata)==null?void 0:u.url)&&((f=a.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&a.topic&&a.topic!==n.topic});if(i.length===0)return;this.client.logger.info(`Cleaning up ${i.length} duplicate pairing(s)`),await Promise.all(i.map(a=>this.client.core.pairing.disconnect({topic:a.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async t=>{var n;const{topic:i,expirerHasDeleted:a=!1,emitEvent:u=!0,id:f=0}=t,{self:d}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),await this.client.session.delete(i,Ct("USER_DISCONNECTED")),this.addToRecentlyDeleted(i,"session"),this.client.core.crypto.keychain.has(d.publicKey)&&await this.client.core.crypto.deleteKeyPair(d.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),a||this.client.core.expirer.del(i),this.client.core.storage.removeItem(mg).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===i&&this.deletePendingSessionRequest(l.id,Ct("USER_DISCONNECTED"))}),i===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=Qn.idle),u&&this.client.events.emit("session_delete",{id:f,topic:i})},this.deleteProposal=async(t,n)=>{if(n)try{const i=this.client.proposal.get(t),a=this.client.core.eventClient.getEvent({topic:i.pairingTopic});a==null||a.setError(vs.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,Ct("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")},this.deletePendingSessionRequest=async(t,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),i?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(a=>a.id!==t),i&&(this.sessionRequestQueue.state=Qn.idle,this.client.events.emit("session_request_expire",{id:t}))},this.deletePendingAuthRequest=async(t,n,i=!1)=>{await Promise.all([this.client.auth.requests.delete(t,n),i?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,n)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,n),await this.client.session.update(t,{expiry:n}))},this.setProposal=async(t,n)=>{this.client.core.expirer.set(t,vr(_r.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,n)},this.setAuthRequest=async(t,n)=>{const{request:i,pairingTopic:a,transportType:u=Yt.relay}=n;this.client.core.expirer.set(t,i.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:i.authPayload,requester:i.requester,expiryTimestamp:i.expiryTimestamp,id:t,pairingTopic:a,verifyContext:i.verifyContext,transportType:u})},this.setPendingSessionRequest=async t=>{const{id:n,topic:i,params:a,verifyContext:u}=t,f=a.request.expiryTimestamp||vr(_r.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,f),await this.client.pendingRequest.set(n,{id:n,topic:i,params:a,verifyContext:u})},this.sendRequest=async t=>{const{topic:n,method:i,params:a,expiry:u,relayRpcId:f,clientRpcId:d,throwOnFailedPublish:l,appLink:w}=t,b=Ki(i,a,d);let S;const I=!!w;try{const k=I?zo:Bi;S=await this.client.core.crypto.encode(n,b,{encoding:k})}catch(k){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),k}let M;if(CL.includes(i)){const k=_i(JSON.stringify(b)),Y=_i(S);M=await this.client.core.verify.register({id:Y,decryptedId:k})}const z=_r[i].req;if(z.attestation=M,u&&(z.ttl=u),f&&(z.id=f),this.client.core.history.set(n,b),I){const k=Su(w,n,S);await Je.Linking.openURL(k,this.client.name)}else{const k=_r[i].req;u&&(k.ttl=u),f&&(k.id=f),l?(k.internal=jn(sr({},k.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,S,k)):this.client.core.relayer.publish(n,S,k).catch(Y=>this.client.logger.error(Y))}return b.id},this.sendResult=async t=>{const{id:n,topic:i,result:a,throwOnFailedPublish:u,encodeOpts:f,appLink:d}=t,l=Sc(n,a);let w;const b=d&&typeof(Je==null?void 0:Je.Linking)<"u";try{const I=b?zo:Bi;w=await this.client.core.crypto.encode(i,l,jn(sr({},f||{}),{encoding:I}))}catch(I){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${i} failed`),I}let S;try{S=await this.client.core.history.get(i,n)}catch(I){throw this.client.logger.error(`sendResult() -> history.get(${i}, ${n}) failed`),I}if(b){const I=Su(d,i,w);await Je.Linking.openURL(I,this.client.name)}else{const I=_r[S.request.method].res;u?(I.internal=jn(sr({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,w,I)):this.client.core.relayer.publish(i,w,I).catch(M=>this.client.logger.error(M))}await this.client.core.history.resolve(l)},this.sendError=async t=>{const{id:n,topic:i,error:a,encodeOpts:u,rpcOpts:f,appLink:d}=t,l=Ic(n,a);let w;const b=d&&typeof(Je==null?void 0:Je.Linking)<"u";try{const I=b?zo:Bi;w=await this.client.core.crypto.encode(i,l,jn(sr({},u||{}),{encoding:I}))}catch(I){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${i} failed`),I}let S;try{S=await this.client.core.history.get(i,n)}catch(I){throw this.client.logger.error(`sendError() -> history.get(${i}, ${n}) failed`),I}if(b){const I=Su(d,i,w);await Je.Linking.openURL(I,this.client.name)}else{const I=f||_r[S.request.method].res;this.client.core.relayer.publish(i,w,I)}await this.client.core.history.resolve(l)},this.cleanup=async()=>{const t=[],n=[];this.client.session.getAll().forEach(i=>{let a=!1;qi(i.expiry)&&(a=!0),this.client.core.crypto.keychain.has(i.topic)||(a=!0),a&&t.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{qi(i.expiryTimestamp)&&n.push(i.id)}),await Promise.all([...t.map(i=>this.deleteSession({topic:i})),...n.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Qn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Qn.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=Qn.idle},this.processRequest=async t=>{const{topic:n,payload:i,attestation:a,transportType:u,encryptedId:f}=t,d=i.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:d}))switch(d){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:i,attestation:a,encryptedId:f});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,i);case"wc_sessionPing":return await this.onSessionPingRequest(n,i);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:i,attestation:a,encryptedId:f,transportType:u});case"wc_sessionEvent":return await this.onSessionEventRequest(n,i);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:i,attestation:a,encryptedId:f,transportType:u});default:return this.client.logger.info(`Unsupported request method ${d}`)}},this.onRelayEventResponse=async t=>{const{topic:n,payload:i,transportType:a}=t,u=(await this.client.core.history.get(n,i.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i,a);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:n}=t,{message:i}=me("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(i)},this.shouldIgnorePairingRequest=t=>{const{topic:n,requestMethod:i}=t,a=this.expectedPairingMethodMap.get(n);return!a||a.includes(i)?!1:!!(a.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async t=>{const{topic:n,payload:i,attestation:a,encryptedId:u}=t,{params:f,id:d}=i;try{const l=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(yi.proposal_listener_not_found)),this.isValidConnect(sr({},i.params));const w=f.expiryTimestamp||vr(_r.wc_sessionPropose.req.ttl),b=sr({id:d,pairingTopic:n,expiryTimestamp:w},f);await this.setProposal(d,b);const S=await this.getVerifyContext({attestationId:a,hash:_i(JSON.stringify(i)),encryptedId:u,metadata:b.proposer.metadata});l==null||l.addTrace(ei.emit_session_proposal),this.client.events.emit("session_proposal",{id:d,params:b,verifyContext:S})}catch(l){await this.sendError({id:d,topic:n,error:l,rpcOpts:_r.wc_sessionPropose.autoReject}),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,n,i)=>{const{id:a}=n;if(ti(n)){const{result:u}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const f=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const d=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const l=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const w=await this.client.core.crypto.generateSharedKey(d,l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:w});const b=await this.client.core.relayer.subscribe(w,{transportType:i});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:b}),await this.client.core.pairing.activate({topic:t})}else if(An(n)){await this.client.proposal.delete(a,Ct("USER_DISCONNECTED"));const u=pt("session_connect");if(this.events.listenerCount(u)===0)throw new Error(`emitting ${u} without any listeners, 954`);this.events.emit(pt("session_connect"),{error:n.error})}},this.onSessionSettleRequest=async(t,n)=>{const{id:i,params:a}=n;try{this.isValidSessionSettleRequest(a);const{relay:u,controller:f,expiry:d,namespaces:l,sessionProperties:w,sessionConfig:b}=n.params,S=jn(sr(sr({topic:t,relay:u,expiry:d,namespaces:l,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},w&&{sessionProperties:w}),b&&{sessionConfig:b}),{transportType:Yt.relay}),I=pt("session_connect");if(this.events.listenerCount(I)===0)throw new Error(`emitting ${I} without any listeners 997`);this.events.emit(pt("session_connect"),{session:S}),await this.sendResult({id:n.id,topic:t,result:!0,throwOnFailedPublish:!0})}catch(u){await this.sendError({id:i,topic:t,error:u}),this.client.logger.error(u)}},this.onSessionSettleResponse=async(t,n)=>{const{id:i}=n;ti(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(pt("session_approve",i),{})):An(n)&&(await this.client.session.delete(t,Ct("USER_DISCONNECTED")),this.events.emit(pt("session_approve",i),{error:n.error}))},this.onSessionUpdateRequest=async(t,n)=>{const{params:i,id:a}=n;try{const u=`${t}_session_update`,f=Ho.get(u);if(f&&this.isRequestOutOfSync(f,a)){this.client.logger.warn(`Discarding out of sync request - ${a}`),this.sendError({id:a,topic:t,error:Ct("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(sr({topic:t},i));try{Ho.set(u,a),await this.client.session.update(t,{namespaces:i.namespaces}),await this.sendResult({id:a,topic:t,result:!0,throwOnFailedPublish:!0})}catch(d){throw Ho.delete(u),d}this.client.events.emit("session_update",{id:a,topic:t,params:i})}catch(u){await this.sendError({id:a,topic:t,error:u}),this.client.logger.error(u)}},this.isRequestOutOfSync=(t,n)=>n.toString().slice(0,-3)<t.toString().slice(0,-3),this.onSessionUpdateResponse=(t,n)=>{const{id:i}=n,a=pt("session_update",i);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);ti(n)?this.events.emit(pt("session_update",i),{}):An(n)&&this.events.emit(pt("session_update",i),{error:n.error})},this.onSessionExtendRequest=async(t,n)=>{const{id:i}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,vr(eo)),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:i,topic:t})}catch(a){await this.sendError({id:i,topic:t,error:a}),this.client.logger.error(a)}},this.onSessionExtendResponse=(t,n)=>{const{id:i}=n,a=pt("session_extend",i);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);ti(n)?this.events.emit(pt("session_extend",i),{}):An(n)&&this.events.emit(pt("session_extend",i),{error:n.error})},this.onSessionPingRequest=async(t,n)=>{const{id:i}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:i,topic:t})}catch(a){await this.sendError({id:i,topic:t,error:a}),this.client.logger.error(a)}},this.onSessionPingResponse=(t,n)=>{const{id:i}=n,a=pt("session_ping",i);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);setTimeout(()=>{ti(n)?this.events.emit(pt("session_ping",i),{}):An(n)&&this.events.emit(pt("session_ping",i),{error:n.error})},500)},this.onSessionDeleteRequest=async(t,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),Promise.all([new Promise(a=>{this.client.core.relayer.once(Er.publish,async()=>{a(await this.deleteSession({topic:t,id:i}))})}),this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:Ct("USER_DISCONNECTED")})]).catch(a=>this.client.logger.error(a))}catch(a){this.client.logger.error(a)}},this.onSessionRequest=async t=>{var n,i,a;const{topic:u,payload:f,attestation:d,encryptedId:l,transportType:w}=t,{id:b,params:S}=f;try{await this.isValidRequest(sr({topic:u},S));const I=this.client.session.get(u),M=await this.getVerifyContext({attestationId:d,hash:_i(JSON.stringify(Ki("wc_sessionRequest",S,b))),encryptedId:l,metadata:I.peer.metadata,transportType:w}),z={id:b,topic:u,params:S,verifyContext:M};await this.setPendingSessionRequest(z),w===Yt.link_mode&&(n=I.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((i=I.peer.metadata.redirect)==null?void 0:i.universal),(a=this.client.signConfig)!=null&&a.disableRequestQueue?this.emitSessionRequest(z):(this.addSessionRequestToSessionRequestQueue(z),this.processSessionRequestQueue())}catch(I){await this.sendError({id:b,topic:u,error:I}),this.client.logger.error(I)}},this.onSessionRequestResponse=(t,n)=>{const{id:i}=n,a=pt("session_request",i);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);ti(n)?this.events.emit(pt("session_request",i),{result:n.result}):An(n)&&this.events.emit(pt("session_request",i),{error:n.error})},this.onSessionEventRequest=async(t,n)=>{const{id:i,params:a}=n;try{const u=`${t}_session_event_${a.event.name}`,f=Ho.get(u);if(f&&this.isRequestOutOfSync(f,i)){this.client.logger.info(`Discarding out of sync request - ${i}`);return}this.isValidEmit(sr({topic:t},a)),this.client.events.emit("session_event",{id:i,topic:t,params:a}),Ho.set(u,i)}catch(u){await this.sendError({id:i,topic:t,error:u}),this.client.logger.error(u)}},this.onSessionAuthenticateResponse=(t,n)=>{const{id:i}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:n}),ti(n)?this.events.emit(pt("session_request",i),{result:n.result}):An(n)&&this.events.emit(pt("session_request",i),{error:n.error})},this.onSessionAuthenticateRequest=async t=>{var n;const{topic:i,payload:a,attestation:u,encryptedId:f,transportType:d}=t;try{const{requester:l,authPayload:w,expiryTimestamp:b}=a.params,S=await this.getVerifyContext({attestationId:u,hash:_i(JSON.stringify(a)),encryptedId:f,metadata:l.metadata,transportType:d}),I={requester:l,pairingTopic:i,id:a.id,authPayload:w,verifyContext:S,expiryTimestamp:b};await this.setAuthRequest(a.id,{request:I,pairingTopic:i,transportType:d}),d===Yt.link_mode&&(n=l.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:i,params:a.params,id:a.id,verifyContext:S})}catch(l){this.client.logger.error(l);const w=a.params.requester.publicKey,b=await this.client.core.crypto.generateKeyPair(),S=this.getAppLinkIfEnabled(a.params.requester.metadata,d),I={type:bi,receiverPublicKey:w,senderPublicKey:b};await this.sendError({id:a.id,topic:i,error:l,encodeOpts:I,rpcOpts:_r.wc_sessionAuthenticate.autoReject,appLink:S})}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Qn.idle,this.processSessionRequestQueue()},ge.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:n})=>{const i=this.client.core.history.pending;i.length>0&&i.filter(a=>a.topic===t&&a.request.method==="wc_sessionRequest").forEach(a=>{const u=a.request.id,f=pt("session_request",u);if(this.events.listenerCount(f)===0)throw new Error(`emitting ${f} without any listeners`);this.events.emit(pt("session_request",a.request.id),{error:n})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Qn.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Qn.active,this.emitSessionRequest(t)}catch(n){this.client.logger.error(n)}},this.emitSessionRequest=t=>{this.client.events.emit("session_request",t)},this.onPairingCreated=t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const n=this.client.proposal.getAll().find(i=>i.pairingTopic===t.topic);n&&this.onSessionProposeRequest({topic:t.topic,payload:Ki("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id)})},this.isValidConnect=async t=>{if(!Yr(t)){const{message:d}=me("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(d)}const{pairingTopic:n,requiredNamespaces:i,optionalNamespaces:a,sessionProperties:u,relays:f}=t;if(Br(n)||await this.isValidPairingTopic(n),!pO(f)){const{message:d}=me("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(d)}!Br(i)&&oa(i)!==0&&this.validateNamespaces(i,"requiredNamespaces"),!Br(a)&&oa(a)!==0&&this.validateNamespaces(a,"optionalNamespaces"),Br(u)||this.validateSessionProps(u,"sessionProperties")},this.validateNamespaces=(t,n)=>{const i=dO(t,"connect()",n);if(i)throw new Error(i.message)},this.isValidApprove=async t=>{if(!Yr(t))throw new Error(me("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:i,relayProtocol:a,sessionProperties:u}=t;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const f=this.client.proposal.get(n),d=ih(i,"approve()");if(d)throw new Error(d.message);const l=D0(f.requiredNamespaces,i,"approve()");if(l)throw new Error(l.message);if(!fr(a,!0)){const{message:w}=me("MISSING_OR_INVALID",`approve() relayProtocol: ${a}`);throw new Error(w)}Br(u)||this.validateSessionProps(u,"sessionProperties")},this.isValidReject=async t=>{if(!Yr(t)){const{message:a}=me("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(a)}const{id:n,reason:i}=t;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!vO(i)){const{message:a}=me("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(a)}},this.isValidSessionSettleRequest=t=>{if(!Yr(t)){const{message:l}=me("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(l)}const{relay:n,controller:i,namespaces:a,expiry:u}=t;if(!mm(n)){const{message:l}=me("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const f=aO(i,"onSessionSettleRequest()");if(f)throw new Error(f.message);const d=ih(a,"onSessionSettleRequest()");if(d)throw new Error(d.message);if(qi(u)){const{message:l}=me("EXPIRED","onSessionSettleRequest()");throw new Error(l)}},this.isValidUpdate=async t=>{if(!Yr(t)){const{message:d}=me("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(d)}const{topic:n,namespaces:i}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const a=this.client.session.get(n),u=ih(i,"update()");if(u)throw new Error(u.message);const f=D0(a.requiredNamespaces,i,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!Yr(t)){const{message:i}=me("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(i)}const{topic:n}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)},this.isValidRequest=async t=>{if(!Yr(t)){const{message:d}=me("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(d)}const{topic:n,request:i,chainId:a,expiry:u}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:f}=this.client.session.get(n);if(!P0(f,a)){const{message:d}=me("MISSING_OR_INVALID",`request() chainId: ${a}`);throw new Error(d)}if(!mO(i)){const{message:d}=me("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(d)}if(!_O(f,a,i.method)){const{message:d}=me("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(d)}if(u&&!SO(u,ch)){const{message:d}=me("MISSING_OR_INVALID",`request() expiry: ${u}. Expiry must be a number (in seconds) between ${ch.min} and ${ch.max}`);throw new Error(d)}},this.isValidRespond=async t=>{var n;if(!Yr(t)){const{message:u}=me("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(u)}const{topic:i,response:a}=t;try{await this.isValidSessionTopic(i)}catch(u){throw(n=t==null?void 0:t.response)!=null&&n.id&&this.cleanupAfterResponse(t),u}if(!yO(a)){const{message:u}=me("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidPing=async t=>{if(!Yr(t)){const{message:i}=me("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(i)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async t=>{if(!Yr(t)){const{message:f}=me("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:n,event:i,chainId:a}=t;await this.isValidSessionTopic(n);const{namespaces:u}=this.client.session.get(n);if(!P0(u,a)){const{message:f}=me("MISSING_OR_INVALID",`emit() chainId: ${a}`);throw new Error(f)}if(!wO(i)){const{message:f}=me("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(f)}if(!bO(u,a,i.name)){const{message:f}=me("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!Yr(t)){const{message:i}=me("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(i)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.isValidAuthenticate=t=>{const{chains:n,uri:i,domain:a,nonce:u}=t;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!fr(i,!1))throw new Error("uri is required parameter");if(!fr(a,!1))throw new Error("domain is required parameter");if(!fr(u,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(d=>co(d).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:f}=co(n[0]);if(f!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async t=>{const{attestationId:n,hash:i,encryptedId:a,metadata:u,transportType:f}=t,d={verified:{verifyUrl:u.verifyUrl||ea,validation:"UNKNOWN",origin:u.url||""}};try{if(f===Yt.link_mode){const w=this.getAppLinkIfEnabled(u,f);return d.verified.validation=w&&new URL(w).origin===new URL(u.url).origin?"VALID":"INVALID",d}const l=await this.client.core.verify.resolve({attestationId:n,hash:i,encryptedId:a,verifyUrl:u.verifyUrl});l&&(d.verified.origin=l.origin,d.verified.isScam=l.isScam,d.verified.validation=l.origin===new URL(u.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(d)}`),d},this.validateSessionProps=(t,n)=>{Object.values(t).forEach(i=>{if(!fr(i,!1)){const{message:a}=me("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(i)}`);throw new Error(a)}})},this.getPendingAuthRequest=t=>{const n=this.client.auth.requests.get(t);return typeof n=="object"?n:void 0},this.addToRecentlyDeleted=(t,n)=>{if(this.recentlyDeletedMap.set(t,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let i=0;const a=this.recentlyDeletedLimit/2;for(const u of this.recentlyDeletedMap.keys()){if(i++>=a)break;this.recentlyDeletedMap.delete(u)}}},this.checkRecentlyDeleted=t=>{const n=this.recentlyDeletedMap.get(t);if(n){const{message:i}=me("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${t}`);throw new Error(i)}},this.isLinkModeEnabled=(t,n)=>{var i,a,u,f,d,l,w,b,S;return!t||n!==Yt.link_mode?!1:((a=(i=this.client.metadata)==null?void 0:i.redirect)==null?void 0:a.linkMode)===!0&&((f=(u=this.client.metadata)==null?void 0:u.redirect)==null?void 0:f.universal)!==void 0&&((l=(d=this.client.metadata)==null?void 0:d.redirect)==null?void 0:l.universal)!==""&&((w=t==null?void 0:t.redirect)==null?void 0:w.universal)!==void 0&&((b=t==null?void 0:t.redirect)==null?void 0:b.universal)!==""&&((S=t==null?void 0:t.redirect)==null?void 0:S.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(Je==null?void 0:Je.Linking)<"u"},this.getAppLinkIfEnabled=(t,n)=>{var i;return this.isLinkModeEnabled(t,n)?(i=t==null?void 0:t.redirect)==null?void 0:i.universal:void 0},this.handleLinkModeMessage=({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const n=p0(t,"topic")||"",i=decodeURIComponent(p0(t,"wc_ev")||""),a=this.client.session.keys.includes(n);a&&this.client.session.update(n,{transportType:Yt.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:i,sessionExists:a})},this.registerLinkModeListeners=async()=>{var t;if(rl()||Gi()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const n=Je==null?void 0:Je.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const i=await n.getInitialURL();i&&setTimeout(()=>{this.handleLinkModeMessage({url:i})},50)}}}}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Er.message,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){const{topic:t,message:n,attestation:i,transportType:a}=e,{publicKey:u}=this.client.auth.authKeys.keys.includes(zu)?this.client.auth.authKeys.get(zu):{publicKey:void 0},f=await this.client.core.crypto.decode(t,n,{receiverPublicKey:u,encoding:a===Yt.link_mode?zo:Bi});try{cl(f)?(this.client.core.history.set(t,f),this.onRelayEventRequest({topic:t,payload:f,attestation:i,transportType:a,encryptedId:_i(n)})):Ac(f)?(await this.client.core.history.resolve(f),await this.onRelayEventResponse({topic:t,payload:f,transportType:a}),this.client.core.history.delete(t,f.id)):this.onRelayEventUnknownPayload({topic:t,payload:f,transportType:a})}catch(d){this.client.logger.error(d)}}registerExpirerEvents(){this.client.core.expirer.on(In.expired,async e=>{const{topic:t,id:n}=am(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,me("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,me("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(_s.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(_s.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!fr(e,!1)){const{message:t}=me("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=me("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(qi(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=me("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!fr(e,!1)){const{message:t}=me("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=me("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(qi(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=me("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=me("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(fr(e,!1)){const{message:t}=me("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=me("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!gO(e)){const{message:t}=me("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=me("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(qi(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=me("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class HL extends Cs{constructor(e,t){super(e,t,PL,ll),this.core=e,this.logger=t}}let kL=class extends Cs{constructor(e,t){super(e,t,DL,ll),this.core=e,this.logger=t}};class WL extends Cs{constructor(e,t){super(e,t,LL,ll,n=>n.id),this.core=e,this.logger=t}}class GL extends Cs{constructor(e,t){super(e,t,TL,Mc,()=>zu),this.core=e,this.logger=t}}class VL extends Cs{constructor(e,t){super(e,t,$L,Mc),this.core=e,this.logger=t}}class JL extends Cs{constructor(e,t){super(e,t,FL,Mc,n=>n.id),this.core=e,this.logger=t}}class YL{constructor(e,t){this.core=e,this.logger=t,this.authKeys=new GL(this.core,this.logger),this.pairingTopics=new VL(this.core,this.logger),this.requests=new JL(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}class dl extends B6{constructor(e){super(e),this.protocol=ly,this.version=dy,this.name=uh.name,this.events=new hy.EventEmitter,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}},this.update=async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}},this.request=async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}},this.find=n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.authenticate=async(n,i)=>{try{return await this.engine.authenticate(n,i)}catch(a){throw this.logger.error(a.message),a}},this.formatAuthMessage=n=>{try{return this.engine.formatAuthMessage(n)}catch(i){throw this.logger.error(i.message),i}},this.approveSessionAuthenticate=async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(i){throw this.logger.error(i.message),i}},this.rejectSessionAuthenticate=async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(i){throw this.logger.error(i.message),i}},this.name=(e==null?void 0:e.name)||uh.name,this.metadata=(e==null?void 0:e.metadata)||rm(),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:ca(dc({level:(e==null?void 0:e.logger)||uh.logger}));this.core=(e==null?void 0:e.core)||new _L(e),this.logger=zr(t,this.name),this.session=new kL(this.core,this.logger),this.proposal=new HL(this.core,this.logger),this.pendingRequest=new WL(this.core,this.logger),this.engine=new zL(this),this.auth=new YL(this.core,this.logger)}static async init(e){const t=new dl(e);return await t.initialize(),t}get context(){return Zr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},ge.toMiliseconds(ge.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var pl={exports:{}},po=typeof Reflect=="object"?Reflect:null,_g=po&&typeof po.apply=="function"?po.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Hu;po&&typeof po.ownKeys=="function"?Hu=po.ownKeys:Object.getOwnPropertySymbols?Hu=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Hu=function(e){return Object.getOwnPropertyNames(e)};function XL(r){console&&console.warn&&console.warn(r)}var vy=Number.isNaN||function(e){return e!==e};function zt(){zt.init.call(this)}pl.exports=zt;pl.exports.once=tC;zt.EventEmitter=zt;zt.prototype._events=void 0;zt.prototype._eventsCount=0;zt.prototype._maxListeners=void 0;var bg=10;function Lc(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(zt,"defaultMaxListeners",{enumerable:!0,get:function(){return bg},set:function(r){if(typeof r!="number"||r<0||vy(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");bg=r}});zt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};zt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||vy(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function my(r){return r._maxListeners===void 0?zt.defaultMaxListeners:r._maxListeners}zt.prototype.getMaxListeners=function(){return my(this)};zt.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var f=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw f.context=u,f}var d=a[e];if(d===void 0)return!1;if(typeof d=="function")_g(d,this,t);else for(var l=d.length,w=Ey(d,l),n=0;n<l;++n)_g(w[n],this,t);return!0};function yy(r,e,t,n){var i,a,u;if(Lc(t),a=r._events,a===void 0?(a=r._events=Object.create(null),r._eventsCount=0):(a.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),u=a[e]),u===void 0)u=a[e]=t,++r._eventsCount;else if(typeof u=="function"?u=a[e]=n?[t,u]:[u,t]:n?u.unshift(t):u.push(t),i=my(r),i>0&&u.length>i&&!u.warned){u.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=r,f.type=e,f.count=u.length,XL(f)}return r}zt.prototype.addListener=function(e,t){return yy(this,e,t,!1)};zt.prototype.on=zt.prototype.addListener;zt.prototype.prependListener=function(e,t){return yy(this,e,t,!0)};function ZL(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function wy(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=ZL.bind(n);return i.listener=t,n.wrapFn=i,i}zt.prototype.once=function(e,t){return Lc(t),this.on(e,wy(this,e,t)),this};zt.prototype.prependOnceListener=function(e,t){return Lc(t),this.prependListener(e,wy(this,e,t)),this};zt.prototype.removeListener=function(e,t){var n,i,a,u,f;if(Lc(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(a=-1,u=n.length-1;u>=0;u--)if(n[u]===t||n[u].listener===t){f=n[u].listener,a=u;break}if(a<0)return this;a===0?n.shift():QL(n,a),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,f||t)}return this};zt.prototype.off=zt.prototype.removeListener;zt.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),u;for(i=0;i<a.length;++i)u=a[i],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function _y(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?eC(i):Ey(i,i.length)}zt.prototype.listeners=function(e){return _y(this,e,!0)};zt.prototype.rawListeners=function(e){return _y(this,e,!1)};zt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):by.call(r,e)};zt.prototype.listenerCount=by;function by(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}zt.prototype.eventNames=function(){return this._eventsCount>0?Hu(this._events):[]};function Ey(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function QL(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function eC(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function tC(r,e){return new Promise(function(t,n){function i(u){r.removeListener(e,a),n(u)}function a(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}xy(r,e,a,{once:!0}),e!=="error"&&rC(r,i,{once:!0})})}function rC(r,e,t){typeof r.on=="function"&&xy(r,"error",e,t)}function xy(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(a){n.once&&r.removeEventListener(e,i),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var nC=pl.exports,ac={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */ac.exports;(function(r,e){(function(){var t,n="4.17.21",i=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",f="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",l=500,w="__lodash_placeholder__",b=1,S=2,I=4,M=1,z=2,k=1,Y=2,te=4,ie=8,W=16,Z=32,V=64,y=128,B=256,he=512,de=30,pe="...",Ee=800,$=16,h=1,v=2,x=3,P=1/0,A=9007199254740991,R=17976931348623157e292,j=NaN,O=4294967295,m=O-1,L=O>>>1,ce=[["ary",y],["bind",k],["bindKey",Y],["curry",ie],["curryRight",W],["flip",he],["partial",Z],["partialRight",V],["rearg",B]],_="[object Arguments]",G="[object Array]",U="[object AsyncFunction]",T="[object Boolean]",F="[object Date]",g="[object DOMException]",N="[object Error]",ee="[object Function]",le="[object GeneratorFunction]",se="[object Map]",ve="[object Number]",et="[object Null]",Ae="[object Object]",qe="[object Promise]",bt="[object Proxy]",Pe="[object RegExp]",_e="[object Set]",je="[object String]",xe="[object Symbol]",De="[object Undefined]",Te="[object WeakMap]",Se="[object WeakSet]",ye="[object ArrayBuffer]",$e="[object DataView]",Me="[object Float32Array]",be="[object Float64Array]",tt="[object Int8Array]",Le="[object Int16Array]",Re="[object Int32Array]",st="[object Uint8Array]",Ce="[object Uint8ClampedArray]",at="[object Uint16Array]",nr="[object Uint32Array]",gt=/\b__p \+= '';/g,ut=/\b(__p \+=) '' \+/g,Ar=/(__e\(.*?\)|\b__t\)) \+\n'';/g,wt=/&(?:amp|lt|gt|quot|#39);/g,_t=/[&<>"']/g,St=RegExp(wt.source),Be=RegExp(_t.source),We=/<%-([\s\S]+?)%>/g,It=/<%([\s\S]+?)%>/g,ke=/<%=([\s\S]+?)%>/g,Ke=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Rt=/^\w*$/,Ze=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ge=/[\\^$.*+?()[\]{}|]/g,Nt=RegExp(Ge.source),Ve=/^\s+/,Ye=/\s/,At=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Fe=/\{\n\/\* \[wrapped with (.+)\] \*/,Qe=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Pt=/[()=,{}\[\]\/\s]/,Dt=/\\(\\)?/g,Cn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,lt=/\w*$/,Mt=/^[-+]0x[0-9a-f]+$/i,ln=/^0b[01]+$/i,dn=/^\[object .+?Constructor\]$/,pn=/^0o[0-7]+$/i,gn=/^(?:0|[1-9]\d*)$/,mr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Hn=/($^)/,Vi=/['\n\r\u2028\u2029\\]/g,kn="\\ud800-\\udfff",Ji="\\u0300-\\u036f",Yi="\\ufe20-\\ufe2f",Wn="\\u20d0-\\u20ff",Ii=Ji+Yi+Wn,Ai="\\u2700-\\u27bf",$r="a-z\\xdf-\\xf6\\xf8-\\xff",Xi="\\xac\\xb1\\xd7\\xf7",Zi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Qi="\\u2000-\\u206f",es=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Oi="A-Z\\xc0-\\xd6\\xd8-\\xde",_a="\\ufe0e\\ufe0f",ts=Xi+Zi+Qi+es,bo="['’]",rs="["+kn+"]",Eo="["+ts+"]",ns="["+Ii+"]",ba="\\d+",Nc="["+Ai+"]",Ea="["+$r+"]",xa="[^"+kn+ts+ba+Ai+$r+Oi+"]",Ns="\\ud83c[\\udffb-\\udfff]",Tc="(?:"+ns+"|"+Ns+")",Sa="[^"+kn+"]",Ts="(?:\\ud83c[\\udde6-\\uddff]){2}",Pi="[\\ud800-\\udbff][\\udc00-\\udfff]",Qr="["+Oi+"]",Ia="\\u200d",Aa="(?:"+Ea+"|"+xa+")",Gn="(?:"+Qr+"|"+xa+")",Oa="(?:"+bo+"(?:d|ll|m|re|s|t|ve))?",Pa="(?:"+bo+"(?:D|LL|M|RE|S|T|VE))?",Da=Tc+"?",Ma="["+_a+"]?",$c="(?:"+Ia+"(?:"+[Sa,Ts,Pi].join("|")+")"+Ma+Da+")*",si="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",La="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ca=Ma+Da+$c,$s="(?:"+[Nc,Ts,Pi].join("|")+")"+Ca,Fc="(?:"+[Sa+ns+"?",ns,Ts,Pi,rs].join("|")+")",xo=RegExp(bo,"g"),Uc=RegExp(ns,"g"),Fs=RegExp(Ns+"(?="+Ns+")|"+Fc+Ca,"g"),Ra=RegExp([Qr+"?"+Ea+"+"+Oa+"(?="+[Eo,Qr,"$"].join("|")+")",Gn+"+"+Pa+"(?="+[Eo,Qr+Aa,"$"].join("|")+")",Qr+"?"+Aa+"+"+Oa,Qr+"+"+Pa,La,si,ba,$s].join("|"),"g"),Na=RegExp("["+Ia+kn+Ii+_a+"]"),is=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ta=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],qc=-1,Wt={};Wt[Me]=Wt[be]=Wt[tt]=Wt[Le]=Wt[Re]=Wt[st]=Wt[Ce]=Wt[at]=Wt[nr]=!0,Wt[_]=Wt[G]=Wt[ye]=Wt[T]=Wt[$e]=Wt[F]=Wt[N]=Wt[ee]=Wt[se]=Wt[ve]=Wt[Ae]=Wt[Pe]=Wt[_e]=Wt[je]=Wt[Te]=!1;var $t={};$t[_]=$t[G]=$t[ye]=$t[$e]=$t[T]=$t[F]=$t[Me]=$t[be]=$t[tt]=$t[Le]=$t[Re]=$t[se]=$t[ve]=$t[Ae]=$t[Pe]=$t[_e]=$t[je]=$t[xe]=$t[st]=$t[Ce]=$t[at]=$t[nr]=!0,$t[N]=$t[ee]=$t[Te]=!1;var q={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},X={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ue={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ie={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Gt=parseFloat,nt=parseInt,Zt=typeof Pr=="object"&&Pr&&Pr.Object===Object&&Pr,hr=typeof self=="object"&&self&&self.Object===Object&&self,mt=Zt||hr||Function("return this")(),Vt=e&&!e.nodeType&&e,or=Vt&&!0&&r&&!r.nodeType&&r,Hr=or&&or.exports===Vt,lr=Hr&&Zt.process,Qt=function(){try{var J=or&&or.require&&or.require("util").types;return J||lr&&lr.binding&&lr.binding("util")}catch{}}(),Fr=Qt&&Qt.isArrayBuffer,Rn=Qt&&Qt.isDate,vn=Qt&&Qt.isMap,Vn=Qt&&Qt.isRegExp,So=Qt&&Qt.isSet,ss=Qt&&Qt.isTypedArray;function yr(J,ne,re){switch(re.length){case 0:return J.call(ne);case 1:return J.call(ne,re[0]);case 2:return J.call(ne,re[0],re[1]);case 3:return J.call(ne,re[0],re[1],re[2])}return J.apply(ne,re)}function Hy(J,ne,re,Oe){for(var rt=-1,xt=J==null?0:J.length;++rt<xt;){var pr=J[rt];ne(Oe,pr,re(pr),J)}return Oe}function mn(J,ne){for(var re=-1,Oe=J==null?0:J.length;++re<Oe&&ne(J[re],re,J)!==!1;);return J}function ky(J,ne){for(var re=J==null?0:J.length;re--&&ne(J[re],re,J)!==!1;);return J}function yl(J,ne){for(var re=-1,Oe=J==null?0:J.length;++re<Oe;)if(!ne(J[re],re,J))return!1;return!0}function Di(J,ne){for(var re=-1,Oe=J==null?0:J.length,rt=0,xt=[];++re<Oe;){var pr=J[re];ne(pr,re,J)&&(xt[rt++]=pr)}return xt}function $a(J,ne){var re=J==null?0:J.length;return!!re&&Us(J,ne,0)>-1}function jc(J,ne,re){for(var Oe=-1,rt=J==null?0:J.length;++Oe<rt;)if(re(ne,J[Oe]))return!0;return!1}function tr(J,ne){for(var re=-1,Oe=J==null?0:J.length,rt=Array(Oe);++re<Oe;)rt[re]=ne(J[re],re,J);return rt}function Mi(J,ne){for(var re=-1,Oe=ne.length,rt=J.length;++re<Oe;)J[rt+re]=ne[re];return J}function Bc(J,ne,re,Oe){var rt=-1,xt=J==null?0:J.length;for(Oe&&xt&&(re=J[++rt]);++rt<xt;)re=ne(re,J[rt],rt,J);return re}function Wy(J,ne,re,Oe){var rt=J==null?0:J.length;for(Oe&&rt&&(re=J[--rt]);rt--;)re=ne(re,J[rt],rt,J);return re}function Kc(J,ne){for(var re=-1,Oe=J==null?0:J.length;++re<Oe;)if(ne(J[re],re,J))return!0;return!1}var Gy=zc("length");function Vy(J){return J.split("")}function Jy(J){return J.match(Tt)||[]}function wl(J,ne,re){var Oe;return re(J,function(rt,xt,pr){if(ne(rt,xt,pr))return Oe=xt,!1}),Oe}function Fa(J,ne,re,Oe){for(var rt=J.length,xt=re+(Oe?1:-1);Oe?xt--:++xt<rt;)if(ne(J[xt],xt,J))return xt;return-1}function Us(J,ne,re){return ne===ne?aw(J,ne,re):Fa(J,_l,re)}function Yy(J,ne,re,Oe){for(var rt=re-1,xt=J.length;++rt<xt;)if(Oe(J[rt],ne))return rt;return-1}function _l(J){return J!==J}function bl(J,ne){var re=J==null?0:J.length;return re?kc(J,ne)/re:j}function zc(J){return function(ne){return ne==null?t:ne[J]}}function Hc(J){return function(ne){return J==null?t:J[ne]}}function El(J,ne,re,Oe,rt){return rt(J,function(xt,pr,Jt){re=Oe?(Oe=!1,xt):ne(re,xt,pr,Jt)}),re}function Xy(J,ne){var re=J.length;for(J.sort(ne);re--;)J[re]=J[re].value;return J}function kc(J,ne){for(var re,Oe=-1,rt=J.length;++Oe<rt;){var xt=ne(J[Oe]);xt!==t&&(re=re===t?xt:re+xt)}return re}function Wc(J,ne){for(var re=-1,Oe=Array(J);++re<J;)Oe[re]=ne(re);return Oe}function Zy(J,ne){return tr(ne,function(re){return[re,J[re]]})}function xl(J){return J&&J.slice(0,Ol(J)+1).replace(Ve,"")}function en(J){return function(ne){return J(ne)}}function Gc(J,ne){return tr(ne,function(re){return J[re]})}function Io(J,ne){return J.has(ne)}function Sl(J,ne){for(var re=-1,Oe=J.length;++re<Oe&&Us(ne,J[re],0)>-1;);return re}function Il(J,ne){for(var re=J.length;re--&&Us(ne,J[re],0)>-1;);return re}function Qy(J,ne){for(var re=J.length,Oe=0;re--;)J[re]===ne&&++Oe;return Oe}var ew=Hc(q),tw=Hc(X);function rw(J){return"\\"+Ie[J]}function nw(J,ne){return J==null?t:J[ne]}function qs(J){return Na.test(J)}function iw(J){return is.test(J)}function sw(J){for(var ne,re=[];!(ne=J.next()).done;)re.push(ne.value);return re}function Vc(J){var ne=-1,re=Array(J.size);return J.forEach(function(Oe,rt){re[++ne]=[rt,Oe]}),re}function Al(J,ne){return function(re){return J(ne(re))}}function Li(J,ne){for(var re=-1,Oe=J.length,rt=0,xt=[];++re<Oe;){var pr=J[re];(pr===ne||pr===w)&&(J[re]=w,xt[rt++]=re)}return xt}function Ua(J){var ne=-1,re=Array(J.size);return J.forEach(function(Oe){re[++ne]=Oe}),re}function ow(J){var ne=-1,re=Array(J.size);return J.forEach(function(Oe){re[++ne]=[Oe,Oe]}),re}function aw(J,ne,re){for(var Oe=re-1,rt=J.length;++Oe<rt;)if(J[Oe]===ne)return Oe;return-1}function uw(J,ne,re){for(var Oe=re+1;Oe--;)if(J[Oe]===ne)return Oe;return Oe}function js(J){return qs(J)?fw(J):Gy(J)}function Nn(J){return qs(J)?hw(J):Vy(J)}function Ol(J){for(var ne=J.length;ne--&&Ye.test(J.charAt(ne)););return ne}var cw=Hc(ue);function fw(J){for(var ne=Fs.lastIndex=0;Fs.test(J);)++ne;return ne}function hw(J){return J.match(Fs)||[]}function lw(J){return J.match(Ra)||[]}var dw=function J(ne){ne=ne==null?mt:Bs.defaults(mt.Object(),ne,Bs.pick(mt,Ta));var re=ne.Array,Oe=ne.Date,rt=ne.Error,xt=ne.Function,pr=ne.Math,Jt=ne.Object,Jc=ne.RegExp,pw=ne.String,yn=ne.TypeError,qa=re.prototype,gw=xt.prototype,Ks=Jt.prototype,ja=ne["__core-js_shared__"],Ba=gw.toString,Lt=Ks.hasOwnProperty,vw=0,Pl=function(){var s=/[^.]+$/.exec(ja&&ja.keys&&ja.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),Ka=Ks.toString,mw=Ba.call(Jt),yw=mt._,ww=Jc("^"+Ba.call(Lt).replace(Ge,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),za=Hr?ne.Buffer:t,Ci=ne.Symbol,Ha=ne.Uint8Array,Dl=za?za.allocUnsafe:t,ka=Al(Jt.getPrototypeOf,Jt),Ml=Jt.create,Ll=Ks.propertyIsEnumerable,Wa=qa.splice,Cl=Ci?Ci.isConcatSpreadable:t,Ao=Ci?Ci.iterator:t,os=Ci?Ci.toStringTag:t,Ga=function(){try{var s=hs(Jt,"defineProperty");return s({},"",{}),s}catch{}}(),_w=ne.clearTimeout!==mt.clearTimeout&&ne.clearTimeout,bw=Oe&&Oe.now!==mt.Date.now&&Oe.now,Ew=ne.setTimeout!==mt.setTimeout&&ne.setTimeout,Va=pr.ceil,Ja=pr.floor,Yc=Jt.getOwnPropertySymbols,xw=za?za.isBuffer:t,Rl=ne.isFinite,Sw=qa.join,Iw=Al(Jt.keys,Jt),gr=pr.max,Cr=pr.min,Aw=Oe.now,Ow=ne.parseInt,Nl=pr.random,Pw=qa.reverse,Xc=hs(ne,"DataView"),Oo=hs(ne,"Map"),Zc=hs(ne,"Promise"),zs=hs(ne,"Set"),Po=hs(ne,"WeakMap"),Do=hs(Jt,"create"),Ya=Po&&new Po,Hs={},Dw=ls(Xc),Mw=ls(Oo),Lw=ls(Zc),Cw=ls(zs),Rw=ls(Po),Xa=Ci?Ci.prototype:t,Mo=Xa?Xa.valueOf:t,Tl=Xa?Xa.toString:t;function D(s){if(ir(s)&&!it(s)&&!(s instanceof vt)){if(s instanceof wn)return s;if(Lt.call(s,"__wrapped__"))return $d(s)}return new wn(s)}var ks=function(){function s(){}return function(o){if(!rr(o))return{};if(Ml)return Ml(o);s.prototype=o;var c=new s;return s.prototype=t,c}}();function Za(){}function wn(s,o){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=t}D.templateSettings={escape:We,evaluate:It,interpolate:ke,variable:"",imports:{_:D}},D.prototype=Za.prototype,D.prototype.constructor=D,wn.prototype=ks(Za.prototype),wn.prototype.constructor=wn;function vt(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=O,this.__views__=[]}function Nw(){var s=new vt(this.__wrapped__);return s.__actions__=kr(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=kr(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=kr(this.__views__),s}function Tw(){if(this.__filtered__){var s=new vt(this);s.__dir__=-1,s.__filtered__=!0}else s=this.clone(),s.__dir__*=-1;return s}function $w(){var s=this.__wrapped__.value(),o=this.__dir__,c=it(s),p=o<0,E=c?s.length:0,C=V1(0,E,this.__views__),K=C.start,H=C.end,Q=H-K,oe=p?H:K-1,ae=this.__iteratees__,fe=ae.length,we=0,Ne=Cr(Q,this.__takeCount__);if(!c||!p&&E==Q&&Ne==Q)return sd(s,this.__actions__);var ze=[];e:for(;Q--&&we<Ne;){oe+=o;for(var ft=-1,He=s[oe];++ft<fe;){var dt=ae[ft],yt=dt.iteratee,nn=dt.type,jr=yt(He);if(nn==v)He=jr;else if(!jr){if(nn==h)continue e;break e}}ze[we++]=He}return ze}vt.prototype=ks(Za.prototype),vt.prototype.constructor=vt;function as(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var p=s[o];this.set(p[0],p[1])}}function Fw(){this.__data__=Do?Do(null):{},this.size=0}function Uw(s){var o=this.has(s)&&delete this.__data__[s];return this.size-=o?1:0,o}function qw(s){var o=this.__data__;if(Do){var c=o[s];return c===d?t:c}return Lt.call(o,s)?o[s]:t}function jw(s){var o=this.__data__;return Do?o[s]!==t:Lt.call(o,s)}function Bw(s,o){var c=this.__data__;return this.size+=this.has(s)?0:1,c[s]=Do&&o===t?d:o,this}as.prototype.clear=Fw,as.prototype.delete=Uw,as.prototype.get=qw,as.prototype.has=jw,as.prototype.set=Bw;function oi(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var p=s[o];this.set(p[0],p[1])}}function Kw(){this.__data__=[],this.size=0}function zw(s){var o=this.__data__,c=Qa(o,s);if(c<0)return!1;var p=o.length-1;return c==p?o.pop():Wa.call(o,c,1),--this.size,!0}function Hw(s){var o=this.__data__,c=Qa(o,s);return c<0?t:o[c][1]}function kw(s){return Qa(this.__data__,s)>-1}function Ww(s,o){var c=this.__data__,p=Qa(c,s);return p<0?(++this.size,c.push([s,o])):c[p][1]=o,this}oi.prototype.clear=Kw,oi.prototype.delete=zw,oi.prototype.get=Hw,oi.prototype.has=kw,oi.prototype.set=Ww;function ai(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var p=s[o];this.set(p[0],p[1])}}function Gw(){this.size=0,this.__data__={hash:new as,map:new(Oo||oi),string:new as}}function Vw(s){var o=hu(this,s).delete(s);return this.size-=o?1:0,o}function Jw(s){return hu(this,s).get(s)}function Yw(s){return hu(this,s).has(s)}function Xw(s,o){var c=hu(this,s),p=c.size;return c.set(s,o),this.size+=c.size==p?0:1,this}ai.prototype.clear=Gw,ai.prototype.delete=Vw,ai.prototype.get=Jw,ai.prototype.has=Yw,ai.prototype.set=Xw;function us(s){var o=-1,c=s==null?0:s.length;for(this.__data__=new ai;++o<c;)this.add(s[o])}function Zw(s){return this.__data__.set(s,d),this}function Qw(s){return this.__data__.has(s)}us.prototype.add=us.prototype.push=Zw,us.prototype.has=Qw;function Tn(s){var o=this.__data__=new oi(s);this.size=o.size}function e1(){this.__data__=new oi,this.size=0}function t1(s){var o=this.__data__,c=o.delete(s);return this.size=o.size,c}function r1(s){return this.__data__.get(s)}function n1(s){return this.__data__.has(s)}function i1(s,o){var c=this.__data__;if(c instanceof oi){var p=c.__data__;if(!Oo||p.length<i-1)return p.push([s,o]),this.size=++c.size,this;c=this.__data__=new ai(p)}return c.set(s,o),this.size=c.size,this}Tn.prototype.clear=e1,Tn.prototype.delete=t1,Tn.prototype.get=r1,Tn.prototype.has=n1,Tn.prototype.set=i1;function $l(s,o){var c=it(s),p=!c&&ds(s),E=!c&&!p&&Fi(s),C=!c&&!p&&!E&&Js(s),K=c||p||E||C,H=K?Wc(s.length,pw):[],Q=H.length;for(var oe in s)(o||Lt.call(s,oe))&&!(K&&(oe=="length"||E&&(oe=="offset"||oe=="parent")||C&&(oe=="buffer"||oe=="byteLength"||oe=="byteOffset")||hi(oe,Q)))&&H.push(oe);return H}function Fl(s){var o=s.length;return o?s[ff(0,o-1)]:t}function s1(s,o){return lu(kr(s),cs(o,0,s.length))}function o1(s){return lu(kr(s))}function Qc(s,o,c){(c!==t&&!$n(s[o],c)||c===t&&!(o in s))&&ui(s,o,c)}function Lo(s,o,c){var p=s[o];(!(Lt.call(s,o)&&$n(p,c))||c===t&&!(o in s))&&ui(s,o,c)}function Qa(s,o){for(var c=s.length;c--;)if($n(s[c][0],o))return c;return-1}function a1(s,o,c,p){return Ri(s,function(E,C,K){o(p,E,c(E),K)}),p}function Ul(s,o){return s&&Yn(o,wr(o),s)}function u1(s,o){return s&&Yn(o,Gr(o),s)}function ui(s,o,c){o=="__proto__"&&Ga?Ga(s,o,{configurable:!0,enumerable:!0,value:c,writable:!0}):s[o]=c}function ef(s,o){for(var c=-1,p=o.length,E=re(p),C=s==null;++c<p;)E[c]=C?t:Tf(s,o[c]);return E}function cs(s,o,c){return s===s&&(c!==t&&(s=s<=c?s:c),o!==t&&(s=s>=o?s:o)),s}function _n(s,o,c,p,E,C){var K,H=o&b,Q=o&S,oe=o&I;if(c&&(K=E?c(s,p,E,C):c(s)),K!==t)return K;if(!rr(s))return s;var ae=it(s);if(ae){if(K=Y1(s),!H)return kr(s,K)}else{var fe=Rr(s),we=fe==ee||fe==le;if(Fi(s))return ud(s,H);if(fe==Ae||fe==_||we&&!E){if(K=Q||we?{}:Od(s),!H)return Q?q1(s,u1(K,s)):U1(s,Ul(K,s))}else{if(!$t[fe])return E?s:{};K=X1(s,fe,H)}}C||(C=new Tn);var Ne=C.get(s);if(Ne)return Ne;C.set(s,K),rp(s)?s.forEach(function(He){K.add(_n(He,o,c,He,s,C))}):ep(s)&&s.forEach(function(He,dt){K.set(dt,_n(He,o,c,dt,s,C))});var ze=oe?Q?bf:_f:Q?Gr:wr,ft=ae?t:ze(s);return mn(ft||s,function(He,dt){ft&&(dt=He,He=s[dt]),Lo(K,dt,_n(He,o,c,dt,s,C))}),K}function c1(s){var o=wr(s);return function(c){return ql(c,s,o)}}function ql(s,o,c){var p=c.length;if(s==null)return!p;for(s=Jt(s);p--;){var E=c[p],C=o[E],K=s[E];if(K===t&&!(E in s)||!C(K))return!1}return!0}function jl(s,o,c){if(typeof s!="function")throw new yn(u);return Uo(function(){s.apply(t,c)},o)}function Co(s,o,c,p){var E=-1,C=$a,K=!0,H=s.length,Q=[],oe=o.length;if(!H)return Q;c&&(o=tr(o,en(c))),p?(C=jc,K=!1):o.length>=i&&(C=Io,K=!1,o=new us(o));e:for(;++E<H;){var ae=s[E],fe=c==null?ae:c(ae);if(ae=p||ae!==0?ae:0,K&&fe===fe){for(var we=oe;we--;)if(o[we]===fe)continue e;Q.push(ae)}else C(o,fe,p)||Q.push(ae)}return Q}var Ri=dd(Jn),Bl=dd(rf,!0);function f1(s,o){var c=!0;return Ri(s,function(p,E,C){return c=!!o(p,E,C),c}),c}function eu(s,o,c){for(var p=-1,E=s.length;++p<E;){var C=s[p],K=o(C);if(K!=null&&(H===t?K===K&&!rn(K):c(K,H)))var H=K,Q=C}return Q}function h1(s,o,c,p){var E=s.length;for(c=ct(c),c<0&&(c=-c>E?0:E+c),p=p===t||p>E?E:ct(p),p<0&&(p+=E),p=c>p?0:ip(p);c<p;)s[c++]=o;return s}function Kl(s,o){var c=[];return Ri(s,function(p,E,C){o(p,E,C)&&c.push(p)}),c}function Or(s,o,c,p,E){var C=-1,K=s.length;for(c||(c=Q1),E||(E=[]);++C<K;){var H=s[C];o>0&&c(H)?o>1?Or(H,o-1,c,p,E):Mi(E,H):p||(E[E.length]=H)}return E}var tf=pd(),zl=pd(!0);function Jn(s,o){return s&&tf(s,o,wr)}function rf(s,o){return s&&zl(s,o,wr)}function tu(s,o){return Di(o,function(c){return li(s[c])})}function fs(s,o){o=Ti(o,s);for(var c=0,p=o.length;s!=null&&c<p;)s=s[Xn(o[c++])];return c&&c==p?s:t}function Hl(s,o,c){var p=o(s);return it(s)?p:Mi(p,c(s))}function Ur(s){return s==null?s===t?De:et:os&&os in Jt(s)?G1(s):o_(s)}function nf(s,o){return s>o}function l1(s,o){return s!=null&&Lt.call(s,o)}function d1(s,o){return s!=null&&o in Jt(s)}function p1(s,o,c){return s>=Cr(o,c)&&s<gr(o,c)}function sf(s,o,c){for(var p=c?jc:$a,E=s[0].length,C=s.length,K=C,H=re(C),Q=1/0,oe=[];K--;){var ae=s[K];K&&o&&(ae=tr(ae,en(o))),Q=Cr(ae.length,Q),H[K]=!c&&(o||E>=120&&ae.length>=120)?new us(K&&ae):t}ae=s[0];var fe=-1,we=H[0];e:for(;++fe<E&&oe.length<Q;){var Ne=ae[fe],ze=o?o(Ne):Ne;if(Ne=c||Ne!==0?Ne:0,!(we?Io(we,ze):p(oe,ze,c))){for(K=C;--K;){var ft=H[K];if(!(ft?Io(ft,ze):p(s[K],ze,c)))continue e}we&&we.push(ze),oe.push(Ne)}}return oe}function g1(s,o,c,p){return Jn(s,function(E,C,K){o(p,c(E),C,K)}),p}function Ro(s,o,c){o=Ti(o,s),s=Ld(s,o);var p=s==null?s:s[Xn(En(o))];return p==null?t:yr(p,s,c)}function kl(s){return ir(s)&&Ur(s)==_}function v1(s){return ir(s)&&Ur(s)==ye}function m1(s){return ir(s)&&Ur(s)==F}function No(s,o,c,p,E){return s===o?!0:s==null||o==null||!ir(s)&&!ir(o)?s!==s&&o!==o:y1(s,o,c,p,No,E)}function y1(s,o,c,p,E,C){var K=it(s),H=it(o),Q=K?G:Rr(s),oe=H?G:Rr(o);Q=Q==_?Ae:Q,oe=oe==_?Ae:oe;var ae=Q==Ae,fe=oe==Ae,we=Q==oe;if(we&&Fi(s)){if(!Fi(o))return!1;K=!0,ae=!1}if(we&&!ae)return C||(C=new Tn),K||Js(s)?Sd(s,o,c,p,E,C):k1(s,o,Q,c,p,E,C);if(!(c&M)){var Ne=ae&&Lt.call(s,"__wrapped__"),ze=fe&&Lt.call(o,"__wrapped__");if(Ne||ze){var ft=Ne?s.value():s,He=ze?o.value():o;return C||(C=new Tn),E(ft,He,c,p,C)}}return we?(C||(C=new Tn),W1(s,o,c,p,E,C)):!1}function w1(s){return ir(s)&&Rr(s)==se}function of(s,o,c,p){var E=c.length,C=E,K=!p;if(s==null)return!C;for(s=Jt(s);E--;){var H=c[E];if(K&&H[2]?H[1]!==s[H[0]]:!(H[0]in s))return!1}for(;++E<C;){H=c[E];var Q=H[0],oe=s[Q],ae=H[1];if(K&&H[2]){if(oe===t&&!(Q in s))return!1}else{var fe=new Tn;if(p)var we=p(oe,ae,Q,s,o,fe);if(!(we===t?No(ae,oe,M|z,p,fe):we))return!1}}return!0}function Wl(s){if(!rr(s)||t_(s))return!1;var o=li(s)?ww:dn;return o.test(ls(s))}function _1(s){return ir(s)&&Ur(s)==Pe}function b1(s){return ir(s)&&Rr(s)==_e}function E1(s){return ir(s)&&yu(s.length)&&!!Wt[Ur(s)]}function Gl(s){return typeof s=="function"?s:s==null?Vr:typeof s=="object"?it(s)?Yl(s[0],s[1]):Jl(s):gp(s)}function af(s){if(!Fo(s))return Iw(s);var o=[];for(var c in Jt(s))Lt.call(s,c)&&c!="constructor"&&o.push(c);return o}function x1(s){if(!rr(s))return s_(s);var o=Fo(s),c=[];for(var p in s)p=="constructor"&&(o||!Lt.call(s,p))||c.push(p);return c}function uf(s,o){return s<o}function Vl(s,o){var c=-1,p=Wr(s)?re(s.length):[];return Ri(s,function(E,C,K){p[++c]=o(E,C,K)}),p}function Jl(s){var o=xf(s);return o.length==1&&o[0][2]?Dd(o[0][0],o[0][1]):function(c){return c===s||of(c,s,o)}}function Yl(s,o){return If(s)&&Pd(o)?Dd(Xn(s),o):function(c){var p=Tf(c,s);return p===t&&p===o?$f(c,s):No(o,p,M|z)}}function ru(s,o,c,p,E){s!==o&&tf(o,function(C,K){if(E||(E=new Tn),rr(C))S1(s,o,K,c,ru,p,E);else{var H=p?p(Of(s,K),C,K+"",s,o,E):t;H===t&&(H=C),Qc(s,K,H)}},Gr)}function S1(s,o,c,p,E,C,K){var H=Of(s,c),Q=Of(o,c),oe=K.get(Q);if(oe){Qc(s,c,oe);return}var ae=C?C(H,Q,c+"",s,o,K):t,fe=ae===t;if(fe){var we=it(Q),Ne=!we&&Fi(Q),ze=!we&&!Ne&&Js(Q);ae=Q,we||Ne||ze?it(H)?ae=H:ar(H)?ae=kr(H):Ne?(fe=!1,ae=ud(Q,!0)):ze?(fe=!1,ae=cd(Q,!0)):ae=[]:qo(Q)||ds(Q)?(ae=H,ds(H)?ae=sp(H):(!rr(H)||li(H))&&(ae=Od(Q))):fe=!1}fe&&(K.set(Q,ae),E(ae,Q,p,C,K),K.delete(Q)),Qc(s,c,ae)}function Xl(s,o){var c=s.length;if(c)return o+=o<0?c:0,hi(o,c)?s[o]:t}function Zl(s,o,c){o.length?o=tr(o,function(C){return it(C)?function(K){return fs(K,C.length===1?C[0]:C)}:C}):o=[Vr];var p=-1;o=tr(o,en(Ue()));var E=Vl(s,function(C,K,H){var Q=tr(o,function(oe){return oe(C)});return{criteria:Q,index:++p,value:C}});return Xy(E,function(C,K){return F1(C,K,c)})}function I1(s,o){return Ql(s,o,function(c,p){return $f(s,p)})}function Ql(s,o,c){for(var p=-1,E=o.length,C={};++p<E;){var K=o[p],H=fs(s,K);c(H,K)&&To(C,Ti(K,s),H)}return C}function A1(s){return function(o){return fs(o,s)}}function cf(s,o,c,p){var E=p?Yy:Us,C=-1,K=o.length,H=s;for(s===o&&(o=kr(o)),c&&(H=tr(s,en(c)));++C<K;)for(var Q=0,oe=o[C],ae=c?c(oe):oe;(Q=E(H,ae,Q,p))>-1;)H!==s&&Wa.call(H,Q,1),Wa.call(s,Q,1);return s}function ed(s,o){for(var c=s?o.length:0,p=c-1;c--;){var E=o[c];if(c==p||E!==C){var C=E;hi(E)?Wa.call(s,E,1):df(s,E)}}return s}function ff(s,o){return s+Ja(Nl()*(o-s+1))}function O1(s,o,c,p){for(var E=-1,C=gr(Va((o-s)/(c||1)),0),K=re(C);C--;)K[p?C:++E]=s,s+=c;return K}function hf(s,o){var c="";if(!s||o<1||o>A)return c;do o%2&&(c+=s),o=Ja(o/2),o&&(s+=s);while(o);return c}function ht(s,o){return Pf(Md(s,o,Vr),s+"")}function P1(s){return Fl(Ys(s))}function D1(s,o){var c=Ys(s);return lu(c,cs(o,0,c.length))}function To(s,o,c,p){if(!rr(s))return s;o=Ti(o,s);for(var E=-1,C=o.length,K=C-1,H=s;H!=null&&++E<C;){var Q=Xn(o[E]),oe=c;if(Q==="__proto__"||Q==="constructor"||Q==="prototype")return s;if(E!=K){var ae=H[Q];oe=p?p(ae,Q,H):t,oe===t&&(oe=rr(ae)?ae:hi(o[E+1])?[]:{})}Lo(H,Q,oe),H=H[Q]}return s}var td=Ya?function(s,o){return Ya.set(s,o),s}:Vr,M1=Ga?function(s,o){return Ga(s,"toString",{configurable:!0,enumerable:!1,value:Uf(o),writable:!0})}:Vr;function L1(s){return lu(Ys(s))}function bn(s,o,c){var p=-1,E=s.length;o<0&&(o=-o>E?0:E+o),c=c>E?E:c,c<0&&(c+=E),E=o>c?0:c-o>>>0,o>>>=0;for(var C=re(E);++p<E;)C[p]=s[p+o];return C}function C1(s,o){var c;return Ri(s,function(p,E,C){return c=o(p,E,C),!c}),!!c}function nu(s,o,c){var p=0,E=s==null?p:s.length;if(typeof o=="number"&&o===o&&E<=L){for(;p<E;){var C=p+E>>>1,K=s[C];K!==null&&!rn(K)&&(c?K<=o:K<o)?p=C+1:E=C}return E}return lf(s,o,Vr,c)}function lf(s,o,c,p){var E=0,C=s==null?0:s.length;if(C===0)return 0;o=c(o);for(var K=o!==o,H=o===null,Q=rn(o),oe=o===t;E<C;){var ae=Ja((E+C)/2),fe=c(s[ae]),we=fe!==t,Ne=fe===null,ze=fe===fe,ft=rn(fe);if(K)var He=p||ze;else oe?He=ze&&(p||we):H?He=ze&&we&&(p||!Ne):Q?He=ze&&we&&!Ne&&(p||!ft):Ne||ft?He=!1:He=p?fe<=o:fe<o;He?E=ae+1:C=ae}return Cr(C,m)}function rd(s,o){for(var c=-1,p=s.length,E=0,C=[];++c<p;){var K=s[c],H=o?o(K):K;if(!c||!$n(H,Q)){var Q=H;C[E++]=K===0?0:K}}return C}function nd(s){return typeof s=="number"?s:rn(s)?j:+s}function tn(s){if(typeof s=="string")return s;if(it(s))return tr(s,tn)+"";if(rn(s))return Tl?Tl.call(s):"";var o=s+"";return o=="0"&&1/s==-1/0?"-0":o}function Ni(s,o,c){var p=-1,E=$a,C=s.length,K=!0,H=[],Q=H;if(c)K=!1,E=jc;else if(C>=i){var oe=o?null:z1(s);if(oe)return Ua(oe);K=!1,E=Io,Q=new us}else Q=o?[]:H;e:for(;++p<C;){var ae=s[p],fe=o?o(ae):ae;if(ae=c||ae!==0?ae:0,K&&fe===fe){for(var we=Q.length;we--;)if(Q[we]===fe)continue e;o&&Q.push(fe),H.push(ae)}else E(Q,fe,c)||(Q!==H&&Q.push(fe),H.push(ae))}return H}function df(s,o){return o=Ti(o,s),s=Ld(s,o),s==null||delete s[Xn(En(o))]}function id(s,o,c,p){return To(s,o,c(fs(s,o)),p)}function iu(s,o,c,p){for(var E=s.length,C=p?E:-1;(p?C--:++C<E)&&o(s[C],C,s););return c?bn(s,p?0:C,p?C+1:E):bn(s,p?C+1:0,p?E:C)}function sd(s,o){var c=s;return c instanceof vt&&(c=c.value()),Bc(o,function(p,E){return E.func.apply(E.thisArg,Mi([p],E.args))},c)}function pf(s,o,c){var p=s.length;if(p<2)return p?Ni(s[0]):[];for(var E=-1,C=re(p);++E<p;)for(var K=s[E],H=-1;++H<p;)H!=E&&(C[E]=Co(C[E]||K,s[H],o,c));return Ni(Or(C,1),o,c)}function od(s,o,c){for(var p=-1,E=s.length,C=o.length,K={};++p<E;){var H=p<C?o[p]:t;c(K,s[p],H)}return K}function gf(s){return ar(s)?s:[]}function vf(s){return typeof s=="function"?s:Vr}function Ti(s,o){return it(s)?s:If(s,o)?[s]:Td(Ot(s))}var R1=ht;function $i(s,o,c){var p=s.length;return c=c===t?p:c,!o&&c>=p?s:bn(s,o,c)}var ad=_w||function(s){return mt.clearTimeout(s)};function ud(s,o){if(o)return s.slice();var c=s.length,p=Dl?Dl(c):new s.constructor(c);return s.copy(p),p}function mf(s){var o=new s.constructor(s.byteLength);return new Ha(o).set(new Ha(s)),o}function N1(s,o){var c=o?mf(s.buffer):s.buffer;return new s.constructor(c,s.byteOffset,s.byteLength)}function T1(s){var o=new s.constructor(s.source,lt.exec(s));return o.lastIndex=s.lastIndex,o}function $1(s){return Mo?Jt(Mo.call(s)):{}}function cd(s,o){var c=o?mf(s.buffer):s.buffer;return new s.constructor(c,s.byteOffset,s.length)}function fd(s,o){if(s!==o){var c=s!==t,p=s===null,E=s===s,C=rn(s),K=o!==t,H=o===null,Q=o===o,oe=rn(o);if(!H&&!oe&&!C&&s>o||C&&K&&Q&&!H&&!oe||p&&K&&Q||!c&&Q||!E)return 1;if(!p&&!C&&!oe&&s<o||oe&&c&&E&&!p&&!C||H&&c&&E||!K&&E||!Q)return-1}return 0}function F1(s,o,c){for(var p=-1,E=s.criteria,C=o.criteria,K=E.length,H=c.length;++p<K;){var Q=fd(E[p],C[p]);if(Q){if(p>=H)return Q;var oe=c[p];return Q*(oe=="desc"?-1:1)}}return s.index-o.index}function hd(s,o,c,p){for(var E=-1,C=s.length,K=c.length,H=-1,Q=o.length,oe=gr(C-K,0),ae=re(Q+oe),fe=!p;++H<Q;)ae[H]=o[H];for(;++E<K;)(fe||E<C)&&(ae[c[E]]=s[E]);for(;oe--;)ae[H++]=s[E++];return ae}function ld(s,o,c,p){for(var E=-1,C=s.length,K=-1,H=c.length,Q=-1,oe=o.length,ae=gr(C-H,0),fe=re(ae+oe),we=!p;++E<ae;)fe[E]=s[E];for(var Ne=E;++Q<oe;)fe[Ne+Q]=o[Q];for(;++K<H;)(we||E<C)&&(fe[Ne+c[K]]=s[E++]);return fe}function kr(s,o){var c=-1,p=s.length;for(o||(o=re(p));++c<p;)o[c]=s[c];return o}function Yn(s,o,c,p){var E=!c;c||(c={});for(var C=-1,K=o.length;++C<K;){var H=o[C],Q=p?p(c[H],s[H],H,c,s):t;Q===t&&(Q=s[H]),E?ui(c,H,Q):Lo(c,H,Q)}return c}function U1(s,o){return Yn(s,Sf(s),o)}function q1(s,o){return Yn(s,Id(s),o)}function su(s,o){return function(c,p){var E=it(c)?Hy:a1,C=o?o():{};return E(c,s,Ue(p,2),C)}}function Ws(s){return ht(function(o,c){var p=-1,E=c.length,C=E>1?c[E-1]:t,K=E>2?c[2]:t;for(C=s.length>3&&typeof C=="function"?(E--,C):t,K&&qr(c[0],c[1],K)&&(C=E<3?t:C,E=1),o=Jt(o);++p<E;){var H=c[p];H&&s(o,H,p,C)}return o})}function dd(s,o){return function(c,p){if(c==null)return c;if(!Wr(c))return s(c,p);for(var E=c.length,C=o?E:-1,K=Jt(c);(o?C--:++C<E)&&p(K[C],C,K)!==!1;);return c}}function pd(s){return function(o,c,p){for(var E=-1,C=Jt(o),K=p(o),H=K.length;H--;){var Q=K[s?H:++E];if(c(C[Q],Q,C)===!1)break}return o}}function j1(s,o,c){var p=o&k,E=$o(s);function C(){var K=this&&this!==mt&&this instanceof C?E:s;return K.apply(p?c:this,arguments)}return C}function gd(s){return function(o){o=Ot(o);var c=qs(o)?Nn(o):t,p=c?c[0]:o.charAt(0),E=c?$i(c,1).join(""):o.slice(1);return p[s]()+E}}function Gs(s){return function(o){return Bc(dp(lp(o).replace(xo,"")),s,"")}}function $o(s){return function(){var o=arguments;switch(o.length){case 0:return new s;case 1:return new s(o[0]);case 2:return new s(o[0],o[1]);case 3:return new s(o[0],o[1],o[2]);case 4:return new s(o[0],o[1],o[2],o[3]);case 5:return new s(o[0],o[1],o[2],o[3],o[4]);case 6:return new s(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new s(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var c=ks(s.prototype),p=s.apply(c,o);return rr(p)?p:c}}function B1(s,o,c){var p=$o(s);function E(){for(var C=arguments.length,K=re(C),H=C,Q=Vs(E);H--;)K[H]=arguments[H];var oe=C<3&&K[0]!==Q&&K[C-1]!==Q?[]:Li(K,Q);if(C-=oe.length,C<c)return _d(s,o,ou,E.placeholder,t,K,oe,t,t,c-C);var ae=this&&this!==mt&&this instanceof E?p:s;return yr(ae,this,K)}return E}function vd(s){return function(o,c,p){var E=Jt(o);if(!Wr(o)){var C=Ue(c,3);o=wr(o),c=function(H){return C(E[H],H,E)}}var K=s(o,c,p);return K>-1?E[C?o[K]:K]:t}}function md(s){return fi(function(o){var c=o.length,p=c,E=wn.prototype.thru;for(s&&o.reverse();p--;){var C=o[p];if(typeof C!="function")throw new yn(u);if(E&&!K&&fu(C)=="wrapper")var K=new wn([],!0)}for(p=K?p:c;++p<c;){C=o[p];var H=fu(C),Q=H=="wrapper"?Ef(C):t;Q&&Af(Q[0])&&Q[1]==(y|ie|Z|B)&&!Q[4].length&&Q[9]==1?K=K[fu(Q[0])].apply(K,Q[3]):K=C.length==1&&Af(C)?K[H]():K.thru(C)}return function(){var oe=arguments,ae=oe[0];if(K&&oe.length==1&&it(ae))return K.plant(ae).value();for(var fe=0,we=c?o[fe].apply(this,oe):ae;++fe<c;)we=o[fe].call(this,we);return we}})}function ou(s,o,c,p,E,C,K,H,Q,oe){var ae=o&y,fe=o&k,we=o&Y,Ne=o&(ie|W),ze=o&he,ft=we?t:$o(s);function He(){for(var dt=arguments.length,yt=re(dt),nn=dt;nn--;)yt[nn]=arguments[nn];if(Ne)var jr=Vs(He),sn=Qy(yt,jr);if(p&&(yt=hd(yt,p,E,Ne)),C&&(yt=ld(yt,C,K,Ne)),dt-=sn,Ne&&dt<oe){var ur=Li(yt,jr);return _d(s,o,ou,He.placeholder,c,yt,ur,H,Q,oe-dt)}var Fn=fe?c:this,pi=we?Fn[s]:s;return dt=yt.length,H?yt=a_(yt,H):ze&&dt>1&&yt.reverse(),ae&&Q<dt&&(yt.length=Q),this&&this!==mt&&this instanceof He&&(pi=ft||$o(pi)),pi.apply(Fn,yt)}return He}function yd(s,o){return function(c,p){return g1(c,s,o(p),{})}}function au(s,o){return function(c,p){var E;if(c===t&&p===t)return o;if(c!==t&&(E=c),p!==t){if(E===t)return p;typeof c=="string"||typeof p=="string"?(c=tn(c),p=tn(p)):(c=nd(c),p=nd(p)),E=s(c,p)}return E}}function yf(s){return fi(function(o){return o=tr(o,en(Ue())),ht(function(c){var p=this;return s(o,function(E){return yr(E,p,c)})})})}function uu(s,o){o=o===t?" ":tn(o);var c=o.length;if(c<2)return c?hf(o,s):o;var p=hf(o,Va(s/js(o)));return qs(o)?$i(Nn(p),0,s).join(""):p.slice(0,s)}function K1(s,o,c,p){var E=o&k,C=$o(s);function K(){for(var H=-1,Q=arguments.length,oe=-1,ae=p.length,fe=re(ae+Q),we=this&&this!==mt&&this instanceof K?C:s;++oe<ae;)fe[oe]=p[oe];for(;Q--;)fe[oe++]=arguments[++H];return yr(we,E?c:this,fe)}return K}function wd(s){return function(o,c,p){return p&&typeof p!="number"&&qr(o,c,p)&&(c=p=t),o=di(o),c===t?(c=o,o=0):c=di(c),p=p===t?o<c?1:-1:di(p),O1(o,c,p,s)}}function cu(s){return function(o,c){return typeof o=="string"&&typeof c=="string"||(o=xn(o),c=xn(c)),s(o,c)}}function _d(s,o,c,p,E,C,K,H,Q,oe){var ae=o&ie,fe=ae?K:t,we=ae?t:K,Ne=ae?C:t,ze=ae?t:C;o|=ae?Z:V,o&=~(ae?V:Z),o&te||(o&=-4);var ft=[s,o,E,Ne,fe,ze,we,H,Q,oe],He=c.apply(t,ft);return Af(s)&&Cd(He,ft),He.placeholder=p,Rd(He,s,o)}function wf(s){var o=pr[s];return function(c,p){if(c=xn(c),p=p==null?0:Cr(ct(p),292),p&&Rl(c)){var E=(Ot(c)+"e").split("e"),C=o(E[0]+"e"+(+E[1]+p));return E=(Ot(C)+"e").split("e"),+(E[0]+"e"+(+E[1]-p))}return o(c)}}var z1=zs&&1/Ua(new zs([,-0]))[1]==P?function(s){return new zs(s)}:Bf;function bd(s){return function(o){var c=Rr(o);return c==se?Vc(o):c==_e?ow(o):Zy(o,s(o))}}function ci(s,o,c,p,E,C,K,H){var Q=o&Y;if(!Q&&typeof s!="function")throw new yn(u);var oe=p?p.length:0;if(oe||(o&=-97,p=E=t),K=K===t?K:gr(ct(K),0),H=H===t?H:ct(H),oe-=E?E.length:0,o&V){var ae=p,fe=E;p=E=t}var we=Q?t:Ef(s),Ne=[s,o,c,p,E,ae,fe,C,K,H];if(we&&i_(Ne,we),s=Ne[0],o=Ne[1],c=Ne[2],p=Ne[3],E=Ne[4],H=Ne[9]=Ne[9]===t?Q?0:s.length:gr(Ne[9]-oe,0),!H&&o&(ie|W)&&(o&=-25),!o||o==k)var ze=j1(s,o,c);else o==ie||o==W?ze=B1(s,o,H):(o==Z||o==(k|Z))&&!E.length?ze=K1(s,o,c,p):ze=ou.apply(t,Ne);var ft=we?td:Cd;return Rd(ft(ze,Ne),s,o)}function Ed(s,o,c,p){return s===t||$n(s,Ks[c])&&!Lt.call(p,c)?o:s}function xd(s,o,c,p,E,C){return rr(s)&&rr(o)&&(C.set(o,s),ru(s,o,t,xd,C),C.delete(o)),s}function H1(s){return qo(s)?t:s}function Sd(s,o,c,p,E,C){var K=c&M,H=s.length,Q=o.length;if(H!=Q&&!(K&&Q>H))return!1;var oe=C.get(s),ae=C.get(o);if(oe&&ae)return oe==o&&ae==s;var fe=-1,we=!0,Ne=c&z?new us:t;for(C.set(s,o),C.set(o,s);++fe<H;){var ze=s[fe],ft=o[fe];if(p)var He=K?p(ft,ze,fe,o,s,C):p(ze,ft,fe,s,o,C);if(He!==t){if(He)continue;we=!1;break}if(Ne){if(!Kc(o,function(dt,yt){if(!Io(Ne,yt)&&(ze===dt||E(ze,dt,c,p,C)))return Ne.push(yt)})){we=!1;break}}else if(!(ze===ft||E(ze,ft,c,p,C))){we=!1;break}}return C.delete(s),C.delete(o),we}function k1(s,o,c,p,E,C,K){switch(c){case $e:if(s.byteLength!=o.byteLength||s.byteOffset!=o.byteOffset)return!1;s=s.buffer,o=o.buffer;case ye:return!(s.byteLength!=o.byteLength||!C(new Ha(s),new Ha(o)));case T:case F:case ve:return $n(+s,+o);case N:return s.name==o.name&&s.message==o.message;case Pe:case je:return s==o+"";case se:var H=Vc;case _e:var Q=p&M;if(H||(H=Ua),s.size!=o.size&&!Q)return!1;var oe=K.get(s);if(oe)return oe==o;p|=z,K.set(s,o);var ae=Sd(H(s),H(o),p,E,C,K);return K.delete(s),ae;case xe:if(Mo)return Mo.call(s)==Mo.call(o)}return!1}function W1(s,o,c,p,E,C){var K=c&M,H=_f(s),Q=H.length,oe=_f(o),ae=oe.length;if(Q!=ae&&!K)return!1;for(var fe=Q;fe--;){var we=H[fe];if(!(K?we in o:Lt.call(o,we)))return!1}var Ne=C.get(s),ze=C.get(o);if(Ne&&ze)return Ne==o&&ze==s;var ft=!0;C.set(s,o),C.set(o,s);for(var He=K;++fe<Q;){we=H[fe];var dt=s[we],yt=o[we];if(p)var nn=K?p(yt,dt,we,o,s,C):p(dt,yt,we,s,o,C);if(!(nn===t?dt===yt||E(dt,yt,c,p,C):nn)){ft=!1;break}He||(He=we=="constructor")}if(ft&&!He){var jr=s.constructor,sn=o.constructor;jr!=sn&&"constructor"in s&&"constructor"in o&&!(typeof jr=="function"&&jr instanceof jr&&typeof sn=="function"&&sn instanceof sn)&&(ft=!1)}return C.delete(s),C.delete(o),ft}function fi(s){return Pf(Md(s,t,qd),s+"")}function _f(s){return Hl(s,wr,Sf)}function bf(s){return Hl(s,Gr,Id)}var Ef=Ya?function(s){return Ya.get(s)}:Bf;function fu(s){for(var o=s.name+"",c=Hs[o],p=Lt.call(Hs,o)?c.length:0;p--;){var E=c[p],C=E.func;if(C==null||C==s)return E.name}return o}function Vs(s){var o=Lt.call(D,"placeholder")?D:s;return o.placeholder}function Ue(){var s=D.iteratee||qf;return s=s===qf?Gl:s,arguments.length?s(arguments[0],arguments[1]):s}function hu(s,o){var c=s.__data__;return e_(o)?c[typeof o=="string"?"string":"hash"]:c.map}function xf(s){for(var o=wr(s),c=o.length;c--;){var p=o[c],E=s[p];o[c]=[p,E,Pd(E)]}return o}function hs(s,o){var c=nw(s,o);return Wl(c)?c:t}function G1(s){var o=Lt.call(s,os),c=s[os];try{s[os]=t;var p=!0}catch{}var E=Ka.call(s);return p&&(o?s[os]=c:delete s[os]),E}var Sf=Yc?function(s){return s==null?[]:(s=Jt(s),Di(Yc(s),function(o){return Ll.call(s,o)}))}:Kf,Id=Yc?function(s){for(var o=[];s;)Mi(o,Sf(s)),s=ka(s);return o}:Kf,Rr=Ur;(Xc&&Rr(new Xc(new ArrayBuffer(1)))!=$e||Oo&&Rr(new Oo)!=se||Zc&&Rr(Zc.resolve())!=qe||zs&&Rr(new zs)!=_e||Po&&Rr(new Po)!=Te)&&(Rr=function(s){var o=Ur(s),c=o==Ae?s.constructor:t,p=c?ls(c):"";if(p)switch(p){case Dw:return $e;case Mw:return se;case Lw:return qe;case Cw:return _e;case Rw:return Te}return o});function V1(s,o,c){for(var p=-1,E=c.length;++p<E;){var C=c[p],K=C.size;switch(C.type){case"drop":s+=K;break;case"dropRight":o-=K;break;case"take":o=Cr(o,s+K);break;case"takeRight":s=gr(s,o-K);break}}return{start:s,end:o}}function J1(s){var o=s.match(Fe);return o?o[1].split(Qe):[]}function Ad(s,o,c){o=Ti(o,s);for(var p=-1,E=o.length,C=!1;++p<E;){var K=Xn(o[p]);if(!(C=s!=null&&c(s,K)))break;s=s[K]}return C||++p!=E?C:(E=s==null?0:s.length,!!E&&yu(E)&&hi(K,E)&&(it(s)||ds(s)))}function Y1(s){var o=s.length,c=new s.constructor(o);return o&&typeof s[0]=="string"&&Lt.call(s,"index")&&(c.index=s.index,c.input=s.input),c}function Od(s){return typeof s.constructor=="function"&&!Fo(s)?ks(ka(s)):{}}function X1(s,o,c){var p=s.constructor;switch(o){case ye:return mf(s);case T:case F:return new p(+s);case $e:return N1(s,c);case Me:case be:case tt:case Le:case Re:case st:case Ce:case at:case nr:return cd(s,c);case se:return new p;case ve:case je:return new p(s);case Pe:return T1(s);case _e:return new p;case xe:return $1(s)}}function Z1(s,o){var c=o.length;if(!c)return s;var p=c-1;return o[p]=(c>1?"& ":"")+o[p],o=o.join(c>2?", ":" "),s.replace(At,`{
/* [wrapped with `+o+`] */
`)}function Q1(s){return it(s)||ds(s)||!!(Cl&&s&&s[Cl])}function hi(s,o){var c=typeof s;return o=o??A,!!o&&(c=="number"||c!="symbol"&&gn.test(s))&&s>-1&&s%1==0&&s<o}function qr(s,o,c){if(!rr(c))return!1;var p=typeof o;return(p=="number"?Wr(c)&&hi(o,c.length):p=="string"&&o in c)?$n(c[o],s):!1}function If(s,o){if(it(s))return!1;var c=typeof s;return c=="number"||c=="symbol"||c=="boolean"||s==null||rn(s)?!0:Rt.test(s)||!Ke.test(s)||o!=null&&s in Jt(o)}function e_(s){var o=typeof s;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?s!=="__proto__":s===null}function Af(s){var o=fu(s),c=D[o];if(typeof c!="function"||!(o in vt.prototype))return!1;if(s===c)return!0;var p=Ef(c);return!!p&&s===p[0]}function t_(s){return!!Pl&&Pl in s}var r_=ja?li:zf;function Fo(s){var o=s&&s.constructor,c=typeof o=="function"&&o.prototype||Ks;return s===c}function Pd(s){return s===s&&!rr(s)}function Dd(s,o){return function(c){return c==null?!1:c[s]===o&&(o!==t||s in Jt(c))}}function n_(s){var o=vu(s,function(p){return c.size===l&&c.clear(),p}),c=o.cache;return o}function i_(s,o){var c=s[1],p=o[1],E=c|p,C=E<(k|Y|y),K=p==y&&c==ie||p==y&&c==B&&s[7].length<=o[8]||p==(y|B)&&o[7].length<=o[8]&&c==ie;if(!(C||K))return s;p&k&&(s[2]=o[2],E|=c&k?0:te);var H=o[3];if(H){var Q=s[3];s[3]=Q?hd(Q,H,o[4]):H,s[4]=Q?Li(s[3],w):o[4]}return H=o[5],H&&(Q=s[5],s[5]=Q?ld(Q,H,o[6]):H,s[6]=Q?Li(s[5],w):o[6]),H=o[7],H&&(s[7]=H),p&y&&(s[8]=s[8]==null?o[8]:Cr(s[8],o[8])),s[9]==null&&(s[9]=o[9]),s[0]=o[0],s[1]=E,s}function s_(s){var o=[];if(s!=null)for(var c in Jt(s))o.push(c);return o}function o_(s){return Ka.call(s)}function Md(s,o,c){return o=gr(o===t?s.length-1:o,0),function(){for(var p=arguments,E=-1,C=gr(p.length-o,0),K=re(C);++E<C;)K[E]=p[o+E];E=-1;for(var H=re(o+1);++E<o;)H[E]=p[E];return H[o]=c(K),yr(s,this,H)}}function Ld(s,o){return o.length<2?s:fs(s,bn(o,0,-1))}function a_(s,o){for(var c=s.length,p=Cr(o.length,c),E=kr(s);p--;){var C=o[p];s[p]=hi(C,c)?E[C]:t}return s}function Of(s,o){if(!(o==="constructor"&&typeof s[o]=="function")&&o!="__proto__")return s[o]}var Cd=Nd(td),Uo=Ew||function(s,o){return mt.setTimeout(s,o)},Pf=Nd(M1);function Rd(s,o,c){var p=o+"";return Pf(s,Z1(p,u_(J1(p),c)))}function Nd(s){var o=0,c=0;return function(){var p=Aw(),E=$-(p-c);if(c=p,E>0){if(++o>=Ee)return arguments[0]}else o=0;return s.apply(t,arguments)}}function lu(s,o){var c=-1,p=s.length,E=p-1;for(o=o===t?p:o;++c<o;){var C=ff(c,E),K=s[C];s[C]=s[c],s[c]=K}return s.length=o,s}var Td=n_(function(s){var o=[];return s.charCodeAt(0)===46&&o.push(""),s.replace(Ze,function(c,p,E,C){o.push(E?C.replace(Dt,"$1"):p||c)}),o});function Xn(s){if(typeof s=="string"||rn(s))return s;var o=s+"";return o=="0"&&1/s==-1/0?"-0":o}function ls(s){if(s!=null){try{return Ba.call(s)}catch{}try{return s+""}catch{}}return""}function u_(s,o){return mn(ce,function(c){var p="_."+c[0];o&c[1]&&!$a(s,p)&&s.push(p)}),s.sort()}function $d(s){if(s instanceof vt)return s.clone();var o=new wn(s.__wrapped__,s.__chain__);return o.__actions__=kr(s.__actions__),o.__index__=s.__index__,o.__values__=s.__values__,o}function c_(s,o,c){(c?qr(s,o,c):o===t)?o=1:o=gr(ct(o),0);var p=s==null?0:s.length;if(!p||o<1)return[];for(var E=0,C=0,K=re(Va(p/o));E<p;)K[C++]=bn(s,E,E+=o);return K}function f_(s){for(var o=-1,c=s==null?0:s.length,p=0,E=[];++o<c;){var C=s[o];C&&(E[p++]=C)}return E}function h_(){var s=arguments.length;if(!s)return[];for(var o=re(s-1),c=arguments[0],p=s;p--;)o[p-1]=arguments[p];return Mi(it(c)?kr(c):[c],Or(o,1))}var l_=ht(function(s,o){return ar(s)?Co(s,Or(o,1,ar,!0)):[]}),d_=ht(function(s,o){var c=En(o);return ar(c)&&(c=t),ar(s)?Co(s,Or(o,1,ar,!0),Ue(c,2)):[]}),p_=ht(function(s,o){var c=En(o);return ar(c)&&(c=t),ar(s)?Co(s,Or(o,1,ar,!0),t,c):[]});function g_(s,o,c){var p=s==null?0:s.length;return p?(o=c||o===t?1:ct(o),bn(s,o<0?0:o,p)):[]}function v_(s,o,c){var p=s==null?0:s.length;return p?(o=c||o===t?1:ct(o),o=p-o,bn(s,0,o<0?0:o)):[]}function m_(s,o){return s&&s.length?iu(s,Ue(o,3),!0,!0):[]}function y_(s,o){return s&&s.length?iu(s,Ue(o,3),!0):[]}function w_(s,o,c,p){var E=s==null?0:s.length;return E?(c&&typeof c!="number"&&qr(s,o,c)&&(c=0,p=E),h1(s,o,c,p)):[]}function Fd(s,o,c){var p=s==null?0:s.length;if(!p)return-1;var E=c==null?0:ct(c);return E<0&&(E=gr(p+E,0)),Fa(s,Ue(o,3),E)}function Ud(s,o,c){var p=s==null?0:s.length;if(!p)return-1;var E=p-1;return c!==t&&(E=ct(c),E=c<0?gr(p+E,0):Cr(E,p-1)),Fa(s,Ue(o,3),E,!0)}function qd(s){var o=s==null?0:s.length;return o?Or(s,1):[]}function __(s){var o=s==null?0:s.length;return o?Or(s,P):[]}function b_(s,o){var c=s==null?0:s.length;return c?(o=o===t?1:ct(o),Or(s,o)):[]}function E_(s){for(var o=-1,c=s==null?0:s.length,p={};++o<c;){var E=s[o];p[E[0]]=E[1]}return p}function jd(s){return s&&s.length?s[0]:t}function x_(s,o,c){var p=s==null?0:s.length;if(!p)return-1;var E=c==null?0:ct(c);return E<0&&(E=gr(p+E,0)),Us(s,o,E)}function S_(s){var o=s==null?0:s.length;return o?bn(s,0,-1):[]}var I_=ht(function(s){var o=tr(s,gf);return o.length&&o[0]===s[0]?sf(o):[]}),A_=ht(function(s){var o=En(s),c=tr(s,gf);return o===En(c)?o=t:c.pop(),c.length&&c[0]===s[0]?sf(c,Ue(o,2)):[]}),O_=ht(function(s){var o=En(s),c=tr(s,gf);return o=typeof o=="function"?o:t,o&&c.pop(),c.length&&c[0]===s[0]?sf(c,t,o):[]});function P_(s,o){return s==null?"":Sw.call(s,o)}function En(s){var o=s==null?0:s.length;return o?s[o-1]:t}function D_(s,o,c){var p=s==null?0:s.length;if(!p)return-1;var E=p;return c!==t&&(E=ct(c),E=E<0?gr(p+E,0):Cr(E,p-1)),o===o?uw(s,o,E):Fa(s,_l,E,!0)}function M_(s,o){return s&&s.length?Xl(s,ct(o)):t}var L_=ht(Bd);function Bd(s,o){return s&&s.length&&o&&o.length?cf(s,o):s}function C_(s,o,c){return s&&s.length&&o&&o.length?cf(s,o,Ue(c,2)):s}function R_(s,o,c){return s&&s.length&&o&&o.length?cf(s,o,t,c):s}var N_=fi(function(s,o){var c=s==null?0:s.length,p=ef(s,o);return ed(s,tr(o,function(E){return hi(E,c)?+E:E}).sort(fd)),p});function T_(s,o){var c=[];if(!(s&&s.length))return c;var p=-1,E=[],C=s.length;for(o=Ue(o,3);++p<C;){var K=s[p];o(K,p,s)&&(c.push(K),E.push(p))}return ed(s,E),c}function Df(s){return s==null?s:Pw.call(s)}function $_(s,o,c){var p=s==null?0:s.length;return p?(c&&typeof c!="number"&&qr(s,o,c)?(o=0,c=p):(o=o==null?0:ct(o),c=c===t?p:ct(c)),bn(s,o,c)):[]}function F_(s,o){return nu(s,o)}function U_(s,o,c){return lf(s,o,Ue(c,2))}function q_(s,o){var c=s==null?0:s.length;if(c){var p=nu(s,o);if(p<c&&$n(s[p],o))return p}return-1}function j_(s,o){return nu(s,o,!0)}function B_(s,o,c){return lf(s,o,Ue(c,2),!0)}function K_(s,o){var c=s==null?0:s.length;if(c){var p=nu(s,o,!0)-1;if($n(s[p],o))return p}return-1}function z_(s){return s&&s.length?rd(s):[]}function H_(s,o){return s&&s.length?rd(s,Ue(o,2)):[]}function k_(s){var o=s==null?0:s.length;return o?bn(s,1,o):[]}function W_(s,o,c){return s&&s.length?(o=c||o===t?1:ct(o),bn(s,0,o<0?0:o)):[]}function G_(s,o,c){var p=s==null?0:s.length;return p?(o=c||o===t?1:ct(o),o=p-o,bn(s,o<0?0:o,p)):[]}function V_(s,o){return s&&s.length?iu(s,Ue(o,3),!1,!0):[]}function J_(s,o){return s&&s.length?iu(s,Ue(o,3)):[]}var Y_=ht(function(s){return Ni(Or(s,1,ar,!0))}),X_=ht(function(s){var o=En(s);return ar(o)&&(o=t),Ni(Or(s,1,ar,!0),Ue(o,2))}),Z_=ht(function(s){var o=En(s);return o=typeof o=="function"?o:t,Ni(Or(s,1,ar,!0),t,o)});function Q_(s){return s&&s.length?Ni(s):[]}function eb(s,o){return s&&s.length?Ni(s,Ue(o,2)):[]}function tb(s,o){return o=typeof o=="function"?o:t,s&&s.length?Ni(s,t,o):[]}function Mf(s){if(!(s&&s.length))return[];var o=0;return s=Di(s,function(c){if(ar(c))return o=gr(c.length,o),!0}),Wc(o,function(c){return tr(s,zc(c))})}function Kd(s,o){if(!(s&&s.length))return[];var c=Mf(s);return o==null?c:tr(c,function(p){return yr(o,t,p)})}var rb=ht(function(s,o){return ar(s)?Co(s,o):[]}),nb=ht(function(s){return pf(Di(s,ar))}),ib=ht(function(s){var o=En(s);return ar(o)&&(o=t),pf(Di(s,ar),Ue(o,2))}),sb=ht(function(s){var o=En(s);return o=typeof o=="function"?o:t,pf(Di(s,ar),t,o)}),ob=ht(Mf);function ab(s,o){return od(s||[],o||[],Lo)}function ub(s,o){return od(s||[],o||[],To)}var cb=ht(function(s){var o=s.length,c=o>1?s[o-1]:t;return c=typeof c=="function"?(s.pop(),c):t,Kd(s,c)});function zd(s){var o=D(s);return o.__chain__=!0,o}function fb(s,o){return o(s),s}function du(s,o){return o(s)}var hb=fi(function(s){var o=s.length,c=o?s[0]:0,p=this.__wrapped__,E=function(C){return ef(C,s)};return o>1||this.__actions__.length||!(p instanceof vt)||!hi(c)?this.thru(E):(p=p.slice(c,+c+(o?1:0)),p.__actions__.push({func:du,args:[E],thisArg:t}),new wn(p,this.__chain__).thru(function(C){return o&&!C.length&&C.push(t),C}))});function lb(){return zd(this)}function db(){return new wn(this.value(),this.__chain__)}function pb(){this.__values__===t&&(this.__values__=np(this.value()));var s=this.__index__>=this.__values__.length,o=s?t:this.__values__[this.__index__++];return{done:s,value:o}}function gb(){return this}function vb(s){for(var o,c=this;c instanceof Za;){var p=$d(c);p.__index__=0,p.__values__=t,o?E.__wrapped__=p:o=p;var E=p;c=c.__wrapped__}return E.__wrapped__=s,o}function mb(){var s=this.__wrapped__;if(s instanceof vt){var o=s;return this.__actions__.length&&(o=new vt(this)),o=o.reverse(),o.__actions__.push({func:du,args:[Df],thisArg:t}),new wn(o,this.__chain__)}return this.thru(Df)}function yb(){return sd(this.__wrapped__,this.__actions__)}var wb=su(function(s,o,c){Lt.call(s,c)?++s[c]:ui(s,c,1)});function _b(s,o,c){var p=it(s)?yl:f1;return c&&qr(s,o,c)&&(o=t),p(s,Ue(o,3))}function bb(s,o){var c=it(s)?Di:Kl;return c(s,Ue(o,3))}var Eb=vd(Fd),xb=vd(Ud);function Sb(s,o){return Or(pu(s,o),1)}function Ib(s,o){return Or(pu(s,o),P)}function Ab(s,o,c){return c=c===t?1:ct(c),Or(pu(s,o),c)}function Hd(s,o){var c=it(s)?mn:Ri;return c(s,Ue(o,3))}function kd(s,o){var c=it(s)?ky:Bl;return c(s,Ue(o,3))}var Ob=su(function(s,o,c){Lt.call(s,c)?s[c].push(o):ui(s,c,[o])});function Pb(s,o,c,p){s=Wr(s)?s:Ys(s),c=c&&!p?ct(c):0;var E=s.length;return c<0&&(c=gr(E+c,0)),wu(s)?c<=E&&s.indexOf(o,c)>-1:!!E&&Us(s,o,c)>-1}var Db=ht(function(s,o,c){var p=-1,E=typeof o=="function",C=Wr(s)?re(s.length):[];return Ri(s,function(K){C[++p]=E?yr(o,K,c):Ro(K,o,c)}),C}),Mb=su(function(s,o,c){ui(s,c,o)});function pu(s,o){var c=it(s)?tr:Vl;return c(s,Ue(o,3))}function Lb(s,o,c,p){return s==null?[]:(it(o)||(o=o==null?[]:[o]),c=p?t:c,it(c)||(c=c==null?[]:[c]),Zl(s,o,c))}var Cb=su(function(s,o,c){s[c?0:1].push(o)},function(){return[[],[]]});function Rb(s,o,c){var p=it(s)?Bc:El,E=arguments.length<3;return p(s,Ue(o,4),c,E,Ri)}function Nb(s,o,c){var p=it(s)?Wy:El,E=arguments.length<3;return p(s,Ue(o,4),c,E,Bl)}function Tb(s,o){var c=it(s)?Di:Kl;return c(s,mu(Ue(o,3)))}function $b(s){var o=it(s)?Fl:P1;return o(s)}function Fb(s,o,c){(c?qr(s,o,c):o===t)?o=1:o=ct(o);var p=it(s)?s1:D1;return p(s,o)}function Ub(s){var o=it(s)?o1:L1;return o(s)}function qb(s){if(s==null)return 0;if(Wr(s))return wu(s)?js(s):s.length;var o=Rr(s);return o==se||o==_e?s.size:af(s).length}function jb(s,o,c){var p=it(s)?Kc:C1;return c&&qr(s,o,c)&&(o=t),p(s,Ue(o,3))}var Bb=ht(function(s,o){if(s==null)return[];var c=o.length;return c>1&&qr(s,o[0],o[1])?o=[]:c>2&&qr(o[0],o[1],o[2])&&(o=[o[0]]),Zl(s,Or(o,1),[])}),gu=bw||function(){return mt.Date.now()};function Kb(s,o){if(typeof o!="function")throw new yn(u);return s=ct(s),function(){if(--s<1)return o.apply(this,arguments)}}function Wd(s,o,c){return o=c?t:o,o=s&&o==null?s.length:o,ci(s,y,t,t,t,t,o)}function Gd(s,o){var c;if(typeof o!="function")throw new yn(u);return s=ct(s),function(){return--s>0&&(c=o.apply(this,arguments)),s<=1&&(o=t),c}}var Lf=ht(function(s,o,c){var p=k;if(c.length){var E=Li(c,Vs(Lf));p|=Z}return ci(s,p,o,c,E)}),Vd=ht(function(s,o,c){var p=k|Y;if(c.length){var E=Li(c,Vs(Vd));p|=Z}return ci(o,p,s,c,E)});function Jd(s,o,c){o=c?t:o;var p=ci(s,ie,t,t,t,t,t,o);return p.placeholder=Jd.placeholder,p}function Yd(s,o,c){o=c?t:o;var p=ci(s,W,t,t,t,t,t,o);return p.placeholder=Yd.placeholder,p}function Xd(s,o,c){var p,E,C,K,H,Q,oe=0,ae=!1,fe=!1,we=!0;if(typeof s!="function")throw new yn(u);o=xn(o)||0,rr(c)&&(ae=!!c.leading,fe="maxWait"in c,C=fe?gr(xn(c.maxWait)||0,o):C,we="trailing"in c?!!c.trailing:we);function Ne(ur){var Fn=p,pi=E;return p=E=t,oe=ur,K=s.apply(pi,Fn),K}function ze(ur){return oe=ur,H=Uo(dt,o),ae?Ne(ur):K}function ft(ur){var Fn=ur-Q,pi=ur-oe,vp=o-Fn;return fe?Cr(vp,C-pi):vp}function He(ur){var Fn=ur-Q,pi=ur-oe;return Q===t||Fn>=o||Fn<0||fe&&pi>=C}function dt(){var ur=gu();if(He(ur))return yt(ur);H=Uo(dt,ft(ur))}function yt(ur){return H=t,we&&p?Ne(ur):(p=E=t,K)}function nn(){H!==t&&ad(H),oe=0,p=Q=E=H=t}function jr(){return H===t?K:yt(gu())}function sn(){var ur=gu(),Fn=He(ur);if(p=arguments,E=this,Q=ur,Fn){if(H===t)return ze(Q);if(fe)return ad(H),H=Uo(dt,o),Ne(Q)}return H===t&&(H=Uo(dt,o)),K}return sn.cancel=nn,sn.flush=jr,sn}var zb=ht(function(s,o){return jl(s,1,o)}),Hb=ht(function(s,o,c){return jl(s,xn(o)||0,c)});function kb(s){return ci(s,he)}function vu(s,o){if(typeof s!="function"||o!=null&&typeof o!="function")throw new yn(u);var c=function(){var p=arguments,E=o?o.apply(this,p):p[0],C=c.cache;if(C.has(E))return C.get(E);var K=s.apply(this,p);return c.cache=C.set(E,K)||C,K};return c.cache=new(vu.Cache||ai),c}vu.Cache=ai;function mu(s){if(typeof s!="function")throw new yn(u);return function(){var o=arguments;switch(o.length){case 0:return!s.call(this);case 1:return!s.call(this,o[0]);case 2:return!s.call(this,o[0],o[1]);case 3:return!s.call(this,o[0],o[1],o[2])}return!s.apply(this,o)}}function Wb(s){return Gd(2,s)}var Gb=R1(function(s,o){o=o.length==1&&it(o[0])?tr(o[0],en(Ue())):tr(Or(o,1),en(Ue()));var c=o.length;return ht(function(p){for(var E=-1,C=Cr(p.length,c);++E<C;)p[E]=o[E].call(this,p[E]);return yr(s,this,p)})}),Cf=ht(function(s,o){var c=Li(o,Vs(Cf));return ci(s,Z,t,o,c)}),Zd=ht(function(s,o){var c=Li(o,Vs(Zd));return ci(s,V,t,o,c)}),Vb=fi(function(s,o){return ci(s,B,t,t,t,o)});function Jb(s,o){if(typeof s!="function")throw new yn(u);return o=o===t?o:ct(o),ht(s,o)}function Yb(s,o){if(typeof s!="function")throw new yn(u);return o=o==null?0:gr(ct(o),0),ht(function(c){var p=c[o],E=$i(c,0,o);return p&&Mi(E,p),yr(s,this,E)})}function Xb(s,o,c){var p=!0,E=!0;if(typeof s!="function")throw new yn(u);return rr(c)&&(p="leading"in c?!!c.leading:p,E="trailing"in c?!!c.trailing:E),Xd(s,o,{leading:p,maxWait:o,trailing:E})}function Zb(s){return Wd(s,1)}function Qb(s,o){return Cf(vf(o),s)}function eE(){if(!arguments.length)return[];var s=arguments[0];return it(s)?s:[s]}function tE(s){return _n(s,I)}function rE(s,o){return o=typeof o=="function"?o:t,_n(s,I,o)}function nE(s){return _n(s,b|I)}function iE(s,o){return o=typeof o=="function"?o:t,_n(s,b|I,o)}function sE(s,o){return o==null||ql(s,o,wr(o))}function $n(s,o){return s===o||s!==s&&o!==o}var oE=cu(nf),aE=cu(function(s,o){return s>=o}),ds=kl(function(){return arguments}())?kl:function(s){return ir(s)&&Lt.call(s,"callee")&&!Ll.call(s,"callee")},it=re.isArray,uE=Fr?en(Fr):v1;function Wr(s){return s!=null&&yu(s.length)&&!li(s)}function ar(s){return ir(s)&&Wr(s)}function cE(s){return s===!0||s===!1||ir(s)&&Ur(s)==T}var Fi=xw||zf,fE=Rn?en(Rn):m1;function hE(s){return ir(s)&&s.nodeType===1&&!qo(s)}function lE(s){if(s==null)return!0;if(Wr(s)&&(it(s)||typeof s=="string"||typeof s.splice=="function"||Fi(s)||Js(s)||ds(s)))return!s.length;var o=Rr(s);if(o==se||o==_e)return!s.size;if(Fo(s))return!af(s).length;for(var c in s)if(Lt.call(s,c))return!1;return!0}function dE(s,o){return No(s,o)}function pE(s,o,c){c=typeof c=="function"?c:t;var p=c?c(s,o):t;return p===t?No(s,o,t,c):!!p}function Rf(s){if(!ir(s))return!1;var o=Ur(s);return o==N||o==g||typeof s.message=="string"&&typeof s.name=="string"&&!qo(s)}function gE(s){return typeof s=="number"&&Rl(s)}function li(s){if(!rr(s))return!1;var o=Ur(s);return o==ee||o==le||o==U||o==bt}function Qd(s){return typeof s=="number"&&s==ct(s)}function yu(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=A}function rr(s){var o=typeof s;return s!=null&&(o=="object"||o=="function")}function ir(s){return s!=null&&typeof s=="object"}var ep=vn?en(vn):w1;function vE(s,o){return s===o||of(s,o,xf(o))}function mE(s,o,c){return c=typeof c=="function"?c:t,of(s,o,xf(o),c)}function yE(s){return tp(s)&&s!=+s}function wE(s){if(r_(s))throw new rt(a);return Wl(s)}function _E(s){return s===null}function bE(s){return s==null}function tp(s){return typeof s=="number"||ir(s)&&Ur(s)==ve}function qo(s){if(!ir(s)||Ur(s)!=Ae)return!1;var o=ka(s);if(o===null)return!0;var c=Lt.call(o,"constructor")&&o.constructor;return typeof c=="function"&&c instanceof c&&Ba.call(c)==mw}var Nf=Vn?en(Vn):_1;function EE(s){return Qd(s)&&s>=-9007199254740991&&s<=A}var rp=So?en(So):b1;function wu(s){return typeof s=="string"||!it(s)&&ir(s)&&Ur(s)==je}function rn(s){return typeof s=="symbol"||ir(s)&&Ur(s)==xe}var Js=ss?en(ss):E1;function xE(s){return s===t}function SE(s){return ir(s)&&Rr(s)==Te}function IE(s){return ir(s)&&Ur(s)==Se}var AE=cu(uf),OE=cu(function(s,o){return s<=o});function np(s){if(!s)return[];if(Wr(s))return wu(s)?Nn(s):kr(s);if(Ao&&s[Ao])return sw(s[Ao]());var o=Rr(s),c=o==se?Vc:o==_e?Ua:Ys;return c(s)}function di(s){if(!s)return s===0?s:0;if(s=xn(s),s===P||s===-1/0){var o=s<0?-1:1;return o*R}return s===s?s:0}function ct(s){var o=di(s),c=o%1;return o===o?c?o-c:o:0}function ip(s){return s?cs(ct(s),0,O):0}function xn(s){if(typeof s=="number")return s;if(rn(s))return j;if(rr(s)){var o=typeof s.valueOf=="function"?s.valueOf():s;s=rr(o)?o+"":o}if(typeof s!="string")return s===0?s:+s;s=xl(s);var c=ln.test(s);return c||pn.test(s)?nt(s.slice(2),c?2:8):Mt.test(s)?j:+s}function sp(s){return Yn(s,Gr(s))}function PE(s){return s?cs(ct(s),-9007199254740991,A):s===0?s:0}function Ot(s){return s==null?"":tn(s)}var DE=Ws(function(s,o){if(Fo(o)||Wr(o)){Yn(o,wr(o),s);return}for(var c in o)Lt.call(o,c)&&Lo(s,c,o[c])}),op=Ws(function(s,o){Yn(o,Gr(o),s)}),_u=Ws(function(s,o,c,p){Yn(o,Gr(o),s,p)}),ME=Ws(function(s,o,c,p){Yn(o,wr(o),s,p)}),LE=fi(ef);function CE(s,o){var c=ks(s);return o==null?c:Ul(c,o)}var RE=ht(function(s,o){s=Jt(s);var c=-1,p=o.length,E=p>2?o[2]:t;for(E&&qr(o[0],o[1],E)&&(p=1);++c<p;)for(var C=o[c],K=Gr(C),H=-1,Q=K.length;++H<Q;){var oe=K[H],ae=s[oe];(ae===t||$n(ae,Ks[oe])&&!Lt.call(s,oe))&&(s[oe]=C[oe])}return s}),NE=ht(function(s){return s.push(t,xd),yr(ap,t,s)});function TE(s,o){return wl(s,Ue(o,3),Jn)}function $E(s,o){return wl(s,Ue(o,3),rf)}function FE(s,o){return s==null?s:tf(s,Ue(o,3),Gr)}function UE(s,o){return s==null?s:zl(s,Ue(o,3),Gr)}function qE(s,o){return s&&Jn(s,Ue(o,3))}function jE(s,o){return s&&rf(s,Ue(o,3))}function BE(s){return s==null?[]:tu(s,wr(s))}function KE(s){return s==null?[]:tu(s,Gr(s))}function Tf(s,o,c){var p=s==null?t:fs(s,o);return p===t?c:p}function zE(s,o){return s!=null&&Ad(s,o,l1)}function $f(s,o){return s!=null&&Ad(s,o,d1)}var HE=yd(function(s,o,c){o!=null&&typeof o.toString!="function"&&(o=Ka.call(o)),s[o]=c},Uf(Vr)),kE=yd(function(s,o,c){o!=null&&typeof o.toString!="function"&&(o=Ka.call(o)),Lt.call(s,o)?s[o].push(c):s[o]=[c]},Ue),WE=ht(Ro);function wr(s){return Wr(s)?$l(s):af(s)}function Gr(s){return Wr(s)?$l(s,!0):x1(s)}function GE(s,o){var c={};return o=Ue(o,3),Jn(s,function(p,E,C){ui(c,o(p,E,C),p)}),c}function VE(s,o){var c={};return o=Ue(o,3),Jn(s,function(p,E,C){ui(c,E,o(p,E,C))}),c}var JE=Ws(function(s,o,c){ru(s,o,c)}),ap=Ws(function(s,o,c,p){ru(s,o,c,p)}),YE=fi(function(s,o){var c={};if(s==null)return c;var p=!1;o=tr(o,function(C){return C=Ti(C,s),p||(p=C.length>1),C}),Yn(s,bf(s),c),p&&(c=_n(c,b|S|I,H1));for(var E=o.length;E--;)df(c,o[E]);return c});function XE(s,o){return up(s,mu(Ue(o)))}var ZE=fi(function(s,o){return s==null?{}:I1(s,o)});function up(s,o){if(s==null)return{};var c=tr(bf(s),function(p){return[p]});return o=Ue(o),Ql(s,c,function(p,E){return o(p,E[0])})}function QE(s,o,c){o=Ti(o,s);var p=-1,E=o.length;for(E||(E=1,s=t);++p<E;){var C=s==null?t:s[Xn(o[p])];C===t&&(p=E,C=c),s=li(C)?C.call(s):C}return s}function e2(s,o,c){return s==null?s:To(s,o,c)}function t2(s,o,c,p){return p=typeof p=="function"?p:t,s==null?s:To(s,o,c,p)}var cp=bd(wr),fp=bd(Gr);function r2(s,o,c){var p=it(s),E=p||Fi(s)||Js(s);if(o=Ue(o,4),c==null){var C=s&&s.constructor;E?c=p?new C:[]:rr(s)?c=li(C)?ks(ka(s)):{}:c={}}return(E?mn:Jn)(s,function(K,H,Q){return o(c,K,H,Q)}),c}function n2(s,o){return s==null?!0:df(s,o)}function i2(s,o,c){return s==null?s:id(s,o,vf(c))}function s2(s,o,c,p){return p=typeof p=="function"?p:t,s==null?s:id(s,o,vf(c),p)}function Ys(s){return s==null?[]:Gc(s,wr(s))}function o2(s){return s==null?[]:Gc(s,Gr(s))}function a2(s,o,c){return c===t&&(c=o,o=t),c!==t&&(c=xn(c),c=c===c?c:0),o!==t&&(o=xn(o),o=o===o?o:0),cs(xn(s),o,c)}function u2(s,o,c){return o=di(o),c===t?(c=o,o=0):c=di(c),s=xn(s),p1(s,o,c)}function c2(s,o,c){if(c&&typeof c!="boolean"&&qr(s,o,c)&&(o=c=t),c===t&&(typeof o=="boolean"?(c=o,o=t):typeof s=="boolean"&&(c=s,s=t)),s===t&&o===t?(s=0,o=1):(s=di(s),o===t?(o=s,s=0):o=di(o)),s>o){var p=s;s=o,o=p}if(c||s%1||o%1){var E=Nl();return Cr(s+E*(o-s+Gt("1e-"+((E+"").length-1))),o)}return ff(s,o)}var f2=Gs(function(s,o,c){return o=o.toLowerCase(),s+(c?hp(o):o)});function hp(s){return Ff(Ot(s).toLowerCase())}function lp(s){return s=Ot(s),s&&s.replace(mr,ew).replace(Uc,"")}function h2(s,o,c){s=Ot(s),o=tn(o);var p=s.length;c=c===t?p:cs(ct(c),0,p);var E=c;return c-=o.length,c>=0&&s.slice(c,E)==o}function l2(s){return s=Ot(s),s&&Be.test(s)?s.replace(_t,tw):s}function d2(s){return s=Ot(s),s&&Nt.test(s)?s.replace(Ge,"\\$&"):s}var p2=Gs(function(s,o,c){return s+(c?"-":"")+o.toLowerCase()}),g2=Gs(function(s,o,c){return s+(c?" ":"")+o.toLowerCase()}),v2=gd("toLowerCase");function m2(s,o,c){s=Ot(s),o=ct(o);var p=o?js(s):0;if(!o||p>=o)return s;var E=(o-p)/2;return uu(Ja(E),c)+s+uu(Va(E),c)}function y2(s,o,c){s=Ot(s),o=ct(o);var p=o?js(s):0;return o&&p<o?s+uu(o-p,c):s}function w2(s,o,c){s=Ot(s),o=ct(o);var p=o?js(s):0;return o&&p<o?uu(o-p,c)+s:s}function _2(s,o,c){return c||o==null?o=0:o&&(o=+o),Ow(Ot(s).replace(Ve,""),o||0)}function b2(s,o,c){return(c?qr(s,o,c):o===t)?o=1:o=ct(o),hf(Ot(s),o)}function E2(){var s=arguments,o=Ot(s[0]);return s.length<3?o:o.replace(s[1],s[2])}var x2=Gs(function(s,o,c){return s+(c?"_":"")+o.toLowerCase()});function S2(s,o,c){return c&&typeof c!="number"&&qr(s,o,c)&&(o=c=t),c=c===t?O:c>>>0,c?(s=Ot(s),s&&(typeof o=="string"||o!=null&&!Nf(o))&&(o=tn(o),!o&&qs(s))?$i(Nn(s),0,c):s.split(o,c)):[]}var I2=Gs(function(s,o,c){return s+(c?" ":"")+Ff(o)});function A2(s,o,c){return s=Ot(s),c=c==null?0:cs(ct(c),0,s.length),o=tn(o),s.slice(c,c+o.length)==o}function O2(s,o,c){var p=D.templateSettings;c&&qr(s,o,c)&&(o=t),s=Ot(s),o=_u({},o,p,Ed);var E=_u({},o.imports,p.imports,Ed),C=wr(E),K=Gc(E,C),H,Q,oe=0,ae=o.interpolate||Hn,fe="__p += '",we=Jc((o.escape||Hn).source+"|"+ae.source+"|"+(ae===ke?Cn:Hn).source+"|"+(o.evaluate||Hn).source+"|$","g"),Ne="//# sourceURL="+(Lt.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++qc+"]")+`
`;s.replace(we,function(He,dt,yt,nn,jr,sn){return yt||(yt=nn),fe+=s.slice(oe,sn).replace(Vi,rw),dt&&(H=!0,fe+=`' +
__e(`+dt+`) +
'`),jr&&(Q=!0,fe+=`';
`+jr+`;
__p += '`),yt&&(fe+=`' +
((__t = (`+yt+`)) == null ? '' : __t) +
'`),oe=sn+He.length,He}),fe+=`';
`;var ze=Lt.call(o,"variable")&&o.variable;if(!ze)fe=`with (obj) {
`+fe+`
}
`;else if(Pt.test(ze))throw new rt(f);fe=(Q?fe.replace(gt,""):fe).replace(ut,"$1").replace(Ar,"$1;"),fe="function("+(ze||"obj")+`) {
`+(ze?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(H?", __e = _.escape":"")+(Q?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+fe+`return __p
}`;var ft=pp(function(){return xt(C,Ne+"return "+fe).apply(t,K)});if(ft.source=fe,Rf(ft))throw ft;return ft}function P2(s){return Ot(s).toLowerCase()}function D2(s){return Ot(s).toUpperCase()}function M2(s,o,c){if(s=Ot(s),s&&(c||o===t))return xl(s);if(!s||!(o=tn(o)))return s;var p=Nn(s),E=Nn(o),C=Sl(p,E),K=Il(p,E)+1;return $i(p,C,K).join("")}function L2(s,o,c){if(s=Ot(s),s&&(c||o===t))return s.slice(0,Ol(s)+1);if(!s||!(o=tn(o)))return s;var p=Nn(s),E=Il(p,Nn(o))+1;return $i(p,0,E).join("")}function C2(s,o,c){if(s=Ot(s),s&&(c||o===t))return s.replace(Ve,"");if(!s||!(o=tn(o)))return s;var p=Nn(s),E=Sl(p,Nn(o));return $i(p,E).join("")}function R2(s,o){var c=de,p=pe;if(rr(o)){var E="separator"in o?o.separator:E;c="length"in o?ct(o.length):c,p="omission"in o?tn(o.omission):p}s=Ot(s);var C=s.length;if(qs(s)){var K=Nn(s);C=K.length}if(c>=C)return s;var H=c-js(p);if(H<1)return p;var Q=K?$i(K,0,H).join(""):s.slice(0,H);if(E===t)return Q+p;if(K&&(H+=Q.length-H),Nf(E)){if(s.slice(H).search(E)){var oe,ae=Q;for(E.global||(E=Jc(E.source,Ot(lt.exec(E))+"g")),E.lastIndex=0;oe=E.exec(ae);)var fe=oe.index;Q=Q.slice(0,fe===t?H:fe)}}else if(s.indexOf(tn(E),H)!=H){var we=Q.lastIndexOf(E);we>-1&&(Q=Q.slice(0,we))}return Q+p}function N2(s){return s=Ot(s),s&&St.test(s)?s.replace(wt,cw):s}var T2=Gs(function(s,o,c){return s+(c?" ":"")+o.toUpperCase()}),Ff=gd("toUpperCase");function dp(s,o,c){return s=Ot(s),o=c?t:o,o===t?iw(s)?lw(s):Jy(s):s.match(o)||[]}var pp=ht(function(s,o){try{return yr(s,t,o)}catch(c){return Rf(c)?c:new rt(c)}}),$2=fi(function(s,o){return mn(o,function(c){c=Xn(c),ui(s,c,Lf(s[c],s))}),s});function F2(s){var o=s==null?0:s.length,c=Ue();return s=o?tr(s,function(p){if(typeof p[1]!="function")throw new yn(u);return[c(p[0]),p[1]]}):[],ht(function(p){for(var E=-1;++E<o;){var C=s[E];if(yr(C[0],this,p))return yr(C[1],this,p)}})}function U2(s){return c1(_n(s,b))}function Uf(s){return function(){return s}}function q2(s,o){return s==null||s!==s?o:s}var j2=md(),B2=md(!0);function Vr(s){return s}function qf(s){return Gl(typeof s=="function"?s:_n(s,b))}function K2(s){return Jl(_n(s,b))}function z2(s,o){return Yl(s,_n(o,b))}var H2=ht(function(s,o){return function(c){return Ro(c,s,o)}}),k2=ht(function(s,o){return function(c){return Ro(s,c,o)}});function jf(s,o,c){var p=wr(o),E=tu(o,p);c==null&&!(rr(o)&&(E.length||!p.length))&&(c=o,o=s,s=this,E=tu(o,wr(o)));var C=!(rr(c)&&"chain"in c)||!!c.chain,K=li(s);return mn(E,function(H){var Q=o[H];s[H]=Q,K&&(s.prototype[H]=function(){var oe=this.__chain__;if(C||oe){var ae=s(this.__wrapped__),fe=ae.__actions__=kr(this.__actions__);return fe.push({func:Q,args:arguments,thisArg:s}),ae.__chain__=oe,ae}return Q.apply(s,Mi([this.value()],arguments))})}),s}function W2(){return mt._===this&&(mt._=yw),this}function Bf(){}function G2(s){return s=ct(s),ht(function(o){return Xl(o,s)})}var V2=yf(tr),J2=yf(yl),Y2=yf(Kc);function gp(s){return If(s)?zc(Xn(s)):A1(s)}function X2(s){return function(o){return s==null?t:fs(s,o)}}var Z2=wd(),Q2=wd(!0);function Kf(){return[]}function zf(){return!1}function ex(){return{}}function tx(){return""}function rx(){return!0}function nx(s,o){if(s=ct(s),s<1||s>A)return[];var c=O,p=Cr(s,O);o=Ue(o),s-=O;for(var E=Wc(p,o);++c<s;)o(c);return E}function ix(s){return it(s)?tr(s,Xn):rn(s)?[s]:kr(Td(Ot(s)))}function sx(s){var o=++vw;return Ot(s)+o}var ox=au(function(s,o){return s+o},0),ax=wf("ceil"),ux=au(function(s,o){return s/o},1),cx=wf("floor");function fx(s){return s&&s.length?eu(s,Vr,nf):t}function hx(s,o){return s&&s.length?eu(s,Ue(o,2),nf):t}function lx(s){return bl(s,Vr)}function dx(s,o){return bl(s,Ue(o,2))}function px(s){return s&&s.length?eu(s,Vr,uf):t}function gx(s,o){return s&&s.length?eu(s,Ue(o,2),uf):t}var vx=au(function(s,o){return s*o},1),mx=wf("round"),yx=au(function(s,o){return s-o},0);function wx(s){return s&&s.length?kc(s,Vr):0}function _x(s,o){return s&&s.length?kc(s,Ue(o,2)):0}return D.after=Kb,D.ary=Wd,D.assign=DE,D.assignIn=op,D.assignInWith=_u,D.assignWith=ME,D.at=LE,D.before=Gd,D.bind=Lf,D.bindAll=$2,D.bindKey=Vd,D.castArray=eE,D.chain=zd,D.chunk=c_,D.compact=f_,D.concat=h_,D.cond=F2,D.conforms=U2,D.constant=Uf,D.countBy=wb,D.create=CE,D.curry=Jd,D.curryRight=Yd,D.debounce=Xd,D.defaults=RE,D.defaultsDeep=NE,D.defer=zb,D.delay=Hb,D.difference=l_,D.differenceBy=d_,D.differenceWith=p_,D.drop=g_,D.dropRight=v_,D.dropRightWhile=m_,D.dropWhile=y_,D.fill=w_,D.filter=bb,D.flatMap=Sb,D.flatMapDeep=Ib,D.flatMapDepth=Ab,D.flatten=qd,D.flattenDeep=__,D.flattenDepth=b_,D.flip=kb,D.flow=j2,D.flowRight=B2,D.fromPairs=E_,D.functions=BE,D.functionsIn=KE,D.groupBy=Ob,D.initial=S_,D.intersection=I_,D.intersectionBy=A_,D.intersectionWith=O_,D.invert=HE,D.invertBy=kE,D.invokeMap=Db,D.iteratee=qf,D.keyBy=Mb,D.keys=wr,D.keysIn=Gr,D.map=pu,D.mapKeys=GE,D.mapValues=VE,D.matches=K2,D.matchesProperty=z2,D.memoize=vu,D.merge=JE,D.mergeWith=ap,D.method=H2,D.methodOf=k2,D.mixin=jf,D.negate=mu,D.nthArg=G2,D.omit=YE,D.omitBy=XE,D.once=Wb,D.orderBy=Lb,D.over=V2,D.overArgs=Gb,D.overEvery=J2,D.overSome=Y2,D.partial=Cf,D.partialRight=Zd,D.partition=Cb,D.pick=ZE,D.pickBy=up,D.property=gp,D.propertyOf=X2,D.pull=L_,D.pullAll=Bd,D.pullAllBy=C_,D.pullAllWith=R_,D.pullAt=N_,D.range=Z2,D.rangeRight=Q2,D.rearg=Vb,D.reject=Tb,D.remove=T_,D.rest=Jb,D.reverse=Df,D.sampleSize=Fb,D.set=e2,D.setWith=t2,D.shuffle=Ub,D.slice=$_,D.sortBy=Bb,D.sortedUniq=z_,D.sortedUniqBy=H_,D.split=S2,D.spread=Yb,D.tail=k_,D.take=W_,D.takeRight=G_,D.takeRightWhile=V_,D.takeWhile=J_,D.tap=fb,D.throttle=Xb,D.thru=du,D.toArray=np,D.toPairs=cp,D.toPairsIn=fp,D.toPath=ix,D.toPlainObject=sp,D.transform=r2,D.unary=Zb,D.union=Y_,D.unionBy=X_,D.unionWith=Z_,D.uniq=Q_,D.uniqBy=eb,D.uniqWith=tb,D.unset=n2,D.unzip=Mf,D.unzipWith=Kd,D.update=i2,D.updateWith=s2,D.values=Ys,D.valuesIn=o2,D.without=rb,D.words=dp,D.wrap=Qb,D.xor=nb,D.xorBy=ib,D.xorWith=sb,D.zip=ob,D.zipObject=ab,D.zipObjectDeep=ub,D.zipWith=cb,D.entries=cp,D.entriesIn=fp,D.extend=op,D.extendWith=_u,jf(D,D),D.add=ox,D.attempt=pp,D.camelCase=f2,D.capitalize=hp,D.ceil=ax,D.clamp=a2,D.clone=tE,D.cloneDeep=nE,D.cloneDeepWith=iE,D.cloneWith=rE,D.conformsTo=sE,D.deburr=lp,D.defaultTo=q2,D.divide=ux,D.endsWith=h2,D.eq=$n,D.escape=l2,D.escapeRegExp=d2,D.every=_b,D.find=Eb,D.findIndex=Fd,D.findKey=TE,D.findLast=xb,D.findLastIndex=Ud,D.findLastKey=$E,D.floor=cx,D.forEach=Hd,D.forEachRight=kd,D.forIn=FE,D.forInRight=UE,D.forOwn=qE,D.forOwnRight=jE,D.get=Tf,D.gt=oE,D.gte=aE,D.has=zE,D.hasIn=$f,D.head=jd,D.identity=Vr,D.includes=Pb,D.indexOf=x_,D.inRange=u2,D.invoke=WE,D.isArguments=ds,D.isArray=it,D.isArrayBuffer=uE,D.isArrayLike=Wr,D.isArrayLikeObject=ar,D.isBoolean=cE,D.isBuffer=Fi,D.isDate=fE,D.isElement=hE,D.isEmpty=lE,D.isEqual=dE,D.isEqualWith=pE,D.isError=Rf,D.isFinite=gE,D.isFunction=li,D.isInteger=Qd,D.isLength=yu,D.isMap=ep,D.isMatch=vE,D.isMatchWith=mE,D.isNaN=yE,D.isNative=wE,D.isNil=bE,D.isNull=_E,D.isNumber=tp,D.isObject=rr,D.isObjectLike=ir,D.isPlainObject=qo,D.isRegExp=Nf,D.isSafeInteger=EE,D.isSet=rp,D.isString=wu,D.isSymbol=rn,D.isTypedArray=Js,D.isUndefined=xE,D.isWeakMap=SE,D.isWeakSet=IE,D.join=P_,D.kebabCase=p2,D.last=En,D.lastIndexOf=D_,D.lowerCase=g2,D.lowerFirst=v2,D.lt=AE,D.lte=OE,D.max=fx,D.maxBy=hx,D.mean=lx,D.meanBy=dx,D.min=px,D.minBy=gx,D.stubArray=Kf,D.stubFalse=zf,D.stubObject=ex,D.stubString=tx,D.stubTrue=rx,D.multiply=vx,D.nth=M_,D.noConflict=W2,D.noop=Bf,D.now=gu,D.pad=m2,D.padEnd=y2,D.padStart=w2,D.parseInt=_2,D.random=c2,D.reduce=Rb,D.reduceRight=Nb,D.repeat=b2,D.replace=E2,D.result=QE,D.round=mx,D.runInContext=J,D.sample=$b,D.size=qb,D.snakeCase=x2,D.some=jb,D.sortedIndex=F_,D.sortedIndexBy=U_,D.sortedIndexOf=q_,D.sortedLastIndex=j_,D.sortedLastIndexBy=B_,D.sortedLastIndexOf=K_,D.startCase=I2,D.startsWith=A2,D.subtract=yx,D.sum=wx,D.sumBy=_x,D.template=O2,D.times=nx,D.toFinite=di,D.toInteger=ct,D.toLength=ip,D.toLower=P2,D.toNumber=xn,D.toSafeInteger=PE,D.toString=Ot,D.toUpper=D2,D.trim=M2,D.trimEnd=L2,D.trimStart=C2,D.truncate=R2,D.unescape=N2,D.uniqueId=sx,D.upperCase=T2,D.upperFirst=Ff,D.each=Hd,D.eachRight=kd,D.first=jd,jf(D,function(){var s={};return Jn(D,function(o,c){Lt.call(D.prototype,c)||(s[c]=o)}),s}(),{chain:!1}),D.VERSION=n,mn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){D[s].placeholder=D}),mn(["drop","take"],function(s,o){vt.prototype[s]=function(c){c=c===t?1:gr(ct(c),0);var p=this.__filtered__&&!o?new vt(this):this.clone();return p.__filtered__?p.__takeCount__=Cr(c,p.__takeCount__):p.__views__.push({size:Cr(c,O),type:s+(p.__dir__<0?"Right":"")}),p},vt.prototype[s+"Right"]=function(c){return this.reverse()[s](c).reverse()}}),mn(["filter","map","takeWhile"],function(s,o){var c=o+1,p=c==h||c==x;vt.prototype[s]=function(E){var C=this.clone();return C.__iteratees__.push({iteratee:Ue(E,3),type:c}),C.__filtered__=C.__filtered__||p,C}}),mn(["head","last"],function(s,o){var c="take"+(o?"Right":"");vt.prototype[s]=function(){return this[c](1).value()[0]}}),mn(["initial","tail"],function(s,o){var c="drop"+(o?"":"Right");vt.prototype[s]=function(){return this.__filtered__?new vt(this):this[c](1)}}),vt.prototype.compact=function(){return this.filter(Vr)},vt.prototype.find=function(s){return this.filter(s).head()},vt.prototype.findLast=function(s){return this.reverse().find(s)},vt.prototype.invokeMap=ht(function(s,o){return typeof s=="function"?new vt(this):this.map(function(c){return Ro(c,s,o)})}),vt.prototype.reject=function(s){return this.filter(mu(Ue(s)))},vt.prototype.slice=function(s,o){s=ct(s);var c=this;return c.__filtered__&&(s>0||o<0)?new vt(c):(s<0?c=c.takeRight(-s):s&&(c=c.drop(s)),o!==t&&(o=ct(o),c=o<0?c.dropRight(-o):c.take(o-s)),c)},vt.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},vt.prototype.toArray=function(){return this.take(O)},Jn(vt.prototype,function(s,o){var c=/^(?:filter|find|map|reject)|While$/.test(o),p=/^(?:head|last)$/.test(o),E=D[p?"take"+(o=="last"?"Right":""):o],C=p||/^find/.test(o);E&&(D.prototype[o]=function(){var K=this.__wrapped__,H=p?[1]:arguments,Q=K instanceof vt,oe=H[0],ae=Q||it(K),fe=function(dt){var yt=E.apply(D,Mi([dt],H));return p&&we?yt[0]:yt};ae&&c&&typeof oe=="function"&&oe.length!=1&&(Q=ae=!1);var we=this.__chain__,Ne=!!this.__actions__.length,ze=C&&!we,ft=Q&&!Ne;if(!C&&ae){K=ft?K:new vt(this);var He=s.apply(K,H);return He.__actions__.push({func:du,args:[fe],thisArg:t}),new wn(He,we)}return ze&&ft?s.apply(this,H):(He=this.thru(fe),ze?p?He.value()[0]:He.value():He)})}),mn(["pop","push","shift","sort","splice","unshift"],function(s){var o=qa[s],c=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",p=/^(?:pop|shift)$/.test(s);D.prototype[s]=function(){var E=arguments;if(p&&!this.__chain__){var C=this.value();return o.apply(it(C)?C:[],E)}return this[c](function(K){return o.apply(it(K)?K:[],E)})}}),Jn(vt.prototype,function(s,o){var c=D[o];if(c){var p=c.name+"";Lt.call(Hs,p)||(Hs[p]=[]),Hs[p].push({name:o,func:c})}}),Hs[ou(t,Y).name]=[{name:"wrapper",func:t}],vt.prototype.clone=Nw,vt.prototype.reverse=Tw,vt.prototype.value=$w,D.prototype.at=hb,D.prototype.chain=lb,D.prototype.commit=db,D.prototype.next=pb,D.prototype.plant=vb,D.prototype.reverse=mb,D.prototype.toJSON=D.prototype.valueOf=D.prototype.value=yb,D.prototype.first=D.prototype.head,Ao&&(D.prototype[Ao]=gb),D},Bs=dw();or?((or.exports=Bs)._=Bs,Vt._=Bs):mt._=Bs}).call(Pr)})(ac,ac.exports);var iC=ac.exports,gl={exports:{}},go=typeof Reflect=="object"?Reflect:null,Eg=go&&typeof go.apply=="function"?go.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},ku;go&&typeof go.ownKeys=="function"?ku=go.ownKeys:Object.getOwnPropertySymbols?ku=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ku=function(e){return Object.getOwnPropertyNames(e)};function sC(r){console&&console.warn&&console.warn(r)}var Sy=Number.isNaN||function(e){return e!==e};function Ht(){Ht.init.call(this)}gl.exports=Ht;gl.exports.once=cC;Ht.EventEmitter=Ht;Ht.prototype._events=void 0;Ht.prototype._eventsCount=0;Ht.prototype._maxListeners=void 0;var xg=10;function Cc(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Ht,"defaultMaxListeners",{enumerable:!0,get:function(){return xg},set:function(r){if(typeof r!="number"||r<0||Sy(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");xg=r}});Ht.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ht.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Sy(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Iy(r){return r._maxListeners===void 0?Ht.defaultMaxListeners:r._maxListeners}Ht.prototype.getMaxListeners=function(){return Iy(this)};Ht.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var f=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw f.context=u,f}var d=a[e];if(d===void 0)return!1;if(typeof d=="function")Eg(d,this,t);else for(var l=d.length,w=My(d,l),n=0;n<l;++n)Eg(w[n],this,t);return!0};function Ay(r,e,t,n){var i,a,u;if(Cc(t),a=r._events,a===void 0?(a=r._events=Object.create(null),r._eventsCount=0):(a.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),u=a[e]),u===void 0)u=a[e]=t,++r._eventsCount;else if(typeof u=="function"?u=a[e]=n?[t,u]:[u,t]:n?u.unshift(t):u.push(t),i=Iy(r),i>0&&u.length>i&&!u.warned){u.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=r,f.type=e,f.count=u.length,sC(f)}return r}Ht.prototype.addListener=function(e,t){return Ay(this,e,t,!1)};Ht.prototype.on=Ht.prototype.addListener;Ht.prototype.prependListener=function(e,t){return Ay(this,e,t,!0)};function oC(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Oy(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=oC.bind(n);return i.listener=t,n.wrapFn=i,i}Ht.prototype.once=function(e,t){return Cc(t),this.on(e,Oy(this,e,t)),this};Ht.prototype.prependOnceListener=function(e,t){return Cc(t),this.prependListener(e,Oy(this,e,t)),this};Ht.prototype.removeListener=function(e,t){var n,i,a,u,f;if(Cc(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(a=-1,u=n.length-1;u>=0;u--)if(n[u]===t||n[u].listener===t){f=n[u].listener,a=u;break}if(a<0)return this;a===0?n.shift():aC(n,a),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,f||t)}return this};Ht.prototype.off=Ht.prototype.removeListener;Ht.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),u;for(i=0;i<a.length;++i)u=a[i],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Py(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?uC(i):My(i,i.length)}Ht.prototype.listeners=function(e){return Py(this,e,!0)};Ht.prototype.rawListeners=function(e){return Py(this,e,!1)};Ht.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):Dy.call(r,e)};Ht.prototype.listenerCount=Dy;function Dy(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Ht.prototype.eventNames=function(){return this._eventsCount>0?ku(this._events):[]};function My(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function aC(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function uC(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function cC(r,e){return new Promise(function(t,n){function i(u){r.removeListener(e,a),n(u)}function a(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}Ly(r,e,a,{once:!0}),e!=="error"&&fC(r,i,{once:!0})})}function fC(r,e,t){typeof r.on=="function"&&Ly(r,"error",e,t)}function Ly(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(a){n.once&&r.removeEventListener(e,i),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var hC=gl.exports,lC=Object.defineProperty,dC=Object.defineProperties,pC=Object.getOwnPropertyDescriptors,Sg=Object.getOwnPropertySymbols,gC=Object.prototype.hasOwnProperty,vC=Object.prototype.propertyIsEnumerable,Ig=(r,e,t)=>e in r?lC(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ag=(r,e)=>{for(var t in e||(e={}))gC.call(e,t)&&Ig(r,t,e[t]);if(Sg)for(var t of Sg(e))vC.call(e,t)&&Ig(r,t,e[t]);return r},Og=(r,e)=>dC(r,pC(e));const mC={Accept:"application/json","Content-Type":"application/json"},yC="POST",Pg={headers:mC,method:yC},Dg=10;let zn=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new hC.EventEmitter,this.isAvailable=!1,this.registering=!1,!F0(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=xi(e),n=await(await mp(this.url,Og(Ag({},Pg),{body:t}))).json();this.onPayload({data:n})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!F0(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,i)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),i(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return i(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=xi({id:1,jsonrpc:"2.0",method:"test",params:[]});await mp(e,Og(Ag({},Pg),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?xs(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),i=n.message||n.toString(),a=Ic(e,i);this.events.emit("payload",a)}parseError(e,t=this.url){return Pm(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Dg&&this.events.setMaxListeners(Dg)}};var vl={exports:{}},vo=typeof Reflect=="object"?Reflect:null,Mg=vo&&typeof vo.apply=="function"?vo.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Wu;vo&&typeof vo.ownKeys=="function"?Wu=vo.ownKeys:Object.getOwnPropertySymbols?Wu=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Wu=function(e){return Object.getOwnPropertyNames(e)};function wC(r){console&&console.warn&&console.warn(r)}var Cy=Number.isNaN||function(e){return e!==e};function kt(){kt.init.call(this)}vl.exports=kt;vl.exports.once=xC;kt.EventEmitter=kt;kt.prototype._events=void 0;kt.prototype._eventsCount=0;kt.prototype._maxListeners=void 0;var Lg=10;function Rc(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(kt,"defaultMaxListeners",{enumerable:!0,get:function(){return Lg},set:function(r){if(typeof r!="number"||r<0||Cy(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Lg=r}});kt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};kt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Cy(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Ry(r){return r._maxListeners===void 0?kt.defaultMaxListeners:r._maxListeners}kt.prototype.getMaxListeners=function(){return Ry(this)};kt.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var f=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw f.context=u,f}var d=a[e];if(d===void 0)return!1;if(typeof d=="function")Mg(d,this,t);else for(var l=d.length,w=Uy(d,l),n=0;n<l;++n)Mg(w[n],this,t);return!0};function Ny(r,e,t,n){var i,a,u;if(Rc(t),a=r._events,a===void 0?(a=r._events=Object.create(null),r._eventsCount=0):(a.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),u=a[e]),u===void 0)u=a[e]=t,++r._eventsCount;else if(typeof u=="function"?u=a[e]=n?[t,u]:[u,t]:n?u.unshift(t):u.push(t),i=Ry(r),i>0&&u.length>i&&!u.warned){u.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=r,f.type=e,f.count=u.length,wC(f)}return r}kt.prototype.addListener=function(e,t){return Ny(this,e,t,!1)};kt.prototype.on=kt.prototype.addListener;kt.prototype.prependListener=function(e,t){return Ny(this,e,t,!0)};function _C(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ty(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=_C.bind(n);return i.listener=t,n.wrapFn=i,i}kt.prototype.once=function(e,t){return Rc(t),this.on(e,Ty(this,e,t)),this};kt.prototype.prependOnceListener=function(e,t){return Rc(t),this.prependListener(e,Ty(this,e,t)),this};kt.prototype.removeListener=function(e,t){var n,i,a,u,f;if(Rc(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(a=-1,u=n.length-1;u>=0;u--)if(n[u]===t||n[u].listener===t){f=n[u].listener,a=u;break}if(a<0)return this;a===0?n.shift():bC(n,a),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,f||t)}return this};kt.prototype.off=kt.prototype.removeListener;kt.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),u;for(i=0;i<a.length;++i)u=a[i],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function $y(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?EC(i):Uy(i,i.length)}kt.prototype.listeners=function(e){return $y(this,e,!0)};kt.prototype.rawListeners=function(e){return $y(this,e,!1)};kt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):Fy.call(r,e)};kt.prototype.listenerCount=Fy;function Fy(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}kt.prototype.eventNames=function(){return this._eventsCount>0?Wu(this._events):[]};function Uy(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function bC(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function EC(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function xC(r,e){return new Promise(function(t,n){function i(u){r.removeListener(e,a),n(u)}function a(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}qy(r,e,a,{once:!0}),e!=="error"&&SC(r,i,{once:!0})})}function SC(r,e,t){typeof r.on=="function"&&qy(r,"error",e,t)}function qy(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(a){n.once&&r.removeEventListener(e,i),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var IC=vl.exports;const AC=As(IC),Cg="error",OC="wss://relay.walletconnect.org",PC="wc",DC="universal_provider",Rg=`${PC}@2:${DC}:`,jy="https://rpc.walletconnect.org/v1/",ro="generic",MC=`${jy}bundler`,Ln={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var LC=Object.defineProperty,CC=Object.defineProperties,RC=Object.getOwnPropertyDescriptors,Ng=Object.getOwnPropertySymbols,NC=Object.prototype.hasOwnProperty,TC=Object.prototype.propertyIsEnumerable,Tg=(r,e,t)=>e in r?LC(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Iu=(r,e)=>{for(var t in e||(e={}))NC.call(e,t)&&Tg(r,t,e[t]);if(Ng)for(var t of Ng(e))TC.call(e,t)&&Tg(r,t,e[t]);return r},$C=(r,e)=>CC(r,RC(e));function cn(r,e,t){var n;const i=co(r);return((n=e.rpcMap)==null?void 0:n[i.reference])||`${jy}?chainId=${i.namespace}:${i.reference}&projectId=${t}`}function Rs(r){return r.includes(":")?r.split(":")[1]:r}function By(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function FC(r,e){const t=Object.keys(e.namespaces).filter(i=>i.includes(r));if(!t.length)return[];const n=[];return t.forEach(i=>{const a=e.namespaces[i].accounts;n.push(...a)}),n}function fh(r={},e={}){const t=$g(r),n=$g(e);return iC.merge(t,n)}function $g(r){var e,t,n,i;const a={};if(!oa(r))return a;for(const[u,f]of Object.entries(r)){const d=sl(u)?[u]:f.chains,l=f.methods||[],w=f.events||[],b=f.rpcMap||{},S=Xo(u);a[S]=$C(Iu(Iu({},a[S]),f),{chains:Fu(d,(e=a[S])==null?void 0:e.chains),methods:Fu(l,(t=a[S])==null?void 0:t.methods),events:Fu(w,(n=a[S])==null?void 0:n.events),rpcMap:Iu(Iu({},b),(i=a[S])==null?void 0:i.rpcMap)})}return a}function UC(r){return r.includes(":")?r.split(":")[2]:r}function Fg(r){const e={};for(const[t,n]of Object.entries(r)){const i=n.methods||[],a=n.events||[],u=n.accounts||[],f=sl(t)?[t]:n.chains?n.chains:By(n.accounts);e[t]={chains:f,methods:i,events:a,accounts:u}}return e}function hh(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const Ky={},Et=r=>Ky[r],lh=(r,e)=>{Ky[r]=e};class qC{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ln.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=Rs(t);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||cn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Mn(new zn(n,Et("disableProviderPing")))}}var jC=Object.defineProperty,BC=Object.defineProperties,KC=Object.getOwnPropertyDescriptors,Ug=Object.getOwnPropertySymbols,zC=Object.prototype.hasOwnProperty,HC=Object.prototype.propertyIsEnumerable,qg=(r,e,t)=>e in r?jC(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,jg=(r,e)=>{for(var t in e||(e={}))zC.call(e,t)&&qg(r,t,e[t]);if(Ug)for(var t of Ug(e))HC.call(e,t)&&qg(r,t,e[t]);return r},Bg=(r,e)=>BC(r,KC(e));class kC{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Et("events"),this.client=Et("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(Ln.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const n=t||cn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Mn(new zn(n,Et("disableProviderPing")))}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=parseInt(Rs(t));e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,n;let i=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";i=i.startsWith("0x")?i:`0x${i}`;const a=parseInt(i,16);if(this.isChainApproved(a))this.setDefaultChain(`${a}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${a}`);else throw new Error(`Failed to switch to chain 'eip155:${a}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,n,i;const a=(n=(t=e.request)==null?void 0:t.params)==null?void 0:n[0];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const u=this.client.session.get(e.topic),f=((i=u==null?void 0:u.sessionProperties)==null?void 0:i.capabilities)||{};if(f!=null&&f[a])return f==null?void 0:f[a];const d=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Bg(jg({},u.sessionProperties||{}),{capabilities:Bg(jg({},f||{}),{[a]:d})})})}catch(l){console.warn("Failed to update session with capabilities",l)}return d}async getCallStatus(e){var t,n;const i=this.client.session.get(e.topic),a=(t=i.sessionProperties)==null?void 0:t.bundler_name;if(a){const f=this.getBundlerUrl(e.chainId,a);try{return await this.getUserOperationReceipt(f,e)}catch(d){console.warn("Failed to fetch call status from bundler",d,f)}}const u=(n=i.sessionProperties)==null?void 0:n.bundler_url;if(u)try{return await this.getUserOperationReceipt(u,e)}catch(f){console.warn("Failed to fetch call status from custom bundler",f,u)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var n;const i=new URL(e),a=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ki("eth_getUserOperationReceipt",[(n=t.request.params)==null?void 0:n[0]]))});if(!a.ok)throw new Error(`Failed to fetch user operation receipt - ${a.status}`);return await a.json()}getBundlerUrl(e,t){return`${MC}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}class WC{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ln.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=Rs(t);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||cn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Mn(new zn(n,Et("disableProviderPing")))}}class GC{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ln.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=Rs(t);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||cn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Mn(new zn(n,Et("disableProviderPing")))}}class VC{constructor(e){this.name="algorand",this.namespace=e.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const n=t||cn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(Ln.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||cn(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Mn(new zn(n,Et("disableProviderPing")))}}class JC{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ln.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t),i=Rs(t);e[i]=this.createHttpProvider(i,n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||this.getCardanoRPCUrl(e);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Mn(new zn(n,Et("disableProviderPing")))}}class YC{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ln.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=Rs(t);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||cn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Mn(new zn(n,Et("disableProviderPing")))}}class XC{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ln.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=Rs(t);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||cn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Mn(new zn(n,Et("disableProviderPing")))}}class ZC{constructor(e){this.name="near",this.namespace=e.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||cn(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Ln.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||cn(e,this.namespace);return typeof n>"u"?void 0:new Mn(new zn(n,Et("disableProviderPing")))}}class QC{constructor(e){this.name="tezos",this.namespace=e.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||cn(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Ln.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||cn(e,this.namespace);return typeof n>"u"?void 0:new Mn(new zn(n))}}class eR{constructor(e){this.name=ro,this.namespace=e.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ln.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const n={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(i=>{const a=co(i);n[`${a.namespace}:${a.reference}`]=this.createHttpProvider(i)}),n}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||cn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Mn(new zn(n,Et("disableProviderPing")))}}var tR=Object.defineProperty,rR=Object.defineProperties,nR=Object.getOwnPropertyDescriptors,Kg=Object.getOwnPropertySymbols,iR=Object.prototype.hasOwnProperty,sR=Object.prototype.propertyIsEnumerable,zg=(r,e,t)=>e in r?tR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Au=(r,e)=>{for(var t in e||(e={}))iR.call(e,t)&&zg(r,t,e[t]);if(Kg)for(var t of Kg(e))sR.call(e,t)&&zg(r,t,e[t]);return r},dh=(r,e)=>rR(r,nR(e));let oR=class zy{constructor(e){this.events=new AC,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:ca(dc({level:(e==null?void 0:e.logger)||Cg})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new zy(e);return await t.initialize(),t}async request(e,t,n){const[i,a]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:Au({},e),chainId:`${i}:${a}`,topic:this.session.topic,expiry:n})}sendAsync(e,t,n,i){const a=new Date().getTime();this.request(e,n,i).then(u=>t(null,Sc(a,u))).catch(u=>t(u,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ct("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:i}=await this.client.authenticate(e,t);n&&(this.uri=n,this.events.emit("display_uri",n));const a=await i();if(this.session=a.session,this.session){const u=Fg(this.session.namespaces);this.namespaces=fh(this.namespaces,u),this.persist("namespaces",this.namespaces),this.onConnect()}return a}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await i().then(a=>{this.session=a;const u=Fg(a.namespaces);this.namespaces=fh(this.namespaces,u),this.persist("namespaces",this.namespaces)}).catch(a=>{if(a.message!==gy)throw a;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[n,i]=this.validateChain(e),a=this.getProvider(n);a.name===ro?a.setDefaultChain(`${n}:${i}`,t):a.setDefaultChain(i,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Si(t)){for(const n of t)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await dl.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Cg,relayUrl:this.providerOpts.relayUrl||OC,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>Xo(t)))];lh("client",this.client),lh("events",this.events),lh("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const n=FC(t,this.session),i=By(n),a=fh(this.namespaces,this.optionalNamespaces),u=dh(Au({},a[t]),{accounts:n,chains:i});switch(t){case"eip155":this.rpcProviders[t]=new kC({namespace:u});break;case"algorand":this.rpcProviders[t]=new VC({namespace:u});break;case"solana":this.rpcProviders[t]=new WC({namespace:u});break;case"cosmos":this.rpcProviders[t]=new GC({namespace:u});break;case"polkadot":this.rpcProviders[t]=new qC({namespace:u});break;case"cip34":this.rpcProviders[t]=new JC({namespace:u});break;case"elrond":this.rpcProviders[t]=new YC({namespace:u});break;case"multiversx":this.rpcProviders[t]=new XC({namespace:u});break;case"near":this.rpcProviders[t]=new ZC({namespace:u});break;case"tezos":this.rpcProviders[t]=new QC({namespace:u});break;default:this.rpcProviders[ro]?this.rpcProviders[ro].updateNamespace(u):this.rpcProviders[ro]=new eR({namespace:u})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:n}=t;if(n.name==="accountsChanged"){const i=n.data;i&&Si(i)&&this.events.emit("accountsChanged",i.map(UC))}else if(n.name==="chainChanged"){const i=t.chainId,a=t.event.data,u=Xo(i),f=hh(i)!==hh(a)?`${u}:${hh(a)}`:i;this.onChainChanged(f)}else this.events.emit(n.name,n.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var n;const{namespaces:i}=t,a=(n=this.client)==null?void 0:n.session.get(e);this.session=dh(Au({},a),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",dh(Au({},Ct("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Ln.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[ro]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:n,sessionProperties:i}=e;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=i,this.persist("namespaces",t),this.persist("optionalNamespaces",n)}validateChain(e){const[t,n]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(u=>Xo(u)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const i=Xo(Object.keys(this.namespaces)[0]),a=this.rpcProviders[i].getDefaultChain();return[i,a]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;const[n,i]=this.validateChain(e);i&&(t||this.getProvider(n).setDefaultChain(i),this.namespaces[n]?this.namespaces[n].defaultChain=i:this.namespaces[`${n}:${i}`]?this.namespaces[`${n}:${i}`].defaultChain=i:this.namespaces[`${n}:${i}`]={defaultChain:i},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",i))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Rg}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Rg}/${e}`)}};const aR=oR,uR="wc",cR="ethereum_provider",fR=`${uR}@2:${cR}:`,hR="https://rpc.walletconnect.org/v1/",Uh=["eth_sendTransaction","personal_sign"],lR=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],qh=["chainChanged","accountsChanged"],dR=["chainChanged","accountsChanged","message","disconnect","connect"];var pR=Object.defineProperty,gR=Object.defineProperties,vR=Object.getOwnPropertyDescriptors,Hg=Object.getOwnPropertySymbols,mR=Object.prototype.hasOwnProperty,yR=Object.prototype.propertyIsEnumerable,kg=(r,e,t)=>e in r?pR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,no=(r,e)=>{for(var t in e||(e={}))mR.call(e,t)&&kg(r,t,e[t]);if(Hg)for(var t of Hg(e))yR.call(e,t)&&kg(r,t,e[t]);return r},ph=(r,e)=>gR(r,vR(e));function uc(r){return Number(r[0].split(":")[1])}function Ou(r){return`0x${r.toString(16)}`}function wR(r){const{chains:e,optionalChains:t,methods:n,optionalMethods:i,events:a,optionalEvents:u,rpcMap:f}=r;if(!Si(e))throw new Error("Invalid chains");const d={chains:e,methods:n||Uh,events:a||qh,rpcMap:no({},e.length?{[uc(e)]:f[uc(e)]}:{})},l=a==null?void 0:a.filter(I=>!qh.includes(I)),w=n==null?void 0:n.filter(I=>!Uh.includes(I));if(!t&&!u&&!i&&!(l!=null&&l.length)&&!(w!=null&&w.length))return{required:e.length?d:void 0};const b=(l==null?void 0:l.length)&&(w==null?void 0:w.length)||!t,S={chains:[...new Set(b?d.chains.concat(t||[]):t)],methods:[...new Set(d.methods.concat(i!=null&&i.length?i:lR))],events:[...new Set(d.events.concat(u!=null&&u.length?u:dR))],rpcMap:f};return{required:e.length?d:void 0,optional:t.length?S:void 0}}class ml{constructor(){this.events=new nC.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=fR,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new ml;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,n){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),n)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:n}=wR(this.rpc);try{const i=await new Promise(async(u,f)=>{var d;this.rpc.showQrModal&&((d=this.modal)==null||d.subscribeModal(l=>{!l.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(ph(no({namespaces:no({},t&&{[this.namespace]:t})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(l=>{u(l)}).catch(l=>{f(new Error(l.message))})});if(!i)return;const a=l0(i.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:Ou(this.chainId)})}catch(i){throw this.signer.logger.error(i),i}finally{this.modal&&this.modal.closeModal()}}async authenticate(e,t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e==null?void 0:e.chains});try{const n=await new Promise(async(a,u)=>{var f;this.rpc.showQrModal&&((f=this.modal)==null||f.subscribeModal(d=>{!d.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),u(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(ph(no({},e),{chains:this.rpc.chains}),t).then(d=>{a(d)}).catch(d=>{u(new Error(d.message))})}),i=n.session;if(i){const a=l0(i.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:Ou(this.chainId)})}return n}catch(n){throw this.signer.logger.error(n),n}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:n}=t;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",Ou(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",ph(no({},Ct("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,n;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(n=this.modal)==null||n.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",Ou(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,n,i]=e.split(":");return{chainId:`${t}:${n}`,address:i}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,n;const i=(t=e==null?void 0:e.chains)!=null?t:[],a=(n=e==null?void 0:e.optionalChains)!=null?n:[],u=i.concat(a);if(!u.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=i.length?(e==null?void 0:e.methods)||Uh:[],d=i.length?(e==null?void 0:e.events)||qh:[],l=(e==null?void 0:e.optionalMethods)||[],w=(e==null?void 0:e.optionalEvents)||[],b=(e==null?void 0:e.rpcMap)||this.buildRpcMap(u,e.projectId),S=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:i==null?void 0:i.map(I=>this.formatChainId(I)),optionalChains:a.map(I=>this.formatChainId(I)),methods:f,events:d,optionalMethods:l,optionalEvents:w,rpcMap:b,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:S,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const n={};return e.forEach(i=>{n[i]=this.getRpcUrl(i,t)}),n}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?uc(this.rpc.chains):uc(this.rpc.optionalChains),this.signer=await aR.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:n}=await xx(()=>import("./index-CLnLKdOW.js").then(i=>i.i),__vite__mapDeps([0,1,2,3,4]));t=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(no({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:n,rpcMap:i}=e;t&&Si(t)&&(this.rpc.chains=t.map(a=>this.formatChainId(a)),t.forEach(a=>{this.rpc.rpcMap[a]=(i==null?void 0:i[a])||this.getRpcUrl(a)})),n&&Si(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(a=>this.formatChainId(a)),n.forEach(a=>{this.rpc.rpcMap[a]=(i==null?void 0:i[a])||this.getRpcUrl(a)}))}getRpcUrl(e,t){var n;return((n=this.rpc.rpcMap)==null?void 0:n[e])||`${hR}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(t=>this.signer.logger.warn(t))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const VR=ml;export{VR as EthereumProvider,dR as OPTIONAL_EVENTS,lR as OPTIONAL_METHODS,qh as REQUIRED_EVENTS,Uh as REQUIRED_METHODS,ml as default};
